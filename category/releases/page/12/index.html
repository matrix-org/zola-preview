<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="twitter:widgets:csp" content="on" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="twitter:site" content="@matrixdotorg" />
    <meta name="twitter:creator" content="@matrixdotorg" />

    <title>Matrix.org - Releases</title>
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg" />
    <link rel="stylesheet" href="/style.css" />

    
<link rel="alternate" type="application/rss+xml" title="RSS" href="/category/releases/atom.xml">
</head>

<body>
    
    <header class="site-header">
    <a href="/" class="brand">
        <img src="/images/matrix-logo-white.svg" alt="Matrix logo">
    </a>
    <input id="site-header-dropdown-checkbox" type="checkbox" class="dropdown-checkbox" aria-hidden="true">
    <label for="site-header-dropdown-checkbox" class="dropdown-button">&#xe602;</label>
    <label for="site-header-dropdown-checkbox" class="page-overlay"></label>
    <nav>
        
        
        <a href="&#x2F;about&#x2F;" class="
            ">
            About
        </a>
        
        
        
        <a href="&#x2F;blog&#x2F;" class="
            ">
            Blog
        </a>
        
        
        
        <a href="&#x2F;docs&#x2F;" class="
            ">
            Documentation
        </a>
        
        
        
        
        
        <div class="section-wrap">
            <input id="ecosystem-submenu-checkbox" type="checkbox" class="submenu-checkbox" aria-hidden="true"
                >
            <label for="ecosystem-submenu-checkbox" class="submenu-title">Ecosystem <div class="arrow">
                </div></label>

            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;clients&#x2F;">Clients</a>
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;bridges&#x2F;">Bridges</a>
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;servers&#x2F;">Servers</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;bots&#x2F;">Bots</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;sdks&#x2F;">SDKs</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;hosting&#x2F;">Hosting</a>
                    
                </div>
            </div>
        </div>
        
        
        
        <a href="&#x2F;podcasts&#x2F;" class="
            ">
            Podcasts
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;shop.matrix.org" class="
            ">
            Shop
        </a>
        
        
        
        <a href="&#x2F;try-matrix&#x2F;" class="primary
            ">
            Try Matrix
        </a>
        
        
    </nav>
</header>


    <main>
        
<div id="taxonomy-single">
    <div class="content">
        <header>
            <h1>Releases</h1>
            138 posts tagged with "Releases" <a href="/category">(See all Category)</a>
            
            <h2>
                <small><a href="/category/releases/atom.xml">Atom Feed</a></small>
            </h2>
            
        </header>

        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2019&#x2F;05&#x2F;30&#x2F;synapse-0-99-5-2-released&#x2F;" title="Synapse 0.99.5.2 released">Synapse 0.99.5.2 released</a></h2>
                <span>
                    30.05.2019 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>0.99.5.2 contains a critical performance fix following a regression that was introduced in 0.99.5. Affected servers will have experienced increased CPU and RAM usage with a knock on effect of generally sluggish performance.</p>
<p>Separately, we are also looking into reports relating to further performance degradations that may have been introduced as part of 0.99.5, though consider the 0.99.5.2 fix to be a significant improvement on previous 0.99.5.x releases.</p>
<p>Please upgrade asap.</p>
<p>You can get the new update <a href="https://github.com/matrix-org/synapse/releases/tag/v0.99.5.2">here</a> or any of the sources mentioned at <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>. Note, Synapse is now available from PyPI, pick it up <a href="https://pypi.org/project/matrix-synapse/">here</a>. Also, check out our <a href="https://matrix.org/docs/guides/installing-synapse">Synapse installation guide page</a>.</p>
<h1 id="synapse-v0-99-5-2-changelog">Synapse v0.99.5.2 Changelog</h1>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Fix bug where we leaked extremities when we soft failed events, leading to performance degradation. (<a href="https://github.com/matrix-org/synapse/issues/5274">#5274</a>, <a href="https://github.com/matrix-org/synapse/issues/5278">#5278</a>, <a href="https://github.com/matrix-org/synapse/issues/5291">#5291</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2019&#x2F;05&#x2F;21&#x2F;synapse-0-99-5-1-released&#x2F;" title="Synapse 0.99.5.1 released!">Synapse 0.99.5.1 released!</a></h2>
                <span>
                    21.05.2019 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Okay folks, this is an important one. v0.99.5.1 will be the last release before we ship Synapse v1.0. <strong>It is really important that you upgrade to v0.99.5.1 because it implements rooms <a href="https://github.com/matrix-org/matrix-doc/blob/matthew/room_v4/proposals/2002-rooms-v4.md">version 4</a> - which is the room version that Synapse 1.0 will default to.</strong></p>
<p>This means that Synapse 1.0 servers will create new rooms as version 4 by default and servers that have not upgraded to at least v0.99.5.1 will not be able to join those rooms.</p>
<p>Over the coming days we will announce a release day for Synapse v1.0, the idea is to give admins 2 weeks notice so that anyone yet to configure their federation SSL certificate has time to do so. <strong>This is important, failure to configure your certs will mean not being able to federate with v1.0 servers.</strong> If you are not sure if you certs are valid, you can test <a href="https://federationtester.matrix.org/">here</a> and read <a href="https://github.com/matrix-org/synapse/blob/master/docs/MSC1711_certificates_FAQ.md">here</a> for more info on what to do.</p>
<p>Aside from room v4, this release also includes the ability to blacklist specific IPs from federating as well as experimental support for edits and reactions. We are not quite ready to mark the feature 'done done', but it is very close. Watch out for news as the feature lands properly.</p>
<p>We're really close to v1.0 now, give us a few more days and we'll announce an official release date.</p>
<p>As ever, you can get the new update <a href="https://github.com/matrix-org/synapse/releases/tag/v0.99.5.1">here</a> or any of the sources mentioned at <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>. Note, Synapse is now available from PyPI, pick it up <a href="https://pypi.org/project/matrix-synapse/">here</a>. Also, check out our <a href="https://matrix.org/docs/guides/installing-synapse">Synapse installation guide page</a></p>
<h1 id="synapse-v0-99-5-1-changelog-since-v0-99-4">Synapse v0.99.5.1 Changelog (since v0.99.4)</h1>
<h2 id="features">Features</h2>
<ul>
<li>Add ability to blacklist IP ranges for the federation client. (<a href="https://github.com/matrix-org/synapse/issues/5043">#5043</a>)</li>
<li>Ratelimiting configuration for clients sending messages and the federation server has been altered to match login ratelimiting. The old configuration names will continue working. Check the sample config for details of the new names. (<a href="https://github.com/matrix-org/synapse/issues/5181">#5181</a>)</li>
<li>Drop support for the undocumented /_matrix/client/v2_alpha API prefix. (<a href="https://github.com/matrix-org/synapse/issues/5190">#5190</a>)</li>
<li>Add an option to disable per-room profiles. (<a href="https://github.com/matrix-org/synapse/issues/5196">#5196</a>)</li>
<li>Stick an expiration date to any registered user missing one at startup if account validity is enabled. (<a href="https://github.com/matrix-org/synapse/issues/5204">#5204</a>)</li>
<li>Add experimental support for relations (aka reactions and edits). (<a href="https://github.com/matrix-org/synapse/issues/5209">#5209</a>, <a href="https://github.com/matrix-org/synapse/issues/5211">#5211</a>, <a href="https://github.com/matrix-org/synapse/issues/5203">#5203</a>, <a href="https://github.com/matrix-org/synapse/issues/5212">#5212</a>)</li>
<li>Add a room version 4 which uses a new event ID format, as per <a href="https://github.com/matrix-org/matrix-doc/pull/2002">MSC2002</a>. (<a href="https://github.com/matrix-org/synapse/issues/5210">#5210</a>, <a href="https://github.com/matrix-org/synapse/issues/5217">#5217</a>)</li>
</ul>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Fix image orientation when generating thumbnails (needs pillow&gt;=4.3.0). Contributed by Pau Rodriguez-Estivill. (<a href="https://github.com/matrix-org/synapse/issues/5039">#5039</a>)</li>
<li>Exclude soft-failed events from forward-extremity candidates: fixes &quot;No forward extremities left!&quot; error. (<a href="https://github.com/matrix-org/synapse/issues/5146">#5146</a>)</li>
<li>Re-order stages in registration flows such that msisdn and email verification are done last. (<a href="https://github.com/matrix-org/synapse/issues/5174">#5174</a>)</li>
<li>Fix 3pid guest invites. (<a href="https://github.com/matrix-org/synapse/issues/5177">#5177</a>)</li>
<li>Fix a bug where the register endpoint would fail with M_THREEPID_IN_USE instead of returning an account previously registered in the same session. (<a href="https://github.com/matrix-org/synapse/issues/5187">#5187</a>)</li>
<li>Prevent registration for user ids that are too long to fit into a state key. Contributed by Reid Anderson. (<a href="https://github.com/matrix-org/synapse/issues/5198">#5198</a>)</li>
<li>Fix incompatibility between ACME support and Python 3.5.2. (<a href="https://github.com/matrix-org/synapse/issues/5218">#5218</a>)</li>
<li>Fix error handling for rooms whose versions are unknown. (<a href="https://github.com/matrix-org/synapse/issues/5219">#5219</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Make /sync attempt to return device updates for both joined and invited users. Note that this doesn't currently work correctly due to other bugs. (<a href="https://github.com/matrix-org/synapse/issues/3484">#3484</a>)</li>
<li>Update tests to consistently be configured via the same code that is used when loading from configuration files. (<a href="https://github.com/matrix-org/synapse/issues/5171">#5171</a>, <a href="https://github.com/matrix-org/synapse/issues/5185">#5185</a>)</li>
<li>Allow client event serialization to be async. (<a href="https://github.com/matrix-org/synapse/issues/5183">#5183</a>)</li>
<li>Expose DataStore._get_events as get_events_as_list. (<a href="https://github.com/matrix-org/synapse/issues/5184">#5184</a>)</li>
<li>Make generating SQL bounds for pagination generic. (<a href="https://github.com/matrix-org/synapse/issues/5191">#5191</a>)</li>
<li>Stop telling people to install the optional dependencies by default. (<a href="https://github.com/matrix-org/synapse/issues/5197">#5197</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2019&#x2F;05&#x2F;15&#x2F;synapse-0-99-4-released&#x2F;" title="Synapse 0.99.4 released!">Synapse 0.99.4 released!</a></h2>
                <span>
                    15.05.2019 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hey ho Synapse release day.</p>
<p>0.99.4 is a maintenance release collecting together all of the bug fixes and performance improvements over the past few weeks, additionally there is further support for the upcoming 1.0 release (more info coming soon). One thing worth calling out is how many community contributions have made their way into 0.99.4, take a look at the change log for details, but many thanks to everyone submitting PRs, keep them coming!</p>
<p>As ever, you can get the new update <a href="https://github.com/matrix-org/synapse/releases/tag/v0.99.4">here</a> or any of the sources mentioned at <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>. Note, Synapse is now available from PyPI, pick it up <a href="https://pypi.org/project/matrix-synapse/">here</a>. Also, check out our <a href="https://matrix.org/docs/guides/installing-synapse">Synapse installation guide page</a></p>
<h1 id="synapse-0-99-4-changelog">Synapse 0.99.4 Changelog</h1>
<h2 id="features">Features</h2>
<ul>
<li>Add systemd-python to the optional dependencies to enable logging to the systemd journal. Install with <code>pip install matrix-synapse[systemd]</code>. (<a href="https://github.com/matrix-org/synapse/issues/4339">#4339</a>)</li>
<li>Add a default .m.rule.tombstone push rule. (<a href="https://github.com/matrix-org/synapse/issues/4867">#4867</a>)</li>
<li>Add ability for password provider modules to bind email addresses to users upon registration. (<a href="https://github.com/matrix-org/synapse/issues/4947">#4947</a>)</li>
<li>Implementation of <a href="https://github.com/matrix-org/matrix-doc/pull/1711">MSC1711</a> including config options for requiring valid TLS certificates for federation traffic, the ability to disable TLS validation for specific domains, and the ability to specify your own list of CA certificates. (<a href="https://github.com/matrix-org/synapse/issues/4967">#4967</a>)</li>
<li>Remove presence list support as per MSC 1819. (<a href="https://github.com/matrix-org/synapse/issues/4989">#4989</a>)</li>
<li>Reduce CPU usage starting pushers during start up. (<a href="https://github.com/matrix-org/synapse/issues/4991">#4991</a>)</li>
<li>Add a delete group admin API. (<a href="https://github.com/matrix-org/synapse/issues/5002">#5002</a>)</li>
<li>Add config option to block users from looking up 3PIDs. (<a href="https://github.com/matrix-org/synapse/issues/5010">#5010</a>)</li>
<li>Add context to phonehome stats. (<a href="https://github.com/matrix-org/synapse/issues/5020">#5020</a>)</li>
<li>Configure the example systemd units to have a log identifier of <code>matrix-synapse</code>
instead of the executable name, <code>python</code>.
Contributed by Christoph Müller. (<a href="https://github.com/matrix-org/synapse/issues/5023">#5023</a>)</li>
<li>Add time-based account expiration. (<a href="https://github.com/matrix-org/synapse/issues/5027">#5027</a>, <a href="https://github.com/matrix-org/synapse/issues/5047">#5047</a>, <a href="https://github.com/matrix-org/synapse/issues/5073">#5073</a>, <a href="https://github.com/matrix-org/synapse/issues/5116">#5116</a>)</li>
<li>Add support for handling /versions, /voip and /push_rules client endpoints to client_reader worker. (<a href="https://github.com/matrix-org/synapse/issues/5063">#5063</a>, <a href="https://github.com/matrix-org/synapse/issues/5065">#5065</a>, <a href="https://github.com/matrix-org/synapse/issues/5070">#5070</a>)</li>
<li>Add an configuration option to require authentication on /publicRooms and /profile endpoints. (<a href="https://github.com/matrix-org/synapse/issues/5083">#5083</a>)</li>
<li>Move admin APIs to <code>/_synapse/admin/v1</code>. (The old paths are retained for backwards-compatibility, for now). (<a href="https://github.com/matrix-org/synapse/issues/5119">#5119</a>)</li>
<li>Implement an admin API for sending server notices. Many thanks to @krombel who provided a foundation for this work. (<a href="https://github.com/matrix-org/synapse/issues/5121">#5121</a>, <a href="https://github.com/matrix-org/synapse/issues/5142">#5142</a>)</li>
</ul>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Avoid redundant URL encoding of redirect URL for SSO login in the fallback login page. Fixes a regression introduced in <a href="https://github.com/matrix-org/synapse/pull/4220">#4220</a>. Contributed by Marcel Fabian Krüger (&quot;<a href="https://github.com/zauguin">zaugin</a>&quot;). (<a href="https://github.com/matrix-org/synapse/issues/4555">#4555</a>)</li>
<li>Fix bug where presence updates were sent to all servers in a room when a new server joined, rather than to just the new server. (<a href="https://github.com/matrix-org/synapse/issues/4942">#4942</a>, <a href="https://github.com/matrix-org/synapse/issues/5103">#5103</a>)</li>
<li>Fix sync bug which made accepting invites unreliable in worker-mode synapses. (<a href="https://github.com/matrix-org/synapse/issues/4955">#4955</a>, <a href="https://github.com/matrix-org/synapse/issues/4956">#4956</a>)</li>
<li>start.sh: Fix the --no-rate-limit option for messages and make it bypass rate limit on registration and login too. (<a href="https://github.com/matrix-org/synapse/issues/4981">#4981</a>)</li>
<li>Transfer related groups on room upgrade. (<a href="https://github.com/matrix-org/synapse/issues/4990">#4990</a>)</li>
<li>Prevent the ability to kick users from a room they aren't in. (<a href="https://github.com/matrix-org/synapse/issues/4999">#4999</a>)</li>
<li>Fix issue #4596 so synapse_port_db script works with --curses option on Python 3. Contributed by Anders Jensen-Waud <a href="mailto:anders@jensenwaud.com">anders@jensenwaud.com</a>. (<a href="https://github.com/matrix-org/synapse/issues/5003">#5003</a>)</li>
<li>Clients timing out/disappearing while downloading from the media repository will now no longer log a spurious &quot;Producer was not unregistered&quot; message. (<a href="https://github.com/matrix-org/synapse/issues/5009">#5009</a>)</li>
<li>Fix &quot;cannot import name execute_batch&quot; error with postgres. (<a href="https://github.com/matrix-org/synapse/issues/5032">#5032</a>)</li>
<li>Fix disappearing exceptions in manhole. (<a href="https://github.com/matrix-org/synapse/issues/5035">#5035</a>)</li>
<li>Workaround bug in twisted where attempting too many concurrent DNS requests could cause it to hang due to running out of file descriptors. (<a href="https://github.com/matrix-org/synapse/issues/5037">#5037</a>)</li>
<li>Make sure we're not registering the same 3pid twice on registration. (<a href="https://github.com/matrix-org/synapse/issues/5071">#5071</a>)</li>
<li>Don't crash on lack of expiry templates. (<a href="https://github.com/matrix-org/synapse/issues/5077">#5077</a>)</li>
<li>Fix the ratelimting on third party invites. (<a href="https://github.com/matrix-org/synapse/issues/5104">#5104</a>)</li>
<li>Add some missing limitations to room alias creation. (<a href="https://github.com/matrix-org/synapse/issues/5124">#5124</a>, <a href="https://github.com/matrix-org/synapse/issues/5128">#5128</a>)</li>
<li>Limit the number of EDUs in transactions to 100 as expected by synapse. Thanks to @superboum for this work! (<a href="https://github.com/matrix-org/synapse/issues/5138">#5138</a>)</li>
<li>Fix bogus imports in unit tests. (<a href="https://github.com/matrix-org/synapse/issues/5154">#5154</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Add test to verify threepid auth check added in #4435. (<a href="https://github.com/matrix-org/synapse/issues/4474">#4474</a>)</li>
<li>Fix/improve some docstrings in the replication code. (<a href="https://github.com/matrix-org/synapse/issues/4949">#4949</a>)</li>
<li>Split synapse.replication.tcp.streams into smaller files. (<a href="https://github.com/matrix-org/synapse/issues/4953">#4953</a>)</li>
<li>Refactor replication row generation/parsing. (<a href="https://github.com/matrix-org/synapse/issues/4954">#4954</a>)</li>
<li>Run <code>black</code> to clean up formatting on <code>synapse/storage/roommember.py</code> and <code>synapse/storage/events.py</code>. (<a href="https://github.com/matrix-org/synapse/issues/4959">#4959</a>)</li>
<li>Remove log line for password via the admin API. (<a href="https://github.com/matrix-org/synapse/issues/4965">#4965</a>)</li>
<li>Fix typo in TLS filenames in docker/README.md. Also add the '-p' commandline option to the 'docker run' example. Contributed by Jurrie Overgoor. (<a href="https://github.com/matrix-org/synapse/issues/4968">#4968</a>)</li>
<li>Refactor room version definitions. (<a href="https://github.com/matrix-org/synapse/issues/4969">#4969</a>)</li>
<li>Reduce log level of .well-known/matrix/client responses. (<a href="https://github.com/matrix-org/synapse/issues/4972">#4972</a>)</li>
<li>Add <code>config.signing_key_path</code> that can be read by <code>synapse.config</code> utility. (<a href="https://github.com/matrix-org/synapse/issues/4974">#4974</a>)</li>
<li>Track which identity server is used when binding a threepid and use that for unbinding, as per MSC1915. (<a href="https://github.com/matrix-org/synapse/issues/4982">#4982</a>)</li>
<li>Rewrite KeyringTestCase as a HomeserverTestCase. (<a href="https://github.com/matrix-org/synapse/issues/4985">#4985</a>)</li>
<li>README updates: Corrected the default POSTGRES_USER. Added port forwarding hint in TLS section. (<a href="https://github.com/matrix-org/synapse/issues/4987">#4987</a>)</li>
<li>Remove a number of unused tables from the database schema. (<a href="https://github.com/matrix-org/synapse/issues/4992">#4992</a>, <a href="https://github.com/matrix-org/synapse/issues/5028">#5028</a>, <a href="https://github.com/matrix-org/synapse/issues/5033">#5033</a>)</li>
<li>Run <code>black</code> on the remainder of <code>synapse/storage/</code>. (<a href="https://github.com/matrix-org/synapse/issues/4996">#4996</a>)</li>
<li>Fix grammar in get_current_users_in_room and give it a docstring. (<a href="https://github.com/matrix-org/synapse/issues/4998">#4998</a>)</li>
<li>Clean up some code in the server-key Keyring. (<a href="https://github.com/matrix-org/synapse/issues/5001">#5001</a>)</li>
<li>Convert SYNAPSE_NO_TLS Docker variable to boolean for user friendliness. Contributed by Gabriel Eckerson. (<a href="https://github.com/matrix-org/synapse/issues/5005">#5005</a>)</li>
<li>Refactor synapse.storage._base._simple_select_list_paginate. (<a href="https://github.com/matrix-org/synapse/issues/5007">#5007</a>)</li>
<li>Store the notary server name correctly in server_keys_json. (<a href="https://github.com/matrix-org/synapse/issues/5024">#5024</a>)</li>
<li>Rewrite Datastore.get_server_verify_keys to reduce the number of database transactions. (<a href="https://github.com/matrix-org/synapse/issues/5030">#5030</a>)</li>
<li>Remove extraneous period from copyright headers. (<a href="https://github.com/matrix-org/synapse/issues/5046">#5046</a>)</li>
<li>Update documentation for where to get Synapse packages. (<a href="https://github.com/matrix-org/synapse/issues/5067">#5067</a>)</li>
<li>Add workarounds for pep-517 install errors. (<a href="https://github.com/matrix-org/synapse/issues/5098">#5098</a>)</li>
<li>Improve logging when event-signature checks fail. (<a href="https://github.com/matrix-org/synapse/issues/5100">#5100</a>)</li>
<li>Factor out an &quot;assert_requester_is_admin&quot; function. (<a href="https://github.com/matrix-org/synapse/issues/5120">#5120</a>)</li>
<li>Remove the requirement to authenticate for /admin/server_version. (<a href="https://github.com/matrix-org/synapse/issues/5122">#5122</a>)</li>
<li>Prevent an exception from being raised in a IResolutionReceiver and use a more generic error message for blacklisted URL previews. (<a href="https://github.com/matrix-org/synapse/issues/5155">#5155</a>)</li>
<li>Run <code>black</code> on the tests directory. (<a href="https://github.com/matrix-org/synapse/issues/5170">#5170</a>)</li>
<li>Fix CI after new release of isort. (<a href="https://github.com/matrix-org/synapse/issues/5179">#5179</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2019&#x2F;04&#x2F;01&#x2F;synapse-0-99-3-released&#x2F;" title="Synapse 0.99.3 released!">Synapse 0.99.3 released!</a></h2>
                <span>
                    01.04.2019 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hey hey, a Synapse release for you today.</p>
<p>The big news in 0.99.3 is that the user directory has been completely re-written and should now be much more performant - this will benefit all installations, but especially those housing larger servers.</p>
<p>Aside from that we continue our 1.0 preparations and relatedly we've improved our docs, in particular to explain how .well-known works. On the perf side we've added rate limiting to login and register endpoints as well as now batching up read receipts to send over federation.</p>
<p>I've said it before, and I'll say it again:-</p>
<blockquote>
<p>The most important thing that admins should know is that prior to 1.0 landing later this month, <strong>it is essential that the federation API has a valid TLS certificate - self signed certificates will no longer be accepted.</strong> For more details see our <a href="https://github.com/matrix-org/synapse/blob/master/docs/MSC1711_certificates_FAQ.md">handy guide</a>. Failure to do this will result in being unable to federate with other 1.0 servers.</p>
</blockquote>
<p>As ever, you can get the new update <a href="https://github.com/matrix-org/synapse/releases/tag/v0.99.3">here</a> or any of the sources mentioned at <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>. Note, Synapse is now available from PyPI, pick it up <a href="https://pypi.org/project/matrix-synapse/">here</a>. Also, check out our new <a href="/docs/guides/installing-synapse">Synapse installation guide page.</a></p>
<h2 id="synapse-0-99-3-changelog">Synapse 0.99.3 changelog</h2>
<h4 id="features">Features</h4>
<ul>
 	<li>The user directory has been rewritten to make it faster, with less chance of falling behind on a large server. (<a href="https://github.com/matrix-org/synapse/issues/4537">#4537</a>, <a href="https://github.com/matrix-org/synapse/issues/4846">#4846</a>, <a href="https://github.com/matrix-org/synapse/issues/4864">#4864</a>, <a href="https://github.com/matrix-org/synapse/issues/4887">#4887</a>, <a href="https://github.com/matrix-org/synapse/issues/4900">#4900</a>, <a href="https://github.com/matrix-org/synapse/issues/4944">#4944</a>)</li>
 	<li>Add configurable rate limiting to the /register endpoint. (<a href="https://github.com/matrix-org/synapse/issues/4735">#4735</a>, <a href="https://github.com/matrix-org/synapse/issues/4804">#4804</a>)</li>
 	<li>Move server key queries to federation reader. (<a href="https://github.com/matrix-org/synapse/issues/4757">#4757</a>)</li>
 	<li>Add support for /account/3pid REST endpoint to client_reader worker. (<a href="https://github.com/matrix-org/synapse/issues/4759">#4759</a>)</li>
 	<li>Add an endpoint to the admin API for querying the server version. Contributed by Joseph Weston. (<a href="https://github.com/matrix-org/synapse/issues/4772">#4772</a>)</li>
 	<li>Include a default configuration file in the 'docs' directory. (<a href="https://github.com/matrix-org/synapse/issues/4791">#4791</a>, <a href="https://github.com/matrix-org/synapse/issues/4801">#4801</a>)</li>
 	<li>Synapse is now permissive about trailing slashes on some of its federation endpoints, allowing zero or more to be present. (<a href="https://github.com/matrix-org/synapse/issues/4793">#4793</a>)</li>
 	<li>Add support for /keys/query and /keys/changes REST endpoints to client_reader worker. (<a href="https://github.com/matrix-org/synapse/issues/4796">#4796</a>)</li>
 	<li>Add checks to incoming events over federation for events evading auth (aka "soft fail"). (<a href="https://github.com/matrix-org/synapse/issues/4814">#4814</a>)</li>
 	<li>Add configurable rate limiting to the /login endpoint. (<a href="https://github.com/matrix-org/synapse/issues/4821">#4821</a>, <a href="https://github.com/matrix-org/synapse/issues/4865">#4865</a>)</li>
 	<li>Remove trailing slashes from certain outbound federation requests. Retry if receiving a 404. Context: #3622. (<a href="https://github.com/matrix-org/synapse/issues/4840">#4840</a>)</li>
 	<li>Allow passing --daemonize flags to workers in the same way as with master. (<a href="https://github.com/matrix-org/synapse/issues/4853">#4853</a>)</li>
 	<li>Batch up outgoing read-receipts to reduce federation traffic. (<a href="https://github.com/matrix-org/synapse/issues/4890">#4890</a>, <a href="https://github.com/matrix-org/synapse/issues/4927">#4927</a>)</li>
 	<li>Add option to disable searching the user directory. (<a href="https://github.com/matrix-org/synapse/issues/4895">#4895</a>)</li>
 	<li>Add option to disable searching of local and remote public room lists. (<a href="https://github.com/matrix-org/synapse/issues/4896">#4896</a>)</li>
 	<li>Add ability for password providers to login/register a user via 3PID (email, phone). (<a href="https://github.com/matrix-org/synapse/issues/4931">#4931</a>)</li>
</ul>
<h4 id="bugfixes">Bugfixes</h4>
<ul>
 	<li>Fix a bug where media with spaces in the name would get a corrupted name. (<a href="https://github.com/matrix-org/synapse/issues/2090">#2090</a>)</li>
 	<li>Fix attempting to paginate in rooms where server cannot see any events, to avoid unnecessarily pulling in lots of redacted events. (<a href="https://github.com/matrix-org/synapse/issues/4699">#4699</a>)</li>
 	<li>'event_id' is now a required parameter in federated state requests, as per the matrix spec. (<a href="https://github.com/matrix-org/synapse/issues/4740">#4740</a>)</li>
 	<li>Fix tightloop over connecting to replication server. (<a href="https://github.com/matrix-org/synapse/issues/4749">#4749</a>)</li>
 	<li>Fix parsing of Content-Disposition headers on remote media requests and URL previews. (<a href="https://github.com/matrix-org/synapse/issues/4763">#4763</a>)</li>
 	<li>Fix incorrect log about not persisting duplicate state event. (<a href="https://github.com/matrix-org/synapse/issues/4776">#4776</a>)</li>
 	<li>Fix v4v6 option in HAProxy example config. Contributed by Flakebi. (<a href="https://github.com/matrix-org/synapse/issues/4790">#4790</a>)</li>
 	<li>Handle batch updates in worker replication protocol. (<a href="https://github.com/matrix-org/synapse/issues/4792">#4792</a>)</li>
 	<li>Fix bug where we didn't correctly throttle sending of USER_IP commands over replication. (<a href="https://github.com/matrix-org/synapse/issues/4818">#4818</a>)</li>
 	<li>Fix potential race in handling missing updates in device list updates. (<a href="https://github.com/matrix-org/synapse/issues/4829">#4829</a>)</li>
 	<li>Fix bug where synapse expected an un-specced <code>prev_state</code> field on state events. (<a href="https://github.com/matrix-org/synapse/issues/4837">#4837</a>)</li>
 	<li>Transfer a user's notification settings (push rules) on room upgrade. (<a href="https://github.com/matrix-org/synapse/issues/4838">#4838</a>)</li>
 	<li>fix test_auto_create_auto_join_where_no_consent. (<a href="https://github.com/matrix-org/synapse/issues/4886">#4886</a>)</li>
 	<li>Fix a bug where hs_disabled_message was sometimes not correctly enforced. (<a href="https://github.com/matrix-org/synapse/issues/4888">#4888</a>)</li>
 	<li>Fix bug in shutdown room admin API where it would fail if a user in the room hadn't consented to the privacy policy. (<a href="https://github.com/matrix-org/synapse/issues/4904">#4904</a>)</li>
 	<li>Fix bug where blocked world-readable rooms were still peekable. (<a href="https://github.com/matrix-org/synapse/issues/4908">#4908</a>)</li>
</ul>
<h4 id="internal-changes">Internal Changes</h4>
<ul>
 	<li>Add a systemd setup that supports synapse workers. Contributed by Luca Corbatto. (<a href="https://github.com/matrix-org/synapse/issues/4662">#4662</a>)</li>
 	<li>Change from TravisCI to Buildkite for CI. (<a href="https://github.com/matrix-org/synapse/issues/4752">#4752</a>)</li>
 	<li>When presence is disabled don't send over replication. (<a href="https://github.com/matrix-org/synapse/issues/4757">#4757</a>)</li>
 	<li>Minor docstring fixes for MatrixFederationAgent. (<a href="https://github.com/matrix-org/synapse/issues/4765">#4765</a>)</li>
 	<li>Optimise EDU transmission for the federation_sender worker. (<a href="https://github.com/matrix-org/synapse/issues/4770">#4770</a>)</li>
 	<li>Update test_typing to use HomeserverTestCase. (<a href="https://github.com/matrix-org/synapse/issues/4771">#4771</a>)</li>
 	<li>Update URLs for riot.im icons and logos in the default notification templates. (<a href="https://github.com/matrix-org/synapse/issues/4779">#4779</a>)</li>
 	<li>Removed unnecessary $ from some federation endpoint path regexes. (<a href="https://github.com/matrix-org/synapse/issues/4794">#4794</a>)</li>
 	<li>Remove link to deleted title in README. (<a href="https://github.com/matrix-org/synapse/issues/4795">#4795</a>)</li>
 	<li>Clean up read-receipt handling. (<a href="https://github.com/matrix-org/synapse/issues/4797">#4797</a>)</li>
 	<li>Add some debug about processing read receipts. (<a href="https://github.com/matrix-org/synapse/issues/4798">#4798</a>)</li>
 	<li>Clean up some replication code. (<a href="https://github.com/matrix-org/synapse/issues/4799">#4799</a>)</li>
 	<li>Add some docstrings. (<a href="https://github.com/matrix-org/synapse/issues/4815">#4815</a>)</li>
 	<li>Add debug logger to try and track down #4422. (<a href="https://github.com/matrix-org/synapse/issues/4816">#4816</a>)</li>
 	<li>Make shutdown API send explanation message to room after users have been forced joined. (<a href="https://github.com/matrix-org/synapse/issues/4817">#4817</a>)</li>
 	<li>Update example_log_config.yaml. (<a href="https://github.com/matrix-org/synapse/issues/4820">#4820</a>)</li>
 	<li>Document the <code>generate</code> option for the docker image. (<a href="https://github.com/matrix-org/synapse/issues/4824">#4824</a>)</li>
 	<li>Fix check-newsfragment for debian-only changes. (<a href="https://github.com/matrix-org/synapse/issues/4825">#4825</a>)</li>
 	<li>Add some debug logging for device list updates to help with #4828. (<a href="https://github.com/matrix-org/synapse/issues/4828">#4828</a>)</li>
 	<li>Improve federation documentation, specifically .well-known support. Many thanks to @vaab. (<a href="https://github.com/matrix-org/synapse/issues/4832">#4832</a>)</li>
 	<li>Disable captcha registration by default in unit tests. (<a href="https://github.com/matrix-org/synapse/issues/4839">#4839</a>)</li>
 	<li>Add stuff back to the .gitignore. (<a href="https://github.com/matrix-org/synapse/issues/4843">#4843</a>)</li>
 	<li>Clarify what registration_shared_secret allows for. (<a href="https://github.com/matrix-org/synapse/issues/4844">#4844</a>)</li>
 	<li>Correctly log expected errors when fetching server keys. (<a href="https://github.com/matrix-org/synapse/issues/4847">#4847</a>)</li>
 	<li>Update install docs to explicitly state a full-chain (not just the top-level) TLS certificate must be provided to Synapse. This caused some people's Synapse ports to appear correct in a browser but still (rightfully so) upset the federation tester. (<a href="https://github.com/matrix-org/synapse/issues/4849">#4849</a>)</li>
 	<li>Move client read-receipt processing to federation sender worker. (<a href="https://github.com/matrix-org/synapse/issues/4852">#4852</a>)</li>
 	<li>Refactor federation TransactionQueue. (<a href="https://github.com/matrix-org/synapse/issues/4855">#4855</a>)</li>
 	<li>Comment out most options in the generated config. (<a href="https://github.com/matrix-org/synapse/issues/4863">#4863</a>)</li>
 	<li>Fix yaml library warnings by using safe_load. (<a href="https://github.com/matrix-org/synapse/issues/4869">#4869</a>)</li>
 	<li>Update Apache setup to remove location syntax. Thanks to @cwmke! (<a href="https://github.com/matrix-org/synapse/issues/4870">#4870</a>)</li>
 	<li>Reinstate test case that runs unit tests against oldest supported dependencies. (<a href="https://github.com/matrix-org/synapse/issues/4879">#4879</a>)</li>
 	<li>Update link to federation docs. (<a href="https://github.com/matrix-org/synapse/issues/4881">#4881</a>)</li>
 	<li>fix test_auto_create_auto_join_where_no_consent. (<a href="https://github.com/matrix-org/synapse/issues/4886">#4886</a>)</li>
 	<li>Use a regular HomeServerConfig object for unit tests rater than a Mock. (<a href="https://github.com/matrix-org/synapse/issues/4889">#4889</a>)</li>
 	<li>Add some notes about tuning postgres for larger deployments. (<a href="https://github.com/matrix-org/synapse/issues/4895">#4895</a>)</li>
 	<li>Add a config option for torture-testing worker replication. (<a href="https://github.com/matrix-org/synapse/issues/4902">#4902</a>)</li>
 	<li>Log requests which are simulated by the unit tests. (<a href="https://github.com/matrix-org/synapse/issues/4905">#4905</a>)</li>
 	<li>Allow newsfragments to end with exclamation marks. Exciting! (<a href="https://github.com/matrix-org/synapse/issues/4912">#4912</a>)</li>
 	<li>Refactor some more tests to use HomeserverTestCase. (<a href="https://github.com/matrix-org/synapse/issues/4913">#4913</a>)</li>
 	<li>Refactor out the state deltas portion of the user directory store and handler. (<a href="https://github.com/matrix-org/synapse/issues/4917">#4917</a>)</li>
 	<li>Fix nginx example in ACME doc. (<a href="https://github.com/matrix-org/synapse/issues/4923">#4923</a>)</li>
 	<li>Use an explicit dbname for postgres connections in the tests. (<a href="https://github.com/matrix-org/synapse/issues/4928">#4928</a>)</li>
 	<li>Fix <code>ClientReplicationStreamProtocol.__str__()</code>. (<a href="https://github.com/matrix-org/synapse/issues/4929">#4929</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2019&#x2F;03&#x2F;04&#x2F;synapse-0-99-2-released&#x2F;" title="Synapse 0.99.2 released!">Synapse 0.99.2 released!</a></h2>
                <span>
                    04.03.2019 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Well now, what have we here? Synapse 0.99.2 is the latest in the 0.99.x series as we step ever closer to 1.0.</p>
<p>0.99.2 is an incremental release including a bunch of performance improvements, enhancements to room upgrades and generally a plethora of bug fixes.</p>
<p>The most important thing that admins should know is that prior to 1.0 landing later this month, <strong>it is essential that the federation API has a valid TLS certificate - self signed certificates will no longer be accepted.</strong> For more details see our <a href="https://github.com/matrix-org/synapse/blob/master/docs/MSC1711_certificates_FAQ.md">handy guide</a>. Failure to do this will result in being unable to federate with other 1.0 servers.</p>
<p>As ever, you can get the new update <a href="https://github.com/matrix-org/synapse/releases/tag/v0.99.2">here</a> or any of the sources mentioned at <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>. Note, Synapse is now available from PyPI, pick it up <a href="https://pypi.org/project/matrix-synapse/">here</a>. Also, check out our new <a href="/docs/guides/installing-synapse">Synapse installation guide page.</a></p>
<h2 id="synapse-0-99-2-changelog">Synapse 0.99.2 changelog</h2>
<h3 id="features">Features</h3>
<ul>
 	<li>Added an HAProxy example in the reverse proxy documentation. Contributed by Benoît S. (“Benpro”). (<a href="https://github.com/matrix-org/synapse/issues/4541" data-hovercard-type="issue" data-hovercard-url="/matrix-org/synapse/issues/4541/hovercard">#4541</a>)</li>
 	<li>Add basic optional sentry integration. (<a href="https://github.com/matrix-org/synapse/issues/4632" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4632/hovercard">#4632</a>, <a href="https://github.com/matrix-org/synapse/issues/4694" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4694/hovercard">#4694</a>)</li>
 	<li>Transfer bans on room upgrade. (<a href="https://github.com/matrix-org/synapse/issues/4642" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4642/hovercard">#4642</a>)</li>
 	<li>Add configurable room list publishing rules. (<a href="https://github.com/matrix-org/synapse/issues/4647" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4647/hovercard">#4647</a>)</li>
 	<li>Support .well-known delegation when issuing certificates through ACME. (<a href="https://github.com/matrix-org/synapse/issues/4652" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4652/hovercard">#4652</a>)</li>
 	<li>Allow registration and login to be handled by a worker instance. (<a href="https://github.com/matrix-org/synapse/issues/4666" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4666/hovercard">#4666</a>, <a href="https://github.com/matrix-org/synapse/issues/4670" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4670/hovercard">#4670</a>, <a href="https://github.com/matrix-org/synapse/issues/4682" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4682/hovercard">#4682</a>)</li>
 	<li>Reduce the overhead of creating outbound federation connections over TLS by caching the TLS client options. (<a href="https://github.com/matrix-org/synapse/issues/4674" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4674/hovercard">#4674</a>)</li>
 	<li>Add prometheus metrics for number of outgoing EDUs, by type. (<a href="https://github.com/matrix-org/synapse/issues/4695" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4695/hovercard">#4695</a>)</li>
 	<li>Return correct error code when inviting a remote user to a room whose homeserver does not support the room version. (<a href="https://github.com/matrix-org/synapse/issues/4721" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4721/hovercard">#4721</a>)</li>
 	<li>Prevent showing rooms to other servers that were set to not federate. (<a href="https://github.com/matrix-org/synapse/issues/4746" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4746/hovercard">#4746</a>)</li>
</ul>
<h3 id="bugfixes">Bugfixes</h3>
<ul>
 	<li>Fix possible exception when paginating. (<a href="https://github.com/matrix-org/synapse/issues/4263" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4263/hovercard">#4263</a>)</li>
 	<li>The dependency checker now correctly reports a version mismatch for optional
dependencies, instead of reporting the dependency missing. (<a href="https://github.com/matrix-org/synapse/issues/4450" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4450/hovercard">#4450</a>)</li>
 	<li>Set CORS headers on .well-known requests. (<a href="https://github.com/matrix-org/synapse/issues/4651" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4651/hovercard">#4651</a>)</li>
 	<li>Fix kicking guest users on guest access revocation in worker mode. (<a href="https://github.com/matrix-org/synapse/issues/4667" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4667/hovercard">#4667</a>)</li>
 	<li>Fix an issue in the database migration script where the
<code>e2e_room_keys.is_verified</code> column wasn't considered as
a boolean. (<a href="https://github.com/matrix-org/synapse/issues/4680" data-hovercard-type="issue" data-hovercard-url="/matrix-org/synapse/issues/4680/hovercard">#4680</a>)</li>
 	<li>Fix TaskStopped exceptions in logs when outbound requests time out. (<a href="https://github.com/matrix-org/synapse/issues/4690" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4690/hovercard">#4690</a>)</li>
 	<li>Fix ACME config for python 2. (<a href="https://github.com/matrix-org/synapse/issues/4717" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4717/hovercard">#4717</a>)</li>
 	<li>Fix paginating over federation persisting incorrect state. (<a href="https://github.com/matrix-org/synapse/issues/4718" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4718/hovercard">#4718</a>)</li>
</ul>
<h3 id="internal-changes">Internal Changes</h3>
<ul>
 	<li>Run <code>black</code> to reformat user directory code. (<a href="https://github.com/matrix-org/synapse/issues/4635" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4635/hovercard">#4635</a>)</li>
 	<li>Reduce number of exceptions we log. (<a href="https://github.com/matrix-org/synapse/issues/4643" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4643/hovercard">#4643</a>, <a href="https://github.com/matrix-org/synapse/issues/4668" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4668/hovercard">#4668</a>)</li>
 	<li>Introduce upsert batching functionality in the database layer. (<a href="https://github.com/matrix-org/synapse/issues/4644" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4644/hovercard">#4644</a>)</li>
 	<li>Fix various spelling mistakes. (<a href="https://github.com/matrix-org/synapse/issues/4657" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4657/hovercard">#4657</a>)</li>
 	<li>Cleanup request exception logging. (<a href="https://github.com/matrix-org/synapse/issues/4669" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4669/hovercard">#4669</a>, <a href="https://github.com/matrix-org/synapse/issues/4737" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4737/hovercard">#4737</a>, <a href="https://github.com/matrix-org/synapse/issues/4738" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4738/hovercard">#4738</a>)</li>
 	<li>Improve replication performance by reducing cache invalidation traffic. (<a href="https://github.com/matrix-org/synapse/issues/4671" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4671/hovercard">#4671</a>, <a href="https://github.com/matrix-org/synapse/issues/4715" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4715/hovercard">#4715</a>, <a href="https://github.com/matrix-org/synapse/issues/4748" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4748/hovercard">#4748</a>)</li>
 	<li>Test against Postgres 9.5 as well as 9.4. (<a href="https://github.com/matrix-org/synapse/issues/4676" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4676/hovercard">#4676</a>)</li>
 	<li>Run unit tests against python 3.7. (<a href="https://github.com/matrix-org/synapse/issues/4677" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4677/hovercard">#4677</a>)</li>
 	<li>Attempt to clarify installation instructions/config. (<a href="https://github.com/matrix-org/synapse/issues/4681" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4681/hovercard">#4681</a>)</li>
 	<li>Clean up gitignores. (<a href="https://github.com/matrix-org/synapse/issues/4688" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4688/hovercard">#4688</a>)</li>
 	<li>Minor tweaks to acme docs. (<a href="https://github.com/matrix-org/synapse/issues/4689" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4689/hovercard">#4689</a>)</li>
 	<li>Improve the logging in the pusher process. (<a href="https://github.com/matrix-org/synapse/issues/4691" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4691/hovercard">#4691</a>)</li>
 	<li>Better checks on newsfragments. (<a href="https://github.com/matrix-org/synapse/issues/4698" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4698/hovercard">#4698</a>, <a href="https://github.com/matrix-org/synapse/issues/4750" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4750/hovercard">#4750</a>)</li>
 	<li>Avoid some redundant work when processing read receipts. (<a href="https://github.com/matrix-org/synapse/issues/4706" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4706/hovercard">#4706</a>)</li>
 	<li>Run <code>push_receipts_to_remotes</code> as background job. (<a href="https://github.com/matrix-org/synapse/issues/4707" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4707/hovercard">#4707</a>)</li>
 	<li>Add prometheus metrics for number of badge update pushes. (<a href="https://github.com/matrix-org/synapse/issues/4709" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4709/hovercard">#4709</a>)</li>
 	<li>Reduce pusher logging on startup (<a href="https://github.com/matrix-org/synapse/issues/4716" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4716/hovercard">#4716</a>)</li>
 	<li>Don't log exceptions when failing to fetch remote server keys. (<a href="https://github.com/matrix-org/synapse/issues/4722" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4722/hovercard">#4722</a>)</li>
 	<li>Correctly proxy exception in frontend_proxy worker. (<a href="https://github.com/matrix-org/synapse/issues/4723" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4723/hovercard">#4723</a>)</li>
 	<li>Add database version to phonehome stats. (<a href="https://github.com/matrix-org/synapse/issues/4753" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4753/hovercard">#4753</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2019&#x2F;02&#x2F;14&#x2F;synapse-0-99-1-1-released&#x2F;" title="Synapse 0.99.1.1 Released!">Synapse 0.99.1.1 Released!</a></h2>
                <span>
                    14.02.2019 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hey, everyone, today is the day we release Synapse 0.99.1.1</p>
<p>This release contains improved ACME support to make it even easier to get going with TLS certs on your federation end points, plus some tweaks to make the room version upgrade path easier.</p>
<p>Just as a reminder that the 0.99.x series is precursor for our 1.0 release (which will land in early March, exact date to be confirmed) - it is really important that all server admins are aware that self signed certificates on the Server to Server API will no longer be accepted by &gt;= Synapse 1.0. If you have not already done so, now is the time to configure your certificate. For more info see our <a href="https://github.com/matrix-org/synapse/blob/master/docs/MSC1711_certificates_FAQ.md">FAQ</a> and if you get stuck come and join us in <a href="https://matrix.to/#/#synapse:matrix.org">#Synapse.</a></p>
<p>As ever, you can get the new update <a href="https://github.com/matrix-org/synapse/releases/tag/v0.99.1.1">here</a> or any of the sources mentioned at <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>. Note, Synapse is now available from PyPI, pick it up <a href="https://pypi.org/project/matrix-synapse/">here</a>. Also, check out our new <a href="/docs/guides/installing-synapse">Synapse installation guide page.</a></p>
<h2 id="synapse-0-99-1-1-changelog">Synapse 0.99.1.1 Changelog</h2>
<h3 id="bugfixes">Bugfixes</h3>
<ul>
 	<li>Fix "TypeError: '&gt;' not supported" when starting without an existing certificate.
Fix a bug where an existing certificate would be reprovisoned every day. (<a href="https://github.com/matrix-org/synapse/issues/4648" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4648/hovercard" aria-describedby="hovercard-aria-description">#4648</a>)</li>
</ul>
<h2 id="synapse-0-99-1-changelog">Synapse 0.99.1 Changelog</h2>
<h3 id="features">Features</h3>
<ul>
 	<li>Include m.room.encryption on invites by default (<a href="https://github.com/matrix-org/synapse/issues/3902" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/3902/hovercard" aria-describedby="hovercard-aria-description">#3902</a>)</li>
 	<li>Federation OpenID listener resource can now be activated even if federation is disabled (<a href="https://github.com/matrix-org/synapse/issues/4420" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4420/hovercard" aria-describedby="hovercard-aria-description">#4420</a>)</li>
 	<li>Synapse's ACME support will now correctly reprovision a certificate that approaches its expiry while Synapse is running. (<a href="https://github.com/matrix-org/synapse/issues/4522" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4522/hovercard" aria-describedby="hovercard-aria-description">#4522</a>)</li>
 	<li>Add ability to update backup versions (<a href="https://github.com/matrix-org/synapse/issues/4580" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4580/hovercard" aria-describedby="hovercard-aria-description">#4580</a>)</li>
 	<li>Allow the "unavailable" presence status for /sync.
This change makes Synapse compliant with r0.4.0 of the Client-Server specification. (<a href="https://github.com/matrix-org/synapse/issues/4592" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4592/hovercard" aria-describedby="hovercard-aria-description">#4592</a>)</li>
 	<li>There is no longer any need to specify <code>no_tls</code>: it is inferred from the absence of TLS listeners (<a href="https://github.com/matrix-org/synapse/issues/4613" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4613/hovercard" aria-describedby="hovercard-aria-description">#4613</a>, <a href="https://github.com/matrix-org/synapse/issues/4615" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4615/hovercard" aria-describedby="hovercard-aria-description">#4615</a>, <a href="https://github.com/matrix-org/synapse/issues/4617" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4617/hovercard" aria-describedby="hovercard-aria-description">#4617</a>, <a href="https://github.com/matrix-org/synapse/issues/4636" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4636/hovercard" aria-describedby="hovercard-aria-description">#4636</a>)</li>
 	<li>The default configuration no longer requires TLS certificates. (<a href="https://github.com/matrix-org/synapse/issues/4614" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4614/hovercard" aria-describedby="hovercard-aria-description">#4614</a>)</li>
</ul>
<h3 id="bugfixes-1">Bugfixes</h3>
<ul>
 	<li>Copy over room federation ability on room upgrade. (<a href="https://github.com/matrix-org/synapse/issues/4530" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4530/hovercard" aria-describedby="hovercard-aria-description">#4530</a>)</li>
 	<li>Fix noisy "twisted.internet.task.TaskStopped" errors in logs (<a href="https://github.com/matrix-org/synapse/issues/4546" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4546/hovercard" aria-describedby="hovercard-aria-description">#4546</a>)</li>
 	<li>Synapse is now tolerant of the <code>tls_fingerprints</code> option being None or not specified. (<a href="https://github.com/matrix-org/synapse/issues/4589" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4589/hovercard" aria-describedby="hovercard-aria-description">#4589</a>)</li>
 	<li>Fix 'no unique or exclusion constraint' error (<a href="https://github.com/matrix-org/synapse/issues/4591" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4591/hovercard" aria-describedby="hovercard-aria-description">#4591</a>)</li>
 	<li>Transfer Server ACLs on room upgrade. (<a href="https://github.com/matrix-org/synapse/issues/4608" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4608/hovercard" aria-describedby="hovercard-aria-description">#4608</a>)</li>
 	<li>Fix failure to start when not TLS certificate was given even if TLS was disabled. (<a href="https://github.com/matrix-org/synapse/issues/4618" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4618/hovercard" aria-describedby="hovercard-aria-description">#4618</a>)</li>
 	<li>Fix self-signed cert notice from generate-config. (<a href="https://github.com/matrix-org/synapse/issues/4625" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4625/hovercard" aria-describedby="hovercard-aria-description">#4625</a>)</li>
 	<li>Fix performance of <code>user_ips</code> table deduplication background update (<a href="https://github.com/matrix-org/synapse/issues/4626" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4626/hovercard" aria-describedby="hovercard-aria-description">#4626</a>, <a href="https://github.com/matrix-org/synapse/issues/4627" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4627/hovercard" aria-describedby="hovercard-aria-description">#4627</a>)</li>
</ul>
<h3 id="internal-changes">Internal Changes</h3>
<ul>
 	<li>Change the user directory state query to use a filtered call to the db instead of a generic one. (<a href="https://github.com/matrix-org/synapse/issues/4462" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4462/hovercard" aria-describedby="hovercard-aria-description">#4462</a>)</li>
 	<li>Reject federation transactions if they include more than 50 PDUs or 100 EDUs. (<a href="https://github.com/matrix-org/synapse/issues/4513" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4513/hovercard" aria-describedby="hovercard-aria-description">#4513</a>)</li>
 	<li>Reduce duplication of <code>synapse.app</code> code. (<a href="https://github.com/matrix-org/synapse/issues/4567" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4567/hovercard" aria-describedby="hovercard-aria-description">#4567</a>)</li>
 	<li>Fix docker upload job to push -py2 images. (<a href="https://github.com/matrix-org/synapse/issues/4576" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4576/hovercard" aria-describedby="hovercard-aria-description">#4576</a>)</li>
 	<li>Add port configuration information to ACME instructions. (<a href="https://github.com/matrix-org/synapse/issues/4578" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4578/hovercard" aria-describedby="hovercard-aria-description">#4578</a>)</li>
 	<li>Update MSC1711 FAQ to clarify .well-known usage (<a href="https://github.com/matrix-org/synapse/issues/4584" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4584/hovercard" aria-describedby="hovercard-aria-description">#4584</a>)</li>
 	<li>Clean up default listener configuration (<a href="https://github.com/matrix-org/synapse/issues/4586" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4586/hovercard" aria-describedby="hovercard-aria-description">#4586</a>)</li>
 	<li>Clarifications for reverse proxy docs (<a href="https://github.com/matrix-org/synapse/issues/4607" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4607/hovercard" aria-describedby="hovercard-aria-description">#4607</a>)</li>
 	<li>Move ClientTLSOptionsFactory init out of <code>refresh_certificates</code> (<a href="https://github.com/matrix-org/synapse/issues/4611" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4611/hovercard" aria-describedby="hovercard-aria-description">#4611</a>)</li>
 	<li>Fail cleanly if listener config lacks a 'port' (<a href="https://github.com/matrix-org/synapse/issues/4616" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4616/hovercard" aria-describedby="hovercard-aria-description">#4616</a>)</li>
 	<li>Remove redundant entries from docker config (<a href="https://github.com/matrix-org/synapse/issues/4619" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4619/hovercard" aria-describedby="hovercard-aria-description">#4619</a>)</li>
 	<li>README updates (<a href="https://github.com/matrix-org/synapse/issues/4621" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4621/hovercard" aria-describedby="hovercard-aria-description">#4621</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2019&#x2F;02&#x2F;05&#x2F;synapse-0-99-0&#x2F;" title="Synapse 0.99.0">Synapse 0.99.0</a></h2>
                <span>
                    05.02.2019 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hey hey, Synapse 0.99.0 is here!</p>
<p>You may have heard that we recently published the first stable release of the <a href="/docs/spec/server_server/r0.1.0.html">Server to Server Spec (r0.1)</a>. The spec makes some changes which are not compatible with the protocol of the past - particularly, <strong>self-signed certificates are no longer valid for homeservers. </strong>Synapse 1.0.0 will be compliant with r0.1 and the goal of Synapse 0.99.0 is to act as a stepping stone to Synapse 1.0. Synapse 0.99.0 supports the r0.1 release of the server to server specification, but is compatible with both the legacy Matrix federation behaviour (pre-r0.1) as well as post-r0.1 behaviour, in order to allow for a smooth upgrade across the federation.</p>
<p><strong>It is critical that all admins upgrade to 0.99.0 and configure a valid TLS certificate. </strong>Admins will have 1 month to do so, after which 1.0.0 will be released and those servers without a valid certificate will no longer be able to federate with &gt;= 1.0.0 servers.</p>
<p>First of all, please don't panic :) We have taken steps to make this process as simple as possible - specifically implementing ACME support to allow servers to automatically generate free Let's Encrypt certificates if you choose to. What's more, it is not necessary to add the certificate right away, you have at least a month to get set up.</p>
<p>For more details on exactly what you need to do (and also why this change is essential), we have provided an <strong>extensive <a href="https://github.com/matrix-org/synapse/blob/master/docs/MSC1711_certificates_FAQ.md">FAQ</a></strong> as well as the <a href="https://github.com/matrix-org/synapse/blob/release-v0.99.0/UPGRADE.rst">Upgrade notes for Synapse</a></p>
<p>As ever, you can get the new update <a href="https://github.com/matrix-org/synapse/releases/tag/v0.99.0">here</a> or any of the sources mentioned at <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>. Note, Synapse is now available from PyPI, pick it up <a href="https://pypi.org/project/matrix-synapse/">here</a>. Also, check out our new <a href="/docs/guides/installing-synapse">Synapse installation guide page.</a></p>
<p>This was a huge effort! Congratulations to all involved, especially those of you in the community who contributed to spec MSCs and tested our release candidates. Thank you for bearing with us as we move the whole public Matrix Federation onto r0.1 compliant servers.</p>
<p>Onwards!</p>
<h2 id="changelog">Changelog</h2>
<p>Synapse v0.99.x is a precursor to the upcoming Synapse v1.0 release. It contains foundational changes to room architecture and the federation security model necessary to support the upcoming r0 release of the Server to Server API.</p>
<h2 id="features">Features</h2>
<ul>
 	<li>Synapse's cipher string has been updated to require ECDH key exchange. Configuring and generating dh_params is no longer required, and they will be ignored. (<a href="https://github.com/matrix-org/synapse/issues/4229">#4229</a>)</li>
 	<li>Synapse can now automatically provision TLS certificates via ACME (the protocol used by CAs like Let's Encrypt). (<a href="https://github.com/matrix-org/synapse/issues/4384">#4384</a>, <a href="https://github.com/matrix-org/synapse/issues/4492">#4492</a>, <a href="https://github.com/matrix-org/synapse/issues/4525">#4525</a>, <a href="https://github.com/matrix-org/synapse/issues/4572">#4572</a>, <a href="https://github.com/matrix-org/synapse/issues/4564">#4564</a>, <a href="https://github.com/matrix-org/synapse/issues/4566">#4566</a>, <a href="https://github.com/matrix-org/synapse/issues/4547">#4547</a>, <a href="https://github.com/matrix-org/synapse/issues/4557">#4557</a>)</li>
 	<li>Implement MSC1708 (.well-known routing for server-server federation) (<a href="https://github.com/matrix-org/synapse/issues/4408">#4408</a>, <a href="https://github.com/matrix-org/synapse/issues/4409">#4409</a>, <a href="https://github.com/matrix-org/synapse/issues/4426">#4426</a>, <a href="https://github.com/matrix-org/synapse/issues/4427">#4427</a>, <a href="https://github.com/matrix-org/synapse/issues/4428">#4428</a>, <a href="https://github.com/matrix-org/synapse/issues/4464">#4464</a>, <a href="https://github.com/matrix-org/synapse/issues/4468">#4468</a>, <a href="https://github.com/matrix-org/synapse/issues/4487">#4487</a>, <a href="https://github.com/matrix-org/synapse/issues/4488">#4488</a>, <a href="https://github.com/matrix-org/synapse/issues/4489">#4489</a>, <a href="https://github.com/matrix-org/synapse/issues/4497">#4497</a>, <a href="https://github.com/matrix-org/synapse/issues/4511">#4511</a>, <a href="https://github.com/matrix-org/synapse/issues/4516">#4516</a>, <a href="https://github.com/matrix-org/synapse/issues/4520">#4520</a>, <a href="https://github.com/matrix-org/synapse/issues/4521">#4521</a>, <a href="https://github.com/matrix-org/synapse/issues/4539">#4539</a>, <a href="https://github.com/matrix-org/synapse/issues/4542">#4542</a>, <a href="https://github.com/matrix-org/synapse/issues/4544">#4544</a>)</li>
 	<li>Search now includes results from predecessor rooms after a room upgrade. (<a href="https://github.com/matrix-org/synapse/issues/4415">#4415</a>)</li>
 	<li>Config option to disable requesting MSISDN on registration. (<a href="https://github.com/matrix-org/synapse/issues/4423">#4423</a>)</li>
 	<li>Add a metric for tracking event stream position of the user directory. (<a href="https://github.com/matrix-org/synapse/issues/4445">#4445</a>)</li>
 	<li>Support exposing server capabilities in CS API (MSC1753, MSC1804) (<a href="https://github.com/matrix-org/synapse/issues/4472">#4472</a>, <a href="https://github.com/matrix-org/synapse/commit/81b7e7eed323f55d6550e7a270a9dc2c4c7b0fe0">81b7e7eed</a>))</li>
 	<li>Add support for room version 3 (<a href="https://github.com/matrix-org/synapse/issues/4483">#4483</a>, <a href="https://github.com/matrix-org/synapse/issues/4499">#4499</a>, <a href="https://github.com/matrix-org/synapse/issues/4515">#4515</a>, <a href="https://github.com/matrix-org/synapse/issues/4523">#4523</a>, <a href="https://github.com/matrix-org/synapse/issues/4535">#4535</a>)</li>
 	<li>Synapse will now reload TLS certificates from disk upon SIGHUP. (<a href="https://github.com/matrix-org/synapse/issues/4495">#4495</a>, <a href="https://github.com/matrix-org/synapse/issues/4524">#4524</a>)</li>
 	<li>The matrixdotorg/synapse Docker images now use Python 3 by default. (<a href="https://github.com/matrix-org/synapse/issues/4558">#4558</a>)</li>
</ul>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
 	<li>Prevent users with access tokens predating the introduction of device IDs from creating spurious entries in the user_ips table. (<a href="https://github.com/matrix-org/synapse/issues/4369">#4369</a>)</li>
 	<li>Fix typo in ALL_USER_TYPES definition to ensure type is a tuple (<a href="https://github.com/matrix-org/synapse/issues/4392">#4392</a>)</li>
 	<li>Fix high CPU usage due to remote devicelist updates (<a href="https://github.com/matrix-org/synapse/issues/4397">#4397</a>)</li>
 	<li>Fix potential bug where creating or joining a room could fail (<a href="https://github.com/matrix-org/synapse/issues/4404">#4404</a>)</li>
 	<li>Fix bug when rejecting remote invites (<a href="https://github.com/matrix-org/synapse/issues/4405">#4405</a>, <a href="https://github.com/matrix-org/synapse/issues/4527">#4527</a>)</li>
 	<li>Fix incorrect logcontexts after a Deferred was cancelled (<a href="https://github.com/matrix-org/synapse/issues/4407">#4407</a>)</li>
 	<li>Ensure encrypted room state is persisted across room upgrades. (<a href="https://github.com/matrix-org/synapse/issues/4411">#4411</a>)</li>
 	<li>Copy over whether a room is a direct message and any associated room tags on room upgrade. (<a href="https://github.com/matrix-org/synapse/issues/4412">#4412</a>)</li>
 	<li>Fix None guard in calling config.server.is_threepid_reserved (<a href="https://github.com/matrix-org/synapse/issues/4435">#4435</a>)</li>
 	<li>Don't send IP addresses as SNI (<a href="https://github.com/matrix-org/synapse/issues/4452">#4452</a>)</li>
 	<li>Fix UnboundLocalError in post_urlencoded_get_json (<a href="https://github.com/matrix-org/synapse/issues/4460">#4460</a>)</li>
 	<li>Add a timeout to filtered room directory queries. (<a href="https://github.com/matrix-org/synapse/issues/4461">#4461</a>)</li>
 	<li>Workaround for login error when using both LDAP and internal authentication. (<a href="https://github.com/matrix-org/synapse/issues/4486">#4486</a>)</li>
 	<li>Fix a bug where setting a relative consent directory path would cause a crash. (<a href="https://github.com/matrix-org/synapse/issues/4512">#4512</a>)</li>
</ul>
<h2 id="deprecations-and-removals">Deprecations and Removals</h2>
<ul>
 	<li>Synapse no longer generates self-signed TLS certificates when generating a configuration file. (<a href="https://github.com/matrix-org/synapse/issues/4509">#4509</a>)</li>
</ul>
<h2 id="improved-documentation">Improved Documentation</h2>
<ul>
 	<li>Update debian installation instructions (<a href="https://github.com/matrix-org/synapse/issues/4526">#4526</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
 	<li>Synapse will now take advantage of native UPSERT functionality in PostgreSQL 9.5+ and SQLite 3.24+. (<a href="https://github.com/matrix-org/synapse/issues/4306">#4306</a>, <a href="https://github.com/matrix-org/synapse/issues/4459">#4459</a>, <a href="https://github.com/matrix-org/synapse/issues/4466">#4466</a>, <a href="https://github.com/matrix-org/synapse/issues/4471">#4471</a>, <a href="https://github.com/matrix-org/synapse/issues/4477">#4477</a>, <a href="https://github.com/matrix-org/synapse/issues/4505">#4505</a>)</li>
 	<li>Update README to use the new virtualenv everywhere (<a href="https://github.com/matrix-org/synapse/issues/4342">#4342</a>)</li>
 	<li>Add better logging for unexpected errors while sending transactions (<a href="https://github.com/matrix-org/synapse/issues/4368">#4368</a>)</li>
 	<li>Apply a unique index to the user_ips table, preventing duplicates. (<a href="https://github.com/matrix-org/synapse/issues/4370">#4370</a>, <a href="https://github.com/matrix-org/synapse/issues/4432">#4432</a>, <a href="https://github.com/matrix-org/synapse/issues/4434">#4434</a>)</li>
 	<li>Silence travis-ci build warnings by removing non-functional python3.6 (<a href="https://github.com/matrix-org/synapse/issues/4377">#4377</a>)</li>
 	<li>Fix a comment in the generated config file (<a href="https://github.com/matrix-org/synapse/issues/4387">#4387</a>)</li>
 	<li>Add ground work for implementing future federation API versions (<a href="https://github.com/matrix-org/synapse/issues/4390">#4390</a>)</li>
 	<li>Update dependencies on msgpack and pymacaroons to use the up-to-date packages. (<a href="https://github.com/matrix-org/synapse/issues/4399">#4399</a>)</li>
 	<li>Tweak codecov settings to make them less loud. (<a href="https://github.com/matrix-org/synapse/issues/4400">#4400</a>)</li>
 	<li>Implement server support for MSC1794 - Federation v2 Invite API (<a href="https://github.com/matrix-org/synapse/issues/4402">#4402</a>)</li>
 	<li>debian package: symlink to explicit python version (<a href="https://github.com/matrix-org/synapse/issues/4433">#4433</a>)</li>
 	<li>Add infrastructure to support different event formats (<a href="https://github.com/matrix-org/synapse/issues/4437">#4437</a>, <a href="https://github.com/matrix-org/synapse/issues/4447">#4447</a>, <a href="https://github.com/matrix-org/synapse/issues/4448">#4448</a>, <a href="https://github.com/matrix-org/synapse/issues/4470">#4470</a>, <a href="https://github.com/matrix-org/synapse/issues/4481">#4481</a>, <a href="https://github.com/matrix-org/synapse/issues/4482">#4482</a>, <a href="https://github.com/matrix-org/synapse/issues/4493">#4493</a>, <a href="https://github.com/matrix-org/synapse/issues/4494">#4494</a>, <a href="https://github.com/matrix-org/synapse/issues/4496">#4496</a>, <a href="https://github.com/matrix-org/synapse/issues/4510">#4510</a>, <a href="https://github.com/matrix-org/synapse/issues/4514">#4514</a>)</li>
 	<li>Generate the debian config during build (<a href="https://github.com/matrix-org/synapse/issues/4444">#4444</a>)</li>
 	<li>Clarify documentation for the <code>public_baseurl</code> config param (<a href="https://github.com/matrix-org/synapse/issues/4458">#4458</a>, <a href="https://github.com/matrix-org/synapse/issues/4498">#4498</a>)</li>
 	<li>Fix quoting for allowed_local_3pids example config (<a href="https://github.com/matrix-org/synapse/issues/4476">#4476</a>)</li>
 	<li>Remove deprecated --process-dependency-links option from UPGRADE.rst (<a href="https://github.com/matrix-org/synapse/issues/4485">#4485</a>)</li>
 	<li>Make it possible to set the log level for tests via an environment variable (<a href="https://github.com/matrix-org/synapse/issues/4506">#4506</a>)</li>
 	<li>Reduce the log level of linearizer lock acquirement to DEBUG. (<a href="https://github.com/matrix-org/synapse/issues/4507">#4507</a>)</li>
 	<li>Fix code to comply with linting in PyFlakes 3.7.1. (<a href="https://github.com/matrix-org/synapse/issues/4519">#4519</a>)</li>
 	<li>Add some debug for membership syncing issues (<a href="https://github.com/matrix-org/synapse/issues/4538">#4538</a>)</li>
 	<li>Docker: only copy what we need to the build image (<a href="https://github.com/matrix-org/synapse/issues/4562">#4562</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2019&#x2F;01&#x2F;10&#x2F;critical-security-update-synapse-0-34-0-1-synapse-0-34-1-1&#x2F;" title="Critical Security Update: Synapse 0.34.0.1&#x2F;Synapse 0.34.1.1">Critical Security Update: Synapse 0.34.0.1&#x2F;Synapse 0.34.1.1</a></h2>
                <span>
                    10.01.2019 00:00
                    —
                    <a href="/category/security">
                        Security
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>After releasing Synapse v0.34.1, we have become aware of a security vulnerability affecting all previous versions (<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5885">CVE-2019-5885</a>). v0.34.1 closed the vulnerability but, in some cases, caused users to be logged out of their clients, so we do not recommend v0.34.1 for production use.</p>
<p><b>Today we release two mitigating versions v0.34.0.1 and v0.34.1.1</b>. Both versions close the vulnerability and will not cause users to be logged out. <b>All installations should be upgraded to one or other immediately.</b></p>
<ul>
 	<li style="font-weight: 400;">Admins who would otherwise upgrade to v0.34.1 (or those that have already done so) should upgrade to v0.34.1.1. 
</li>
 	<li style="font-weight: 400;">Admins on v0.34.0, who do not wish to bring in new non-security related behaviour, should upgrade to v0.34.0.1.
</li>
</ul>
<p>You can get the new updates for <a href="https://github.com/matrix-org/synapse/releases/tag/v0.34.0.1">v0.34.0.1</a> and <a href="https://github.com/matrix-org/synapse/releases/tag/v0.34.1.1">v0.34.1.1</a> here or any of the sources mentioned at <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>. Note, Synapse is now available from PyPI, pick it up <a href="https://pypi.org/project/matrix-synapse/">here</a>. See also our <a href="/docs/guides/installing-synapse">Synapse installation guide page.</a></p>
<p>We will publish more details of the vulnerability once admins have had a chance to upgrade. To our knowledge the vulnerability has not been exploited in the wild.</p>
<p>Many thanks for your patience, we are moving ever closer to Synapse reaching v1.0, and fixes like this one edge us ever closer.</p>
<p>Thanks also to the package maintainers who have coordinated with us to ensure distro packages are available for a speedy upgrade!</p>
<ul>
 	<li><a href="https://github.com/matrix-org/synapse/releases/tag/v0.34.0.1">Synapse v0.34.0.1 Changelog</a></li>
 	<li><a href="https://github.com/matrix-org/synapse/releases/tag/v0.34.1.1">Synapse v0.34.1.1 Changelog</a></li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2018&#x2F;12&#x2F;20&#x2F;synapse-0-34-0-released&#x2F;" title="Synapse 0.34.0 released!">Synapse 0.34.0 released!</a></h2>
                <span>
                    20.12.2018 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Folks this is a big day for us at Matrix Towers, because today we release 0.34.0.</p>
<p>The big news for 0.34.0 is that we now <strong>recommend Python 3 for production use</strong> and have been running matrix.org under Python 3 for the past month.</p>
<p>Performance improvements have been marked, in some contexts we have seen 50% reductions in RAM and CPU usage. Here are some illustrative graphs to get you going but look out for a dedicated post delving into much more detail on the port. You can also see a Matrix Live interview with the project lead Amber (hawkowl) <a href="https://www.youtube.com/watch?v=Ad3oqEo5leM">here</a>.</p>
<p><a href="/blog/wp-content/uploads/2018/12/image2.png"><img class="alignnone wp-image-3822 size-large" src="/blog/wp-content/uploads/2018/12/image2-1024x296.png" alt="" width="1024" height="296" /></a></p>
<p>Matrix.org federation reader workers, the big drops signify roll over to python 3</p>
<p><a href="/blog/wp-content/uploads/2018/12/image1.png"><img class="alignnone size-large wp-image-3824" src="/blog/wp-content/uploads/2018/12/image1-1024x237.png" alt="" width="1024" height="237" /></a></p>
<p>Synapse master on matrix.org, again the drop in RAM signifies the roll over to python 3</p>
<p>Many thanks to Amber for leading the effort, Rich and Erik for providing support as well as Notafile and Krombel from the community for pushing this effort right from the early days of the project.</p>
<p>If that wasn't enough, 0.34.0 also all the usual bug fixes and perf improvements. In particular the media repository now no longer fails to decode UTF-8 filenames when downloading remote media and auto joining rooms now work on servers with consent requirements enabled.</p>
<p>As ever, you can get the new update <a href="https://github.com/matrix-org/synapse/releases/tag/v0.34.0">here</a> or any of the sources mentioned at <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>. Note, Synapse is now available from PyPI, pick it up <a href="https://pypi.org/project/matrix-synapse/">here</a>. Also, check out our new <a href="/docs/guides/installing-synapse">Synapse installation guide page.</a></p>
<p>In particular, if you want to run Synapse 0.34.0 on Python 3 take a look at the <a href="https://github.com/matrix-org/synapse/blob/release-v0.34.0/UPGRADE.rst#upgrading-to-v0340">upgrade notes</a>.</p>
<h3 id="synapse-0-34-0-changelog">Synapse 0.34.0 changelog</h3>
<p>Synapse 0.34.0 is the first release to fully support Python 3. Synapse will now run on Python versions 3.5 or 3.6 (as well as 2.7). Support for Python 3.7 remains experimental.</p>
<p>We recommend upgrading to Python 3, but make sure to read the <a href="https://github.com/matrix-org/synapse/blob/release-v0.34.0/UPGRADE.rst#upgrading-to-v0340">upgrade notes</a> when doing so.</p>
<h4 id="features">Features</h4>
<ul>
 	<li>Add 'sandbox' to CSP for media reprository (<a href="https://github.com/matrix-org/synapse/issues/4284" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4284/hovercard" aria-describedby="hovercard-aria-description">#4284</a>)</li>
 	<li>Make the new landing page prettier. (<a href="https://github.com/matrix-org/synapse/issues/4294" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4294/hovercard" aria-describedby="hovercard-aria-description">#4294</a>)</li>
 	<li>Fix deleting E2E room keys when using old SQLite versions. (<a href="https://github.com/matrix-org/synapse/issues/4295" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4295/hovercard" aria-describedby="hovercard-aria-description">#4295</a>)</li>
 	<li>Add a welcome page for the client API port. Credit to <a class="user-mention" href="https://github.com/krombel" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=11167142" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" aria-describedby="hovercard-aria-description">@krombel</a>! (<a href="https://github.com/matrix-org/synapse/issues/4289" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4289/hovercard" aria-describedby="hovercard-aria-description">#4289</a>)</li>
 	<li>Remove Matrix console from the default distribution (<a href="https://github.com/matrix-org/synapse/issues/4290" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4290/hovercard" aria-describedby="hovercard-aria-description">#4290</a>)</li>
 	<li>Add option to track MAU stats (but not limit people) (<a href="https://github.com/matrix-org/synapse/issues/3830" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/3830/hovercard" aria-describedby="hovercard-aria-description">#3830</a>)</li>
 	<li>Add an option to enable recording IPs for appservice users (<a href="https://github.com/matrix-org/synapse/issues/3831" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/3831/hovercard" aria-describedby="hovercard-aria-description">#3831</a>)</li>
 	<li>Rename login type <code>m.login.cas</code> to <code>m.login.sso</code> (<a href="https://github.com/matrix-org/synapse/issues/4220" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4220/hovercard" aria-describedby="hovercard-aria-description">#4220</a>)</li>
 	<li>Add an option to disable search for homeservers that may not be interested in it. (<a href="https://github.com/matrix-org/synapse/issues/4230" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4230/hovercard" aria-describedby="hovercard-aria-description">#4230</a>)</li>
</ul>
<h4 id="bugfixes">Bugfixes</h4>
<ul>
 	<li>Pushrules can now again be made with non-ASCII rule IDs. (<a href="https://github.com/matrix-org/synapse/issues/4165" data-hovercard-type="issue" data-hovercard-url="/matrix-org/synapse/issues/4165/hovercard" aria-describedby="hovercard-aria-description">#4165</a>)</li>
 	<li>The media repository now no longer fails to decode UTF-8 filenames when downloading remote media. (<a href="https://github.com/matrix-org/synapse/issues/4176" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4176/hovercard" aria-describedby="hovercard-aria-description">#4176</a>)</li>
 	<li>URL previews now correctly decode non-UTF-8 text if the header contains a <code>&lt;meta http-equiv="Content-Type"</code> header. (<a href="https://github.com/matrix-org/synapse/issues/4183" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4183/hovercard" aria-describedby="hovercard-aria-description">#4183</a>)</li>
 	<li>Fix an issue where public consent URLs had two slashes. (<a href="https://github.com/matrix-org/synapse/issues/4192" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4192/hovercard" aria-describedby="hovercard-aria-description">#4192</a>)</li>
 	<li>Fallback auth now accepts the session parameter on Python 3. (<a href="https://github.com/matrix-org/synapse/issues/4197" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4197/hovercard" aria-describedby="hovercard-aria-description">#4197</a>)</li>
 	<li>Remove riot.im from the list of trusted Identity Servers in the default configuration (<a href="https://github.com/matrix-org/synapse/issues/4207" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4207/hovercard" aria-describedby="hovercard-aria-description">#4207</a>)</li>
 	<li>fix start up failure when mau_limit_reserved_threepids set and db is postgres (<a href="https://github.com/matrix-org/synapse/issues/4211" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4211/hovercard" aria-describedby="hovercard-aria-description">#4211</a>)</li>
 	<li>Fix auto join failures for servers that require user consent (<a href="https://github.com/matrix-org/synapse/issues/4223" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4223/hovercard" aria-describedby="hovercard-aria-description">#4223</a>)</li>
 	<li>Fix exception caused by non-ascii event IDs (<a href="https://github.com/matrix-org/synapse/issues/4241" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4241/hovercard" aria-describedby="hovercard-aria-description">#4241</a>)</li>
 	<li>Pushers can now be unsubscribed from on Python 3. (<a href="https://github.com/matrix-org/synapse/issues/4250" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4250/hovercard" aria-describedby="hovercard-aria-description">#4250</a>)</li>
 	<li>Fix UnicodeDecodeError when postgres is configured to give non-English errors (<a href="https://github.com/matrix-org/synapse/issues/4253" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4253/hovercard" aria-describedby="hovercard-aria-description">#4253</a>)</li>
</ul>
<h4 id="internal-changes">Internal Changes</h4>
<ul>
 	<li>Debian packages utilising a virtualenv with bundled dependencies can now be built. (<a href="https://github.com/matrix-org/synapse/issues/4212" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4212/hovercard" aria-describedby="hovercard-aria-description">#4212</a>)</li>
 	<li>Disable pager when running git-show in CI (<a href="https://github.com/matrix-org/synapse/issues/4291" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4291/hovercard" aria-describedby="hovercard-aria-description">#4291</a>)</li>
 	<li>A coveragerc file has been added. (<a href="https://github.com/matrix-org/synapse/issues/4180" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4180/hovercard" aria-describedby="hovercard-aria-description">#4180</a>)</li>
 	<li>Add a GitHub pull request template and add multiple issue templates (<a href="https://github.com/matrix-org/synapse/issues/4182" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4182/hovercard" aria-describedby="hovercard-aria-description">#4182</a>)</li>
 	<li>Update README to reflect the fact that <a href="https://github.com/matrix-org/synapse/issues/1491" data-hovercard-type="issue" data-hovercard-url="/matrix-org/synapse/issues/1491/hovercard" aria-describedby="hovercard-aria-description">#1491</a> is fixed (<a href="https://github.com/matrix-org/synapse/issues/4188" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4188/hovercard" aria-describedby="hovercard-aria-description">#4188</a>)</li>
 	<li>Run the AS senders as background processes to fix warnings (<a href="https://github.com/matrix-org/synapse/issues/4189" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4189/hovercard" aria-describedby="hovercard-aria-description">#4189</a>)</li>
 	<li>Add some diagnostics to the tests to detect logcontext problems (<a href="https://github.com/matrix-org/synapse/issues/4190" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4190/hovercard" aria-describedby="hovercard-aria-description">#4190</a>)</li>
 	<li>Add missing <code>jpeg</code> package prerequisite for OpenBSD in README. (<a href="https://github.com/matrix-org/synapse/issues/4193" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4193/hovercard" aria-describedby="hovercard-aria-description">#4193</a>)</li>
 	<li>Add a note saying you need to manually reclaim disk space after using the Purge History API (<a href="https://github.com/matrix-org/synapse/issues/4200" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4200/hovercard" aria-describedby="hovercard-aria-description">#4200</a>)</li>
 	<li>More logcontext checking in unittests (<a href="https://github.com/matrix-org/synapse/issues/4205" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4205/hovercard" aria-describedby="hovercard-aria-description">#4205</a>)</li>
 	<li>Ignore <code>__pycache__</code> directories in the database schema folder (<a href="https://github.com/matrix-org/synapse/issues/4214" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4214/hovercard" aria-describedby="hovercard-aria-description">#4214</a>)</li>
 	<li>Add note to UPGRADE.rst about removing riot.im from list of trusted identity servers (<a href="https://github.com/matrix-org/synapse/issues/4224" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4224/hovercard" aria-describedby="hovercard-aria-description">#4224</a>)</li>
 	<li>Added automated coverage reporting to CI. (<a href="https://github.com/matrix-org/synapse/issues/4225" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4225/hovercard" aria-describedby="hovercard-aria-description">#4225</a>)</li>
 	<li>Garbage-collect after each unit test to fix logcontext leaks (<a href="https://github.com/matrix-org/synapse/issues/4227" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4227/hovercard" aria-describedby="hovercard-aria-description">#4227</a>)</li>
 	<li>add more detail to logging regarding "More than one row matched" error (<a href="https://github.com/matrix-org/synapse/issues/4234" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4234/hovercard" aria-describedby="hovercard-aria-description">#4234</a>)</li>
 	<li>Drop sent_transactions table (<a href="https://github.com/matrix-org/synapse/issues/4244" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4244/hovercard" aria-describedby="hovercard-aria-description">#4244</a>)</li>
 	<li>Add a basic .editorconfig (<a href="https://github.com/matrix-org/synapse/issues/4257" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4257/hovercard" aria-describedby="hovercard-aria-description">#4257</a>)</li>
 	<li>Update README.rst and UPGRADE.rst for Python 3. (<a href="https://github.com/matrix-org/synapse/issues/4260" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4260/hovercard" aria-describedby="hovercard-aria-description">#4260</a>)</li>
 	<li>Remove obsolete <code>verbose</code> and <code>log_file</code> settings from <code>homeserver.yaml</code> for Docker image. (<a href="https://github.com/matrix-org/synapse/issues/4261" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4261/hovercard" aria-describedby="hovercard-aria-description">#4261</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2018&#x2F;11&#x2F;20&#x2F;synapse-0-33-9-is-here&#x2F;" title="Synapse 0.33.9 is here!">Synapse 0.33.9 is here!</a></h2>
                <span>
                    20.11.2018 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Well here you are then, the 9th episode in the Synapse 0.33.x series.</p>
<p>Features wise, 0.33.9 contains a change to the way that GDPR consent works under the hood. It is now plumbed in to the login flow (rather than following immediately afterwards) such that it does not inadvertently break on-boarding. This is part of a broader set of changes that span Synapse and Riot to improve initial first impressions of using matrix.</p>
<p>Separately we now have support for room version upgrades which is pre-requisite for rolling out the new state resolution algorithm, come and join us in #teststateresv2:jki.re if you would like to help us test.</p>
<p>Finally we've spent a bunch of time further improving perf especially in and around reducing device ids federation traffic.</p>
<p>I know I say it every time, but full python 3 support is really really close now, matrix.org is now running entirely on py3 and seeing some amazing perf improvements - the remaining blocker is getting py3 deb packages ready and then we'll ship an official python 3 release. There will also be a blog post to explain what we've been up to and what to expect perf wise.</p>
<p>As ever, you can get the new update <a href="https://github.com/matrix-org/synapse/releases/tag/v0.33.9">here</a> or any of the sources mentioned at <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>. Note, Synapse is now available from PyPI, pick it up <a href="https://pypi.org/project/matrix-synapse/">here</a>. Also, check out our new <a href="/docs/guides/installing-synapse">Synapse installation guide page.</a></p>
<h3 id="synapse-0-33-9-changelog">Synapse 0.33.9 changelog</h3>
<h4 id="features">Features</h4>
<ul>
 	<li>Include flags to optionally add <code>m.login.terms</code> to the registration flow when consent tracking is enabled. (<a href="https://github.com/matrix-org/synapse/issues/4004" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4004/hovercard" aria-describedby="hovercard-aria-description">#4004</a>, <a href="https://github.com/matrix-org/synapse/issues/4133" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4133/hovercard" aria-describedby="hovercard-aria-description">#4133</a>, <a href="https://github.com/matrix-org/synapse/issues/4142" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4142/hovercard" aria-describedby="hovercard-aria-description">#4142</a>, <a href="https://github.com/matrix-org/synapse/issues/4184" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4184/hovercard" aria-describedby="hovercard-aria-description">#4184</a>)</li>
 	<li>Support for replacing rooms with new ones (<a href="https://github.com/matrix-org/synapse/issues/4091" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4091/hovercard" aria-describedby="hovercard-aria-description">#4091</a>, <a href="https://github.com/matrix-org/synapse/issues/4099" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4099/hovercard" aria-describedby="hovercard-aria-description">#4099</a>, <a href="https://github.com/matrix-org/synapse/issues/4100" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4100/hovercard" aria-describedby="hovercard-aria-description">#4100</a>, <a href="https://github.com/matrix-org/synapse/issues/4101" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4101/hovercard" aria-describedby="hovercard-aria-description">#4101</a>)</li>
</ul>
<h4 id="bugfixes">Bugfixes</h4>
<ul>
 	<li>Fix exceptions when using the email mailer on Python 3. (<a href="https://github.com/matrix-org/synapse/issues/4095" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4095/hovercard" aria-describedby="hovercard-aria-description">#4095</a>)</li>
 	<li>Fix e2e key backup with more than 9 backup versions (<a href="https://github.com/matrix-org/synapse/issues/4113" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4113/hovercard" aria-describedby="hovercard-aria-description">#4113</a>)</li>
 	<li>Searches that request profile info now no longer fail with a 500. (<a href="https://github.com/matrix-org/synapse/issues/4122" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4122/hovercard" aria-describedby="hovercard-aria-description">#4122</a>)</li>
 	<li>fix return code of empty key backups (<a href="https://github.com/matrix-org/synapse/issues/4123" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4123/hovercard" aria-describedby="hovercard-aria-description">#4123</a>)</li>
 	<li>If the typing stream ID goes backwards (as on a worker when the master restarts), the worker's typing handler will no longer erroneously report rooms containing new typing events. (<a href="https://github.com/matrix-org/synapse/issues/4127" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4127/hovercard" aria-describedby="hovercard-aria-description">#4127</a>)</li>
 	<li>Fix table lock of device_lists_remote_cache which could freeze the application (<a href="https://github.com/matrix-org/synapse/issues/4132" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4132/hovercard" aria-describedby="hovercard-aria-description">#4132</a>)</li>
 	<li>Fix exception when using state res v2 algorithm (<a href="https://github.com/matrix-org/synapse/issues/4135" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4135/hovercard" aria-describedby="hovercard-aria-description">#4135</a>)</li>
 	<li>Generating the user consent URI no longer fails on Python 3. (<a href="https://github.com/matrix-org/synapse/issues/4140" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4140/hovercard" aria-describedby="hovercard-aria-description">#4140</a>, <a href="https://github.com/matrix-org/synapse/issues/4163" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4163/hovercard" aria-describedby="hovercard-aria-description">#4163</a>)</li>
 	<li>Loading URL previews from the DB cache on Postgres will no longer cause Unicode type errors when responding to the request, and URL previews will no longer fail if the remote server returns a Content-Type header with the chartype in quotes. (<a href="https://github.com/matrix-org/synapse/issues/4157" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4157/hovercard" aria-describedby="hovercard-aria-description">#4157</a>)</li>
 	<li>The hash_password script now works on Python 3. (<a href="https://github.com/matrix-org/synapse/issues/4161" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4161/hovercard" aria-describedby="hovercard-aria-description">#4161</a>)</li>
 	<li>Fix noop checks when updating device keys, reducing spurious device list update notifications. (<a href="https://github.com/matrix-org/synapse/issues/4164" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4164/hovercard" aria-describedby="hovercard-aria-description">#4164</a>)</li>
</ul>
<h4 id="deprecations-and-removals">Deprecations and Removals</h4>
<ul>
 	<li>The disused and un-specced identicon generator has been removed. (<a href="https://github.com/matrix-org/synapse/issues/4106" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4106/hovercard" aria-describedby="hovercard-aria-description">#4106</a>)</li>
 	<li>The obsolete and non-functional /pull federation endpoint has been removed. (<a href="https://github.com/matrix-org/synapse/issues/4118" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4118/hovercard" aria-describedby="hovercard-aria-description">#4118</a>)</li>
 	<li>The deprecated v1 key exchange endpoints have been removed. (<a href="https://github.com/matrix-org/synapse/issues/4119" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4119/hovercard" aria-describedby="hovercard-aria-description">#4119</a>)</li>
 	<li>Synapse will no longer fetch keys using the fallback deprecated v1 key exchange method and will now always use v2. (<a href="https://github.com/matrix-org/synapse/issues/4120" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4120/hovercard" aria-describedby="hovercard-aria-description">#4120</a>)</li>
</ul>
<h4 id="internal-changes">Internal Changes</h4>
<ul>
 	<li>Fix build of Docker image with docker-compose (<a href="https://github.com/matrix-org/synapse/issues/3778" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/3778/hovercard" aria-describedby="hovercard-aria-description">#3778</a>)</li>
 	<li>Delete unreferenced state groups during history purge (<a href="https://github.com/matrix-org/synapse/issues/4006" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4006/hovercard" aria-describedby="hovercard-aria-description">#4006</a>)</li>
 	<li>The "Received rdata" log messages on workers is now logged at DEBUG, not INFO. (<a href="https://github.com/matrix-org/synapse/issues/4108" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4108/hovercard" aria-describedby="hovercard-aria-description">#4108</a>)</li>
 	<li>Reduce replication traffic for device lists (<a href="https://github.com/matrix-org/synapse/issues/4109" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4109/hovercard" aria-describedby="hovercard-aria-description">#4109</a>)</li>
 	<li>Fix <code>synapse_replication_tcp_protocol_*_commands</code> metric label to be full command name, rather than just the first character (<a href="https://github.com/matrix-org/synapse/issues/4110" data-hovercard-type="issue" data-hovercard-url="/matrix-org/synapse/issues/4110/hovercard" aria-describedby="hovercard-aria-description">#4110</a>)</li>
 	<li>Log some bits about room creation (<a href="https://github.com/matrix-org/synapse/issues/4121" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4121/hovercard" aria-describedby="hovercard-aria-description">#4121</a>)</li>
 	<li>Fix <code>tox</code> failure on old systems (<a href="https://github.com/matrix-org/synapse/issues/4124" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4124/hovercard" aria-describedby="hovercard-aria-description">#4124</a>)</li>
 	<li>Add STATE_V2_TEST room version (<a href="https://github.com/matrix-org/synapse/issues/4128" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4128/hovercard" aria-describedby="hovercard-aria-description">#4128</a>)</li>
 	<li>Clean up event accesses and tests (<a href="https://github.com/matrix-org/synapse/issues/4137" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4137/hovercard" aria-describedby="hovercard-aria-description">#4137</a>)</li>
 	<li>The default logging config will now set an explicit log file encoding of UTF-8. (<a href="https://github.com/matrix-org/synapse/issues/4138" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4138/hovercard" aria-describedby="hovercard-aria-description">#4138</a>)</li>
 	<li>Add helpers functions for getting prev and auth events of an event (<a href="https://github.com/matrix-org/synapse/issues/4139" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4139/hovercard" aria-describedby="hovercard-aria-description">#4139</a>)</li>
 	<li>Add some tests for the HTTP pusher. (<a href="https://github.com/matrix-org/synapse/issues/4149" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4149/hovercard" aria-describedby="hovercard-aria-description">#4149</a>)</li>
 	<li>add purge_history.sh and purge_remote_media.sh scripts to contrib/ (<a href="https://github.com/matrix-org/synapse/issues/4155" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4155/hovercard" aria-describedby="hovercard-aria-description">#4155</a>)</li>
 	<li>HTTP tests have been refactored to contain less boilerplate. (<a href="https://github.com/matrix-org/synapse/issues/4156" data-hovercard-type="pull_request" data-hovercard-url="/matrix-org/synapse/pull/4156/hovercard" aria-describedby="hovercard-aria-description">#4156</a>)</li>
 	<li>Drop incoming events from federation for unknown rooms (<a href="https://github.com/matrix-org/synapse/issues/4165" data-hovercard-type="issue" data-hovercard-url="/matrix-org/synapse/issues/4165/hovercard" aria-describedby="hovercard-aria-description">#4165</a>)</li>
</ul>

                
            </div>
        </article>
        
        <nav class="pagination">
    <div class="prev">
        
        <a href="&#x2F;category&#x2F;releases&#x2F;page&#x2F;11&#x2F;">‹ Previous</a>
        
    </div>
    <span class="page-number">12 / 14</span>
    <div class="prev">
        
        <a href="&#x2F;category&#x2F;releases&#x2F;page&#x2F;13&#x2F;">Next ›</a>
        
    </div>
</nav>

    </div>
</div>

    </main>

    <footer class="site-footer">
    <div class="internal-links">
        
        <a href="&#x2F;faq">FAQs</a>
        
        <a href="&#x2F;security-disclosure-policy">Security Disclosure Policy</a>
        
        <a href="&#x2F;security-hall-of-fame">Security Hall of Fame</a>
        
        <a href="&#x2F;legal&#x2F;code-of-conduct">Code of Conduct for Matrix.org</a>
        
        <a href="&#x2F;legal">Legal</a>
        
        <a href="&#x2F;contact">Contact</a>
        
        <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org&#x2F;matrix.org&#x2F;">Site Source</a>
        
    </div>
    <div class="external-links">
        <div>
            
            <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org"><img src="/assets/github.svg" alt="GitHub"></a>
            
            <a href="https:&#x2F;&#x2F;gitlab.matrix.org&#x2F;"><img src="/assets/gitlab.svg" alt="GitLab"></a>
            
            <a href="https:&#x2F;&#x2F;mastodon.matrix.org&#x2F;@matrix"><img src="/assets/mastodon.svg" alt="Mastodon"></a>
            
            <a href="https:&#x2F;&#x2F;twitter.com&#x2F;matrixdotorg"><img src="/assets/twitter.svg" alt="Twitter"></a>
            
            <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCVFkW-chclhuyYRbmmfwt6w"><img src="/assets/youtube.svg" alt="YouTube"></a>
            
        </div>
    </div>
    <p>© 2022 The Matrix.org Foundation C.I.C.</p>
</footer>

</body>

</html>
