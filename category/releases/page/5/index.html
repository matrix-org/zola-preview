<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="twitter:widgets:csp" content="on" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="twitter:site" content="@matrixdotorg" />
    <meta name="twitter:creator" content="@matrixdotorg" />

    <title>Matrix.org - Releases</title>
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg" />
    <link rel="stylesheet" href="/style.css" />

    
<link rel="alternate" type="application/rss+xml" title="RSS" href="/category/releases/atom.xml">
</head>

<body>
    
    <header class="site-header">
    <a href="/" class="brand">
        <img src="/images/matrix-logo-white.svg" alt="Matrix logo">
    </a>
    <input id="site-header-dropdown-checkbox" type="checkbox" class="dropdown-checkbox" aria-hidden="true">
    <label for="site-header-dropdown-checkbox" class="dropdown-button">&#xe602;</label>
    <label for="site-header-dropdown-checkbox" class="page-overlay"></label>
    <nav>
        
        
        <a href="&#x2F;about&#x2F;" class="
            ">
            About
        </a>
        
        
        
        <a href="&#x2F;blog&#x2F;" class="
            ">
            Blog
        </a>
        
        
        
        <a href="&#x2F;docs&#x2F;" class="
            ">
            Documentation
        </a>
        
        
        
        
        
        <div class="section-wrap">
            <input id="ecosystem-submenu-checkbox" type="checkbox" class="submenu-checkbox" aria-hidden="true"
                >
            <label for="ecosystem-submenu-checkbox" class="submenu-title">Ecosystem <div class="arrow">
                </div></label>

            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;clients&#x2F;">Clients</a>
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;bridges&#x2F;">Bridges</a>
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;servers&#x2F;">Servers</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;bots&#x2F;">Bots</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;sdks&#x2F;">SDKs</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;hosting&#x2F;">Hosting</a>
                    
                </div>
            </div>
        </div>
        
        
        
        <a href="&#x2F;podcasts&#x2F;" class="
            ">
            Podcasts
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;shop.matrix.org" class="
            ">
            Shop
        </a>
        
        
        
        <a href="&#x2F;try-matrix&#x2F;" class="primary
            ">
            Try Matrix
        </a>
        
        
    </nav>
</header>


    <main>
        
<div id="taxonomy-single">
    <div class="content">
        <header>
            <h1>Releases</h1>
            138 posts tagged with "Releases" <a href="/category">(See all Category)</a>
            
            <h2>
                <small><a href="/category/releases/atom.xml">Atom Feed</a></small>
            </h2>
            
        </header>

        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;10&#x2F;05&#x2F;synapse-1-44-0-released&#x2F;" title="Synapse 1.44.0 released">Synapse 1.44.0 released</a></h2>
                <span>
                    05.10.2021 23:44
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.44.0 is out now!</p>
<h2 id="loads-of-bug-fixes">Loads of Bug Fixes</h2>
<p>This release primarily includes fixes for over a dozen long-standing bugs. For example:</p>
<ul>
<li>Messages containing null bytes are now properly indexed for search.</li>
<li>The Room Search Admin API now allows searching for rooms with non-ascii titles.</li>
<li>URL preview caches, which are meant to be ephemeral, are no longer mirrored from the local media store into other media providers.</li>
</ul>
<h2 id="faster-json-responses">Faster JSON Responses</h2>
<p>We now stay within C code while generating large JSON objects for responses, which should be substantially faster than the previous technique, which fell back to Python for encoding.</p>
<h2 id="new-extension-module-apis">New Extension Module APIs</h2>
<p>Spam checker modules can now use a <code>user_may_create_room_with_invites</code> callback to inspect room creation events which include invitations to users via Matrix or other media (email, etc.).</p>
<p>Additionally, the ModuleApi can now inspect IP and User Agent data, as well as checking whether Rooms and MXIDs are local to the current homeserver.</p>
<h2 id="everything-else">Everything Else</h2>
<p>We've also been busy refactoring. For example:</p>
<ul>
<li>Prometheus stats now distinguish between cache evictions due to entries expiring, and cache evictions due to the cache being full.</li>
<li>The <code>synapse.handlers</code>, <code>synapse.rest</code>, and <code>synapse.storage.databases.state</code> modules are now fully type annotated and checked by mypy, among others.</li>
<li>The user directory search code was cleaned up in preparation for future fixes.</li>
<li>Another half dozen pull requests were merged with an aim toward clarifying federated event authentication code (and associated logging).</li>
</ul>
<p>Lastly, this release has seen considerable work toward supporting <a href="https://github.com/matrix-org/matrix-doc/pull/2716">MSC2716: Incrementally importing history into existing rooms</a>, along with an update to match the current state of <a href="https://github.com/matrix-org/matrix-doc/pull/3231">MSC3231: Token authenticated registration</a>.</p>
<p>These are just the highlights; please see the <a href="https://matrix-org.github.io/synapse/v1.44/upgrade.html#upgrading-to-v1440">Upgrade Notes</a> and <a href="https://github.com/matrix-org/synapse/blob/v1.44.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/aaronraimist">aaronraimist</a>, <a href="https://github.com/cvwright">cvwright</a>, <a href="https://github.com/govynnus">govynnus</a>, <a href="https://github.com/Kokokokoka">Kokokokoka</a>, and <a href="https://github.com/tulir">tulir</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;09&#x2F;21&#x2F;synapse-1-43-0-released&#x2F;" title="Synapse 1.43.0 released">Synapse 1.43.0 released</a></h2>
                <span>
                    21.09.2021 22:03
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.43.0 is out now!</p>
<h2 id="preparing-for-spaces">Preparing for Spaces</h2>
<p>Quite a lot of work has gone into preparing for Spaces to graduate from beta testing. For example, Synapse now:</p>
<ul>
<li>Asks clients to prefer <a href="https://github.com/matrix-org/matrix-doc/pull/3375">room version 9</a> when creating restricted rooms (<a href="https://github.com/matrix-org/synapse/issues/10772">#10772</a>), via the API defined in <a href="https://github.com/matrix-org/matrix-doc/pull/3244">MSC3244: room version capabilities</a>.</li>
<li>Allows the Spaces Summary APIs to be handled by worker processes.</li>
<li>Omits rooms with unknown room versions from the Spaces Summary.</li>
<li>Properly handles upgrades of Spaces to different room versions.</li>
</ul>
<h2 id="everything-else">Everything Else</h2>
<p>This release of Synapse also:</p>
<ul>
<li>Includes initial work toward fully supporting oEmbed for embedding URL previews (<a href="https://github.com/matrix-org/synapse/issues/10714">#10714</a>, <a href="https://github.com/matrix-org/synapse/issues/10759">#10759</a>).</li>
<li>Slightly speeds up room joins over federation (<a href="https://github.com/matrix-org/synapse/issues/10754">#10754</a>, <a href="https://github.com/matrix-org/synapse/issues/10755">#10755</a>, <a href="https://github.com/matrix-org/synapse/issues/10756">#10756</a>, <a href="https://github.com/matrix-org/synapse/issues/10780">#10780</a>, <a href="https://github.com/matrix-org/synapse/issues/10784">#10784</a>).</li>
<li>Somewhat improves service restart times for large Synapse deployments.</li>
<li>Significantly refactors federation event authentication code for greater clarity (<a href="https://github.com/matrix-org/synapse/issues/10744">#10744</a>, <a href="https://github.com/matrix-org/synapse/issues/10745">#10745</a>, <a href="https://github.com/matrix-org/synapse/issues/10746">#10746</a>, <a href="https://github.com/matrix-org/synapse/issues/10771">#10771</a>, <a href="https://github.com/matrix-org/synapse/issues/10773">#10773</a>, <a href="https://github.com/matrix-org/synapse/issues/10781">#10781</a>).</li>
<li>Adds further static type hints to various modules.</li>
</ul>
<p>We've also spent quite a lot of time on SyTest, our integration test suite. In particular, many of the tests made assumptions about event processing which were not correct when targeting a multi-worker Synapse deployment. These flakey tests have plagued our continuous integration pipelines, and are finally being fixed.</p>
<p>These are just the highlights; please see the <a href="https://github.com/matrix-org/synapse/blob/v1.43.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/AndrewFerr">AndrewFerr</a>, <a href="https://github.com/BramvdnHeuvel">BramvdnHeuvel</a>, and <a href="https://github.com/cuttingedge1109">cuttingedge1109</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;09&#x2F;07&#x2F;synapse-1-42-0-released&#x2F;" title="Synapse 1.42.0 released">Synapse 1.42.0 released</a></h2>
                <span>
                    07.09.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.42.0 is out now!</p>
<p>This release includes changes that you may need to be aware of before upgrading, such as the removal of two deprecated Admin APIs or a retroactive fix to ensure that email notifications are only sent to addresses which are presently associated with an account. Please see the  <a href="https://matrix-org.github.io/synapse/v1.42/upgrade.html#upgrading-to-v1420">Upgrade Notes</a> for details.</p>
<h2 id="room-version-9-a-bugfix-for-restricted-rooms">Room Version 9: A Bugfix for Restricted Rooms</h2>
<p>Synapse 1.42 includes support for <a href="https://github.com/matrix-org/matrix-doc/pull/3375">Room Version 9</a>, which fixes <a href="https://github.com/matrix-org/matrix-doc/issues/3373">an oversight</a> in the list of event fields which were protected from redaction in Room Version 8's <a href="https://github.com/matrix-org/matrix-doc/pull/3083">restricted rooms</a>. This makes it possible, in certain circumstances, for a restricted room to degrade into a state where participating servers will disagree about the room's membership.</p>
<p>Because changing a room version's redaction algorithm also changes the way that event IDs are calculated, properly fixing this issue required the creation of a new room version.</p>
<p>To ensure compatibility with existing servers, Synapse 1.42's <a href="https://github.com/matrix-org/matrix-doc/pull/3244">MSC3244: Room version capabilities</a> hints will continue to ask clients to prefer Room Version 8 when creating restricted rooms and Room Version 6 otherwise. A future release of Synapse will ask clients to prefer Room Version 9 for restricted rooms.</p>
<h2 id="handling-unknown-rooms">Handling Unknown Rooms</h2>
<p>Very rarely, users find themselves in rooms created with unstable or experimental room versions. Then, when Synapse removes support for these versions, bad things happen. The server no longer understands how to interact with that room version, which means <em>you</em> can't interact with that room. And if you can't interact with that room, you can't <em>leave</em>.</p>
<p>In Synapse 1.42, rooms with unknown room versions are no longer returned down <code>/sync</code>. This prevents them from appearing in your client, though you may need to empty your client's cache and re-sync to see any effect.</p>
<h2 id="new-mscs">New MSCs</h2>
<p>In addition to Room Version 9 (<a href="https://github.com/matrix-org/matrix-doc/pull/3375">MSC3375</a>), this release includes:</p>
<ul>
<li>
<p>An initial implementation of <a href="https://github.com/matrix-org/matrix-doc/pull/3231">MSC3231: Token authenticated registration</a>, which makes it possible for homeservers to disable user registration while still allowing new accounts to be made by people who know a pre-shared secret.</p>
<p>This MSC and its implementations were produced as part of a Google Summer of Code (GSoC) project by Callum Brown.</p>
</li>
<li>
<p>An updated implementation of <a href="https://github.com/matrix-org/matrix-doc/pull/2946">MSC2946: Spaces Summary</a> following recent changes to the proposal.</p>
</li>
<li>
<p>Support for <a href="https://github.com/matrix-org/matrix-doc/pull/3283">MSC3283: Expose capabilities for profile actions</a>, which hints to clients whether or not a server allows users to change their display name, avatar, or email address.</p>
</li>
</ul>
<h2 id="everything-else">Everything Else</h2>
<p>In addition to the usual array of improvements to performance, type hints, error messages, and documentation:</p>
<ul>
<li>Custom Presence Router modules can now be built using Synapse's <a href="https://matrix-org.github.io/synapse/v1.42/modules.html#presence-router-callbacks">new, unified module interface</a> which debuted in Synapse 1.37.</li>
<li>Code around federation event handling and authentication has been significantly refactored to improve reliability and maintainability, including extracting nearly 1,800 lines of code from the <code>FederationHandler</code> class into a separate <code>FederationEventHandler</code> class.</li>
<li>Backfilling history and fetching missing events now use the same code paths, reducing the potential for bugs.</li>
<li>Concurrently fetching the same large set of events (<a href="https://github.com/matrix-org/synapse/pull/10703">#10703</a>) is now much more efficient, preventing the process hangs which were possible in prior, extreme cases.</li>
</ul>
<p>These are just the highlights; please see the <a href="https://matrix-org.github.io/synapse/v1.42/upgrade.html#upgrading-to-v1420">Upgrade Notes</a> and <a href="https://github.com/matrix-org/synapse/blob/v1.42.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/aaronraimist">aaronraimist</a>, <a href="https://github.com/dklimpel">dklimpel</a>, <a href="https://github.com/govynnus">govynnus</a>, and <a href="https://github.com/HugoDelval">HugoDelval</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;08&#x2F;31&#x2F;synapse-1-41-1-released&#x2F;" title="Synapse 1.41.1 released">Synapse 1.41.1 released</a></h2>
                <span>
                    31.08.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Today we are releasing Synapse 1.41.1, a security update based on last week's release of <a href="https://matrix.org/blog/2021/08/24/synapse-1-41-0-released">Synapse 1.41.0</a>. This release patches two moderate severity issues which could reveal metadata about private rooms:</p>
<ul>
<li>
<p><strong><a href="https://github.com/matrix-org/synapse/security/advisories/GHSA-3x4c-pq33-4w3q">GHSA-3x4c-pq33-4w3q</a> / CVE-2021-39164: Enumerating a private room's list of members and their display names.</strong></p>
<p>If an unauthorized user both knows the Room ID of a private room <em>and</em> that room's history visibility is set to <code>shared</code>, then they may be able to enumerate the room's members, including their display names.</p>
<p>The unauthorized user must be on the same homeserver as a user who is a member of the target room.</p>
</li>
<li>
<p><strong><a href="https://github.com/matrix-org/synapse/security/advisories/GHSA-jj53-8fmw-f2w2">GHSA-jj53-8fmw-f2w2</a> / CVE-2021-39163: Disclosing a private room's name, avatar, topic, and number of members.</strong></p>
<p>If an unauthorized user knows the Room ID of a private room, then its name, avatar, topic, and number of members may be disclosed through Group / Community features.</p>
<p>The unauthorized user must be on the same homeserver as a user who is a member of the target room, and their homeserver must allow non-administrators to create groups (<code>enable_group_creation</code> in the Synapse configuration; off by default).</p>
</li>
</ul>
<p>Note that in both cases:</p>
<ul>
<li>The private room's Room ID must be known to the attacker.</li>
<li>Another user on the attacker's homeserver must be a legitimate member of the target room.</li>
<li>The information disclosed is <em>already</em> present in the database and thus legitimately known to the administrators of homeservers participating in the target room.</li>
</ul>
<p>We'd like to credit <a href="https://twitter.com/0xkasper">0xkasper</a> for discovering and responsibly disclosing these issues.</p>
<p>This release also fixes a small regression in 1.41.0 (<a href="https://github.com/matrix-org/synapse/issues/10709">#10709</a>) which broke compatibility with older Twisted versions when Synapse was a configured to send email.</p>
<p>Please update at your earliest convenience.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;08&#x2F;24&#x2F;synapse-1-41-0-released&#x2F;" title="Synapse 1.41.0 released">Synapse 1.41.0 released</a></h2>
                <span>
                    24.08.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.41.0 is out now!</p>
<blockquote>
<p><strong>NOTE:</strong> We anticipate publishing a <strong>security release</strong> next Tuesday, the 31st of August.</p>
<p>Synapse 1.41.1 will contain fixes for two moderate severity issues.</p>
</blockquote>
<p>Synapse 1.41 includes changes to forward proxies, template settings, and media workers which may require your attention. Please see the  <a href="https://matrix-org.github.io/synapse/v1.41/upgrade.html#upgrading-to-v1410">Upgrade Notes</a> for details.</p>
<p>Also, this release <strong>removes support for Ubuntu 20.10</strong> (Groovy Gorilla), which reached End of Life last month. Support for Ubuntu 18.04 LTS (Bionic Beaver) and Ubuntu 21.04 (Hirsute Hippo) will be withdrawn near the end of this year under our <a href="https://matrix-org.github.io/synapse/v1.41/deprecation_policy.html">platform deprecation policy</a>.</p>
<h2 id="promoting-restricted-rooms">Promoting Restricted Rooms</h2>
<p>Synapse 1.41 includes experimental support for <a href="https://github.com/matrix-org/matrix-doc/pull/3244">MSC3244: Room version capabilities</a>, which indicates to clients that they should use Room Version 8 when creating <a href="https://github.com/matrix-org/matrix-doc/pull/3083">restricted rooms</a>. For example, Element's clients will use the MSC3244 metadata, which is on by default in Synapse 1.41, to determine whether to show end users the UI for creating restricted rooms.</p>
<p>Room Version 6 will remain the default for newly created rooms which do not explicitly request the restricted room capabilities at creation time. This strikes a balance between the broad compatibility of an older default room version, while still making newer features available upon request.</p>
<h2 id="new-mscs">New MSCs</h2>
<p>This version of Synapse implements experimental support for:</p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/3266">MSC3266: Room summary API</a> which provides a simple way to obtain information about a specific room, such as its join rules, room type, etc.</li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/3288">MSC3288: Add room type in store invite</a> which lets identity servers differentiate between invitations to rooms and invitations to Spaces.</li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/3244">MSC3244: Room version capabilities</a> as described above.</li>
</ul>
<p>We've also added pagination to the Spaces Summary API based on updates to <a href="https://github.com/matrix-org/matrix-doc/pull/2946">MSC2946</a>.</p>
<p>Work towards implementing <a href="https://github.com/matrix-org/matrix-doc/pull/2716">MSC2716: Incrementally importing history into existing rooms</a> continues, with several related pull requests landing in this release.</p>
<h2 id="more-admin-apis">More Admin APIs</h2>
<p>Synapse now has an Admin APIs to:</p>
<ul>
<li><a href="https://matrix-org.github.io/synapse/v1.41/admin_api/user_admin_api.html#delete-media-uploaded-by-a-user">Delete media uploaded by a user</a> from your homeserver's local media storage.</li>
<li><a href="https://matrix-org.github.io/synapse/v1.41/admin_api/user_admin_api.html#create-or-modify-account">Edit the external ids</a> associated with a user by Single Sign-On / OpenID Connect providers.</li>
<li><a href="https://matrix-org.github.io/synapse/v1.41/admin_api/user_admin_api.html#check-username-availability">Check if a username is available</a>, which behaves similarly to the <a href="https://matrix.org/docs/spec/client_server/r0.6.0#get-matrix-client-r0-register-available">related client-server API</a> in the Matrix Spec, but the Admin API version works even when registration is disabled on a homeserver.</li>
</ul>
<h2 id="everything-else">Everything Else</h2>
<p>In addition to the usual boosts to performance and reliability like <a href="https://github.com/matrix-org/synapse/pull/10119">#10119</a> or <a href="https://github.com/matrix-org/synapse/pull/10513">#10513</a>, this release includes several notable improvements:</p>
<ul>
<li>The <code>/createRoom</code> endpoint can now be <a href="https://github.com/matrix-org/synapse/pull/10564">handled by workers</a>.</li>
<li>Synapse can now route outbound federation requests, remote media downloads, and public key fetches through a <a href="https://matrix-org.github.io/synapse/v1.41/setup/forward_proxy.html">forward proxy</a>.</li>
<li>Custom template configuration has now been centralized into a single <code>custom_templates_directory</code> <a href="https://matrix-org.github.io/synapse/v1.41/templates.html">configuration setting</a>.</li>
<li>Matrix clients which allow users to <a href="https://matrix.org/docs/spec/client_server/latest#id64">set a <code>status_msg</code> with their presence</a> will find that Synapse no longer arbitrarily unsets the message when a user goes offline. Instead, each user's <code>status_msg</code> will persist until it is deliberately cleared by their client.</li>
<li>The extension module API now exposes a function, <code>get_userinfo_by_id</code>, which accepts an MXID and returns a <code>UserInfo</code> object. This should simplify writing extension modules like spam checkers.</li>
</ul>
<p>These are just the highlights; please see the <a href="https://matrix-org.github.io/synapse/v1.41/upgrade.html#upgrading-to-v1410">Upgrade Notes</a> and <a href="https://github.com/matrix-org/synapse/blob/v1.41.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/Bubu">Bubu</a>, <a href="https://github.com/dklimpel">dklimpel</a>, <a href="https://github.com/H-Shay">H-Shay</a>, <a href="https://github.com/ilmari">ilmari</a>, <a href="https://github.com/Kentokamoto">Kentokamoto</a>, <a href="https://github.com/SimonBrandner">SimonBrandner</a>, and <a href="https://github.com/warricksothr">warricksothr</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;08&#x2F;10&#x2F;synapse-1-40-0-released&#x2F;" title="Synapse 1.40.0 released">Synapse 1.40.0 released</a></h2>
                <span>
                    10.08.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.40.0 is out now!</p>
<h2 id="support-for-room-version-8">Support for Room Version 8</h2>
<p>This release of Synapse includes stable support for <a href="https://github.com/matrix-org/matrix-doc/pull/3289">Room Version 8</a>! Version 8 codifies a concept of &quot;<a href="https://github.com/matrix-org/matrix-doc/pull/3083">restricted rooms</a>&quot; which are private rooms joinable only by direct invitation or by being a member of other, designated Spaces / rooms.</p>
<p>This means you can create a Matrix Space for your company, team, or guild, and instead of inviting people to the Space <em>and</em> directly to a bunch of private rooms, you can simply configure your private rooms such that membership in the Space <em>automatically</em> confers access to the private rooms.</p>
<p>This is a major improvement to access control in Matrix, and we can't wait to use it ourselves.</p>
<p>Note that client support for managing restricted rooms is still forthcoming, and you'll want to ensure that your users are on homeservers which support v8 before upgrading existing rooms. To ensure compatibility across federation, the default for newly created rooms remains at v6 for the time being.</p>
<h2 id="everything-else">Everything Else</h2>
<p>A few other items worth calling out:</p>
<ul>
<li>Synapse can now optionally recycle PostgreSQL connections after a specified number of transactions (<a href="https://github.com/matrix-org/synapse/pull/10440">#10440</a>), which may mitigate slow memory leaks in the database. Thanks to GitHub user hifi.</li>
<li>We have a whole new documentation page explaining <a href="https://matrix-org.github.io/synapse/v1.40/development/room-dag-concepts.html">Room DAG Concepts</a> like depth, stream ordering, extremities, outliers, and state groups.</li>
<li>The <a href="https://matrix-org.github.io/synapse/v1.40/admin_api/user_admin_api.html#list-accounts">Admin API for listing accounts</a> now returns a <code>creation_ts</code> property indicating when an account was created. Thanks to work by dklimpel.</li>
<li>Synapse should better detect character encodings in URL previews thanks to a contribution by srividyut.</li>
</ul>
<p>In addition to further work towards implementing <a href="https://github.com/matrix-org/matrix-doc/pull/2716">MSC2716: Incrementally Importing History into Existing Rooms</a>, we've landed support for:</p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2033">MSC2033</a>: The <code>/account/whoami</code> endpoint now includes the <code>device_id</code> associated with the access token used to make the request.</li>
<li>(Experimental) <a href="https://github.com/matrix-org/matrix-doc/pull/3244">MSC3244</a>: The <code>/_matrix/client/r0/capabilities</code> endpoint may include metadata about which room versions support which capabilities (like knocking on restricted joins).</li>
<li>(Experimental) <a href="https://github.com/matrix-org/matrix-doc/pull/2285">MSC2285</a>: Clients may mark messages as read on the server without updating their externally visible read receipts, implemented by SimonBrandner.</li>
</ul>
<p>These are just the highlights; please see the <a href="https://github.com/matrix-org/synapse/blob/v1.40.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/dklimpel">dklimpel</a>, <a href="https://github.com/hifi">hifi</a>, <a href="https://github.com/SimonBrandner">SimonBrandner</a>, and <a href="https://github.com/srividyut">srividyut</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;07&#x2F;29&#x2F;synapse-1-39-0-released&#x2F;" title="Synapse 1.39.0 released">Synapse 1.39.0 released</a></h2>
                <span>
                    29.07.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.39.0 is now available!</p>
<p>We've done quite a bit of work this release on Synapse's new interface for extension modules:</p>
<ul>
<li>Synapse's <code>account_validity</code> option has been extracted into a built-in <a href="https://matrix-org.github.io/synapse/v1.39/modules.html#account-validity-callbacks">extension module</a>. If your configuration previously enabled <code>account_validity</code>, it will continue working as before, but it is now easier to override and customize.</li>
<li>The third party event rules callbacks have also been <a href="https://matrix-org.github.io/synapse/v1.39/modules.html#third-party-rules-callbacks">experimentally ported</a> to the new module interface.</li>
</ul>
<p>We've also improved the Space Summary API to list all rooms which a user could join (<a href="https://github.com/matrix-org/synapse/pull/10298">#10298</a>). This is especially important with the pending standardization of Room Version 8, which includes <em><a href="https://github.com/matrix-org/matrix-doc/pull/3083">MSC3083</a>: Restricting room membership based on membership in other rooms.</em></p>
<p>MadLittleMods landed several pull requests on the path to implementing <em><a href="https://github.com/matrix-org/matrix-doc/pull/2716">MSC2716</a>: Incrementally importing history into existing rooms</em> (<a href="https://github.com/matrix-org/synapse/pull/10250">#10250</a>, <a href="https://github.com/matrix-org/synapse/pull/10276">#10276</a>).</p>
<p>More than anything else, this release contains an absolutely enormous load of internal cleanup. For example:</p>
<ul>
<li>ShadowJonathan ran <code>pyupgrade</code> on the entire codebase, bringing it up to modern Py3.6+ conventions, then separately used <code>com2ann</code> to move us from legacy <code># type: foo</code> type hints to more modern inline annotations.</li>
<li>We finished converting several integer columns in our database to bigint as a precautionary measure.</li>
<li>We've made innumerable improvements to our CI configuration; including moving completely to GitHub Actions.</li>
<li>Countless small improvements to performance, reliability, and error logging.</li>
</ul>
<p>But that's not all! Synapse 1.39 also allows for setting credentials for HTTP proxy connections thanks to work by dklimpel; previously, Synapse was only able to provide authentication for HTTPS proxies.</p>
<p>Please see the <a href="https://matrix-org.github.io/synapse/v1.39/upgrade.html#upgrading-to-v1390">Upgrade Notes</a> and <a href="https://github.com/matrix-org/synapse/blob/v1.39.0/CHANGES.md">Release Notes</a> for a complete list of changes in this rele ase.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/andir">andir</a>, <a href="https://github.com/dklimpel">dklimpel</a>, <a href="https://github.com/ilmari">ilmari</a>, <a href="https://github.com/LukeWalsh">LukeWalsh</a>, <a href="https://github.com/moritzdietz">moritzdietz</a>, <a href="https://github.com/ShadowJonathan">ShadowJonathan</a>, and <a href="https://github.com/xmunoz">xmunoz</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;07&#x2F;26&#x2F;dendrite-0-4-1-released&#x2F;" title="Dendrite 0.4.1 Released">Dendrite 0.4.1 Released</a></h2>
                <span>
                    26.07.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>It's only been two weeks since Dendrite 0.4 landed, but there's already a
significant new release with Dendrite 0.4.1 (it's amazing how much work we
can do on Dendrite when not off chasing low-bandwidth and P2P Matrix!)</p>
<p>This release further improves memory performance and radically improves
state resolution performance (rumour has it that it's a 10x speed-up).
Meanwhile, SS API sytest coverage is up to 91%(!!) and CS API is now at 63%.</p>
<p>We're going to try to keep the pressure up over the coming weeks - and once
sytest is at 100% coverage (and we're not missing any big features which sytest
doesn't cover yet) we'll be declaring a 1.0 :)</p>
<p>If you're running Dendrite, please upgrade.  If not, perhaps this would be a
good version to give it a try?  You can get it, as always from,
https://github.com/matrix-org/dendrite/releases/tag/v0.4.1.  The changelog
follows:</p>
<h3 id="features">Features</h3>
<ul>
<li>Support for room version 7 has been added</li>
<li>Key notary support is now more complete, allowing Dendrite to be used as a notary server for looking up signing keys</li>
<li>State resolution v2 performance has been optimised further by caching the create event, power levels and join rules in memory instead of parsing them repeatedly</li>
<li>The media API now handles cases where the maximum file size is configured to be less than 0 for unlimited size</li>
<li>The <code>initial_state</code> in a <code>/createRoom</code> request is now respected when creating a room</li>
<li>Code paths for checking if servers are joined to rooms have been optimised significantly</li>
</ul>
<h3 id="fixes">Fixes</h3>
<ul>
<li>A bug resulting in <code>cannot xref null state block with snapshot</code> during the new state storage migration has been fixed</li>
<li>Invites are now retired correctly when rejecting an invite from a remote server which is no longer reachable</li>
<li>The DNS cache <code>cache_lifetime</code> option is now handled correctly (contributed by <a href="https://github.com/S7evinK">S7evinK</a>)</li>
<li>Invalid events in a room join response are now dropped correctly, rather than failing the entire join</li>
<li>The <code>prev_state</code> of an event will no longer be populated incorrectly to the state of the current event</li>
<li>Receiving an invite to an unsupported room version will now correctly return the <code>M_UNSUPPORTED_ROOM_VERSION</code> error code instead of <code>M_BAD_JSON</code> (contributed by <a href="https://github.com/meenal06">meenal06</a>)</li>
</ul>
<p>-- Team Dendrite</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;07&#x2F;13&#x2F;synapse-1-38-0-released&#x2F;" title="Synapse 1.38.0 released">Synapse 1.38.0 released</a></h2>
                <span>
                    13.07.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.38.0 is out now!</p>
<blockquote>
<p><strong>NOTE:</strong> We released Synapse 1.38.1 on Thursday, July 22nd. It <a href="https://github.com/matrix-org/synapse/issues/10456">mitigates</a> a client bug with Synapse 1.38.0's smaller sync responses which prevented new Element Android sessions from successfully participating in encrypted conversations. Server administrators are strongly encouraged to upgrade.</p>
</blockquote>
<h2 id="big-integers">(Big) Integers</h2>
<p>Synapse's database schema used <code>integer</code> columns in a few places where values could potentially overflow a maximum value of 2<sup>31</sup>. One such column is <code>events.stream_ordering</code>, which surpassed 2<sup>31</sup> on matrix.org last week.</p>
<p>To prevent overflows, Synapse 1.38 will automatically convert several <code>integer</code> columns to <code>bigint</code> as a background update. While homeservers will function normally during this task, it could result in increased disk I/O for several hours or days. Note that <strong>homeservers may need several gigabytes of free space</strong> to successfully rebuild associated database indexes and complete the upgrade.</p>
<p>See the <a href="https://matrix-org.github.io/synapse/v1.38/upgrade.html#upgrading-to-v1380">upgrade notes</a> for more details.</p>
<h2 id="expiring-caches">Expiring Caches</h2>
<p>Synapse has a new configuration option, <code>caches.expiry_time</code>, which can be set to enable evicting items from caches if they go too long without being accessed. This helps servers reclaim memory used by large yet infrequently used caches.</p>
<h2 id="smaller-sync-responses">Smaller Sync Responses</h2>
<p>The response to <code>/sync</code> now omits optional keys when they would otherwise be empty. This can significantly reduce the size of incremental syncs, as demonstrated in <a href="https://github.com/matrix-org/synapse/issues/6579">#6579</a>. Thanks to deepbluev7 for  initially submitting this in <a href="https://github.com/matrix-org/synapse/pull/9919">#9919</a>, which made it into this release via <a href="https://github.com/matrix-org/synapse/pull/10214">#10214</a>.</p>
<h2 id="everything-else">Everything Else</h2>
<p>A few other items worth calling out:</p>
<ul>
<li>This release includes an experimental implementation of <a href="https://github.com/matrix-org/matrix-doc/pull/2918">MSC2918: Refresh tokens</a>, which adds initial support for complementary access / refresh tokens in line with OAuth best practices (<a href="https://github.com/matrix-org/synapse/pull/9450">#9450</a>).</li>
<li>Synapse now <a href="https://github.com/matrix-org/synapse/pull/10290">ships a script</a> to review recently registered accounts, which can be useful in cleaning up servers in the wake of malicious, automated registrations like we witnessed during last month's <a href="https://matrix.org/blog/2021/06/30/security-update-synapse-1-37-1-released">spam attack</a>.</li>
<li>We've also fixed a few rough edges (<a href="https://github.com/matrix-org/synapse/pull/10263">#10263</a>, <a href="https://github.com/matrix-org/synapse/pull/10303">#10303</a>, <a href="https://github.com/matrix-org/synapse/pull/10336">#10336</a>) in the spam mitigations from 1.37.1, and would encourage you to update.</li>
<li>The <a href="https://matrix-org.github.io/synapse/v1.38/admin_api/user_admin_api.html">Admin API for querying user information</a> now includes information about a user's SSO identities in its response.</li>
</ul>
<p>These are just the highlights; please see the <a href="https://matrix-org.github.io/synapse/v1.38/upgrade.html#upgrading-to-v1380">Upgrade Notes</a> and <a href="https://github.com/matrix-org/synapse/blob/v1.38.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/deepbluev7">deepbluev7</a>, <a href="https://github.com/dklimpel">dklimpel</a>, <a href="https://github.com/fkr">fkr</a>, and <a href="https://github.com/sideshowbarker">sideshowbarker</a></p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;07&#x2F;12&#x2F;dendrite-0-4-0-released&#x2F;" title="Dendrite 0.4.0 Released">Dendrite 0.4.0 Released</a></h2>
                <span>
                    12.07.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-alexander">
                        Neil Alexander
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>After quite a significant gap between releases — version 0.3.11 was released at the beginning of March — we're happy to finally announce the release of Dendrite 0.4.0 today!</p>
<p>The full changelog for the release is <a href="https://github.com/matrix-org/dendrite/releases/tag/v0.4.0">available on GitHub</a>, but we wanted to take the opportunity to talk a little about some of the changes that have gone into this release.</p>
<p>Recently our release cadence for Dendrite has slowed as we have spent more time within the team working on <a href="https://github.com/matrix-org/pinecone">Pinecone</a> and <a href="https://github.com/matrix-org/lb">Low Bandwidth Matrix</a>. These are major areas of research for us which we hope will unlock a number of new opportunities within the Matrix ecosystem, allowing us to <a href="https://matrix.org/blog/2021/05/06/introducing-the-pinecone-overlay-network">build on Matrix anywhere</a> and to <a href="https://matrix.org/blog/2021/06/10/low-bandwidth-matrix-an-implementation-guide">reduce the protocol-level footprint</a>. However, Dendrite has not been forgotten amidst the excitement and we will be spending more time working on Dendrite again in the coming months.</p>
<h3 id="state-storage">State storage</h3>
<p>One of the major features in v0.4.0 is that we've introduced newly-refactored state storage in the roomserver database. The goal here is to make state storage significantly more efficient by ensuring that we deduplicate state  blocks and snapshots wherever we can. By ensuring that all state blocks and snapshots are ordered strictly, and by enforcing uniqueness constraints on the hashes of the blocks/snapshots, we've been able to achieve this.</p>
<p>This was largely spurred on by watching <code>dendrite.matrix.org</code> consuming a rather alarming amount of disk space on a daily basis. In this particular instance, moving to the new state storage resulted in a 15x improvement on disk utilisation for state blocks and a further 2x improvement for state snapshot references immediately after the migration, and the growth rate of the database has slowed substantially since. </p>
<p>Ensuring that we don't waste disk space is one of the most important factors in ensuring that Dendrite operates well at any scale — future datacentre deployments supporting many users will find storage overheads decreased and small/embedded single-user deployments (such as P2P, on mobile devices or in the browser) will fit much more effectively onto resource-constrained targets.</p>
<p>After upgrading to v0.4.0, Dendrite will run an automatic migration to update your homeserver to the new state storage format. This might take a while on larger databases so please expect some downtime. </p>
<h3 id="optimisations">Optimisations</h3>
<p>We've continued to squeeze further optimisations into the federation and state resolution code, aiming to reduce the amount of CPU burn and memory utilisation. Some of the feedback that we receive most often from those that have been experimenting with the Dendrite betas is around the sudden spikes in resource usage, especially when joined to large rooms.</p>
<p>The bulk of this resource usage comes either from attempting to reconcile missing events or running state resolution in rooms with lots of members, as potentially large state sets of events need to be brought into memory in order to do so. We've introduced some transaction-level caches for dealing with missing auth/prev events to reduce the memory pressure and we've also tweaked the caching around around <code>/get_missing_events</code> to ensure we don't duplicate any state events in memory.</p>
<p>Resource spikes aren't completely eliminated but this should smooth out CPU and memory utilisation significantly. In the case of <code>dendrite.matrix.org</code>,  which is joined to some 6500 rooms at present, memory utilisation of the Dendrite process typically sits around 1.5GB at present. </p>
<p>State Resolution v2 has also seen further optimisations in the power-level checking, which should reduce CPU usage even more.</p>
<h3 id="bridges">Bridges</h3>
<p>Thanks to Half-Shot's perseverance and contributions, we've merged a couple PRs and worked on some further fixes for getting Application Services working correctly in Dendrite. Whilst not entirely feature-complete and with a number of features still to go, enough support is now present to support basic bridging functionality.</p>
<p>We've done quite a bit of preliminary testing with <a href="https://github.com/matrix-org/matrix-appservice-irc">matrix-appservice-irc</a> and have also heard a number of success stories from the community with <a href="https://github.com/tulir/mautrix-whatsapp">mautrix-whatsapp</a> and <a href="https://github.com/tulir/mautrix-telegram">mautrix-telegram</a>. Others may work too — let us know what you find!</p>
<h3 id="bug-hunting">Bug-hunting</h3>
<p>A number of bugs in various places (including the roomserver, federation API and media API) which could cause Dendrite to crash have also been fixed.  Some of these have been contributed by the community in pull requests, so we extend our thanks to anyone who has submitted a fix to the project.</p>
<p>A special mention also goes to Jakob Varmose Bentzen for reporting a security issue to us around the legacy <code>/v1/register</code> endpoint, where a flaw in the legacy shared secret registration allowed malicious users to create accounts. We've since removed this legacy endpoint and the vulnerability is now fixed. </p>
<h3 id="what-s-next">What's next</h3>
<p>There are still a number of missing user-facing features which we will be working on over the coming months, as well as some architectural issues that we will look to address.</p>
<p>A notable area of work involves attempting to remove the dependency on Kafka for polylith deployments. Kafka is very resource-heavy in operation and somewhat limits us to the types of interactions that we can perform between components. It's also very difficult to manage retention correctly, in the interests of not endlessly consuming disk space here either.</p>
<p>As usual, Dendrite is still considered beta so you may not want to rely on it for production systems, although it should be stable enough to experiment with. If you find any bugs or anything that doesn't look right, please let us know:</p>
<ul>
<li><a href="https://matrix.to/#/#dendrite:matrix.org">#dendrite:matrix.org</a></li>
<li><a href="https://github.com/matrix-org/dendrite/issues">GitHub Issues</a></li>
</ul>
<p>We're also open to contributions, so don't be afraid to open pull requests. Finally, thanks for your continued support!</p>
<p>— Team Dendrite</p>

                
            </div>
        </article>
        
        <nav class="pagination">
    <div class="prev">
        
        <a href="&#x2F;category&#x2F;releases&#x2F;page&#x2F;4&#x2F;">‹ Previous</a>
        
    </div>
    <span class="page-number">5 / 14</span>
    <div class="prev">
        
        <a href="&#x2F;category&#x2F;releases&#x2F;page&#x2F;6&#x2F;">Next ›</a>
        
    </div>
</nav>

    </div>
</div>

    </main>

    <footer class="site-footer">
    <div class="internal-links">
        
        <a href="&#x2F;faq">FAQs</a>
        
        <a href="&#x2F;security-disclosure-policy">Security Disclosure Policy</a>
        
        <a href="&#x2F;security-hall-of-fame">Security Hall of Fame</a>
        
        <a href="&#x2F;legal&#x2F;code-of-conduct">Code of Conduct for Matrix.org</a>
        
        <a href="&#x2F;legal">Legal</a>
        
        <a href="&#x2F;contact">Contact</a>
        
        <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org&#x2F;matrix.org&#x2F;">Site Source</a>
        
    </div>
    <div class="external-links">
        <div>
            
            <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org"><img src="/assets/github.svg" alt="GitHub"></a>
            
            <a href="https:&#x2F;&#x2F;gitlab.matrix.org&#x2F;"><img src="/assets/gitlab.svg" alt="GitLab"></a>
            
            <a href="https:&#x2F;&#x2F;mastodon.matrix.org&#x2F;@matrix"><img src="/assets/mastodon.svg" alt="Mastodon"></a>
            
            <a href="https:&#x2F;&#x2F;twitter.com&#x2F;matrixdotorg"><img src="/assets/twitter.svg" alt="Twitter"></a>
            
            <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCVFkW-chclhuyYRbmmfwt6w"><img src="/assets/youtube.svg" alt="YouTube"></a>
            
        </div>
    </div>
    <p>© 2022 The Matrix.org Foundation C.I.C.</p>
</footer>

</body>

</html>
