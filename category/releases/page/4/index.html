<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="twitter:widgets:csp" content="on" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="twitter:site" content="@matrixdotorg" />
    <meta name="twitter:creator" content="@matrixdotorg" />

    <title>Matrix.org - Releases</title>
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="icon" type="image/png" href="/assets/favicon.png" />
    <link rel="stylesheet" href="/style.css" />

    
<link rel="alternate" type="application/rss+xml" title="RSS" href="/category/releases/atom.xml">
</head>

<body>
    
    <header class="site-header">
    <a href="/" class="brand">
        <img src="/images/matrix-logo-white.svg" alt="Matrix logo">
    </a>
    <input id="site-header-dropdown-checkbox" type="checkbox" class="dropdown-checkbox" aria-hidden="true">
    <label for="site-header-dropdown-checkbox" class="dropdown-button">&#xe602;</label>
    <label for="site-header-dropdown-checkbox" class="page-overlay"></label>
    <nav>
        
        
        <a href="&#x2F;about&#x2F;" class="
            ">
            About
        </a>
        
        
        
        <a href="&#x2F;blog&#x2F;" class="
            ">
            Blog
        </a>
        
        
        
        <a href="&#x2F;docs&#x2F;" class="
            ">
            Documentation
        </a>
        
        
        
        
        
        <div class="section-wrap">
            <input id="ecosystem-submenu-checkbox" type="checkbox" class="submenu-checkbox" aria-hidden="true"
                >
            <label for="ecosystem-submenu-checkbox" class="submenu-title">Ecosystem <div class="arrow">
                </div></label>

            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;clients&#x2F;">Clients</a>
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;bridges&#x2F;">Bridges</a>
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;servers&#x2F;">Servers</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;bots&#x2F;">Bots</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;sdks&#x2F;">SDKs</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;hosting&#x2F;">Hosting</a>
                    
                </div>
            </div>
        </div>
        
        
        
        <a href="&#x2F;podcasts&#x2F;" class="
            ">
            Podcasts
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;shop.matrix.org" class="
            ">
            Shop
        </a>
        
        
        
        <a href="&#x2F;try-matrix&#x2F;" class="primary
            ">
            Try Matrix
        </a>
        
        
    </nav>
</header>


    <main>
        
<div id="taxonomy-single">
    <div class="content">
        <header>
            <h1>Releases</h1>
            132 posts tagged with "Releases" <a href="/category">(See all Category)</a>
            
            <h2>
                <small><a href="/category/releases/atom.xml">Atom Feed</a></small>
            </h2>
            
        </header>

        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;11&#x2F;17&#x2F;synapse-1-47-0-released&#x2F;" title="Synapse 1.47.0 released">Synapse 1.47.0 released</a></h2>
                <span>
                    17.11.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/david-robertson">
                        David Robertson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p><a href="https://github.com/matrix-org/synapse/releases/tag/v1.47.0">Synapse 1.47.0</a> is out now!</p>
<blockquote>
<p><strong>NOTE:</strong> We anticipate publishing a <strong>security release</strong>, Synapse 1.47.1, on the coming Tuesday, the 23rd of November.</p>
<p>Synapse 1.47.1 will contain a fix for a high severity issue.</p>
</blockquote>
<p>Synapse 1.47.0 features additions to the admin and module APIs, a plethora of fixes for long-standing bugs, and a raft of internal improvements. Server administrators should note that this release removes a deprecated API for deleting a room and deprecates a module callback. Consult the <a href="https://matrix-org.github.io/synapse/develop/upgrade#upgrading-to-v1470">upgrade notes</a> for more details.</p>
<h2 id="new-admin-and-module-apis">New <a href="https://matrix-org.github.io/synapse/latest/usage/administration/admin_api/index.html">admin</a> and <a href="https://matrix-org.github.io/synapse/latest/modules/index.html">module</a> APIs</h2>
<p>Administrators can now <a href="https://github.com/matrix-org/synapse/issues/11099">search for rooms by their ID or alias</a>. We hope this will be particularly useful for projects like <a href="https://github.com/Awesome-Technologies/synapse-admin">synapse-admin</a>! We've also exposed an API to allow admins to <a href="https://github.com/matrix-org/synapse/pull/11263">control Synapse's background updates</a>.  And while it's not strictly an API change, there's a small <a href="https://github.com/matrix-org/synapse/pull/11211/files">patch</a> which makes it easier for homeservers to redirect matrix traffic to port 443.</p>
<p>Authors of pluggable modules have some new toys to play with. There's <a href="https://github.com/matrix-org/synapse/pull/11126">a way to listen for new events</a>; a means to <a href="https://github.com/matrix-org/synapse/pull/11204">retrieve room state</a> and the ability to edit a <a href="https://github.com/matrix-org/synapse/pull/11147">user's membership of a room</a>.</p>
<h2 id="bug-fixes-and-refactors">Bug Fixes and Refactors</h2>
<p>We fixed a variety of different bugs in this release, many of which were long-standing. It's good to see them dealt with! Worth mentioning in particular:</p>
<ul>
<li>Improvements to <a href="https://github.com/matrix-org/synapse/pull/10097">the</a> <a href="https://github.com/matrix-org/synapse/pull/11199">handling</a> of the <code>device_inbox</code> table, which trim redundant data to reduce database bloat.</li>
<li>Fixes related to <a href="https://github.com/matrix-org/synapse/pull/11255">restarting</a> <a href="https://github.com/matrix-org/synapse/pull/11262">workers</a>, to ensure a more reliable upgrade process.</li>
<li>Fix being <a href="https://github.com/matrix-org/synapse/issues/11135">unable to join certain v1 rooms</a>, e.g. <code>#NextCloud:matrix.org</code>, whose state contained floating point numbers.</li>
<li><a href="https://github.com/matrix-org/synapse/pull/11207">Fix serialisation and duplication errors</a> when sending ephemeral events to application services.</li>
</ul>
<p>Additionally, work continues on improving type-checking coverage, both <a href="https://github.com/matrix-org/synapse/pull/11205">in</a> <a href="https://github.com/matrix-org/synapse/pull/11164">Synapse</a> and <a href="https://github.com/matrix-org/sygnal/pull/264">in</a> <a href="https://github.com/matrix-org/sygnal/pull/271">Sygnal</a>.</p>
<h2 id="sydent-2-5-1">Sydent 2.5.1</h2>
<p>This week also saw the release of <a href="https://github.com/matrix-org/sydent/releases/tag/v2.5.1">Sydent 2.5.1</a>, the reference implementation of a Matrix Identity Server. This is a minor release which mainly tidies up error handling to reduce the amount of noise in logs. It should also make it easier for us to diagnose some outstanding bugs which remain to be squashed.</p>
<h2 id="everything-else">Everything Else</h2>
<p>In the background, we're still working away at implementing <a href="https://github.com/matrix-org/matrix-doc/pull/3440">MSC3440</a> to facilitate threading. Early tests are promising. We're also exploring <a href="https://github.com/matrix-org/matrix-doc/pull/2775">MSC2775</a> as a means to speed up room joins. Both will be long term projects that should hopefully reap major rewards for the Matrix ecosystem. Lastly, there's support for <a href="https://github.com/matrix-org/matrix-doc/pull/3288">MSC3228</a> to allow identity servers to provide bespoke invites to spaces. We mentioned this <a href="https://matrix.org/blog/2021/11/02/synapse-1-46-0-released#sydent-250">last time</a> in Sydent release notes; now we've got support for it on the Synapse side.</p>
<p>Please see the Synapse <a href="https://github.com/matrix-org/synapse/blob/v1.47.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/dklimpel">Dirk Klimpel</a>, <a href="https://github.com/JohannesKleine">JohannesKleine</a>, <a href="https://github.com/l00ptr">l00ptr</a>, <a href="https://github.com/Fizzadar">Nick Barrett</a>, <a href="https://github.com/rogersheu">rogersheu</a>,
<a href="https://github.com/samuel-p">Samuel Philipp</a>, <a href="https://github.com/samip5">Skyler Mäntysaari</a> and <a href="https://github.com/sumnerevans">Sumner Evans</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;11&#x2F;09&#x2F;matrix-v1-1-release&#x2F;" title="Matrix v1.1 release">Matrix v1.1 release</a></h2>
                <span>
                    09.11.2021 21:28
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/travis-ralston">
                        Travis Ralston
                    </a>
                </span>
                <br>
                <small>Last update: 09.11.2021 16:06</small>
            </header>
            <div>
                
                <p>Hey all,</p>
<p>Once again it's been <a href="https://matrix.org/blog/2020/05/27/room-version-6-client-server-r-0-6-1-and-federation-r-0-1-4-spec-releases">a little while</a> since we've done a spec release (sorry; we're aiming for quarterly releases from here on out), but this time we have some pretty big news: we've got an <a href="https://spec.matrix.org">all-new spec platform</a> and a new versioning scheme. The new spec platform has been needed for a long time to make better sense of what Matrix is, and as part of getting that out the door we reduced the number of &quot;Matrix versions&quot; to just one.</p>
<p>Huge thanks to Will Bamberg for building it out for us, anoa for working out the deployment details, and everyone for testing it all. They talk at length about what this specification even is and about the platform itself on <a href="https://www.youtube.com/watch?v=gsdMgXug7u8">Matrix Live S6E19</a>. It's the single greatest improvement to the spec we've seen to date.</p>
<p>The new versioning scheme presents the whole specification as a single document, making it easier to check compatibility between implementations and the spec itself. Previously, a grid would have to be drawn to show whether Server-Server r0.1.4 is compatible with Client-Server r0.6.1 - while obvious at release time, the historical context gets lost quite easily. Now, with a single version number, the entire specification is compatible across a single version number: servers implementing Matrix 1.1 will be compatible with clients implementing v1.1, and vice versa. For the specification itself, this means we no longer have to carefully point and update links between the APIs, as they'll instead be versioned together.</p>
<p>Changing the versioning of the specification does have an impact on the Client-Server API in particular, however. You may have noticed that Client-Server APIs are currently versioned at &quot;r0&quot;. By removing rX.Y.Z versioning, all of the endpoints suddenly don't have a version to reference. All endpoints across the specification are now versioned individually to allow for breaking changes at the endpoint level. They no longer require the whole specification to be listed as a breaking change: a v1 endpoint can get additions/changes which are backwards compatible, but if we need to change format (for example) then it'll get bumped up to v2, leaving v1 in its last known state.</p>
<p>For the Client-Server API, a slight complication is that v1 and v2 (alpha) are already versions familiar to those that have been around for a while - to avoid confusing those people, existing Client-Server API endpoints will start at v3. New endpoints introduced after v1.1 will start at v1 instead.</p>
<p>It's been well over a year since the last release, which means there's a whole lot of features and changes to cover. Here we'll try to cover the things most clients/servers will have to worry about, but we do still recommend reading through the changelog included below. Overall, 28 MSCs have been merged through this release, but some have had to be excluded in the interest of getting the spec release out there. Many of them are expected to be in the next anticipated release (which should hopefully be next quarter).</p>
<h2 id="clients-there-s-a-lot-of-stuff">Clients: There's a lot of stuff</h2>
<p>In Matrix 1.1, client developers get all sorts of new features to play with. Clients which support end-to-end encryption should explore <strong><a href="https://spec.matrix.org/v1.1/client-server-api/#server-side-key-backups">key backups</a></strong>, <strong><a href="https://spec.matrix.org/v1.1/client-server-api/#cross-signing">cross-signing</a></strong>, <strong><a href="https://spec.matrix.org/v1.1/client-server-api/#secrets">SSSS</a></strong>, and <strong><a href="https://spec.matrix.org/v1.1/client-server-api/#key-verification-framework">breaking changes to verification</a></strong>. Quite a lot of this stuff has existed for a while, but has made it into the specification formally now. As an added bonus, the emoji for SAS verification <a href="https://github.com/matrix-org/matrix-doc/tree/master/data-definitions">have been translated</a> (<a href="https://translate.element.io/projects/matrix-doc/sas-emoji-v1/">contribute here</a>).</p>
<p>Knocking has also landed in the spec (thanks Sorunome for leading the charge on this!), opening up the ability for rooms to optionally allow people to request invites to join. This can be helpful for semi-private rooms where it can be easier to approve/deny requests compared to finding someone's MXID and manually inviting them. This does require a <a href="https://spec.matrix.org/v1.1/rooms/v7/">v7 room</a> to work, however.</p>
<p>Thanks again to Sorunome, <a href="https://spec.matrix.org/v1.1/client-server-api/#spoiler-messages">Message Spoilers</a> have been officially included in Matrix. People can now safely discuss the ending to the latest movie without being banned for spoilers. Though, as a new feature, there's a chance that the spoiler text still gets included in the message: clients should update as soon as possible to avoid their users accidentally getting banned for spoiling the conclusion to the <a href="https://github.com/matrix-org/matrix-doc/pull/1772">Spaces saga</a> ;)</p>
<p>There's a few other smaller improvements/additions, and of course the regular &quot;various clarifications and bug fixes&quot; to take a look at. For a sample checklist, check out <a href="https://github.com/vector-im/element-web/issues/16876">element-web's issue</a> on the subject.</p>
<h2 id="servers-knock-knock-it-s-a-new-room-version">Servers: Knock knock, it's a new room version</h2>
<p><a href="https://spec.matrix.org/v1.1/rooms/v7/">Room version 7</a> has landed, bringing forth the ability for users to knock on rooms (requesting an invite to join). The changes are largely scoped to using the reserved keywords for join rules and membership, and are described through the auth rules. Thankfully, the changes over v6 are minimally invasive so should be quick to implement.</p>
<p>Additionally, the <a href="https://spec.matrix.org/v1.1/server-server-api/#end-to-end-encryption">cross-signing bits</a> have been included in the API responses and EDU definitions. <a href="https://matrix.org/blog/2020/05/06/cross-signing-and-end-to-end-encryption-by-default-is-here">Matthew's blog post</a> from last year (it really has been that long...) describes cross-signing and the history of its implementation.</p>
<p>As per usual, there's also various specification errors corrected to aid understanding. <a href="https://github.com/matrix-org/synapse/issues/11079">Synapse has an exhaustive issue</a> to detail what servers might need to do.</p>
<p><em>PS: Room versions 8 and 9 are also out there, but will be included in a future spec release.</em></p>
<h2 id="the-full-changelog">The full changelog</h2>
<p>We haven't mentioned identity servers, bridges, etc in this post but they have changes too! Below is the whole changelog, the entire year and a bit of it. Thank you to everyone who has submitted MSCs, and congratulations on getting them released. If we forgot yours, please mention it in <a href="https://matrix.to/#/#matrix-spec:matrix.org">#matrix-spec:matrix.org</a> so we can apologize and correct.</p>
<p>PS: The MSC process is how changes to Matrix are made, and you (yes, you) can propose those changes too. Check out the <a href="https://www.youtube.com/watch?v=SFkZz60RRfc">Matrix Live episode</a> where Matthew talks about how this process works, and how we avoid blocking clients from implementing their proposals behind the relatively slow spec release cycles.</p>
<h3 id="client-server-api">Client-Server API</h3>
<p><strong>Breaking Changes</strong></p>
<ul>
<li>Document <code>curve25519-hkdf-sha256</code> key agreement method for SAS verification, and deprecate old method as per <a href="https://github.com/matrix-org/matrix-doc/pull/2630">MSC2630</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/2687">#2687</a>)</li>
<li>Add <code>m.key.verification.ready</code> and <code>m.key.verification.done</code> to key verification framework as per <a href="https://github.com/matrix-org/matrix-doc/pull/2366">MSC2366</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3139">#3139</a>)</li>
</ul>
<p><strong>Deprecations</strong></p>
<ul>
<li>Deprecate starting verifications that don't start with <code>m.key.verification.request</code> as per <a href="https://github.com/matrix-org/matrix-doc/pull/3122">MSC3122</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3199">#3199</a>)</li>
</ul>
<p><strong>New Endpoints</strong></p>
<ul>
<li>Add key backup (<code>/room_keys/*</code>) endpoints as per <a href="https://github.com/matrix-org/matrix-doc/pull/1219">MSC1219</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/2387">#2387</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/2639">#2639</a>)</li>
<li>Add <code>POST /keys/device_signing/upload</code> and <code>POST /keys/signatures/upload</code> as per <a href="https://github.com/matrix-org/matrix-doc/pull/1756">MSC1756</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/2536">#2536</a>)</li>
<li>Add <code>/knock</code> endpoint as per <a href="https://github.com/matrix-org/matrix-doc/pull/2403">MSC2403</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3154">#3154</a>)</li>
<li>Add <code>/login/sso/redirect/{idpId}</code> as per <a href="https://github.com/matrix-org/matrix-doc/pull/2858">MSC2858</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3163">#3163</a>)</li>
</ul>
<p><strong>Removed Endpoints</strong></p>
<ul>
<li>Remove unimplemented <code>m.login.oauth2</code> and <code>m.login.token</code> user-interactive authentication mechanisms as per <a href="https://github.com/matrix-org/matrix-doc/pull/2610">MSC2610</a> and <a href="https://github.com/matrix-org/matrix-doc/pull/2611">MSC2611</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/2609">#2609</a>)</li>
</ul>
<p><strong>Backwards Compatible Changes</strong></p>
<ul>
<li>Document how clients can advise recipients that it is withholding decryption keys as per <a href="https://github.com/matrix-org/matrix-doc/pull/2399">MSC2399</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/2399">#2399</a>)</li>
<li>Add cross-signing properties to the response of <code>POST /keys/query</code> as per <a href="https://github.com/matrix-org/matrix-doc/pull/1756">MSC1756</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/2536">#2536</a>)</li>
<li>Document Secure Secret Storage and Sharing as per <a href="https://github.com/matrix-org/matrix-doc/pull/1946">MSC1946</a> and <a href="https://github.com/matrix-org/matrix-doc/pull/2472">MSC2472</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/2597">#2597</a>)</li>
<li>Add a <code>device_id</code> parameter to login fallback as per <a href="https://github.com/matrix-org/matrix-doc/pull/2604">MSC2604</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/2709">#2709</a>)</li>
<li>Added a common set of translations for SAS Emoji. (<a href="https://github.com/matrix-org/matrix-doc/issues/2728">#2728</a>)</li>
<li>Added support for <code>reason</code> on all membership events and related endpoints as per <a href="https://github.com/matrix-org/matrix-doc/pull/2367">MSC2367</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/2795">#2795</a>)</li>
<li>Add a 404 <code>M_NOT_FOUND</code> error to push rule endpoints as per <a href="https://github.com/matrix-org/matrix-doc/pull/2663">MSC2663</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/2796">#2796</a>)</li>
<li>Make <code>reason</code> and <code>score</code> parameters optional in the content reporting API as per <a href="https://github.com/matrix-org/matrix-doc/pull/2414">MSC2414</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/2807">#2807</a>)</li>
<li>Allow guests to get the list of members for a room as per <a href="https://github.com/matrix-org/matrix-doc/pull/2689">MSC2689</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/2808">#2808</a>)</li>
<li>Add support for spoilers as per <a href="https://github.com/matrix-org/matrix-doc/pull/2010">MSC2010</a> and <a href="https://github.com/matrix-org/matrix-doc/pull/2557">MSC2557</a>, and <code>color</code> attribute as per <a href="https://github.com/matrix-org/matrix-doc/pull/2422">MSC2422</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3098">#3098</a>)</li>
<li>Add <code>&lt;details&gt;</code> and <code>&lt;summary&gt;</code> to the suggested HTML subset as per <a href="https://github.com/matrix-org/matrix-doc/pull/2184">MSC2184</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3100">#3100</a>)</li>
<li>Add key verification using in-room messages as per <a href="https://github.com/matrix-org/matrix-doc/pull/2241">MSC2241</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3139">#3139</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/3150">#3150</a>)</li>
<li>Add information about using SSSS for cross-signing and key backup. (<a href="https://github.com/matrix-org/matrix-doc/issues/3147">#3147</a>)</li>
<li>Add key verification method using QR codes as per <a href="https://github.com/matrix-org/matrix-doc/pull/1544">MSC1544</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3149">#3149</a>)</li>
<li>Document how clients can simplify usage of Secure Secret Storage as per <a href="https://github.com/matrix-org/matrix-doc/pull/2874">MSC2874</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3151">#3151</a>)</li>
<li>Add support for knocking, as per <a href="https://github.com/matrix-org/matrix-doc/pull/2403">MSC2403</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3154">#3154</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/3254">#3254</a>)</li>
<li>Multiple SSO providers are possible through <code>m.login.sso</code> as per <a href="https://github.com/matrix-org/matrix-doc/pull/2858">MSC2858</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3163">#3163</a>)</li>
<li>Add <code>device_id</code> to <code>/account/whoami</code> response as per <a href="https://github.com/matrix-org/matrix-doc/pull/2033">MSC2033</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3166">#3166</a>)</li>
<li>Downgrade identity server discovery failures to <code>FAIL_PROMPT</code> as per <a href="https://github.com/matrix-org/matrix-doc/pull/2284">MSC2284</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3169">#3169</a>)</li>
<li>Re-version all endpoints to be <code>v3</code> as a starting point instead of <code>r0</code> as per <a href="https://github.com/matrix-org/matrix-doc/pull/2844">MSC2844</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3421">#3421</a>)</li>
</ul>
<p><strong>Spec Clarifications</strong></p>
<ul>
<li>Fix issues with <code>age</code> and <code>unsigned</code> being shown in the wrong places. (<a href="https://github.com/matrix-org/matrix-doc/issues/2591">#2591</a>)</li>
<li>Fix definitions for room version capabilities. (<a href="https://github.com/matrix-org/matrix-doc/issues/2592">#2592</a>)</li>
<li>Fix various typos throughout the specification. (<a href="https://github.com/matrix-org/matrix-doc/issues/2594">#2594</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/2599">#2599</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/2809">#2809</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/2878">#2878</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/2885">#2885</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/2888">#2888</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/3116">#3116</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/3339">#3339</a>)</li>
<li>Clarify link to OpenID Connect specification. (<a href="https://github.com/matrix-org/matrix-doc/issues/2605">#2605</a>)</li>
<li>Clarify the behaviour of SSO login and UI-Auth. (<a href="https://github.com/matrix-org/matrix-doc/issues/2608">#2608</a>)</li>
<li>Remove spurious <code>room_id</code> from <code>/sync</code> examples. (<a href="https://github.com/matrix-org/matrix-doc/issues/2629">#2629</a>)</li>
<li>Reorganize information in Push Notifications module for clarity. (<a href="https://github.com/matrix-org/matrix-doc/issues/2634">#2634</a>)</li>
<li>Improve consistency and clarity of event schema <code>title</code>s. (<a href="https://github.com/matrix-org/matrix-doc/issues/2647">#2647</a>)</li>
<li>Fix schema issues in <code>m.key.verification.accept</code> and secret storage. (<a href="https://github.com/matrix-org/matrix-doc/issues/2653">#2653</a>)</li>
<li>Reword &quot;UI Authorization&quot; to &quot;User-Interactive Authentication&quot; to be more clear. (<a href="https://github.com/matrix-org/matrix-doc/issues/2667">#2667</a>)</li>
<li>Fix schemas for push rule actions to represent their alternative object form. (<a href="https://github.com/matrix-org/matrix-doc/issues/2669">#2669</a>)</li>
<li>Fix usage of <code>highlight</code> tweak for consistency. (<a href="https://github.com/matrix-org/matrix-doc/issues/2670">#2670</a>)</li>
<li>Clarify the behaviour of <code>state</code> for <code>/sync</code> with lazy-loading. (<a href="https://github.com/matrix-org/matrix-doc/issues/2754">#2754</a>)</li>
<li>Clarify description of <code>m.room.redaction</code> event. (<a href="https://github.com/matrix-org/matrix-doc/issues/2814">#2814</a>)</li>
<li>Mark <code>messages</code> as a required JSON body field in <code>PUT /_matrix/client/r0/sendToDevice/{eventType}/{txnId}</code> calls. (<a href="https://github.com/matrix-org/matrix-doc/issues/2928">#2928</a>)</li>
<li>Correct examples of <code>client_secret</code> request body parameters so that they do not include invalid characters. (<a href="https://github.com/matrix-org/matrix-doc/issues/2985">#2985</a>)</li>
<li>Fix example MXC URI for <code>m.presence</code>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3091">#3091</a>)</li>
<li>Clarify that event bodies are untrusted, as per <a href="https://github.com/matrix-org/matrix-doc/pull/2801">MSC2801</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3099">#3099</a>)</li>
<li>Fix the maximum event size restriction (65535 bytes -&gt; 65536). (<a href="https://github.com/matrix-org/matrix-doc/issues/3127">#3127</a>)</li>
<li>Update <code>Access-Control-Allow-Headers</code> recommendation to fit CORS specification. (<a href="https://github.com/matrix-org/matrix-doc/issues/3225">#3225</a>)</li>
<li>Explicitly state that <code>replacement_room</code> is a room ID in <code>m.room.tombstone</code> events. (<a href="https://github.com/matrix-org/matrix-doc/issues/3233">#3233</a>)</li>
<li>Clarify that all request bodies are required. (<a href="https://github.com/matrix-org/matrix-doc/issues/3238">#3238</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/3332">#3332</a>)</li>
<li>Add missing titles to some scheams. (<a href="https://github.com/matrix-org/matrix-doc/issues/3330">#3330</a>)</li>
<li>Add User-Interactive Authentication fields to cross-signing APIs as per <a href="https://github.com/matrix-org/matrix-doc/pull/1756">MSC1756</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3331">#3331</a>)</li>
<li>Mention that a canonical alias event should be added when a room is created with an alias. (<a href="https://github.com/matrix-org/matrix-doc/issues/3337">#3337</a>)</li>
<li>Add an 'API conventions' section to the Appendices. (<a href="https://github.com/matrix-org/matrix-doc/issues/3350">#3350</a>)</li>
<li>Clarify the documentation around the pagination tokens used by <code>/sync</code>, <code>/rooms/{room_id}/messages</code>, <code>/initialSync</code>, <code>/rooms/{room_id}/initialSync</code>, and <code>/notifications</code>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3353">#3353</a>)</li>
<li>Remove the inaccurate 'Pagination' section. (<a href="https://github.com/matrix-org/matrix-doc/issues/3366">#3366</a>)</li>
<li>Clarify how <code>redacted_because</code> is meant to work. (<a href="https://github.com/matrix-org/matrix-doc/issues/3411">#3411</a>)</li>
<li>Remove extraneous <code>mimetype</code> from <code>EncryptedFile</code> examples, as per <a href="https://github.com/matrix-org/matrix-doc/pull/2582">MSC2582</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3412">#3412</a>)</li>
<li>Describe how <a href="https://github.com/matrix-org/matrix-doc/pull/2844">MSC2844</a> affects the <code>/versions</code> endpoint. (<a href="https://github.com/matrix-org/matrix-doc/issues/3420">#3420</a>)</li>
<li>Fix documentation errors around <code>threepid_creds</code>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3471">#3471</a>)</li>
</ul>
<h3 id="server-server-api">Server-Server API</h3>
<p><strong>New Endpoints</strong></p>
<ul>
<li>Add <code>/make_knock</code> and <code>/send_knock</code> endpoints as per <a href="https://github.com/matrix-org/matrix-doc/pull/2403">MSC2403</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3154">#3154</a>)</li>
</ul>
<p><strong>Backwards Compatible Changes</strong></p>
<ul>
<li>Add cross-signing information to <code>GET /user/keys</code> and <code>GET /user/devices/{userId}</code>, <code>m.device_list_update</code> EDU, and a new <code>m.signing_key_update</code> EDU as per <a href="https://github.com/matrix-org/matrix-doc/pull/1756">MSC1756</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/2536">#2536</a>)</li>
<li>Add support for knocking, as per <a href="https://github.com/matrix-org/matrix-doc/pull/2403">MSC2403</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3154">#3154</a>)</li>
</ul>
<p><strong>Spec Clarifications</strong></p>
<ul>
<li>Specify that <code>GET /_matrix/federation/v1/make_join/{roomId}/{userId}</code> can return a 404 if the room is unknown. (<a href="https://github.com/matrix-org/matrix-doc/issues/2688">#2688</a>)</li>
<li>Fix various typos throughout the specification. (<a href="https://github.com/matrix-org/matrix-doc/issues/2888">#2888</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/3116">#3116</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/3128">#3128</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/3207">#3207</a>)</li>
<li>Correct the <code>/_matrix/federation/v1/user/devices/{userId}</code> response which actually returns <code>&quot;self_signing_key&quot;</code> instead of <code>&quot;self_signing_keys&quot;</code>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3312">#3312</a>)</li>
<li>Explain the reasons why <code>&lt;hostname&gt;</code> TLS certificate is needed rather than <code>&lt;delegated_hostname&gt;</code> for SRV delegation. (<a href="https://github.com/matrix-org/matrix-doc/issues/3322">#3322</a>)</li>
<li>Tweak the example PDU diagram to better demonstrate situations with multiple <code>prev_events</code>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3340">#3340</a>)</li>
</ul>
<h3 id="application-service-api">Application Service API</h3>
<p><strong>Spec Clarifications</strong></p>
<ul>
<li>Fix various typos throughout the specification. (<a href="https://github.com/matrix-org/matrix-doc/issues/2888">#2888</a>)</li>
</ul>
<h3 id="identity-service-api">Identity Service API</h3>
<p><strong>New Endpoints</strong></p>
<ul>
<li>Add <code>GET /_matrix/identity/versions</code> API as per <a href="https://github.com/matrix-org/matrix-doc/pull/2320">MSC2320</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3101">#3101</a>)</li>
</ul>
<p><strong>Removed Endpoints</strong></p>
<ul>
<li>The v1 identity service API has been removed in favour of the v2 API, as per <a href="https://github.com/matrix-org/matrix-doc/pull/2713">MSC2713</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3170">#3170</a>)</li>
</ul>
<p><strong>Spec Clarifications</strong></p>
<ul>
<li>Fix various typos throughout the specification. (<a href="https://github.com/matrix-org/matrix-doc/issues/2888">#2888</a>)</li>
<li>Clarify that some identifiers must be case folded prior to processing, as per <a href="https://github.com/matrix-org/matrix-doc/pull/2265">MSC2265</a>. (<a href="https://github.com/matrix-org/matrix-doc/issues/3167">#3167</a>, <a href="https://github.com/matrix-org/matrix-doc/issues/3176">#3176</a>)</li>
<li>Describe how <a href="https://github.com/matrix-org/matrix-doc/pull/2844">MSC2844</a> affects the <code>/versions</code> endpoint. (<a href="https://github.com/matrix-org/matrix-doc/issues/3459">#3459</a>)</li>
</ul>
<h3 id="push-gateway-api">Push Gateway API</h3>
<p><strong>Spec Clarifications</strong></p>
<ul>
<li>Clarify where to get information about the various parameter values for the notify endpoint. (<a href="https://github.com/matrix-org/matrix-doc/issues/2763">#2763</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;11&#x2F;02&#x2F;synapse-1-46-0-released&#x2F;" title="Synapse 1.46.0 released">Synapse 1.46.0 released</a></h2>
                <span>
                    02.11.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.46.0 is out now and includes support for Ubuntu 21.10: Impish Indri.</p>
<p>This release includes a fix for a <a href="https://github.com/matrix-org/synapse/issues/11049">performance regression</a> that surfaced in Synapse 1.44.</p>
<h2 id="progress-on-threading">Progress on Threading</h2>
<p>While still disabled by default, we're beginning to land code in Synapse to support threaded discussions in Matrix. In particular, the <code>m.thread</code> event relationship defined in <a href="https://github.com/matrix-org/matrix-doc/pull/3440">MSC3440</a> is now implemented behind a configuration flag.</p>
<p>There are still many open questions here, and MSC3440 has not yet been approved to merge into the Matrix spec, but it's a start. Threading is essential to Matrix's continued growth and adoption, and we're excited to provide server-side support to this effort.</p>
<h2 id="bug-fixes-and-refactors">Bug Fixes and Refactors</h2>
<p>This release is mostly comprised of bug fixes and improvements to static typing. Of note:</p>
<ul>
<li>The <code>export-data</code> admin command now works and is tested in CI. This command helps server administrators respond to GDPR Subject Access Requests.</li>
<li>A weeks-long effort to refactor how Synapse validates the <code>auth_events</code> field of incoming PDUs has concluded, resolving a few corner cases which could incorrectly allow events into the room state which should instead be rejected.</li>
<li>Further static type hints have been added to Synapse, improving our precise type coverage to 85% of all lines. Currently, 13% of the Python files in <code>synapse/</code> are skipped during mypy runs. We'd like to cut this in half by the end of the year, as well as increasing overall precise coverage in the codebase.</li>
</ul>
<h2 id="sydent-2-5-0">Sydent 2.5.0</h2>
<p>This week also saw the release of <a href="https://github.com/matrix-org/sydent/releases/tag/v2.5.0">Sydent 2.5.0</a>, the reference implementation of a Matrix Identity Server. In addition to fixing bugs, Sydent 2.5.0 passes <code>mypy --strict</code>, uses Jinja2 for templates, and supports the <code>room_type</code> field from <a href="https://github.com/matrix-org/matrix-doc/pull/3288">MSC3288</a> to better differentiate between invitations to rooms and invitations to Spaces.</p>
<h2 id="everything-else">Everything Else</h2>
<ul>
<li>The Admin API to <a href="https://matrix-org.github.io/synapse/v1.46/admin_api/user_admin_api.html#create-or-modify-account">create or modify accounts</a> now accepts a <code>user_type</code> field, allowing for accounts to be set as belonging to bots or support staff.</li>
<li><a href="https://matrix-org.github.io/synapse/v1.46/modules/password_auth_provider_callbacks.html">Password auth providers</a> can now be implemented using the new pluggable extension module APIs.</li>
</ul>
<p>Please see the Synapse <a href="https://github.com/matrix-org/synapse/blob/v1.46.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/aaronraimist">aaronraimist</a>, <a href="https://github.com/AndrewFerr">AndrewFerr</a>, <a href="https://github.com/dklimpel">dklimpel</a>, and <a href="https://github.com/Legogris">Legogris</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;10&#x2F;20&#x2F;synapse-1-45-1-released&#x2F;" title="Synapse 1.45.1 released">Synapse 1.45.1 released</a></h2>
                <span>
                    20.10.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.45.1 is out now! Python 3.10 and PostgreSQL 14 are now tested and supported by Synapse. Support for Python 3.6 and PostgreSQL 9.6 will be removed by the end of the year.</p>
<blockquote>
<p><strong>Note:</strong> This release may require changes to how media storage providers access your homeserver's configuration. See the <a href="https://matrix-org.github.io/synapse/v1.45/upgrade.html#upgrading-to-v1450">Upgrade Notes</a> for more information.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> Synapse 1.45.0 was released yesterday and <a href="https://github.com/matrix-org/synapse/pull/10947">changed</a> how Synapse's monthly active user limits were calculated. Today's release of 1.45.1 <a href="https://github.com/matrix-org/synapse/pull/11127">reverts</a> that change, but is otherwise identical to 1.45.0.</p>
</blockquote>
<h2 id="support-for-oembed-autodiscovery">Support for oEmbed Autodiscovery</h2>
<p>Synapse can now automatically discover rich metadata when generating previews of links to sites which support <a href="https://oembed.com">oEmbed</a>.</p>
<p>Before:</p>
<p><img src="/blog/img/2021-10-20-synapse-1.44-link-preview.png" alt="synapse-1.44-link-preview" /></p>
<p>After:</p>
<p><img src="/blog/img/2021-10-20-synapse-1.45-link-preview.png" alt="synapse-1.45-link-preview" /></p>
<p>Note that URL previews are generated server-side, and thus generally disabled in encrypted rooms to avoid leaking information about message content to your homeserver. You may need to adjust the room's settings to see the new oEmbed previews.</p>
<h2 id="fixing-stuck-messages">Fixing Stuck Messages</h2>
<p>This release of Synapse <a href="https://github.com/matrix-org/synapse/issues/9424">fixes a race condition</a> which would occasionally prevent your sent events from syncing back down to all of your clients. This caused messages to look like they were stuck at the bottom of the room, waiting to finish sending, even though other users would receive and see them normally.</p>
<h2 id="improved-privacy-for-per-room-nicknames">Improved Privacy for Per-Room Nicknames</h2>
<p>Matrix allows users to set their display names to be different things in different rooms. For example, you might use an alias in public rooms, but your real name in rooms shared with friends and family.</p>
<p>To make it easy to initiate conversations with people, each homeserver maintains a user directory with the Matrix ID, display name, and avatar of the users it sees. Previously, this directory would be updated with the most recent profile metadata that Synapse had seen for a user, even if it was only changed in a single room.</p>
<p>As of 1.45, Synapse only uses includes the <em>default</em> display name of local users in its user directory, ignoring room-specific nicknames or avatars. (<a href="https://github.com/matrix-org/synapse/issues/5677">#5677</a>).</p>
<h2 id="internals">Internals</h2>
<p>This release includes numerous fixes and improvements to Synapse's internals.</p>
<ul>
<li>
<p>We've added countless static type annotations to Synapse (and related projects like Sydent), giving us greater confidence in its correctness and reducing maintenance costs. Several modules newly have <em>all</em> of their definitions typed, allowing us to require and enforce complete type coverage for all future edits therein.</p>
</li>
<li>
<p>This release includes meaningful fixes and improvements to our OpenTracing and logging machinery, helping us better catch and eliminate bugs in Synapse. This work ultimately reduced matrix.org's Sentry event volume by an order of magnitude.</p>
</li>
<li>
<p>Magic accessor methods have been removed from Synapse's <code>Config</code> class. Previously, Synapse would interpret references like <code>config.send_federation</code> by attempting to guess a reasonable full path, like <code>config.worker.send_federation</code>. As of Synapse 1.45, the full path must be specified directly. This prevents errors where values could be drawn from unexpected or incorrect sections of the server's configuration.</p>
</li>
</ul>
<h2 id="everything-else">Everything Else</h2>
<p>We'd like to extend a special thanks to Fizzadar from <a href="https://www.beeper.com/">Beeper</a> for improving Synapse's <code>update_synapse_database</code> script (<a href="https://github.com/matrix-org/synapse/pull/10954">#10954</a>) to allow schema changes to occur while Synapse is running. This is a great step toward reducing the downtime associated with upgrades.</p>
<p>These are just the highlights; please see the <a href="https://matrix-org.github.io/synapse/v1.45/upgrade.html#upgrading-to-v1450">Upgrade Notes</a> and <a href="https://github.com/matrix-org/synapse/blob/v1.45.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/AndrewFerr">AndrewFerr</a>, <a href="https://github.com/dklimpel">dklimpel</a>, <a href="https://github.com/Fizzadar">Fizzadar</a>, <a href="https://github.com/lukaslihotzki">lukaslihotzki</a>, and <a href="https://github.com/maxkratz">maxkratz</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;10&#x2F;05&#x2F;synapse-1-44-0-released&#x2F;" title="Synapse 1.44.0 released">Synapse 1.44.0 released</a></h2>
                <span>
                    05.10.2021 23:44
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.44.0 is out now!</p>
<h2 id="loads-of-bug-fixes">Loads of Bug Fixes</h2>
<p>This release primarily includes fixes for over a dozen long-standing bugs. For example:</p>
<ul>
<li>Messages containing null bytes are now properly indexed for search.</li>
<li>The Room Search Admin API now allows searching for rooms with non-ascii titles.</li>
<li>URL preview caches, which are meant to be ephemeral, are no longer mirrored from the local media store into other media providers.</li>
</ul>
<h2 id="faster-json-responses">Faster JSON Responses</h2>
<p>We now stay within C code while generating large JSON objects for responses, which should be substantially faster than the previous technique, which fell back to Python for encoding.</p>
<h2 id="new-extension-module-apis">New Extension Module APIs</h2>
<p>Spam checker modules can now use a <code>user_may_create_room_with_invites</code> callback to inspect room creation events which include invitations to users via Matrix or other media (email, etc.).</p>
<p>Additionally, the ModuleApi can now inspect IP and User Agent data, as well as checking whether Rooms and MXIDs are local to the current homeserver.</p>
<h2 id="everything-else">Everything Else</h2>
<p>We've also been busy refactoring. For example:</p>
<ul>
<li>Prometheus stats now distinguish between cache evictions due to entries expiring, and cache evictions due to the cache being full.</li>
<li>The <code>synapse.handlers</code>, <code>synapse.rest</code>, and <code>synapse.storage.databases.state</code> modules are now fully type annotated and checked by mypy, among others.</li>
<li>The user directory search code was cleaned up in preparation for future fixes.</li>
<li>Another half dozen pull requests were merged with an aim toward clarifying federated event authentication code (and associated logging).</li>
</ul>
<p>Lastly, this release has seen considerable work toward supporting <a href="https://github.com/matrix-org/matrix-doc/pull/2716">MSC2716: Incrementally importing history into existing rooms</a>, along with an update to match the current state of <a href="https://github.com/matrix-org/matrix-doc/pull/3231">MSC3231: Token authenticated registration</a>.</p>
<p>These are just the highlights; please see the <a href="https://matrix-org.github.io/synapse/v1.44/upgrade.html#upgrading-to-v1440">Upgrade Notes</a> and <a href="https://github.com/matrix-org/synapse/blob/v1.44.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/aaronraimist">aaronraimist</a>, <a href="https://github.com/cvwright">cvwright</a>, <a href="https://github.com/govynnus">govynnus</a>, <a href="https://github.com/Kokokokoka">Kokokokoka</a>, and <a href="https://github.com/tulir">tulir</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;09&#x2F;21&#x2F;synapse-1-43-0-released&#x2F;" title="Synapse 1.43.0 released">Synapse 1.43.0 released</a></h2>
                <span>
                    21.09.2021 22:03
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.43.0 is out now!</p>
<h2 id="preparing-for-spaces">Preparing for Spaces</h2>
<p>Quite a lot of work has gone into preparing for Spaces to graduate from beta testing. For example, Synapse now:</p>
<ul>
<li>Asks clients to prefer <a href="https://github.com/matrix-org/matrix-doc/pull/3375">room version 9</a> when creating restricted rooms (<a href="https://github.com/matrix-org/synapse/issues/10772">#10772</a>), via the API defined in <a href="https://github.com/matrix-org/matrix-doc/pull/3244">MSC3244: room version capabilities</a>.</li>
<li>Allows the Spaces Summary APIs to be handled by worker processes.</li>
<li>Omits rooms with unknown room versions from the Spaces Summary.</li>
<li>Properly handles upgrades of Spaces to different room versions.</li>
</ul>
<h2 id="everything-else">Everything Else</h2>
<p>This release of Synapse also:</p>
<ul>
<li>Includes initial work toward fully supporting oEmbed for embedding URL previews (<a href="https://github.com/matrix-org/synapse/issues/10714">#10714</a>, <a href="https://github.com/matrix-org/synapse/issues/10759">#10759</a>).</li>
<li>Slightly speeds up room joins over federation (<a href="https://github.com/matrix-org/synapse/issues/10754">#10754</a>, <a href="https://github.com/matrix-org/synapse/issues/10755">#10755</a>, <a href="https://github.com/matrix-org/synapse/issues/10756">#10756</a>, <a href="https://github.com/matrix-org/synapse/issues/10780">#10780</a>, <a href="https://github.com/matrix-org/synapse/issues/10784">#10784</a>).</li>
<li>Somewhat improves service restart times for large Synapse deployments.</li>
<li>Significantly refactors federation event authentication code for greater clarity (<a href="https://github.com/matrix-org/synapse/issues/10744">#10744</a>, <a href="https://github.com/matrix-org/synapse/issues/10745">#10745</a>, <a href="https://github.com/matrix-org/synapse/issues/10746">#10746</a>, <a href="https://github.com/matrix-org/synapse/issues/10771">#10771</a>, <a href="https://github.com/matrix-org/synapse/issues/10773">#10773</a>, <a href="https://github.com/matrix-org/synapse/issues/10781">#10781</a>).</li>
<li>Adds further static type hints to various modules.</li>
</ul>
<p>We've also spent quite a lot of time on SyTest, our integration test suite. In particular, many of the tests made assumptions about event processing which were not correct when targeting a multi-worker Synapse deployment. These flakey tests have plagued our continuous integration pipelines, and are finally being fixed.</p>
<p>These are just the highlights; please see the <a href="https://github.com/matrix-org/synapse/blob/v1.43.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/AndrewFerr">AndrewFerr</a>, <a href="https://github.com/BramvdnHeuvel">BramvdnHeuvel</a>, and <a href="https://github.com/cuttingedge1109">cuttingedge1109</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;09&#x2F;07&#x2F;synapse-1-42-0-released&#x2F;" title="Synapse 1.42.0 released">Synapse 1.42.0 released</a></h2>
                <span>
                    07.09.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.42.0 is out now!</p>
<p>This release includes changes that you may need to be aware of before upgrading, such as the removal of two deprecated Admin APIs or a retroactive fix to ensure that email notifications are only sent to addresses which are presently associated with an account. Please see the  <a href="https://matrix-org.github.io/synapse/v1.42/upgrade.html#upgrading-to-v1420">Upgrade Notes</a> for details.</p>
<h2 id="room-version-9-a-bugfix-for-restricted-rooms">Room Version 9: A Bugfix for Restricted Rooms</h2>
<p>Synapse 1.42 includes support for <a href="https://github.com/matrix-org/matrix-doc/pull/3375">Room Version 9</a>, which fixes <a href="https://github.com/matrix-org/matrix-doc/issues/3373">an oversight</a> in the list of event fields which were protected from redaction in Room Version 8's <a href="https://github.com/matrix-org/matrix-doc/pull/3083">restricted rooms</a>. This makes it possible, in certain circumstances, for a restricted room to degrade into a state where participating servers will disagree about the room's membership.</p>
<p>Because changing a room version's redaction algorithm also changes the way that event IDs are calculated, properly fixing this issue required the creation of a new room version.</p>
<p>To ensure compatibility with existing servers, Synapse 1.42's <a href="https://github.com/matrix-org/matrix-doc/pull/3244">MSC3244: Room version capabilities</a> hints will continue to ask clients to prefer Room Version 8 when creating restricted rooms and Room Version 6 otherwise. A future release of Synapse will ask clients to prefer Room Version 9 for restricted rooms.</p>
<h2 id="handling-unknown-rooms">Handling Unknown Rooms</h2>
<p>Very rarely, users find themselves in rooms created with unstable or experimental room versions. Then, when Synapse removes support for these versions, bad things happen. The server no longer understands how to interact with that room version, which means <em>you</em> can't interact with that room. And if you can't interact with that room, you can't <em>leave</em>.</p>
<p>In Synapse 1.42, rooms with unknown room versions are no longer returned down <code>/sync</code>. This prevents them from appearing in your client, though you may need to empty your client's cache and re-sync to see any effect.</p>
<h2 id="new-mscs">New MSCs</h2>
<p>In addition to Room Version 9 (<a href="https://github.com/matrix-org/matrix-doc/pull/3375">MSC3375</a>), this release includes:</p>
<ul>
<li>
<p>An initial implementation of <a href="https://github.com/matrix-org/matrix-doc/pull/3231">MSC3231: Token authenticated registration</a>, which makes it possible for homeservers to disable user registration while still allowing new accounts to be made by people who know a pre-shared secret.</p>
<p>This MSC and its implementations were produced as part of a Google Summer of Code (GSoC) project by Callum Brown.</p>
</li>
<li>
<p>An updated implementation of <a href="https://github.com/matrix-org/matrix-doc/pull/2946">MSC2946: Spaces Summary</a> following recent changes to the proposal.</p>
</li>
<li>
<p>Support for <a href="https://github.com/matrix-org/matrix-doc/pull/3283">MSC3283: Expose capabilities for profile actions</a>, which hints to clients whether or not a server allows users to change their display name, avatar, or email address.</p>
</li>
</ul>
<h2 id="everything-else">Everything Else</h2>
<p>In addition to the usual array of improvements to performance, type hints, error messages, and documentation:</p>
<ul>
<li>Custom Presence Router modules can now be built using Synapse's <a href="https://matrix-org.github.io/synapse/v1.42/modules.html#presence-router-callbacks">new, unified module interface</a> which debuted in Synapse 1.37.</li>
<li>Code around federation event handling and authentication has been significantly refactored to improve reliability and maintainability, including extracting nearly 1,800 lines of code from the <code>FederationHandler</code> class into a separate <code>FederationEventHandler</code> class.</li>
<li>Backfilling history and fetching missing events now use the same code paths, reducing the potential for bugs.</li>
<li>Concurrently fetching the same large set of events (<a href="https://github.com/matrix-org/synapse/pull/10703">#10703</a>) is now much more efficient, preventing the process hangs which were possible in prior, extreme cases.</li>
</ul>
<p>These are just the highlights; please see the <a href="https://matrix-org.github.io/synapse/v1.42/upgrade.html#upgrading-to-v1420">Upgrade Notes</a> and <a href="https://github.com/matrix-org/synapse/blob/v1.42.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/aaronraimist">aaronraimist</a>, <a href="https://github.com/dklimpel">dklimpel</a>, <a href="https://github.com/govynnus">govynnus</a>, and <a href="https://github.com/HugoDelval">HugoDelval</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;08&#x2F;31&#x2F;synapse-1-41-1-released&#x2F;" title="Synapse 1.41.1 released">Synapse 1.41.1 released</a></h2>
                <span>
                    31.08.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Today we are releasing Synapse 1.41.1, a security update based on last week's release of <a href="https://matrix.org/blog/2021/08/24/synapse-1-41-0-released">Synapse 1.41.0</a>. This release patches two moderate severity issues which could reveal metadata about private rooms:</p>
<ul>
<li>
<p><strong><a href="https://github.com/matrix-org/synapse/security/advisories/GHSA-3x4c-pq33-4w3q">GHSA-3x4c-pq33-4w3q</a> / CVE-2021-39164: Enumerating a private room's list of members and their display names.</strong></p>
<p>If an unauthorized user both knows the Room ID of a private room <em>and</em> that room's history visibility is set to <code>shared</code>, then they may be able to enumerate the room's members, including their display names.</p>
<p>The unauthorized user must be on the same homeserver as a user who is a member of the target room.</p>
</li>
<li>
<p><strong><a href="https://github.com/matrix-org/synapse/security/advisories/GHSA-jj53-8fmw-f2w2">GHSA-jj53-8fmw-f2w2</a> / CVE-2021-39163: Disclosing a private room's name, avatar, topic, and number of members.</strong></p>
<p>If an unauthorized user knows the Room ID of a private room, then its name, avatar, topic, and number of members may be disclosed through Group / Community features.</p>
<p>The unauthorized user must be on the same homeserver as a user who is a member of the target room, and their homeserver must allow non-administrators to create groups (<code>enable_group_creation</code> in the Synapse configuration; off by default).</p>
</li>
</ul>
<p>Note that in both cases:</p>
<ul>
<li>The private room's Room ID must be known to the attacker.</li>
<li>Another user on the attacker's homeserver must be a legitimate member of the target room.</li>
<li>The information disclosed is <em>already</em> present in the database and thus legitimately known to the administrators of homeservers participating in the target room.</li>
</ul>
<p>We'd like to credit <a href="https://twitter.com/0xkasper">0xkasper</a> for discovering and responsibly disclosing these issues.</p>
<p>This release also fixes a small regression in 1.41.0 (<a href="https://github.com/matrix-org/synapse/issues/10709">#10709</a>) which broke compatibility with older Twisted versions when Synapse was a configured to send email.</p>
<p>Please update at your earliest convenience.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;08&#x2F;24&#x2F;synapse-1-41-0-released&#x2F;" title="Synapse 1.41.0 released">Synapse 1.41.0 released</a></h2>
                <span>
                    24.08.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.41.0 is out now!</p>
<blockquote>
<p><strong>NOTE:</strong> We anticipate publishing a <strong>security release</strong> next Tuesday, the 31st of August.</p>
<p>Synapse 1.41.1 will contain fixes for two moderate severity issues.</p>
</blockquote>
<p>Synapse 1.41 includes changes to forward proxies, template settings, and media workers which may require your attention. Please see the  <a href="https://matrix-org.github.io/synapse/v1.41/upgrade.html#upgrading-to-v1410">Upgrade Notes</a> for details.</p>
<p>Also, this release <strong>removes support for Ubuntu 20.10</strong> (Groovy Gorilla), which reached End of Life last month. Support for Ubuntu 18.04 LTS (Bionic Beaver) and Ubuntu 21.04 (Hirsute Hippo) will be withdrawn near the end of this year under our <a href="https://matrix-org.github.io/synapse/v1.41/deprecation_policy.html">platform deprecation policy</a>.</p>
<h2 id="promoting-restricted-rooms">Promoting Restricted Rooms</h2>
<p>Synapse 1.41 includes experimental support for <a href="https://github.com/matrix-org/matrix-doc/pull/3244">MSC3244: Room version capabilities</a>, which indicates to clients that they should use Room Version 8 when creating <a href="https://github.com/matrix-org/matrix-doc/pull/3083">restricted rooms</a>. For example, Element's clients will use the MSC3244 metadata, which is on by default in Synapse 1.41, to determine whether to show end users the UI for creating restricted rooms.</p>
<p>Room Version 6 will remain the default for newly created rooms which do not explicitly request the restricted room capabilities at creation time. This strikes a balance between the broad compatibility of an older default room version, while still making newer features available upon request.</p>
<h2 id="new-mscs">New MSCs</h2>
<p>This version of Synapse implements experimental support for:</p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/3266">MSC3266: Room summary API</a> which provides a simple way to obtain information about a specific room, such as its join rules, room type, etc.</li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/3288">MSC3288: Add room type in store invite</a> which lets identity servers differentiate between invitations to rooms and invitations to Spaces.</li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/3244">MSC3244: Room version capabilities</a> as described above.</li>
</ul>
<p>We've also added pagination to the Spaces Summary API based on updates to <a href="https://github.com/matrix-org/matrix-doc/pull/2946">MSC2946</a>.</p>
<p>Work towards implementing <a href="https://github.com/matrix-org/matrix-doc/pull/2716">MSC2716: Incrementally importing history into existing rooms</a> continues, with several related pull requests landing in this release.</p>
<h2 id="more-admin-apis">More Admin APIs</h2>
<p>Synapse now has an Admin APIs to:</p>
<ul>
<li><a href="https://matrix-org.github.io/synapse/v1.41/admin_api/user_admin_api.html#delete-media-uploaded-by-a-user">Delete media uploaded by a user</a> from your homeserver's local media storage.</li>
<li><a href="https://matrix-org.github.io/synapse/v1.41/admin_api/user_admin_api.html#create-or-modify-account">Edit the external ids</a> associated with a user by Single Sign-On / OpenID Connect providers.</li>
<li><a href="https://matrix-org.github.io/synapse/v1.41/admin_api/user_admin_api.html#check-username-availability">Check if a username is available</a>, which behaves similarly to the <a href="https://matrix.org/docs/spec/client_server/r0.6.0#get-matrix-client-r0-register-available">related client-server API</a> in the Matrix Spec, but the Admin API version works even when registration is disabled on a homeserver.</li>
</ul>
<h2 id="everything-else">Everything Else</h2>
<p>In addition to the usual boosts to performance and reliability like <a href="https://github.com/matrix-org/synapse/pull/10119">#10119</a> or <a href="https://github.com/matrix-org/synapse/pull/10513">#10513</a>, this release includes several notable improvements:</p>
<ul>
<li>The <code>/createRoom</code> endpoint can now be <a href="https://github.com/matrix-org/synapse/pull/10564">handled by workers</a>.</li>
<li>Synapse can now route outbound federation requests, remote media downloads, and public key fetches through a <a href="https://matrix-org.github.io/synapse/v1.41/setup/forward_proxy.html">forward proxy</a>.</li>
<li>Custom template configuration has now been centralized into a single <code>custom_templates_directory</code> <a href="https://matrix-org.github.io/synapse/v1.41/templates.html">configuration setting</a>.</li>
<li>Matrix clients which allow users to <a href="https://matrix.org/docs/spec/client_server/latest#id64">set a <code>status_msg</code> with their presence</a> will find that Synapse no longer arbitrarily unsets the message when a user goes offline. Instead, each user's <code>status_msg</code> will persist until it is deliberately cleared by their client.</li>
<li>The extension module API now exposes a function, <code>get_userinfo_by_id</code>, which accepts an MXID and returns a <code>UserInfo</code> object. This should simplify writing extension modules like spam checkers.</li>
</ul>
<p>These are just the highlights; please see the <a href="https://matrix-org.github.io/synapse/v1.41/upgrade.html#upgrading-to-v1410">Upgrade Notes</a> and <a href="https://github.com/matrix-org/synapse/blob/v1.41.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/Bubu">Bubu</a>, <a href="https://github.com/dklimpel">dklimpel</a>, <a href="https://github.com/H-Shay">H-Shay</a>, <a href="https://github.com/ilmari">ilmari</a>, <a href="https://github.com/Kentokamoto">Kentokamoto</a>, <a href="https://github.com/SimonBrandner">SimonBrandner</a>, and <a href="https://github.com/warricksothr">warricksothr</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;08&#x2F;10&#x2F;synapse-1-40-0-released&#x2F;" title="Synapse 1.40.0 released">Synapse 1.40.0 released</a></h2>
                <span>
                    10.08.2021 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.40.0 is out now!</p>
<h2 id="support-for-room-version-8">Support for Room Version 8</h2>
<p>This release of Synapse includes stable support for <a href="https://github.com/matrix-org/matrix-doc/pull/3289">Room Version 8</a>! Version 8 codifies a concept of &quot;<a href="https://github.com/matrix-org/matrix-doc/pull/3083">restricted rooms</a>&quot; which are private rooms joinable only by direct invitation or by being a member of other, designated Spaces / rooms.</p>
<p>This means you can create a Matrix Space for your company, team, or guild, and instead of inviting people to the Space <em>and</em> directly to a bunch of private rooms, you can simply configure your private rooms such that membership in the Space <em>automatically</em> confers access to the private rooms.</p>
<p>This is a major improvement to access control in Matrix, and we can't wait to use it ourselves.</p>
<p>Note that client support for managing restricted rooms is still forthcoming, and you'll want to ensure that your users are on homeservers which support v8 before upgrading existing rooms. To ensure compatibility across federation, the default for newly created rooms remains at v6 for the time being.</p>
<h2 id="everything-else">Everything Else</h2>
<p>A few other items worth calling out:</p>
<ul>
<li>Synapse can now optionally recycle PostgreSQL connections after a specified number of transactions (<a href="https://github.com/matrix-org/synapse/pull/10440">#10440</a>), which may mitigate slow memory leaks in the database. Thanks to GitHub user hifi.</li>
<li>We have a whole new documentation page explaining <a href="https://matrix-org.github.io/synapse/v1.40/development/room-dag-concepts.html">Room DAG Concepts</a> like depth, stream ordering, extremities, outliers, and state groups.</li>
<li>The <a href="https://matrix-org.github.io/synapse/v1.40/admin_api/user_admin_api.html#list-accounts">Admin API for listing accounts</a> now returns a <code>creation_ts</code> property indicating when an account was created. Thanks to work by dklimpel.</li>
<li>Synapse should better detect character encodings in URL previews thanks to a contribution by srividyut.</li>
</ul>
<p>In addition to further work towards implementing <a href="https://github.com/matrix-org/matrix-doc/pull/2716">MSC2716: Incrementally Importing History into Existing Rooms</a>, we've landed support for:</p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2033">MSC2033</a>: The <code>/account/whoami</code> endpoint now includes the <code>device_id</code> associated with the access token used to make the request.</li>
<li>(Experimental) <a href="https://github.com/matrix-org/matrix-doc/pull/3244">MSC3244</a>: The <code>/_matrix/client/r0/capabilities</code> endpoint may include metadata about which room versions support which capabilities (like knocking on restricted joins).</li>
<li>(Experimental) <a href="https://github.com/matrix-org/matrix-doc/pull/2285">MSC2285</a>: Clients may mark messages as read on the server without updating their externally visible read receipts, implemented by SimonBrandner.</li>
</ul>
<p>These are just the highlights; please see the <a href="https://github.com/matrix-org/synapse/blob/v1.40.0/CHANGES.md">Release Notes</a> for a complete list of changes in this release.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/dklimpel">dklimpel</a>, <a href="https://github.com/hifi">hifi</a>, <a href="https://github.com/SimonBrandner">SimonBrandner</a>, and <a href="https://github.com/srividyut">srividyut</a>.</p>

                
            </div>
        </article>
        
        <nav class="pagination">
    <div class="prev">
        
        <a href="&#x2F;category&#x2F;releases&#x2F;page&#x2F;3&#x2F;">‹ Previous</a>
        
    </div>
    <span class="page-number">4 / 14</span>
    <div class="prev">
        
        <a href="&#x2F;category&#x2F;releases&#x2F;page&#x2F;5&#x2F;">Next ›</a>
        
    </div>
</nav>

    </div>
</div>

    </main>

    <footer class="site-footer">
    <div class="internal-links">
        
        <a href="&#x2F;faq">FAQs</a>
        
        <a href="&#x2F;security-disclosure-policy">Security Disclosure Policy</a>
        
        <a href="&#x2F;security-hall-of-fame">Security Hall of Fame</a>
        
        <a href="&#x2F;legal&#x2F;code-of-conduct">Code of Conduct for Matrix.org</a>
        
        <a href="&#x2F;legal">Legal</a>
        
        <a href="&#x2F;contact">Contact</a>
        
        <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org&#x2F;matrix.org&#x2F;">Site Source</a>
        
    </div>
    <div class="external-links">
        <div>
            
            <a href="&#x2F;code"><img src="/assets/github.svg" alt="GitHub"></a>
            
            <a href="https:&#x2F;&#x2F;gitlab.matrix.org&#x2F;"><img src="/assets/gitlab.svg" alt="GitLab"></a>
            
            <a href="https:&#x2F;&#x2F;mastodon.matrix.org&#x2F;@matrix"><img src="/assets/mastodon.svg" alt="Mastodon"></a>
            
            <a href="https:&#x2F;&#x2F;twitter.com&#x2F;matrixdotorg"><img src="/assets/twitter.svg" alt="Twitter"></a>
            
            <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCVFkW-chclhuyYRbmmfwt6w"><img src="/assets/youtube.svg" alt="YouTube"></a>
            
        </div>
    </div>
    <p>© 2022 The Matrix.org Foundation C.I.C.</p>
</footer>

</body>

</html>
