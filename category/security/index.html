<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="twitter:widgets:csp" content="on" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="twitter:site" content="@matrixdotorg" />
    <meta name="twitter:creator" content="@matrixdotorg" />

    <title>Matrix.org - Security</title>
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="icon" type="image/png" href="/assets/favicon.png" />
    <link rel="stylesheet" href="/style.css" />

    
<link rel="alternate" type="application/rss+xml" title="RSS" href="/category/security/atom.xml">
</head>

<body>
    
    <header class="site-header">
    <a href="/" class="brand">
        <img src="/images/matrix-logo.svg" alt="Matrix logo">
    </a>
    <input id="site-header-dropdown-checkbox" type="checkbox" class="dropdown-checkbox" aria-hidden="true">
    <label for="site-header-dropdown-checkbox" class="dropdown-button">&#xe602;</label>
    <label for="site-header-dropdown-checkbox" class="page-overlay"></label>
    <nav>
        
        
        <a href="&#x2F;about&#x2F;" class="
            ">
            About
        </a>
        
        
        
        <a href="&#x2F;blog&#x2F;" class="
            ">
            Blog
        </a>
        
        
        
        
        
        <div class="section-wrap">
            <a href="&#x2F;docs&#x2F;" class="section ">
                Documentation
            </a>
            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                </div>
            </div>
        </div>
        
        
        
        
        
        <div class="section-wrap">
            <a href="&#x2F;ecosystem&#x2F;" class="section ">
                Ecosystem
            </a>
            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    <a href="&#x2F;ecosystem&#x2F;clients&#x2F;">Clients</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;servers&#x2F;">Servers</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;bots&#x2F;">Bots</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;bridges&#x2F;">Bridges</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;sdks&#x2F;">SDKs</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;hosting&#x2F;">Hosting</a>
                    
                </div>
            </div>
        </div>
        
        
        
        <a href="&#x2F;podcasts&#x2F;" class="
            ">
            Podcasts
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;shop.matrix.org" class="
            ">
            Shop
        </a>
        
        
        
        <a href="&#x2F;try-matrix&#x2F;" class="primary
            ">
            Try Matrix
        </a>
        
        
    </nav>
</header>


    <main>
        
<div id="taxonomy-single">
    <div class="content">
        <header>
            <h1>Security</h1>
            18 posts tagged with "Security" <a href="/category">(See all Category)</a>
            
            <h2>
                <small><a href="/category/security/atom.xml">Atom Feed</a></small>
            </h2>
            
        </header>

        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2022&#x2F;09&#x2F;28&#x2F;upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients&#x2F;" title="Upgrade now to address E2EE vulnerabilities in matrix-js-sdk, matrix-ios-sdk and matrix-android-sdk2">Upgrade now to address E2EE vulnerabilities in matrix-js-sdk, matrix-ios-sdk and matrix-android-sdk2</a></h2>
                <span>
                    28.09.2022 15:41
                    —
                    <a href="/category/security">
                        Security
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p><strong>TL;DR:</strong></p>
<ul>
<li>Two critical severity vulnerabilities in end-to-end encryption were found in
the SDKs which power Element, Beeper, Cinny, SchildiChat, Circuli, Synod.im
and any other clients based on matrix-js-sdk, matrix-ios-sdk or
matrix-android-sdk2.</li>
<li>These have now been fixed, and we have not seen evidence of them being
exploited in the wild. All of the critical vulnerabilities require
cooperation from a malicious homeserver to be exploited.</li>
<li><strong>Please upgrade immediately in order to be protected against these
vulnerabilities.</strong></li>
<li>Clients with other encryption implementations (including Hydrogen, ElementX,
Nheko, FluffyChat, Syphon, Timmy, Gomuks and Pantalaimon) are not affected;
<strong>this is not a protocol bug</strong>.</li>
<li>We take the security of our end-to-end encryption extremely seriously, and we
have an ongoing series of public independent audits booked to help guard
against future vulnerabilities.  We will also be making some protocol changes
in the future to provide additional layers of protection.</li>
<li>This resolves the <a href="https://matrix.org/blog/2022/09/23/pre-disclosure-upcoming-critical-security-release-of-matrix-sd-ks-and-clients">pre-disclosure</a> issued on September 23rd.</li>
</ul>

                <p><a href="/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients/#continue-reading">Continue reading…</a></p>
                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2022&#x2F;09&#x2F;23&#x2F;pre-disclosure-upcoming-critical-security-release-of-matrix-sd-ks-and-clients&#x2F;" title="Pre-disclosure: upcoming critical security release of Matrix SDKs and clients">Pre-disclosure: upcoming critical security release of Matrix SDKs and clients</a></h2>
                <span>
                    23.09.2022 12:53
                    —
                    <a href="/category/security">
                        Security
                    </a>
                    —
                    <a
                        href="/author/matrix-security">
                        Matrix Security
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>We will be releasing a security update to matrix-js-sdk, matrix-ios-sdk and matrix-android-sdk2 and clients which implement end-to-end encryption with these libraries, to patch <strong>critical</strong> security issues, on <strong>Wed, Sept 28th</strong>. The releases will be published in the afternoon, followed by the disclosure blog post around 16:00 UTC. The affected clients include Element Web, Desktop, iOS and Android.  We will also be working with downstream packagers and forks over the coming days to ensure a synchronised release to address affected clients.</p>
<p>Clients using matrix-rust-sdk, hydrogen-sdk and matrix-nio are not affected by these critical issues.  We are also auditing third-party client SDKs and clients in advance of the release, and will work with the projects if action is needed. So far we've confirmed that other popular SDK/clients including mtxclient (nheko), Matrix Dart SDK (FluffyChat), Trixnity (Timmy), Syphon, mautrix-go (Gomuks) and mautrix-python are not affected by the issues in question.</p>
<p>If you maintain or package a (potentially) affected E2EE-capable Matrix client and need to coordinate on the release, please contact <a href="mailto:security@matrix.org">security@matrix.org</a>.</p>
<p><strong>We advise to upgrade as soon as possible after the patched versions are released.</strong></p>
<p>Thank you for your patience while we work to resolve this issue.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2022&#x2F;09&#x2F;13&#x2F;security-release-of-matrix-appservice-irc-0-35-0-high-severity&#x2F;" title="Security release of matrix-appservice-irc 0.35.0 (High severity)">Security release of matrix-appservice-irc 0.35.0 (High severity)</a></h2>
                <span>
                    13.09.2022 14:56
                    —
                    <a href="/category/security">
                        Security
                    </a>
                    —
                    <a
                        href="/author/denis-kasak">
                        Denis Kasak
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>We've released a new version of matrix.org's node-irc 1.3.0 and
matrix-appservice-irc 0.35.0, to patch several security issues:</p>
<ul>
<li>IRC mode operator confusion (Low, <a href="https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-cq7q-5c67-w39w">GHSA-cq7q-5c67-w39w</a>)</li>
<li>Parsing issue leading to room takeovers (High, <a href="https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-xvqg-mv25-rwvw">GHSA-xvqg-mv25-rwvw</a>)</li>
<li>Undisclosed issue (Moderate, <a href="https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-r3p6-cg2c-c4qw">GHSA-r3p6-cg2c-c4qw</a>)</li>
</ul>
<p>The details of the final vulnerability will be released at a later date,
pending an audit of the codebase to ensure it's not affected by other similar
vulnerabilities.</p>
<p>The vulnerabilities have been patched in node-irc version 1.3.0 and
matrix-appservice-irc 0.35.0. You can get the release on
<a href="https://github.com/matrix-org/matrix-appservice-irc/releases">Github</a>.</p>
<p>The bridges running on the Libera Chat, OFTC and other networks bridged by the
Matrix.org Foundation have been patched.</p>
<p><strong>Please upgrade your IRC bridge as soon as possible.</strong></p>
<p>The above vulnerabilities were reported by <a href="https://valentin-lorentz.fr/">Val
Lorentz</a>. Thank you!</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;12&#x2F;09&#x2F;synapse-1-24-0-and-1-23-1-released&#x2F;" title="Synapse 1.24.0 and 1.23.1 released">Synapse 1.24.0 and 1.23.1 released</a></h2>
                <span>
                    09.12.2020 23:51
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p><a href="https://github.com/matrix-org/synapse/releases/tag/v1.24.0">Synapse 1.24.0</a> is now available!</p>
<p>This release fixes a denial of service vulnerability (<a href="https://github.com/matrix-org/synapse/security/advisories/GHSA-hxmp-pqch-c8mm">GHSA-hxmp-pqch-c8mm</a> / <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26257">CVE-2020-26257</a>) in which a malicious homeserver could send malformed events into a room which would then break federation of that room.</p>
<p>This follows the disclosure of a denial of service vulnerability in OpenSSL (<a href="https://www.openssl.org/news/secadv/20201208.txt">CVE-2020-1971</a>). If you have installed Synapse from source, please ensure your host is up to date and then execute <code>pip install 'cryptography&gt;=3.3'</code> inside your Synapse virtualenv.</p>
<p>We've also released <a href="https://github.com/matrix-org/synapse/releases/tag/v1.23.1">Synapse 1.23.1</a> which includes that security fix and a small patch to maintain Python 3.5 compatibility. It is otherwise <a href="https://github.com/matrix-org/synapse/compare/v1.23.0...v1.23.1">identical to 1.23.0</a>. Note that Synapse 1.24.0 includes backwards incompatible changes which may affect a small number of users. See the <a href="https://github.com/matrix-org/synapse/blob/develop/UPGRADE.rst#upgrading-to-v1240">notes on upgrading</a> for more information.</p>
<p>Synapse 1.24.0 brings a pair of new Admin APIs, including a way to <a href="https://github.com/matrix-org/synapse/blob/v1.24.0/docs/admin_api/user_admin_api.rst#login-as-a-user">log in as users</a> and to <a href="https://github.com/matrix-org/synapse/blob/v1.24.0/docs/admin_api/rooms.md#delete-room-api">forcibly purge</a> rooms when deleting them. We've also made numerous bug fixes and improvements to SSO support, especially around OpenID Connect and SAML providers.</p>
<p>This release includes an optional change to push notification badges: currently, the number in the badge is based on the count of <em>rooms</em> with unread messages. However, in some specialized cases you may want the badge to show the count of <em>all</em> unread messages, even if there are multiple unread messages in the same room. This behavior can now be toggled with a <a href="https://github.com/matrix-org/synapse/pull/8820">new configuration setting</a>.</p>
<p>Additionally, for server admins, the deprecated <code>/_matrix/client/*/admin</code> Admin API endpoints <a href="https://github.com/matrix-org/synapse/issues/8785">have been removed</a>. If you have tools which target these endpoints, please update them to use the <code>/_synapse/admin</code> URL prefix instead.</p>
<p>See the <a href="https://github.com/matrix-org/synapse/blob/v1.24.0/CHANGES.md">full changelog</a> for more.</p>
<p>Installation instructions are available <a href="https://github.com/matrix-org/synapse/blob/master/INSTALL.md">on GitHub</a>, as is the <code>v1.24.0</code> <a href="https://github.com/matrix-org/synapse/releases/tag/v1.24.0">release tag</a>.</p>
<p>Synapse is a Free and Open Source Software project, and we'd like to extend our thanks to everyone who contributed to this release, including <a href="https://github.com/angdraug">@angdraug</a>, <a href="https://github.com/chagai95">@chagai95</a>, <a href="https://github.com/daenney">@daenney</a>, <a href="https://github.com/dklimpel">@dklimpel</a>, <a href="https://github.com/jordanbancino">@jordanbancino</a>, <a href="https://github.com/localguru">@localguru</a>, <a href="https://github.com/nchamo">@nchamo</a>, <a href="https://github.com/ShadowJonathan">@ShadowJonathan</a>, <a href="https://github.com/TeFiLeDo">@TeFiLeDo</a>, <a href="https://github.com/tulir">@tulir</a>, and <a href="https://github.com/waylon531">@waylon531</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;11&#x2F;23&#x2F;synapse-disclosing-cve-2020-26890&#x2F;" title="Synapse: Disclosing CVE-2020-26890">Synapse: Disclosing CVE-2020-26890</a></h2>
                <span>
                    23.11.2020 14:59
                    —
                    <a href="/category/security">
                        Security
                    </a>
                    —
                    <a
                        href="/author/dan-callahan">
                        Dan Callahan
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Today we are disclosing <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26890">CVE-2020-26890</a> / <a href="https://github.com/matrix-org/synapse/security/advisories/GHSA-4mp3-385r-v63f">GHSA-4mp3-385r-v63f</a>, a denial of service vulnerability affecting Synapse versions prior to 1.20.0. We strongly encourage all Synapse admins to upgrade as soon as possible. If you have not upgraded in a while, please refer to the <a href="https://github.com/matrix-org/synapse/blob/master/UPGRADE.rst">upgrade notes</a>, especially the latter portion of that document which covers any backwards incompatible changes which you may need to take into consideration.</p>
<p>As a best practice, we encourage Synapse admins to upgrade regularly, and either <a href="https://github.com/matrix-org/synapse/releases/">subscribe on GitHub</a> or join <a href="https://matrix.to/#/#homeowners:matrix.org">#homeowners:matrix.org</a> for low-traffic notifications of new releases.</p>
<p>We extend our thanks to Denis Kasak for reporting this issue, earning a second entry in the Matrix Security <a href="/security-disclosure-policy">Hall of Fame</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;10&#x2F;15&#x2F;synapse-1-21-2-released-and-security-advisory&#x2F;" title="Synapse 1.21.2 released, and security advisory.">Synapse 1.21.2 released, and security advisory.</a></h2>
                <span>
                    15.10.2020 17:25
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/richard-van-der-hoff">
                        Richard van der Hoff
                    </a>
                </span>
                <br>
                <small>Last update: 15.10.2020 17:16</small>
            </header>
            <div>
                
                <p>Hi folks,</p>
<p>Today we have released Synapse 1.21.2, which fixes a couple of minor bugs that crept into the previous release. Full details are below.</p>
<p>Separately, we are advising any administrators who have not yet upgraded to Synapse 1.21.0 or later to do so as soon as possible. Previous versions of Synapse were vulnerable to a cross-site-scripting (XSS) attack; the bug was fixed in Synapse 1.21.0 with <a href="https://github.com/matrix-org/synapse/pull/8444">PR #8444</a>.</p>
<p>The changelog for 1.21.2 is as follows:</p>
<h1 id="synapse-1-21-2-2020-10-15">Synapse 1.21.2 (2020-10-15)</h1>
<p>Debian packages and Docker images have been rebuilt using the latest versions of dependency libraries, including authlib 0.15.1. Please see bugfixes below.</p>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Fix rare bug where sending an event would fail due to a racey assertion. (<a href="https://github.com/matrix-org/synapse/issues/8530">#8530</a>)</li>
<li>An updated version of the authlib dependency is included in the Docker and Debian images to fix an issue using OpenID Connect. See <a href="https://github.com/matrix-org/synapse/issues/8534">#8534</a> for details.</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;09&#x2F;16&#x2F;synapse-1-19-2-released&#x2F;" title="Synapse 1.19.2 released">Synapse 1.19.2 released</a></h2>
                <span>
                    16.09.2020 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p><strong>Synapse 1.19.2 is a security patch. All federating instances should upgrade immediately.</strong></p>
<p>Today we are releasing Synapse 1.19.2, which is a security patch release containing a fix to encountering invalid events over federation. We are also putting out a fourth release candidate for the upcoming Synapse 1.20.0 release with the same fix.</p>
<p>The bug prevents affected Synapse instances from joining rooms with invalid events. Server administrators running federating instances are strongly encouraged to update as soon as possible.</p>
<p><strong>Those on Synapse 1.19.1 or earlier should upgrade to Synapse 1.19.2, while those who are running a release candidate of Synapse 1.20.0 should upgrade to 1.20.0rc4.</strong></p>
<p>Get the new releases from any of the usual sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md. 1.19.2 is on github <a href="https://github.com/matrix-org/synapse/releases/tag/v1.19.2">here</a>, and 1.20.0rc4 is <a href="https://github.com/matrix-org/synapse/releases/tag/v1.20.0rc4">here</a>.</p>
<p>The changelog for 1.19.2 is as follows:</p>
<h1 id="synapse-1-19-2-2020-09-16">Synapse 1.19.2 (2020-09-16)</h1>
<p>Due to the issue below server admins are encouraged to upgrade as soon as possible.
Bugfixes</p>
<ul>
<li>Fix joining rooms over federation that include malformed events. (#8324)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;07&#x2F;02&#x2F;synapse-1-15-2-released-with-security-fixes&#x2F;" title="Synapse 1.15.2 released with security fixes">Synapse 1.15.2 released with security fixes</a></h2>
                <span>
                    02.07.2020 17:58
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/richard-van-der-hoff">
                        Richard van der Hoff
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Folks, today we are releasing Synapse 1.15.2, which is a security release which contains fixes to two separate problems. We are also putting out the second release candidate for the forthcoming Synapse 1.16, including the same fixes.</p>
<p>Firstly, we have fixed a bug in the implementation of the room state resolution algorithm which could cause users to be unexpectedly ejected from rooms (Synapse issue <a href="https://github.com/matrix-org/synapse/issues/7742">#7742</a>).</p>
<p>Secondly, we have improved the security of pages served as part of the Single-Sign-on login flows to prevent clickjacking attacks. Thank you to <a href="https://sandhose.fr/">Quentin Gliech</a> for reporting this.</p>
<p>We are not aware of either of these vulnerabilities being exploited in the wild, but we recommend that administrators upgrade as soon as possible. Those on Synapse 1.15.1 or earlier should upgrade to Synapse 1.15.2, while those who have already upgraded to Synapse 1.16.0rc1 should upgrade to 1.16.0rc2.</p>
<p>Get the new releases from any of the usual sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md. 1.15.2 is on github <a href="https://github.com/matrix-org/synapse/releases/tag/v1.15.2">here</a>, and 1.16.0rc2 is <a href="https://github.com/matrix-org/synapse/releases/tag/v1.16.0rc2">here</a>.</p>
<p>Changelog for 1.15.2 follows:</p>
<h2 id="synapse-1-15-2-2020-07-02">Synapse 1.15.2 (2020-07-02)</h2>
<p>Due to the two security issues highlighted below, server administrators are
encouraged to update Synapse. We are not aware of these vulnerabilities being
exploited in the wild.</p>
<h3 id="security-advisory">Security advisory</h3>
<ul>
<li>
<p>A malicious homeserver could force Synapse to reset the state in a room to a
small subset of the correct state. This affects all Synapse deployments which
federate with untrusted servers. (<a href="https://github.com/matrix-org/synapse/commit/96e9afe62500310977dc3cbc99a8d16d3d2fa15c">96e9afe6</a>)</p>
</li>
<li>
<p>HTML pages served via Synapse were vulnerable to clickjacking attacks. This
predominantly affects homeservers with single-sign-on enabled, but all server
administrators are encouraged to upgrade.  (<a href="https://github.com/matrix-org/synapse/commit/ea26e9a98b0541fc886a1cb826a38352b7599dbe">ea26e9a9</a>)</p>
<p>This was reported by <a href="https://sandhose.fr/">Quentin Gliech</a>.</p>
</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2019&#x2F;11&#x2F;09&#x2F;avoiding-unwelcome-visitors-on-private-matrix-servers&#x2F;" title="Avoiding unwelcome visitors on private Matrix servers">Avoiding unwelcome visitors on private Matrix servers</a></h2>
                <span>
                    09.11.2019 00:00
                    —
                    <a href="/category/privacy">
                        Privacy
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hi all,</p>
<p>Over the course of today we've been made aware of folks port-scanning the
general internet to discover private Matrix servers, looking for publicly
visible room directories, and then trying to join rooms listed in them.</p>
<p>If you are running a Matrix server that is intended to be private, you must correctly
configure your server to not expose its public room list to the general public -
and also ensure that any sensitive rooms are invite-only (especially if the
server is federated with the public Matrix network).</p>
<p>In Synapse, this means ensuring that the following options are set correctly in
your <code>homeserver.yaml</code>:</p>
<pre style="background-color:#1e1e1e;color:#dcdcdc;"><code><span># If set to &#39;false&#39;, requires authentication to access the server&#39;s public rooms
</span><span># directory through the client API. Defaults to &#39;true&#39;.
</span><span>#
</span><span>#allow_public_rooms_without_auth: false
</span><span>
</span><span># If set to &#39;false&#39;, forbids any other homeserver to fetch the server&#39;s public
</span><span># rooms directory via federation. Defaults to &#39;true&#39;.
</span><span>#
</span><span>#allow_public_rooms_over_federation: false
</span></code></pre>
<p><strong>For private servers, you will almost certainly want to explicitly set these to
<code>false</code></strong>, meaning that the server's &quot;public&quot; room directory is hidden from the
general internet and wider Matrix network.</p>
<p>You can test whether your room directory is visible to arbitrary Matrix clients
on the general internet by viewing a URL like
https://sandbox.modular.im/_matrix/client/r0/publicRooms (but for your server). 
If it gives a &quot;Missing access token&quot; error, you are okay.</p>
<p>You can test whether your room directory is visible to arbitrary Matrix servers
on the general internet by loading Riot (or similar) on another server, and
entering the target server's domain name into the room directory's server
selection box.  If you can't see any rooms, then are okay.</p>
<p>Relatedly, <strong>please ensure that any sensitive rooms are set to be &quot;invite only&quot;
and room history is not world visible</strong> - particularly if your server is
federated, or if it has public registration enabled.  This stops random
members of the public peeking into them (let alone joining them).</p>
<p>Relying on security-by-obscurity is a very bad idea: all it takes is for someone
to scan the whole internet for Matrix servers, and then trying to join (say)
#finance on each discovered domain (either by signing up on that
server or by trying to join over federation) to cause problems.</p>
<p>Finally, if you don't want the general public reading your room directory,
please also remember to turn off public registration on your homeserver.
Otherwise even with the changes above, if randoms can sign up on your server
to view &amp; join rooms then all bets are off.</p>
<p>We'll be rethinking the security model of room directories in future (e.g.
whether to default them to being only visible to registered users on the local
server, or whether to replace per-server directories with per-community
directories with finer grained access control, etc) - but until this is sorted,
please heed this advice.</p>
<p>If you have concerns about randoms having managed to discover or join rooms
which should have been private, please contact security@matrix.org.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2019&#x2F;11&#x2F;06&#x2F;fun-and-games-with-certificate-transparency-logs&#x2F;" title="Fun and games with certificate transparency logs">Fun and games with certificate transparency logs</a></h2>
                <span>
                    06.11.2019 00:00
                    —
                    <a href="/category/security">
                        Security
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hi all,</p>
<p>This morning (06:11 UTC) it became apparent through mails to support@matrix.org that a security researcher was working through the TLS Certificate Transparency logs for <code>*.matrix.org</code>,<code>*.riot.im</code> and <code>*.modular.im</code> to identify and try to access non-public services run by New Vector (the company formed by the original Matrix team, which hosts <code>*.matrix.org</code> on behalf of the Matrix.org Foundation, and develops Riot and runs the https://modular.im hosting service).</p>
<p>Certificate Transparency (CT) is a feature of the TLS ecosystem which lets you see which public certificates have been created and signed by given authorities - intended to help identify and mitigate against malicious certificates.  This means that the DNS name of any host with a dedicated public TLS certificate (i.e. not using a wildcard certificate) is visible to the general public.</p>
<p>In practice, this revealed a handful of internal-facing services using dedicated public TLS certificates which were accessible to the general internet - some of which should have been locked to be accessible only from our internal network.</p>
<p>Specifically:</p>
<ul>
<li><code>kibana.ap-southeast-1.k8s.i.modular.im</code> - a Kibana deployment for a new experimental Modular cluster which is being set up in SE Asia. The Kibana is in the middle of being deployed, and was exposed without authentication during deployment due to a firewall &amp; config error.  However, <strong>it is not a production system and carries no production traffic or user data</strong> (it was just being used for experimentation for hypothetical geography-specific Modular deployments).  We firewalled this off at 07:53 UTC, and are doing analysis to confirm there was no further compromise, and will then rebuild the cluster (having fixed the firewall config error from repeating).</li>
<li>AWX deployments used by our internal Modular platform, which were behind authentication but should not be exposed to the public net.</li>
<li>Various semi-internal dev and testing services which should be IP-locked to our internal network (but are all locked behind authentication too).</li>
</ul>
<p>Additionally, certain historical Modular homeservers &amp; Riots (from before we switched to using wildcard certs, or where we’ve created a custom LetsEncrypt certificate for the server) are named in the CT logs - thus leaking the server’s name (which is typically public anyway in that server’s matrix IDs if the server is federated).</p>
<p>We’re working through the services whose names were exposed checking for any other issues, but other than the non-production SE Asia Kibana instance we are not aware of problems resulting from this activity.</p>
<p>Meanwhile, we’ll be ensuring that semi-internal services are only exposed on our internal network in future, and that Modular server names are not exposed by CT logs where possible.</p>
<p><strong>TL;DR</strong>: You can list all the public non-wildcard TLS certs for a given domain by looking somewhere like https://crt.sh/?q=%25.matrix.org.  This lets you find internal-sounding services to try to attack.  In practice no production services were compromised, and most of our internal services are correctly firewalled from the public internet.  However, we’re reviewing the IP locking for ones in the grey zone (and preventing the bug which caused an experimental Kibana to be exposed without auth).</p>
<p>We’d like to thank Linda Lapinlampi for notifying us about this.  We’d also like to remind everyone that we operate a Security Disclosure Policy (SDP) and Hall of Fame at https://matrix.org/security-disclosure-policy/ which is designed to protect innocent users from being hurt by security issues - everyone: please consider disclosing issues responsibly to us as per the SDP.</p>

                
            </div>
        </article>
        
        <nav class="pagination">
    <div class="prev">
        
    </div>
    <span class="page-number">1 / 2</span>
    <div class="prev">
        
        <a href="&#x2F;category&#x2F;security&#x2F;page&#x2F;2&#x2F;">Next ›</a>
        
    </div>
</nav>

    </div>
</div>

    </main>

    <footer class="site-footer">
    <div class="internal-links">
        
        <a href="&#x2F;faq">FAQs</a>
        
        <a href="&#x2F;security-disclosure-policy">Security Disclosure Policy</a>
        
        <a href="&#x2F;hall-of-fame">Security Hall of Fame</a>
        
        <a href="&#x2F;legal&#x2F;code-of-conduct">Code of Conduct for Matrix.org</a>
        
        <a href="&#x2F;legal">Legal</a>
        
        <a href="&#x2F;contact">Contact</a>
        
        <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org&#x2F;matrix.org&#x2F;">Site Source</a>
        
    </div>
    <div class="external-links">
        <div>
            
            <a href="&#x2F;code"><img src="/assets/github.svg" alt="GitHub"></a>
            
            <a href="https:&#x2F;&#x2F;gitlab.matrix.org&#x2F;"><img src="/assets/gitlab.svg" alt="GitLab"></a>
            
            <a href="https:&#x2F;&#x2F;mastodon.matrix.org&#x2F;@matrix"><img src="/assets/mastodon.svg" alt="Mastodon"></a>
            
            <a href="https:&#x2F;&#x2F;twitter.com&#x2F;matrixdotorg"><img src="/assets/twitter.svg" alt="Twitter"></a>
            
            <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCVFkW-chclhuyYRbmmfwt6w"><img src="/assets/youtube.svg" alt="YouTube"></a>
            
        </div>
    </div>
    <p>© 2022 The Matrix.org Foundation C.I.C.</p>
</footer>

</body>

</html>
