<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="twitter:widgets:csp" content="on" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="twitter:site" content="@matrixdotorg" />
    <meta name="twitter:creator" content="@matrixdotorg" />

    <title>Matrix.org - Matthew Hodgson</title>
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="icon" type="image/png" href="/assets/favicon.png" />
    <link rel="stylesheet" href="/style.css" />

    
<link rel="alternate" type="application/rss+xml" title="RSS" href="/author/matthew-hodgson/atom.xml">
</head>

<body>
    
    <header class="site-header">
    <a href="/" class="brand">
        <img src="/images/matrix-logo.svg" alt="Matrix logo">
    </a>
    <input id="site-header-dropdown-checkbox" type="checkbox" class="dropdown-checkbox" aria-hidden="true">
    <label for="site-header-dropdown-checkbox" class="dropdown-button">&#xe602;</label>
    <label for="site-header-dropdown-checkbox" class="page-overlay"></label>
    <nav>
        
        
        <a href="&#x2F;about&#x2F;" class="
            ">
            About
        </a>
        
        
        
        <a href="&#x2F;blog&#x2F;" class="
            ">
            Blog
        </a>
        
        
        
        
        
        <div class="section-wrap">
            <a href="&#x2F;docs&#x2F;" class="section ">
                Documentation
            </a>
            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    
                    
                    <a href="&#x2F;docs&#x2F;users&#x2F;">Users</a>
                    
                    
                    <a href="&#x2F;docs&#x2F;communities&#x2F;">Communities</a>
                    
                    
                    <a href="&#x2F;docs&#x2F;developers&#x2F;">Developers</a>
                    
                    
                    <a href="&#x2F;docs&#x2F;legacy&#x2F;">Legacy documentation</a>
                    
                </div>
            </div>
        </div>
        
        
        
        
        
        <div class="section-wrap">
            <a href="&#x2F;ecosystem&#x2F;" class="section ">
                Ecosystem
            </a>
            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    <a href="&#x2F;ecosystem&#x2F;clients&#x2F;">Clients</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;servers&#x2F;">Servers</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;bots&#x2F;">Bots</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;bridges&#x2F;">Bridges</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;sdks&#x2F;">SDKs</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;hosting&#x2F;">Hosting</a>
                    
                    
                </div>
            </div>
        </div>
        
        
        
        <a href="&#x2F;podcasts&#x2F;" class="
            ">
            Podcasts
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;shop.matrix.org" class="
            ">
            Shop
        </a>
        
        
        
        <a href="&#x2F;try-matrix&#x2F;" class="primary
            ">
            Try Matrix
        </a>
        
        
    </nav>
</header>


    <main>
        
<div id="taxonomy-single">
    <div class="content">
        <header>
            <h1>Matthew Hodgson</h1>
            146 posts tagged with "Matthew Hodgson" <a href="/author">(See all Author)</a>
            
        </header>

        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2022&#x2F;09&#x2F;28&#x2F;upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients&#x2F;" title="Upgrade now to address E2EE vulnerabilities in matrix-js-sdk, matrix-ios-sdk and matrix-android-sdk2">Upgrade now to address E2EE vulnerabilities in matrix-js-sdk, matrix-ios-sdk and matrix-android-sdk2</a></h2>
                <span>
                    28.09.2022 17:41
                    —
                    <a href="/category/security">
                        Security
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p><strong>TL;DR:</strong></p>
<ul>
<li>Two critical severity vulnerabilities in end-to-end encryption were found in
the SDKs which power Element, Beeper, Cinny, SchildiChat, Circuli, Synod.im
and any other clients based on matrix-js-sdk, matrix-ios-sdk or
matrix-android-sdk2.</li>
<li>These have now been fixed, and we have not seen evidence of them being
exploited in the wild. All of the critical vulnerabilities require
cooperation from a malicious homeserver to be exploited.</li>
<li><strong>Please upgrade immediately in order to be protected against these
vulnerabilities.</strong></li>
<li>Clients with other encryption implementations (including Hydrogen, ElementX,
Nheko, FluffyChat, Syphon, Timmy, Gomuks and Pantalaimon) are not affected;
<strong>this is not a protocol bug</strong>.</li>
<li>We take the security of our end-to-end encryption extremely seriously, and we
have an ongoing series of public independent audits booked to help guard
against future vulnerabilities.  We will also be making some protocol changes
in the future to provide additional layers of protection.</li>
<li>This resolves the <a href="https://matrix.org/blog/2022/09/23/pre-disclosure-upcoming-critical-security-release-of-matrix-sd-ks-and-clients">pre-disclosure</a> issued on September 23rd.</li>
</ul>

                <p><a href="/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients/#continue-reading">Continue reading…</a></p>
                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2022&#x2F;09&#x2F;27&#x2F;announcing-third-room-tech-preview-1&#x2F;" title="Announcing Third Room Tech Preview 1">Announcing Third Room Tech Preview 1</a></h2>
                <span>
                    27.09.2022 17:53
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>We're excited to announce the first tech preview of <a href="https://thirdroom.io/">Third Room</a>, an open, standards-based, decentralised vision of the metaverse for the open Web, built entirely on Matrix… without cryptocurrencies, NFTs or walled gardens.</p>
<p>To see what it's all about, head over to <a href="https://thirdroom.io/preview">https://thirdroom.io/preview</a> - or come chat in <a href="https://matrix.to/#/#thirdroom-dev:matrix.org">#thirdroom-dev:matrix.org</a> to learn more!</p>
<iframe src="https://www.youtube.com/embed/skC5TYRAgKE" loading="lazy" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2022&#x2F;08&#x2F;15&#x2F;the-matrix-summer-special-2022&#x2F;" title="The Matrix Summer Special 2022">The Matrix Summer Special 2022</a></h2>
                <span>
                    15.08.2022 00:00
                    —
                    <a href="/category/general">
                        General
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hi all,</p>
<p>At the end of each year it’s been traditional to do a big review of everything that the Matrix core team got up to that year, and announcing our predictions for the next.  You can see the last edition in <a href="https://matrix.org/blog/2021/12/22/the-mega-matrix-holiday-special-2021">2021 here</a> - and if you’re feeling nostalgic you can head down memory lane with the <a href="https://matrix.org/blog/2020/12/25/the-matrix-holiday-special-2020">2020</a>, <a href="https://matrix.org/blog/2019/12/24/the-2019-matrix-holiday-update">2019</a>, <a href="https://matrix.org/blog/2018/12/25/the-2018-matrix-holiday-special">2018</a> ones etc too.</p>
<p>This year is turning out to be slightly different, however.  Our plans for 2022 are particularly ambitious: to force a step change in improving Matrix’s performance and usability so that we firmly transition from our historical “make it work” and “make it work right” phases into “<strong>making it fast</strong>”.  Specifically: to succeed, Matrix <strong>has</strong> to succeed in powering apps which punch their weight in terms of performance and usability against the proprietary centralised alternatives of WhatsApp, Discord, Slack and friends.</p>
<p>We’ve seen an absolute tonne of work happening on this so far this year… and somehow the end results all seem to be taking concrete shape at roughly the same time, despite summer traditionally being the quietest point of the year.  The progress is super exciting and we don’t want to wait until things are ready to enthuse about them, and so we thought it’d be fun to do a spontaneous Summer Special gala blog post so that everyone can follow along and see how things are going!</p>
<h2 id="making-it-fast">Making it fast</h2>
<p>We have always focused on first making Matrix “work right” before we make it “work fast” - sometimes to a fault.  After all: the longer you build on a given architecture the harder it becomes to swap it out down the line, and the core architecture of Matrix has remained essentially the same since we began in 2014 - frankly it’s amazing that the initial design has lasted for as long as it has.</p>
<p>Over the years we’ve done a lot of optimisation work on the core team implementations of that original architecture - whether that’s Synapse or matrix-{js,react,ios,android}-sdk and friends: for instance Synapse uses 5-10x less RAM than it used to (my personal federated server is only using 145MB of RAM atm! 🤯) and it continues to speed up in pretty much every new release (<a href="https://github.com/matrix-org/synapse/pull/13522">this PR</a> looks to give a 1000x speedup on calculating push notification actions, for instance!).  However, there are some places where Matrix’s architecture itself ends up being an embarrassingly slow bottleneck: most notably when rapidly syncing data to clients, and when joining rooms for the first time over federation.  We’re addressing these as follows…</p>
<h3 id="sliding-sync-aka-sync-v3">Sliding Sync (aka Sync v3)</h3>
<p>Historically, /sync always assumed that the client would typically want to know about all the conversations its user is in - much as an IRC client or XMPP client is aware of all your current conversations.  This provided some nice properties - such as automatically enabling perfect offline support, simplifying client and server development, and making features like “jump to room” and “tab complete” work instantly given the data is all client-side.  In the early days of Matrix, when nobody was yet a power user, this wasn’t really a problem - but as users join more conversations and join bigger rooms, it’s become one of Matrix’s biggest performance bottlenecks.  In practice, logging into a large account (~4000 rooms) can take ~10 minutes and hundreds of megabytes of network traffic, which is clearly ridiculous. Worse: if you go offline for a day or so, the incremental sync to catch back up can take minutes to calculate (and can even end up being worse than an initial sync).</p>
<p>To fix this, we started work on Sliding Sync (<a href="https://github.com/matrix-org/matrix-spec-proposals/blob/kegan/sync-v3/proposals/3575-sync.md">MSC3575</a>) in 2021: a complete reimagining of the /sync API used by Matrix clients to receive data from their homeserver.  In Sliding Sync, we only send the client the data it needs to render its UI.  Most importantly, we only tell it about the subset of rooms which it is visible in the scroll window of its room list (or that it needs to display notifications about).  As the user scrolls around the room list, they slide the window up and down - hence the name “sliding sync”.  Sliding Sync was originally called Sync v3, given it’s our 3rd iteration of the sync API - it got renamed Sliding Sync given the current sync API confusingly ended up with a prefix of /v3.</p>
<p><a href="https://matrix.org/blog/2021/12/22/the-mega-matrix-holiday-special-2021#sync-v3">Back in December</a> our work on Sliding Sync was still pretty early: we had the initial MSC, an experimental proxy that converted the existing sync v2 API into Sliding Sync, and a simple proof-of-concept web client to exercise it.  Since then, however, there has been spectacular progress:</p>
<ul>
<li>MSC3575 has undergone some <a href="https://github.com/matrix-org/matrix-spec-proposals/pull/3575/commits/bea7323c0b03dbd46600ce8fe01218d55f0de083">big</a> <a href="https://github.com/matrix-org/matrix-spec-proposals/pull/3575/commits/a0bf4027bcef278e43a570c6fa94f2b1bef3488b">iterations</a> as we converge on the optimal API shape.</li>
<li>The <a href="https://github.com/matrix-org/sliding-sync">sliding-sync</a> proxy has matured to be something which we’re now running in stealth against matrix.org for those dogfooding the API</li>
<li>We added the concept of extensions to split out how to sync particular classes of data (to avoid the API becoming a monolithic monster) - specifically:
<ul>
<li>Account Data</li>
<li>End-to-end Encryption</li>
<li>To-device messages</li>
<li>Ephemeral events (to be done)</li>
<li>Presence (to be done)</li>
</ul>
</li>
<li>We added support for spaces!</li>
<li>We implemented it in <a href="https://github.com/matrix-org/matrix-js-sdk/pull/2242">matrix-js-sdk</a> (which merged a few weeks ago!)</li>
<li>…and have a WIP implementation in <a href="https://github.com/matrix-org/matrix-rust-sdk/pull/728">matrix-rust-sdk</a> too.</li>
</ul>
<p>But most importantly, we’ve also been busy implementing Sliding Sync in Element Web itself so we can start using it for real.  Now, this is still a work in progress, but as of today it’s <em>just</em> getting to the point where one can experiment with it as a daily driver (although it’s definitely alpha and we’re still squishing bugs like crazy!) - and we can see just how well it really performs in real life.</p>
<p>For instance, here’s a video of my account (4055 rooms, redacted for privacy) logging in on an entirely fresh browser via Sliding Sync - the actual sync takes roughly 1 second (at 00:18 in the video).  And if we’d started the sync operation while the user is setting up E2E encryption, it would have completed in the background before they even got to the main screen, giving instant login(!).  Given my account typically takes ~10 minutes to initial sync (plus even more time for encryption to sync up), this is at least a real-life <strong>600x improvement</strong>.  Moreover, the sync response is only 20KB (a ~5000x improvement) - a huge win for low-bandwidth Matrix situations.</p>
<iframe width="2056" height="980" src="https://www.youtube.com/embed/9dbM66tGK5s" title="Sliding Sync Demo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Then, having logged in, the client subsequently launches pretty much instantly, <em>no matter how long you’ve been offline</em>. Total launch time is roughly 4 seconds, most of which is loading the app’s assets - which in turn could well be improved by progressively loading the app.  It could also be sped up even more if we cached state locally - currently the implementation simply reloads from the server every time the app launches rather than maintaining a local cache.</p>
<p>As you can see, this is palpably coming together, but there’s still a bunch of work to be done before we can encourage folks to try it, including:</p>
<ul>
<li>Switching the RoomList to be fully backed by sliding sync (currently the v2 roomlist is jury-rigged up to the sliding sync API, causing some flakey bugs such as duplicate rooms)</li>
<li>Spec and hook up typing / receipts / presence extensions</li>
<li>Hook up favourites, low_priority, knocked and historical rooms</li>
<li>Adding back in loading room members</li>
<li>Apply quality-of-service to to-device messages so we prioritise ones relevant to the current sliding window</li>
<li>Sync encrypted rooms in the background to search for notifications (and for indexing).</li>
<li>More local caching to speed up operations which now require checking the server (e.g. Ctrl/Cmd-K room switching)</li>
</ul>
<p>We also need to determine whether it’s viable to run the sliding-sync proxy against matrix.org for general production use, or whether we’ll need native support in Synapse before we can turn it on by default for everyone.  But these are good problems to have!!</p>
<h3 id="matrix-rust-sdk-and-element-x">matrix-rust-sdk and Element X</h3>
<p>Meanwhile, over in the land of Rust, we’ve been making huge progress in maturing and stabilising matrix-rust-sdk and exercising it in Element X: the codename for the next generation of native Element mobile apps.  Most excitingly, we literally just got the first (very alpha) cut of Sliding Sync working in matrix-rust-sdk and hooked up to Element X on iOS - you can see Ștefan’s demo from last week here:</p>
<iframe width="2056" height="980" src="https://www.youtube.com/embed/6KHQSeJTXm0?start=459" title="Matrix Live S08E04 — Element Demos" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>matrix-rust-sdk itself is now getting a <a href="https://github.com/matrix-org/matrix-rust-sdk/releases">steady stream of releases</a> - including long-awaited official node bindings, providing excellent and performant encryption support via the <a href="https://matrix.org/blog/2022/05/16/independent-public-audit-of-vodozemac-a-native-rust-reference-implementation-of-matrix-end-to-end-encryption/">newly audited</a> vodozemac Rust implementation of Olm. It’s also great to see loads of major contributions to matrix-rust-sdk from across the wider Matrix community - particularly from Ruma, Fractal, Famedly and others - thank you!! As a result the SDK is shaping up to be much more healthy and heterogeneous than the original matrix-{js,ios,android}-sdk projects.</p>
<p>On Element X itself: matrix-rust-sdk is being used first on iOS in <a href="https://github.com/vector-im/element-x-ios">Element X iOS</a> - aiming first for launching a stable “barbecue” feature set (i.e. personal messaging) asap, followed by adding on “banquet” features (i.e. team collaboration) such as spaces and threads afterwards. We’ve shamelessly misappropriated the barbecue &amp; banquet terminology from Tobias Bernard’s excellent blog post “<a href="https://blogs.gnome.org/tbernard/2018/05/16/banquets-and-barbecues/">Banquets and Barbecues</a>” - although, ironically, unlike the post, our plan is still to have a single app which incrementally discloses the banquet functionality as the user’s barbecue starts to sprawl.  We’ve just published the brand new <a href="https://github.com/matrix-org/matrix-rust-sdk/projects/1">development roadmap</a> for Element X from the rust-sdk perspective on GitHub.  Above all else, the goal of Element X is to be the fastest mobile messenger out there in terms of launch and sync time, thanks to Sliding Sync.  Not just for Matrix - but the fastest messenger, full stop :D  Watch this space to see how we do!</p>
<p>Finally: Element is getting a major redesign of the core UI on both iOS and Android - both for today’s Element and Element X.  I’m not going to spoil the final result (which is looking <em>amazing</em>) given it’ll have a proper glossy launch in a few weeks, but you can get a rough idea based on the earlier design previewed by Amsha back in June:</p>
<iframe width="2056" height="980" src="https://www.youtube.com/embed/oxfqQ0TrTXU?start=34" title="Matrix Live S07E22 — Element UI experiments, and customising Element Web with greasemonkey" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>In addition to the upcoming overall redesign, Element also landed a complete rework of the login and registration flows last week on iOS and Android - you can see all about it over on the <a href="https://element.io/blog/all-aboard-better-ftue-for-less-wtf/">Element blog</a>.</p>
<h3 id="fast-remote-joins">Fast Remote Joins</h3>
<p>In terms of performance, the other area that we’re reworking at the protocol level is room joins. </p>
<p>One of the most glaring shortcomings of Matrix happens when a new server admin excitedly decides to join the network, installs a homeserver, tries to join a large room like #matrix:matrix.org, and then looks on in horror as it takes 10+ minutes to join the room, promptly despairs of Matrix being slow and complains bitterly about it all over HN and Reddit :)</p>
<p>The reason for the current behaviour is that the Matrix rooms are replicated between the servers who participate in them - and in the initial design of the protocol we made that replication atomic. In other words, a new server joining a room picks a server from which to acquire the room (typically the one in the room’s alias), and gets sent a copy of all the state events (i.e. structural data) about the room, as well as the last 20 or so messages.  For a big room like Matrix HQ, this can be massive - right now, there are 79,969 state events in the room - and 126,510 auth_chain events (i.e. the events used to justify the existence of the state events).  The reason there are so many is typically that the act of a user joining or parting the room is described by a state event - and in the naive implementation, the server needs to know all current state events in the room (e.g. including parted users), in order to keep in sync with the other servers in the room and faithfully authorise each new event which they receive for that room.</p>
<p>However, each event is typically around 500 bytes in size, and so the act of joining a big room could require generating, transmitting, receiving, authenticating and storing up to 100MB of JSON 😱. This is why joining big rooms for the first time is so painfully slow.</p>
<p>Happily, there is an answer: much as Sliding Sync lets clients synchronise with the bare minimum of data required to render their UI, we’ve created <a href="https://github.com/matrix-org/matrix-spec-proposals/blob/rav/proposal/partial_state_on_join/proposals/3706-partial-state-in-send-join.md">MSC3706</a> (and its precursor <a href="https://github.com/matrix-org/matrix-spec-proposals/blob/matthew/msc2775/proposals/2775-lazy-loading-over-federation.md">MSC2775</a>) in order to rework the protocol to let servers receive the bare minimum of state needed to join a room in order to participate.  Practically speaking, we only really care about events relevant to the users who are currently participating in the room; the 40,000 other lurkers can be incrementally synced in the background so that our membership list is accurate - but it shouldn’t block us from being able to join or read (or peek) the room.  We already have membership lazyloading in the client-server API to support incrementally loaded membership data, after all.</p>
<p>The problem with this change is that Synapse was written from the outset to assume that each room’s state should be atomically complete: in other words, room state shouldn’t  incrementally load in the background.  So the work for Faster Joins has been an exercise in auditing the entirety of Synapse for this assumption, and generally reviewing and hardening the whole state management system.  This has been <a href="https://github.com/matrix-org/synapse/pulls?q=is%3Apr+%22faster+joins%22+is%3Aclosed+">loads of work</a> that has been going on since the end of last year - but the end is in sight: you can see the remaining issues <a href="https://github.com/matrix-org/synapse/milestone/8">here</a>.</p>
<p>As of right now, faster joins work (although aren’t enabled by default) - with the main proviso that you can’t speak in the room yet until the background sync has completed, and the new implementation has not yet been optimised.  However, thanks to all the preparation work, this should be relatively straightforward, so the end is in sight on this one too.</p>
<p>In terms of performance: right now, joining Matrix HQ via the unoptimised implementation of faster joins completes on a fresh server in roughly 30 seconds - so a <strong>~25x improvement</strong> over the ~12 minutes we’ve seen previously.  However, the really exciting news is that this only requires synchronising 45 state events and 107 auth_chain events to the new server - a <strong>~1400x improvement</strong>!  So there should be significant scope for further optimising the calculation of these 152 events, given 30 seconds to come up with 152 events is definitely on the high side.  In our ideal world, we’d be getting joins down to sub-second performance, no matter how big the room is - once again, watch this space to see how we do. </p>
<p>Finally, alongside faster remote joins, we’re also working on faster local joins.  This work overlaps a bit with the optimisation needed to speed up the faster remote join logic - given we are seeing relatively simple operations unexpectedly taking tens of seconds in both instances. Some of this is needing to batch database activity more intelligently, but we also have some unknown pauses which we’re currently tracking down.  Profiling is afoot, as well as copious Jaeger and OpenTracing instrumentation - the hunt is on!</p>
<h3 id="ratcheting-up-testing">Ratcheting up testing</h3>
<p>All the work above describes some pretty bold changes to speed up Matrix and improve usability - but in order to land these changes with confidence, avoiding regressions both now and in future, we have really levelled up our testing this year.</p>
<p>Looking at matrix-react-sdk as used by Element Web/Desktop: all PRs made to matrix-js-sdk must now pass 80% unit test coverage for new code (measured using <a href="https://sonarcloud.io/project/overview?id=matrix-js-sdk">Sonarqube</a>, enforced as a GitHub PR check). All matrix-react-sdk PRs must be accompanied by a mix of unit tests, end-to-end tests (via <a href="https://www.cypress.io/">Cypress</a>) and screenshot tests (via <a href="https://percy.io/">percy.io</a>). All regressions (in both nightly and stable) are retro’d to ensure fixed things stay fixed (usually via writing new tests), and we have converted <a href="https://arewetsyet.bit.ovh/">fully to typescript</a> for full type safety.</p>
<p>Concretely, since May, we’ve increased js-sdk unit test coverage by ~10% globally, increased react-sdk coverage by ~17%, and added ever more Cypress integration tests to cover the broad strokes.  Cypress now <a href="https://github.com/matrix-org/matrix-react-sdk/pull/9104">completely replaces</a> our old Puppeteer-based end-to-end tests, and Sliding Sync work in matrix-react-sdk is being extensively tested by Cypress from the outset (the Sliding Sync PR literally comes with a Cypress test suite).</p>
<p>In mobile land, the situation is more complex given our long-term strategy is to deprecate matrix-ios-sdk and matrix-android-sdk2 in favour of matrix-rust-sdk. matrix-rust-sdk has always had <a href="https://app.codecov.io/gh/matrix-org/matrix-rust-sdk">excellent coverage</a>, and in particular, adopting the crypto module in the current matrix-{js,ios,android}-sdk will represent a night and day improvement for quality (not to mention perf!). We’ll also be adopting <a href="https://github.com/vector-im/element-x-ios/pull/50">PR checks</a>, and screenshot testing for the mobile SDKs.</p>
<p>On the backend, we continue to build out test cases for our new integration tester <a href="https://github.com/matrix-org/complement">Complement</a> (in Golang), alongside the original <a href="https://github.com/matrix-org/sytest">sytest</a> integration test suite (in Perl). In particular, we can now test Synapse in worker mode. The intention with Complement is that it should be homeserver agnostic so that <em>any</em> homeserver implementation can benefit. Indeed the project was initiated by Kegan wearing his Dendrite hat. </p>
<p>Finally, we’ve had a huge breakthrough with true multi-client end-to-end testing in the form of Michael Kaye’s brand new <a href="https://github.com/matrix-org/trafficlight">Traffic Light</a> project. For the first time, we can fully test things like cross signing and verification and VoIP calls end-to-end across completely different platforms and different clients. It’s early days yet, but this really will be a game changer, especially for crypto and VoIP. </p>
<p>Next up, we will turn our attention to a performance testing framework so that we can reliably track performance improvements and regressions in an automated fashion - heavily inspired by Safari’s <a href="https://www.goodreads.com/quotes/9844796-don-was-the-one-who-figured-out-how-we-would">Page Load Test</a> approach. This will be essential as we build out new clients like Element X.</p>
<h2 id="a-whole-new-world">A whole new world</h2>
<p>All the stuff above is focused on improving the core performance and usability of Matrix - but in parallel we have also been making enormous progress on entirely new features and capabilities. The following isn’t a comprehensive list, but we wanted to highlight a few of the areas where new development is progressing at a terrifying rate…</p>
<h3 id="native-voip-conferencing">Native VoIP Conferencing</h3>
<p>2022 is turning out to be the year that Matrix finally gets fully native voice/video conferencing. After speccing <a href="https://github.com/matrix-org/matrix-spec-proposals/blob/matthew/group-voip/proposals/3401-group-voip.md">MSC3401</a> at the end of last year, <a href="https://element.io/blog/introducing-native-matrix-voip-with-element-call/">Element Call Beta 1</a> launched as a reference implementation back in March, followed by enabling E2EE, spatial audio and walkie-talkie mode in <a href="https://element.io/blog/element-call-beta-2-encryption-spatial-audio-walkie-talkie-mode-and-more/">Element Call Beta 2</a> in June.</p>
<p>However, the catch was that Element Call beta 1 and 2 only ever implemented “full mesh” conferencing - where every participant calls every other participant simultaneously, limiting the size of the conference to ~7 participants on typical hardware, and wasting lots of bandwidth (given you end up sending the same upstream multiple times over for all the other participants).  Element Call has been working surprisingly well in spite of this, but the design of MSC3401 was always to have “foci” (the plural of ‘focus’ - i.e. conference servers) to optionally sit alongside homeservers in order to aggregate the participating calls, a bit like this:</p>
<p><img src="/blog/img/2022-08-15-msc3401.jpg" alt="MSC3401 Architecture" /></p>
<p>With foci, clients only need to send their upstream to their local focus, rather than replicating it across all the other participants - and the focus can then fan it out to other foci or clients as required.  In fact, if no other clients are even watching your upstream, then your client can skip sending an upstream to its focus entirely!</p>
<p>Most importantly, foci are decentralised, just like Matrix: there is no single conference server as a single point of control or failure responsible for powering the group call - users connect to whichever focus is closest to them, and so you automatically get a standards-based heterogeneous network-split-resilient geographically distributed cascading conferencing system with end-to-end-encryption, powered by a potentially infinite number of different implementations.  To the best of our knowledge, this is the first time someone’s proposed an approach like this for decentralised group calling (watch out, Zoom, we’re coming for you!)</p>
<p>Now, the VoIP team have been busy polishing Element Call (e.g. chasing down end-to-end encryption edge cases and reliability), and also figuring out how to embed it into Element and other Matrix clients as a quick way to get excellent group VoIP (more on that later).  As a result, work on building out foci for scalable conferencing had to be pushed down the line.</p>
<p>But in the last few months this completely changed, thanks to an <strong>amazing</strong> open source contribution from Sean DuBois, project lead over at <a href="https://pion.ly/">Pion</a> - the excellent Golang WebRTC implementation.  Inspired by our <a href="https://2021.commcon.xyz/talks/extending-matrix-s-e2ee-calls-to-multiparty">initial talk</a> about MSC3401 at CommCon, Sean independently decided to see how hard it’d be to build a Selective Forwarding Unit (SFU) focus that implemented MSC3401 semantics using Pion - and published it at <a href="https://github.com/sean-der/sfu-to-sfu">https://github.com/sean-der/sfu-to-sfu</a> (subsequently donated to github.com/matrix-org).  In many ways this was a flag day for Matrix: it’s the first time that a core MSC from the core team has been first implemented from outside the core team (let alone outside the Matrix community!).  It’s the VoIP equivalent of Synapse starting off life as a community contribution rather than being written by the core team.</p>
<p>Either way: Sean’s SFU work has opened the floodgates to making native Matrix conferencing actually scale, with Šimon Brandner and I jumping in to <a href="https://github.com/matrix-org/matrix-js-sdk/pull/2423">implement SFU support</a> in matrix-js-sdk… and as of a few weeks ago we did the first ever SFU-powered Matrix call - which worked impressively well for 12 participants!</p>
<p><img src="/blog/img/2022-08-15-sfu.jpg" alt="12 person Element Call" /></p>
<p>Now, this isn’t released yet, and there is still work to be done, including:</p>
<ul>
<li>We actually need to select the subset of streams we care about from the focus</li>
<li>We need to support thumbnail streams as well as high-res streams</li>
<li>We need rate control to ensure clients on bad connections don’t get swamped</li>
<li>We need to hook up cascading between foci (although the SFU already supports it!)</li>
<li>We need E2EE via insertable streams</li>
<li>Faster signalling for switching between streams</li>
</ul>
<p>You can see the full todo list for basic and future features over on GitHub.  However, we’re making good progress thanks to Šimon’s work and Sean’s help - but with any luck beta 3 of Element Call might showcase SFU support!</p>
<p>Meanwhile it’s worth noting that Element Call is not the only MSC3401 implementation out there - the Hydrogen team has added native support to Hydrogen SDK too (skipping over the old 1:1 calling), so expect to see Element &lt;-&gt; Hydrogen calling in the near future. The Hydrogen implementation is also what powers Third Room (see below…)</p>
<h3 id="matryoshka-voip-embedding">Matryoshka VoIP Embedding</h3>
<p>Elsewhere on VoIP, we’ve also been hard at work figuring out how to embed Element Call into Matrix clients in general, starting with Element Web, iOS &amp; Android.  Given MSC3401 is effectively a superset of native 1:1 Matrix VoIP calling, we’d ideally like to replace the current 1:1-only VoIP implementation in Element with an embedded instance of Element Call (not least so we don’t have to maintain it in triplicate over Web/iOS/Android, and because WebRTC-in-a-webview really isn’t very different to native WebRTC).  To do this efficiently however, the embedded Element Call needs to share the same underlying Matrix client as the parent Element client (otherwise you end up wasting resources and devices and E2EE overhead between the two).  Effectively Element Call ends up needing to parasite off the parent’s client.  We call this approach “matryoshka embedding”, given it resembles nested Russian dolls. 🪆</p>
<p>In practice, we do this by extending the Widget API to let Matrix clients within the widget share the parent’s Matrix client for operations such as sending and receiving to-device messages and accessing TURN servers (c.f. <a href="https://github.com/matrix-org/matrix-spec-proposals/blob/travis/msc/widgets-send-recv-toDevice/proposals/3819-to-device-messages-for-widgets.md">MSC3819</a> and <a href="https://github.com/robintown/matrix-doc/blob/widget-turn-servers/proposals/3846-widget-turn-servers.md">MSC3846</a>).  This in turn has been <a href="https://github.com/matrix-org/matrix-widget-api/pull/57">implemented</a> in the matrix-widget-api helper library for widget implementers - and then a few days ago Robin demonstrated the world’s first ever matryoshka embedded Element Call call, looking like this:</p>
<p><img src="/blog/img/2022-08-15-matryoshka.jpg" alt="Matryoshka embedded Element Call" /></p>
<p>Note that the MSC3401 events are happening in the actual room where the widget has been added, sent by the right users from Element Web rather than from Element Call, and so are subject to all the normal Matrix access control and encryption semantics.  This is a <em>huge</em> step forwards from embedding Jitsi widgets, where the subsequent call membership and signalling happens in an entirely separate system (XMPP via Prosody, ironically) - instead: this is proper native Matrix calling at last.</p>
<p>Moreover, the same trick could be used to efficiently embed other exotic Matrix clients such as Third Room or <a href="https://github.com/toger5/TheBoard">TheBoard</a> - giving the user the choice either to use the app standalone or within the context of their existing Matrix client. Another approach could be to use OIDC scopes to transparently log the embedded client in using the parent’s identity; this has the advantage of no code changes being needed on the embedded client - but has the disadvantage that you needlessly end up running two Matrix clients for the same account side by side, and adding another device to your account, which isn’t ideal for a performance sensitive app like Element Call or Third Room.</p>
<p>Matryoshka embedding isn’t live yet, but between scalable calls via SFU and native Element Call in Element Web/iOS/Android, the future is looking incredibly exciting for native Matrix VoIP.  We hope to finish embedding Element Call in Element Web/iOS/Android in Sept/Oct - and if we get lucky perhaps the SFU will be ready too and then Element Call can exit beta!</p>
<p>Finally, we also added Video Rooms to Element Web - adding the user interface for an “always on” video room that you can hop into whenever you want.  You can read about it over on the <a href="https://element.io/blog/drop-in-drop-out-chats-with-video-rooms-and-a-new-search-experience/">Element blog</a> - the initial implementation uses Jitsi, but once Element Call and Matryoshka embedding is ready, we’ll switch over to using Element Call instead (and add Voice Rooms too!)</p>
<p><img src="/blog/img/2022-08-15-video-rooms.jpg" alt="Video Rooms" /></p>
<h3 id="third-room">Third Room</h3>
<p>Just as MSC3401 and Element Call natively adds decentralised voice/video conferences to boring old textual Matrix chatrooms, <a href="https://github.com/matrix-org/matrix-spec-proposals/pull/3815">MSC3815</a> and <a href="https://github.com/matrix-org/thirdroom/blob/main/README.md">Third Room</a> go the whole enchilada and adds a full decentralised 3D spatial collaboration environment into your Matrix room - letting you turn your Matrix rooms into a full blown interconnected virtual world.</p>
<p>I can’t overstate how exciting this is: one of the key origins of Matrix was back in Oct 2013 when Amandine and myself found ourselves in Berlin after TechCrunch Disrupt, debating why Second Life hadn’t been more successful - and wondering what you’d have to do to build an immersive 3D social environment which would be as positive and successful as a wildly popular chat network.  Our conclusion was that the first key ingredient you’d need would be a kick-ass open decentralised communication protocol to build it on - providing truly open communication primitives that anyone could build on, much like the open web… and that was what got us thinking about how to build Matrix.</p>
<p>Fast forward 9 years, and Third Room is making <em>spectacular</em> progress in building out this dream, thanks to the incredibly hard work of Robert, Nate and Ajay. The goal of Third Room is to be an open platform layered directly on Matrix for spatial collaboration of any kind: effectively a blank canvas to let folks create freeform collaborative 3D (and in future 2D, VR or AR) experiences, either by using existing assets or building their own user-generated content and functionality. Just like the open web itself, this unlocks a literally infinite range of possibilities, but some of the obvious uses include: spatial telepresence, social VR, 3D visualisation of GIS or weather data, 3D simulated environments, search and rescue and disaster response operations (imagine streaming LIDAR from a drone surveying hurricane devastation into Third Room, where you can then overlay and collaborate on GIS data in realtime), and of course 3D gaming in all its various forms.</p>
<p>Now, we’re hoping to give Third Room a proper launch in a few weeks, so I’m not going to spoil too much right now - but the final pieces which are currently coming together include:</p>
<ul>
<li>Finalising the initial version of <a href="https://github.com/matrix-org/thirdroom/tree/main/src/engine">Manifold</a>, the multi-threaded game engine which powers Third Room (built on <a href="https://threejs.org/">Three.JS</a>, <a href="https://github.com/NateTheGreatt/bitECS">bitECS</a> and <a href="https://rapier.rs/">Rapier</a>), using SharedArrayBuffers as triple-buffers to synchronise between the various threads.  See <a href="https://github.com/matrix-org/thirdroom/discussions/47#discussion-4033099">this update</a> for a bit more detail on how the engine works.</li>
<li>Finalising the Matrix client interface itself, powered by <a href="https://github.com/vector-im/hydrogen-web/blob/master/doc/SDK.md">Hydrogen SDK</a> in order to be as lightweight as possible</li>
<li>Adding in full spatial audio and game networking via MSC3401 and Hydrogen SDK (currently full mesh, but will go SFU as soon as SFUs land!)</li>
<li>Adding in animated avatars (currently using <a href="https://www.mixamo.com/">Mixamo</a> animations)</li>
<li>Adding in name tags and object labels</li>
<li>Adding in 3D Tile support in order to incrementally load 3D map tiles à la Google Earth</li>
<li>Building an asset pipeline from Unity and Blender through to the glTF assets which Third Room uses.</li>
<li>Initial framework for an in-world direct-manipulation <a href="https://twitter.com/matrixdotorg/status/1550534909089189888">editor</a></li>
<li>Lightmap support for beautiful high-performance static lighting and shadows</li>
<li>Full post-processing pipeline (bloom, depth-of-field, anti-aliasing etc)</li>
<li>Integrating with OIDC for login, registration, and account management (see OIDC below)</li>
</ul>
<p>As a quick teaser - here’s an example of a <a href="https://assetstore.unity.com/packages/3d/environments/sci-fi/3d-scifi-kit-vol-3-121447">Unity asset</a> exported into Third Room, showing off lightmaps (check out the light and shadows cast by the strip lighting inside, or the shadow on the ground outside).  Ignore the blurry HDR environment map of Venice in the background, which is just there to give the metals something to reflect.  Check out the stats on the right-hand side: on Robert’s M1 Macbook Pro we’re getting a solid 60fps at 2000x1244px, with 13.12ms of unused gametime available for every 16.67ms frame, despite already showing a relatively complicated asset!</p>
<iframe width="2056" height="980" src="https://www.youtube.com/embed/xvjMyYxZbmM" title="Third Room prototype demo 1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Meanwhile, here are some shots of Robert and Nate chasing each other around the UK City demo environment (also exported from <a href="https://assetstore.unity.com/packages/3d/environments/urban/city-builder-london-214943">Unity</a>), showing off blended Mixamo animations and throwing around crates thanks to the Rapier physics engine.</p>
<iframe width="2056" height="980" src="https://www.youtube.com/embed/y2mU19QwZPg" title="Third Room prototype demo 2" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<iframe width="2056" height="980" src="https://www.youtube.com/embed/QEt80wvO4yY" title="Third Room prototype demo 3" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<br/>
<p>And don't forget, it's just a Matrix client - with no infrastructure required other than a normal Matrix server:</p>
<p><img src="/blog/img/2022-08-15-thirdroom-overlay.jpg" alt="Third Room Overlay" /></p>
<p>As you can see, we are rapidly approaching the point where we’ll need support from technical artists to help create beautiful scenes and avatars and assets in order to make it all come to life - especially once the Blender and Unity pipelines, and/or the Third Room editor are finished. If you’re interested in getting involved come chat at <a href="https://matrix.to/#/#thirdroom:matrix.org">#thirdroom:matrix.org</a>!</p>
<h3 id="wysiwyg">WYSIWYG</h3>
<p>Back in the real world, a recent new project that we haven’t spoken about much yet is adding consistent WYSIWYG (What You See Is What You Get) editing to the message composer in matrix-{react,ios,android}-sdk as used by Element Web/iOS/Android - as well as publishing the resulting WYSIWYG editor for the greater glory of the wider ecosystem.</p>
<p>This is a bit of a contentious area, because we’ve tried several times over the years to add a rich text editor to matrix-react-sdk - firstly with the <a href="https://draftjs.org/">Draft.js</a> <a href="https://github.com/matrix-org/matrix-react-sdk/pull/292">implementation</a> by Aviral (which we abandoned after Facebook de-staffed Draft), and then later with a <a href="https://www.slatejs.org">Slate</a> <a href="https://github.com/matrix-org/matrix-react-sdk/pull/1890">implementation</a> by me (which we abandoned thanks to the maintenance burden of keeping up with Slate’s API changes).  Finally, burnt by the experience with third party solutions, Bruno wrote his own editor called <a href="https://github.com/matrix-org/matrix-react-sdk/blob/develop/docs/ciderEditor.md">CIDER</a>, which was a great success and is what Element Web uses today to author messages including ‘pills’ for structured rooms/users etc… but this deliberately didn’t provide full WYSIWYG functionality.  Meanwhile, Slack added WYSIWYG, forced it on, and <a href="https://quuxplusone.github.io/blog/2019/11/20/slack-rich-text-box/">screwed it up</a> - and apps like WhatsApp and Discord seem to get by fine without WYSIWYG. </p>
<p>However, given that users are now used to WYSIWYG in Teams and Slack, we’ve now decided to have another go at it, inspired by CIDER’s success - and with the novel twist that the heavy lifting of modelling and versioning the document and handling Unicode + CJK voodoo will be provided by a cross-platform native library written in Rust, ensuring that matrix-{react,ios,android}-sdk (and in future matrix-rust-sdk-based apps like Element X) all have precisely the same consistent semantics, and we don’t spend our lives fixing per-platform WYSIWYG bugs unless it really is a platform-specific issue with the user interface provided on that particular platform.</p>
<p>The project is fairly young but developing fast, and lives over at <a href="https://github.com/matrix-org/matrix-wysiwyg">https://github.com/matrix-org/matrix-wysiwyg</a> (better name suggestions welcome ;) - we’re aiming to get it into clients by the end of October.  The editor itself is not Matrix specific at all, so it’ll be interesting to see if other projects pick it up at all - and meanwhile, if we’ve done a good job, it’ll be interesting to see if this can be used to power Matrix-backed collaborative-editing solutions in future…</p>
<iframe width="2056" height="980" src="https://www.youtube.com/embed/9_UhNBKUk7A" title="WYSIWYG teaser on Android" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p><strong>Update</strong>: we should have mentioned that the WYSIWYG editor project is being built out by staff at Element, who very kindly have been sponsored to work on it by one of Element's Big Public Sector Customers in order to get to parity with Teams.  Thank you!!</p>
<h3 id="are-we-oidc-yet">Are We OIDC Yet?</h3>
<p>On the other hand, a project we recently <a href="https://matrix.org/blog/2022/08/10/areweoidcyet-com-matrix-and-open-id-connect">yelled about</a> a lot is Matrix’s transition to Open ID Connect for standards-based authentication and account management.  We announced this at the <a href="https://matrix.org/blog/2021/12/22/the-mega-matrix-holiday-special-2021#openid-connect">end of the year</a> and the project has built up huge momentum subsequently, culminating with the release of <a href="https://areweoidcyet.com">https://areweoidcyet.com</a> last week to track the progress and remaining work.</p>
<p>Our plan is to use native OIDC in production for the first time to provide all the login, registration and account management for Third Room when it launches in a few weeks (using a branded Keycloak instance as the identity provider, for convenience).  After all, the last thing we wanted to do was to waste time building fiddly Matrix-specific login/registration UI in Third Room when we’re about to move to OIDC!  This will be an excellent case study to see how it works, and how it feels, and inform the rest of the great OIDC experiment and proposed migration.</p>
<h3 id="dendrite-p2p">Dendrite + P2P</h3>
<p>Meanwhile, the Next Generation team has continued to focus on their mission to make Dendrite as efficient and usable as possible. Within recent months, Dendrite has matured dramatically, with a considerable list of bugs fixed, performance significantly improved and new features added - push notifications, history visibility and presence to name a few notable additions.</p>
<p>Neil Alexander, Kegan and Till have continued to streamline the Dendrite architecture and to refactor areas of the codebase which have long needed attention, as well as moving from Kafka to NATS JetStream, an all-new caching model and some other fairly major architectural changes. We’ve also seen an increase of code contributions from the community and outside organisations, which is exciting, and the <a href="https://github.com/matrix-org/gomatrixserverlib">gomatrixserverlib</a> library which underpins much of Dendrite is also seeing more active development and attention thanks to its use in the <a href="https://github.com/matrix-org/complement">Complement</a> integration testing suite.</p>
<p>With the most recent <a href="https://github.com/matrix-org/dendrite/releases">0.9.3 release</a>, we are proud to announce that <strong>Dendrite now</strong> <strong>passes 90% of Client-Server API tests and 95% of Server-Server API tests</strong> and has support for all specced room versions in use today. We have a growing community of users who are (quite successfully) trialling using Dendrite homeservers day-to-day, as well as our own public <code>dendrite.matrix.org</code> homeserver, which is open to the public for registration for anyone who wants to experiment with Dendrite without running their own deployment.</p>
<p>Dendrite plays an important role in our future strategy as it is also the homeserver implementation used for embedded homeservers, P2P development and experimentation. In addition to being able to scale up, we have also successfully scaled down, with the Element P2P demos proving that an embedded Dendrite homeserver can run comfortably on an iOS or Android device.</p>
<p>Research on the <a href="https://github.com/matrix-org/pinecone/">Pinecone</a> overlay network for P2P Matrix has also continued, with Devon and Neil having experimented with a number of protocol iterations and spent considerable time bringing the <a href="https://github.com/matrix-org/pinecone/tree/main/cmd/pineconesim">Pinecone Simulator</a> up to scratch to help us to test our designs more rapidly. Our work in this area is helping us to form a better direction and strategy for P2P Matrix as a whole, which is moving more towards a hybridised model with the current Matrix federation — a little different to our original vision, but will hopefully result in a much smoother transition path for existing users whilst solving some potential scaling problems. The <a href="https://arewep2pyet.com">arewep2pyet.com</a> site is a living page which contains a high level overview of our goals and all the progress being made.</p>
<h2 id="what-s-left">What’s left?</h2>
<p>Comparing all of the above with the <a href="https://matrix.org/blog/2021/12/22/the-mega-matrix-holiday-special-2021#2022">predictions for 2022</a> section of the end-of-year blog post, we’re making very strong progress in a tonne of areas - and the list above isn’t comprehensive.  For instance, we haven’t called out all the work that the Trust &amp; Safety team are doing to roll out advanced moderation features by default to all communities - or the work that Eric has been doing to close the remaining gap between Gitter and Matrix by creating new static archives throughout Matrix.  Hydrogen has also been beavering away to provide a tiny but perfectly formed web client suitable for embedding, including the new embeddable Hydrogen SDK. We haven’t spoken about the work that the Cryptography team have been doing to adopt vodozemac and matrix-rust-sdk-crypto throughout matrix-{js,ios,android}-sdk, or improve encryption stability and security throughout.  We’ve also not spoken about the new initiative to fix long-term chronic bugs (outside of the work above) in general - or all the work being done around <a href="https://matrix.org/blog/2022/03/30/technical-faq-on-the-digital-markets-act">Digital Markets Act interoperability</a>…</p>
<p>Other things left on the menu for this year include getting Threads out of beta: we’ve had a bit of an adventure here figuring out how to get the right semantics for notification badges and unread state in rooms with threads (especially if you use a mix of clients which support and don’t support threads), and once that’s done we’ll be returning to Spaces (performance, group permissions etc).</p>
<h2 id="matrix-2-0">Matrix 2.0?</h2>
<p>Looking through this post (and congratulations if you’re still reading it at this point ;P), it really feels that Matrix is on the verge of shifting into a new phase.  Much as MacOS X started off as a promising but distinctly unoptimised operating system, and then subsequently got unrecognisably faster year by year (even on the same hardware!) as Apple diligently worked away optimising the kernel… similarly: we are now landing the architectural changes to completely transform how Matrix performs.</p>
<p>Between protocol changes like Sliding Sync, Faster Joins, native OIDC and native VoIP conferencing all landing at roughly the same time - and alongside new implementations like matrix-rust-sdk and vodozemac, let alone Third Room - it feels unquestionably like we have an unrecognisable step change on the horizon.  Our aim is to land as much of this as possible by the end of the year, and if we pull it off, I’m tempted to suggest we call the end result Matrix 2.0.</p>
<p>To the future! 🚀</p>
<p>Matthew, Amandine &amp; the whole core team.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2022&#x2F;05&#x2F;30&#x2F;welcoming-rocket-chat-to-matrix&#x2F;" title="Welcoming Rocket.Chat to Matrix!">Welcoming Rocket.Chat to Matrix!</a></h2>
                <span>
                    30.05.2022 19:04
                    —
                    <a href="/category/general">
                        General
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                <br>
                <small>Last update: 30.05.2022 16:16</small>
            </header>
            <div>
                
                <div style="text-align: center">
<img src="/blog/img/rocketchat.png" alt="Rocket.Chat ♥️ Matrix"/>
</div>
<p>Hi folks,</p>
<p>We just wanted to take a moment to welcome <a href="https://rocket.chat">Rocket.Chat</a> to Matrix, given the <a href="https://rocket.chat/press-releases/rocket-chat-leverages-matrix-protocol-for-decentralized-and-interoperable-communications">recent announcement</a> that they are switching to using Matrix for standards-based interoperable federation!  This is incredible news: Rocket.Chat is one of the leading open source collaboration platforms with <a href="https://rocket.chat/company/about-us">over 12 million users</a>, and they will all shortly have the option to natively interoperate with the wider Matrix network: the feature has already landed (in alpha) in <a href="https://github.com/RocketChat/Rocket.Chat/releases/tag/4.7.0">Rocket.Chat 4.7.0</a>!</p>
<p>We’d like to thank the whole Rocket.Chat team for putting their faith in Matrix and joining the network: the whole idea of Matrix is that by banding together, different independent organisations can build an open decentralised network which is far stronger and more vibrant than any closed communication platform.  The more organisations that join Matrix, the <a href="https://en.wikipedia.org/wiki/Metcalfe%27s_law">more useful and valuable</a> the network becomes for everyone, and the more momentum there is to further refine and improve the protocol.  Our intention is that Matrix will grow into a massive open ecosystem and industry, akin to the open Web itself… and that every organisation participating, be that Rocket.Chat, Element, Gitter, Beeper, Famedly or anyone else will benefit from being part of it. We are stronger together!</p>
<p>Rocket.Chat’s implementation follows the “<a href="https://matrix.org/blog/2020/12/07/gitter-now-speaks-matrix#how-do-you-make-an-existing-chat-system-talk-matrix">How do you make an existing chat system talk Matrix?</a>” approach we published based on our experiences of linking Gitter into Matrix. Looking at the initial <a href="https://github.com/RocketChat/Rocket.Chat/pull/23688">pull request</a>, the implementation lets Rocket.Chat act as a Matrix Application Service, effectively acting as a bridge to talk to an appropriate Matrix homeserver.  From chatting with the team, it sounds like next steps will involve adding in encryption via our upcoming <a href="https://github.com/matrix-org/matrix-rust-sdk/issues/699">matrix-sdk-crypto node bindings</a> - and then looking at ways to transparently embed a homeserver like Dendrite, sharing data as much as possible between RC and Matrix, so Rocket.Chat deployments can transparently sprout Matrix interoperability without having to run a separate homeserver.  Super exciting!</p>
<p>You can see a quick preview of a Rocket.Chat user chatting away with an Element user on matrix.org via Matrix here:</p>
<p><video style="width: 100%" src="/blog/img/164530391-e8b17ecd-a4d0-4ef8-a8b7-81230c1773d3.mp4" controls></video></p>
<p>So, exciting times ahead - needless to say we’ll be doing everything we can to support Rocket.Chat and ensure their Matrix integration is a success.  And at this rate, they might be distinctly ahead of the curve if they start shipping Dendrite!  Meanwhile, we have to wonder who will be next? Nextcloud? Mattermost? Place your bets… ;)</p>
<p>--Matthew</p>
<h3 id="update">Update</h3>
<p>Aaron from Rocket.Chat just published an <a href="https://geekgonecrazy.com/2022/05/30/rocketchat-and-the-matrix-protocol/">excellent guide &amp; video tour</a> for how to actually set up your Rocket.Chat instance with Dendrite to get talking Matrix!</p>
<div style="text-align: center">
<iframe width="680" height="383" src="https://www.youtube.com/embed/oQhIH8kql9I" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2022&#x2F;05&#x2F;16&#x2F;independent-public-audit-of-vodozemac-a-native-rust-reference-implementation-of-matrix-end-to-end-encryption&#x2F;" title="Independent public audit of Vodozemac, a native Rust reference implementation of Matrix end-to-end encryption">Independent public audit of Vodozemac, a native Rust reference implementation of Matrix end-to-end encryption</a></h2>
                <span>
                    16.05.2022 17:04
                    —
                    <a href="/category/general">
                        General
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                <br>
                <small>Last update: 16.05.2022 16:02</small>
            </header>
            <div>
                
                <p>Hi all,</p>
<p>It’s been <a href="https://matrix.org/blog/2016/11/21/matrixs-olm-end-to-end-encryption-security-assessment-released-and-implemented-cross-platform-on-riot-at-last">quite a while</a> since our last independent E2EE review, and so we’re incredibly proud to present an <a href="https://matrix.org/media/Least%20Authority%20-%20Matrix%20vodozemac%20Final%20Audit%20Report.pdf">entirely new independent security audit</a> of <a href="https://github.com/matrix-org/vodozemac">vodozemac</a>, our next generation native Rust implementation of Matrix’s <a href="https://gitlab.matrix.org/matrix-org/olm/blob/master/docs/olm.md">Olm</a> and <a href="https://gitlab.matrix.org/matrix-org/olm/blob/master/docs/megolm.md">Megolm</a> E2EE protocols.  The audit has been conducted by <a href="https://leastauthority.com/">Least Authority</a>, who specialise in <a href="https://leastauthority.com/security-consulting/published-audits/">comprehensive audits</a> of security-sensitive decentralized technologies - and we are very grateful to <a href="https://www.gematik.de/anwendungen/ti-messenger">gematik</a>, who kindly shared the costs of funding the audit as part of their <a href="https://matrix.org/blog/2021/07/21/germanys-national-healthcare-system-adopts-matrix">commitment to Matrix for healthcare in Germany</a>.</p>
<p>This audit was a bit of a whirlwind, as while we were clearly overdue an audit of Matrix’s E2EE implementations, we decided quite late in the day to focus on bringing vodozemac to auditable production quality rather than simply doing a refresh of the original <a href="https://matrix.org/blog/2016/11/21/matrixs-olm-end-to-end-encryption-security-assessment-released-and-implemented-cross-platform-on-riot-at-last">libolm audit</a>.  However, we got there in time, thanks to a monumental sprint from <a href="https://github.com/matrix-org/vodozemac/graphs/contributors">Damir and Denis</a> over Christmas.  The reason we went this route is that vodozemac is an enormous step change forwards in quality over <a href="https://gitlab.matrix.org/matrix-org/olm">libolm</a>, and vodozemac is now the reference Matrix E2EE implementation going forward.  Just as libolm went live with NCC’s security review back in 2016, similarly we’re kicking off the first stable release of vodozemac today with Least Authority’s audit.  In fact, vodozemac just shipped as the default E2EE library in <a href="https://github.com/matrix-org/matrix-rust-sdk/releases/tag/matrix-sdk-0.5.0">matrix-rust-sdk 0.5</a>, released at the end of last week!</p>
<p>The main advantages of vodozemac over libolm include:</p>
<ul>
<li>Native Rust - type, memory and thread safety is preserved both internally, and within the context of larger Rust programs (such as those building on matrix-rust-sdk).  This is particularly important given the <a href="https://matrix.org/blog/2021/06/14/adventures-in-fuzzing-libolm">memory bugs</a> which libolm sprouted, despite our best efforts to the contrary.</li>
<li>Performance - vodozemac benchmarks roughly 5-6x faster than libolm on typical hardware</li>
<li>Better primitives - vodozemac is built on the best practice cryptographic primitives from the Rust community, rather than the generic Brad Conte primitives used by libolm.</li>
</ul>
<p>Also, we’ve finally fixed one of the biggest problems with libolm - which was that the hardest bit of implementing E2EE in Matrix wasn’t necessarily the encryption protocol implementation itself, but how you glue it into your Matrix client’s SDK.  It turns out ~80% of the code and complexity needed to securely implement encryption ends up being in the SDK rather than the Olm implementation - and each client SDK ended up implementing its own independent state machine and glue for E2EE, leading to a needlessly large attack &amp; bug surface.</p>
<p>To address this problem, vodozemac is designed to plug into <a href="https://github.com/matrix-org/matrix-rust-sdk/tree/main/crates/matrix-sdk-crypto">matrix-sdk-crypto</a> - an SDK-independent Rust library which abstracts away the complexities and risks of implementing E2EE, designed to plug into existing SDKs in any language.  For instance, Element Android already <a href="https://github.com/vector-im/element-android/pull/3209">supports</a> delegating its encryption to matrix-sdk-crypto; Element iOS got this working too last week, and we’re <a href="https://github.com/Hywan/matrix-rust-sdk/commits/feat-crypto-wasm">hard at work</a> adding it to Element Web too.  (This set of projects is codenamed Element R).  Meanwhile, <a href="https://youtu.be/chsyOWKvne4">Element X</a> (the project to switch Element iOS and Element Android to use matrix-rust-sdk entirely) obviously benefits from it too, as matrix-rust-sdk now leans on matrix-sdk-crypto for its encryption.</p>
<p>Therefore we highly recommend that developers using libolm migrate over to vodozemac - ideally by switching to matrix-sdk-crypto as a way of managing the interface between Matrix and the E2EE implementation.  Vodozemac does also provides a similar API to libolm with <a href="https://github.com/matrix-org/vodozemac-bindings">bindings for JS and Python</a> (and C++ in progress) if you want to link directly against it - e.g. if you’re using libolm for something other than Matrix, for example XMPP, ActivityPub or Jitsi.  We’ll continue to support and maintain libolm for now though, at least until the majority of folks have switched to vodozemac.</p>
<p>In terms of the audit itself - we recommend <a href="https://matrix.org/media/Least%20Authority%20-%20Matrix%20vodozemac%20Final%20Audit%20Report.pdf">reading it yourself</a>, but the main takeaway is that Least Authority identified 10 valid concerns, of which we addressed 8 during the audit process. The remaining two are valid but lower priority, and we’ll fix them as part of our maintenance backlog.  All the issues identified are excellent valid points, and we’re very glad that Least Authority have added huge value here by highlighting some subtle gotchas which we’d missed.  (If you write Rust, you’ll particularly want to check out their zeroisation comments).</p>
<p>So: exciting times!  Vodozemac should be landing in a Matrix client near you in the near future - we’ll yell about it loudly once Element switches over.  In the meantime, if you have any questions, please head over to <a href="https://matrix.to/#/#e2ee:matrix.org">#e2ee:matrix.org</a>.</p>
<p>Thanks again to gematik for helping fund the audit, and to Least Authority for doing an excellent job - and being patient and accommodating beyond the call of duty when we suddenly switched the scope from libolm to vodozemac at the last minute ;)</p>
<p>Next up: we’re going to get the Rust matrix-sdk-crypto independently audited (once <a href="https://github.com/matrix-org/matrix-rust-sdk/milestone/1">this burndown</a> is complete) so that everyone using the matrix-sdk-crypto state machine for Matrix E2EE can have some independent reassurance too - a huge step forward from the wild west of E2EE SDK implementations today!</p>
<p>– Matthew</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2022&#x2F;03&#x2F;30&#x2F;technical-faq-on-the-digital-markets-act&#x2F;" title="Technical FAQ on the Digital Markets Act">Technical FAQ on the Digital Markets Act</a></h2>
                <span>
                    30.03.2022 14:13
                    —
                    <a href="/category/general">
                        General
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hi all,</p>
<p>We've been flooded with questions about the <a href="https://www.europarl.europa.eu/news/en/press-room/20220315IPR25504/">DMA</a>
since it was announced last week, and have spotted some of the
gatekeepers jumping to the wrong conclusions about what it might entail.
Just in case you don't want to wade through
yesterday's <a href="https://matrix.org/blog/2022/03/29/how-do-you-implement-interoperability-in-a-dma-world/">sprawling blog post</a>,
we've put together a quick FAQ to cover the most important points based on
our understanding.</p>
<h3 id="what-does-dma-mean-for-the-gatekeepers">What does DMA mean for the gatekeepers?</h3>
<p>The gatekeepers will have to open and document their existing APIs, so that
alternative clients and/or bridges can connect to their service. The DMA
requires that the APIs <em>must</em> expose the same level of privacy for remote
users as for local users. So, if their service is end-to-end-encrypted
(E2EE), the APIs must expose the same E2EE semantics (e.g. so that an
alternative client connecting would have to implement E2EE too). For
E2EE-capable APIs to work, the gatekeeper will likely have to model remote
users as if they were local in their system. In the short term (one year
horizon) this applies only to 1:1 chats and file transfers. In the long term
(three year horizon) this applies to group chats and voip calls/conferences
too.</p>
<h3 id="who-counts-as-a-gatekeeper">Who counts as a “gatekeeper”?</h3>
<p>The DMA defines any tech company worth over €75B or with over €7.5B of
turnover as a gatekeeper, who must open their communication APIs. This means
only the tech giants are in scope (e.g. as of today that includes Meta,
Apple, Google, Microsoft, Salesforce/Slack - not Signal, Telegram, Discord,
Twitter).</p>
<h3 id="does-this-mean-the-gatekeepers-are-being-forced-to-implement-an-open-standard-such-as-matrix-or-xmpp">Does this mean the gatekeepers are being forced to implement an open standard such as Matrix or XMPP?</h3>
<p>No. They can keep their existing implementations and APIs. For
interoperability with other service providers, they will need to use a
bridge (which could bridge via a common language such as Matrix or XMPP).</p>
<h3 id="are-bridges-secure">Are bridges secure?</h3>
<p>If the service lacks end-to-end-encryption (Slack, Teams, Google Chat,
non-secret chats on Facebook Messenger, Instagram, Google Messages etc) then
the bridge does not reduce security or privacy, beyond the fact that bridged
conversations by definition will be visible to the bridge and to the service
you are interoperating with.</p>
<p>If the service has E2EE (WhatsApp, iMessage, secret chats on Messenger) then
the bridge will necessarily have to decrypt (and reencrypt, where possible)
the data when passing it to the other service. This means the conversation is
no longer E2EE, and thus less secure (the bridge could be compromised and
inspect or reroute their messages) - and so gatekeepers must warn the user
that their conversation is leaving their platform and is no longer E2EE with
something like this:</p>
<div style="text-align: center">
<img src="/blog/img/2022-03-29-warning.jpg" width="430"/>
</div>
<br/>
<h3 id="why-is-the-dma-good">Why is the DMA good?</h3>
<p>The upside is that the user has the freedom to use an infinite number of
services (bots, virtual assistants, CRMs, translation services, etc) as well
as speak to any other user in the world, regardless what platform they use.</p>
<p>It also puts much-needed pressure on the gatekeepers to innovate and
differentiate rather than rely on their network effects to attract new
users - creating a much more vibrant, open, competitive marketplace for
users.</p>
<p>See &quot;<a href="https://matrix.org/blog/2022/03/29/how-do-you-implement-interoperability-in-a-dma-world#whats-driven-the-dma">What's driven the DMA?</a>&quot;
for more details.</p>
<h3 id="if-the-dma-requires-that-remote-users-have-the-same-security-as-local-users-how-can-bridges-work">If the DMA requires that remote users have the same security as local users, how can bridges work?</h3>
<p>The DMA requires that the <em>APIs</em> expose the same level of security as for
local users - ie E2EE must be exposed. If the users in a conversation choose
to use a bridge and thus reencrypt the messages, then it is their choice to
tradeoff encryption in favour of interoperability for a given conversation.</p>
<h3 id="does-this-undermine-the-gatekeepers-current-encryption">Does this undermine the gatekeepers’ current encryption?</h3>
<p>Absolutely not. Users talking to other users within the same E2EE-capable
gatekeeper will still be E2EE (assuming the gatekeeper doesn’t pull that rug
from under its users) - and in fact it gives the gatekeepers an excellent way
to advertise the selling point that E2EE is only guaranteed when you speak to
other users on the same platform.</p>
<h3 id="but-why-do-we-need-bridges-if-everyone-spoke-a-common-protocol-you-wouldn-t-ever-have-to-decrypt-messages-to-convert-them-between-protocols">But why do we need bridges? If everyone spoke a common protocol, you wouldn’t ever have to decrypt messages to convert them between protocols.</h3>
<p>Practically speaking, we don’t expect the gatekeepers to throw away their
existing stacks (or implement multihead messengers that also speak open
protocols). It’s true that if they natively spoke Matrix or XMPP then the
reencryption problem would go away, but it’s more realistic to focus on
opening the existing APIs than interpret the legislation as a mandate to
speak Matrix. Perhaps in future players will adopt Matrix of their own
volition.</p>
<h3 id="where-do-these-bridges-come-from">Where do these bridges come from?</h3>
<p>There is already a vibrant community of developers who build unofficial
bridges to the gatekeepers - eg Element, Beeper and hundreds of open source
developers in the Matrix and XMPP communities. Historically these bridges
have been hampered by having to use unofficial and private APIs, making them
a second class citizen - but with open documented APIs guaranteed by the DMA
we eagerly anticipate an explosion of high quality transparent bridges which
will be invisible to the end user.</p>
<h3 id="can-you-run-e2ee-bridges-clientside-to-make-them-safer">Can you run E2EE bridges clientside to make them safer?</h3>
<p>Maybe. For instance, current iMessage bridges work by running iMessage on a
local iPhone or Mac and then reencrypting the messages there for
interoperability. Given the messages are already exposed on the client
anyway, this means that E2EE is not broken - and avoids decrypting them on a
server. There is lots of development in this space currently, and with open
APIs guaranteed by DMA the pace should speed up significantly.</p>
<h3 id="how-can-you-tell-what-service-you-should-use-to-talk-to-a-given-remote-user">How can you tell what service you should use to talk to a given remote user?</h3>
<p>For 1:1 chats this is easy: you can simply ask the user which service they
want to use to talk to a given user, if that user is not already on that
service.</p>
<p>For group chats it is harder, and this is why the deadline for group chats is
years away. The problem is that you need a way to verify the identity of
arbitrary numbers of remote users on  different platforms - effectively
looking up their identity in a secure manner which stops services from
maliciously spoofing identities.</p>
<p>One possible way to solve this would be for users to explicitly link their
identity on one service with that on the gatekeeper’s service - eg “Alice on
AliceChat is talking in the same room as Bob on BobChat; Bob will be asked to
prove to AliceChat that he is the real Bob” - and so if AliceChat has already
validated Bob’s identity, then this can be used to spot him popping up on
other services. It also gives Bob a way to block themselves from ever being
unwittingly bridged to AliceChat.</p>
<p>There are many other approaches too - and the onus is on the industry to
figure out the best solution for decentralised identity in the next 3-4 years
in order to realise the most exciting benefits of the DMA.</p>
<hr />
<p>For a much deeper dive into the above, please check out our post at &quot;<a href="https://matrix.org/blog/2022/03/29/how-do-you-implement-interoperability-in-a-dma-world">How do you implement interoperability in a DMA world?</a>&quot;</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2022&#x2F;03&#x2F;29&#x2F;how-do-you-implement-interoperability-in-a-dma-world&#x2F;" title="How do you implement interoperability in a DMA world?">How do you implement interoperability in a DMA world?</a></h2>
                <span>
                    29.03.2022 17:57
                    —
                    <a href="/category/general">
                        General
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                <br>
                <small>Last update: 29.03.2022 09:23</small>
            </header>
            <div>
                
                <p>With last week’s revelation that the <a href="https://www.europarl.europa.eu/news/en/press-room/20220315IPR25504/deal-on-digital-markets-act-ensuring-fair-competition-and-more-choice-for-users">EU Digital Markets Act</a>
will require tech gatekeepers (companies valued at over $75B or with over
$7.5B of turnover) to open their communication APIs for the purposes of
interoperability, there’s been a lot of speculation on what this could mean
in practice, To try to ground the conversation a bit, we’ve had a go at
outlining some concrete proposals for how it could work.</p>
<p>However, before we jump in, we should review how the DMA has come to pass.</p>
<h3 id="what-s-driven-the-dma">What’s driven the DMA?</h3>
<p>Today’s gatekeepers all began with a great product, which got more and more
popular until it grew to such a size that one of the biggest reasons to use
the service is not necessarily the product any more, but the benefits of
being able to talk to a large network of users. This rapidly becomes
anti-competitive, however: the user becomes locked into the network and can’t
switch even if they want to.  Even when people have a <strong>really</strong> good reason
to move provider (e.g. <a href="https://www.theregister.com/2021/01/06/whatsapp_privacy_policy_demand/">WhatsApp’s terms of use changing</a> to
share user data with Facebook, <a href="https://blog.elcomsoft.com/2021/01/apple-scraps-end-to-end-encryption-of-icloud-backups/">Apple doing a 180 on end-to-end encrypting iCloud backups</a>,
or <a href="https://www.wired.co.uk/article/telegram-encryption-end-to-end-features">Telegram not actually being end-to-end encrypted</a>),
in practice <a href="https://medium.com/@carlagriggio/the-great-messaging-app-migration-that-didnt-really-happen-56af637bc5d8">hardly anything changes</a> -
because the users are socially obligated to keep using the service in order
to talk to the rest of the users on it.</p>
<p>As a result, it’s literally harmful to the users. Even if a new service
launches with a shiny new feature, there is enormous inertia that must be
overcome for users to switch, thanks to the pull of their existing network -
and even if they do, they’ll just end up with their conversations haphazardly
fragmented over multiple apps. This isn’t accepted for email; it isn’t
accepted for the phone network; it isn’t accepted on the Internet itself -
and it shouldn’t be accepted for messaging apps either.</p>
<p>Similarly: the closed networks of today’s gatekeepers put a completely
arbitrary limit on how users can extend and enrich their own conversations.
On email, if you want to use a fancy new client like Superhuman - you can. If
you want to hook up a digital assistant or translation service to help you
wrangle your email - you can.  If you want to hook up your emails to a CRM to
help you run your business - you can.  But with today’s gatekeepers, you have
literally no control: you’re completely at the mercy of the service
provider - and for something like WhatsApp or iMessage the options are
limited at best.</p>
<p>Finally - all the users’ conversation metadata for that service (who talks to
who, and when) ends up centralised in the gatekeepers’ databases, which then
become an incredibly valuable and sensitive treasure trove, at risk of abuse.
And if the service provider identifies users by phone number, the user is
forced to disclose their phone number (a deeply sensitive personal
identifier) to participate, whether they want to or not.  Meanwhile the user
is massively incentivised not to move away: effectively they are held hostage
by the pull of the service’s network of users.</p>
<p>So, the DMA exists as a strategy to improve the situation for users and
service providers alike by building a healthier dynamic ecosystem for
communication apps; encouraging products to win by producing the best quality
product rather than the biggest network. To quote Cédric O (Secretary of
State for the Digital Sector of France), the strategy of the legislation came
from Washington advice to address the anticompetitive behaviour of the
gatekeepers “not by breaking them up… but by breaking them open.”  By
requiring the gatekeepers to open their APIs, the door has at last been
opened to give users the option to pick whatever service they prefer to use,
to choose who they trust with their data and control their conversations as
they wish - without losing the ability to talk to their wider audience.</p>
<p>However, something as groundbreaking as this is never going to be completely
straightforward.  Of course while some basic use cases (i.e. non-E2EE chat)
are easy to implement, they initially may not have a UX as smooth as a closed
network which has ingested all your address book; and other use cases(eg E2EE
support) may require some compromises at first.  It’s up to the industry to
figure out how to make the most of that challenge, and how to do it in a way
which minimises the impact on privacy - especially for end-to-end encrypted
services.</p>
<h3 id="what-problems-need-to-be-solved">What problems need to be solved?</h3>
<p>We’ve <a href="https://matrix.org/blog/2022/03/25/interoperability-without-sacrificing-privacy-matrix-and-the-dma">already written about this</a>
from a Matrix perspective, but to recap - the main challenge is the trade-off
between interoperability and privacy for gatekeepers who provide end-to-end
encryption, which at a rough estimate means: WhatsApp, iMessage, secret chats
in Facebook Messenger, and Google Messages.  The problem is that even with
open APIs which correctly expose the end-to-end encrypted semantics (as DMA
requires), the point where you interoperate with a different system
inevitably means that you’ll have to re-encrypt the messages for that system,
unless they speak precisely the same protocol - and by definition you end up
trusting the different system to keep the messages safe.  Therefore this
increases the attack surface on the conversations, putting the end-to-end
encryption at risk.</p>
<p>Alex Stamos (ex-CISO at Facebook) said that “<a href="https://twitter.com/alexstamos/status/1507366543360897028">WhatsApp rolling out mandatory
end-to-end encryption was the largest improvement in communications privacy
in human history</a>” – and we agree.
Guaranteed end-to-end encrypted conversations on WhatsApp is amazing, and
should be protected at all costs. If users are talking to other users on
WhatsApp (or any set of users communicating within the same E2EE messenger),
E2EE should and must be maintained - and there is nothing in the DMA which says otherwise.</p>
<p>But what if the user consciously wants to prioritise interoperability over
encryption?  What if the user wants to hook their WhatsApp messages into a
CRM, or run them through a machine translation service, or try to start a
migration to an alternative service because they don’t trust Meta?  Should
privacy really come so spectacularly at the expense of user freedom?</p>
<p>We also have the problem of figuring out how to reference users on other
platforms.  Say that I want to talk to a user with a given phone number, but
they’re not on my platform - how do I locate them?  What if my platform only
knows about phone numbers, but you’re trying to talk to a user on a platform
which uses a different format for identifiers?</p>
<p>Finally, we have the problem of mitigating abuse: opening up APIs makes it
easier for bad actors to try to spam or phish or otherwise abuse users within
the gatekeepers. There are going to have to be changes in anti-abuse
services/software, and some signals that the gatekeeper platforms currently
use are going to go away or be less useful, but that doesn't mean the whole
thing is intractable. It will require changes and innovative thinking, but
we’ve been making steady progress (e.g. the work done by <a href="https://element.io/blog/moderation-needs-a-radical-change/">Element’s trust and
safety team</a>). Meanwhile, the
gatekeepers already have massive anti-abuse systems in place to handle the
billions of users within their walled gardens, and unofficial APIs are
already widespread: adding official APIs does not change the landscape
significantly (assuming interoperability is implemented in such a way that
the existing anti-abuse mechanisms still apply).</p>
<p>In the past, gatekeepers dismissed the effort of interop as not being
worthwhile - after all, the default course of action is to build a walled
garden, and having built one, the temptation is to try to trap as many users
as possible.  It was also not always clear that there were services worth
interoperating with (thanks to the chilling effects of the gatekeepers
themselves, in terms of stifling innovation for communication startups).
Nowadays this situation has fundamentally changed however: there is a vibrant
ecosystem of open communication startups out there, and a huge appetite to
build a vibrant open ecosystem for interoperable communication, but like the
open web itself.</p>
<h3 id="what-are-the-requirements">What are the requirements?</h3>
<p>Before going further in considering solutions, we need to review the actual
requirements of the DMA.  Our best understanding at this point is that the
DMA will mandate that:</p>
<ul>
<li>Gatekeepers will have to provide open and documented APIs to their services, on request, in order to facilitate interoperability (i.e. so that other services can communicate with their users).</li>
<li>These APIs must preserve the same level of end-to-end encryption (if any) to remote users as is available to local users.</li>
<li>This applies to 1:1 messaging and file transfer in the short term, and group messaging, file-transfer, 1:1 VoIP and group VoIP in the longer term.</li>
</ul>
<h3 id="so-what-could-this-actually-look-like">So, what could this actually look like?</h3>
<p>The DMA legislation deliberately doesn’t focus on implementation, instead
letting the industry figure out how this could actually work in practice.
There are many different possible approaches, and so from our point of view
as Matrix we’ve tried to sketch out some options to make the discussion more
concrete. Please note these are preliminary thoughts, and are far from
perfect - but hopefully useful as a starting point for discussion.</p>
<h4 id="finding-bob">Finding Bob</h4>
<p>Imagine that you have a user Alice on an existing gatekeeper, which we’ll call
AliceChat, who runs an E2EE messaging service which identifies users using
phone numbers.  Say that they want to start a 1-to-1 conversation with Bob,
who doesn’t use AliceChat, but Alice knows he is a keen user of BobChat.
Today, you’d have no choice but to send them an SMS and nag them to join
AliceChat (sucks to be them if they don’t want to use that service, or if
they’re unable to for whatever reason - e.g. their platform isn’t supported,
or their government has blocked access, etc), or join BobChat yourself.</p>
<div style="text-align: center">
<img src="/blog/img/2022-03-29-bob-invite.jpg" width="430"/>
<img src="/blog/img/2022-03-29-bob-invite-b.png" width="430"/>
</div>
<br/>
<p>However, imagine if instead the gatekeeper app had a user experience where the
app prompted you to talk to the user via a different platform instead.  It’d
be no different to your operating system prompting you to pick which app to
use to open a given file extension (rather than the OS vendor hardcoding it
to one of their own apps - another win for user rights <a href="https://en.wikipedia.org/wiki/Microsoft_Corp._v._Commission">led by the EU</a>!).</p>
<div style="text-align: center">
<img src="/blog/img/2022-03-29-bob-invite2.jpg" width="430"/>
</div>
<br/>
<p>Now, the simplest approach in the short term would be for each gatekeeper to
pre-provision a set of options of possible alternative networks.  (The DMA
says that, on request, other service providers can ask to have access to the
gatekeeper’s APIs for the purposes of interoperability, so the gatekeeper
knows who the alternative networks may be).  “Bob is not on AliceChat - do
you want to try to reach him instead on BobChat, CharlieChat, DaveChat
(etc)”.</p>
<p>Much like users can configure their preferred applications for file extensions
in an operating system today, users would also be able to add their own
preferred service providers - simply specifying their domain name.</p>
<h4 id="connecting-to-bob">Connecting to Bob</h4>
<p>Now, AliceChat itself needs to figure out how to query the remote service
provider to see if Bob actually exists there.  Given the DMA requires that
gatekeepers provide open APIs with the same level of security to remote users
as their local ones using today’s private APIs - and very deliberately
doesn’t mandate specific protocols for interoperability - they will need to
locate a bridge which can connect to the other system.</p>
<p>In this thought experiment, the bridge used would be up to the destination
provider.  For instance, bobchat.com could announce that AliceChat users
should connect to it via alicechat-bridge.bobchat.com using the AliceChat
protocol(or matrix-bridge.bobchat.com via Matrix or xmpp-bridge.bobchat.com
via XMPP) by a simple HTTP API or even a .well-known URL.  Users might also
be able to override the bridge used to connect to them (e.g. to point instead
at a client-side bridge), and could sign the advertisement to prove that it
hadn’t been tampered with.</p>
<p>AliceChat would then connect to the discovered bridge using AliceChat’s
vendor-specific newly opened API, and would then effectively treat Bob as if
they were a real AliceChat user and client to all intents and purposes.  In
other words, Bob would effectively be a “ghost user” on AliceChat, and
subject to all their existing anti-abuse mechanisms.</p>
<p>Meanwhile, the other side of the bridge converts through to whatever the
target system is - be that XMPP, Matrix, a different proprietary API, etc.
For Matrix, it’d be chatting away to a homeserver via the <a href="https://spec.matrix.org/latest/application-service-api/">Application Service
API</a> (using
<a href="https://docs.mau.fi/bridges/general/end-to-bridge-encryption.html">End-to-Bridge Encryption</a> via
<a href="https://github.com/matrix-org/matrix-spec-proposals/blob/travis/msc/otk-dl-appservice/proposals/3202-encrypted-appservices.md">MSC3202</a>).
It’s also worth noting that the target might not even be a bridge - it could
be a system which already natively speaks AliceChat’s end-to-end encrypted
API, thus preserving end-to-end encryption without any need to re-encrypt.
It’s also worth noting that while historically bridges have had a bad
reputation as being a second class (often a second class afterthought),
Matrix has shown that by considering them as a first class citizen and really
focusing on mapping the highest common denominator between services rather
than lowest common denominator, it’s possible for them to work transparently
in practice.  <a href="https://beeper.com">Beeper</a> is a great example of Matrix
bridging being used for real in the wild (rather amusingly they just
<a href="https://twitter.com/ericmigi/status/1507827177374445569">shipped emoji reactions for WhatsApp</a> on iOS via their
WhatsApp&lt;-&gt;Matrix bridge before WhatsApp themselves did…)</p>
<p>Architecturally, it could look like this:</p>
<p><img src="/blog/img/2022-03-29-alice-bob.jpg" alt="" /></p>
<p>Or, more likely (given a dedicated bridge between two proprietary services
would be a bit of a special case, and you’d have to solve the dilemma of who
hosts the bridge), both services could run a bridge to a common open standard
protocol like Matrix or XMPP instead (thus immediately enabling
interoperability with everyone else connected to that network):</p>
<p><img src="/blog/img/2022-03-29-alice-bob-bridged.jpg" alt="" /></p>
<p>Please note that while these examples show server-side bridges, in practice it
would be infinitely preferable to use client-side bridges when connecting to
E2EE services - meaning that decrypted message data would only ever be
exposed on the client (which obviously has access to the decrypted data
already).  Client-side bridges are currently complicated by OS limits on
background tasks and push notification semantics (on mobile, at least), but
one could envisage a scenario where you install a little stub AliceChat
client on your phone which auths you with AliceChat and then sits in the
background receiving messages and bridging them through to Matrix or XMPP,
like this:</p>
<p><img src="/blog/img/2022-03-29-alice-bob-clientside.jpg" alt="" /></p>
<p>Another possible architecture could be for the E2EE gatekeeper to expose their
open APIs on the clients, rather than the server.  DMA allows this, to the
best of our knowledge - and would allow other apps on the device to access
the message data locally (with appropriate authorisation, of course) - effectively
doing a form of realtime
<a href="https://en.wikipedia.org/wiki/Google_Data_Liberation_Front">data liberation</a>
from the closed service to an open system, looking something like this:</p>
<p><img src="/blog/img/2022-03-29-alice-bob-clientside-apis.jpg" alt="" /></p>
<p>Finally, it's worth noting that when peer-to-peer decentralised protocols
like <a href="https://matrix.org/blog/2020/06/02/introducing-p-2-p-matrix/">P2P Matrix</a>
enter production, clientside bridges could bridge directly into a local
communication server running on the handset - thus avoiding metadata being
exposed on Matrix or XMPP servers providing a common language between the
service providers.</p>
<h4 id="locating-users">Locating users</h4>
<p>Now, the above describes the simplest and most naive directory lookup system
imaginable - the problem of deciding which provider to use to connect to each
user is shouldered by the users.  This isn’t that unreasonable - after all,
users may have strong feelings about what providers to use to talk to a given
user.  Alice might be quite happy to talk to Bob via BobChat, but might be
very deliberately avoiding talking to him on DaveChat, for whatever ominous
reasons.</p>
<p>However, it’s likely in future we will also see other directory services
appear in order to map phone numbers (or other identities) to providers -
whether these piggyback on top of existing identity providers
(gatekeepers, DNS, telcos, SSO providers, governments) or are decentralised
through some other mechanism.  For instance, Bob could send AliceChat a
blinded proof that he authorises them to automatically route traffic to him
over at BobChat, with BobChat maintaining a matching proof that Bob is who he
claims to be (having gone through BobChat’s auth process) - and the proofs
could be linked using a temporary key such that Bob doesn’t even need to
maintain a long-term one. (Thanks to James Monaghan for suggesting this one!)</p>
<p>Another alternative to having the user decide where to find each other could
be to use a decentralised Keybase-style identity system to track verified
mappings of identities (phone numbers, email addresses etc) through to
service providers - perhaps something like <a href="https://idx.xyz/">IDX</a> might fit
the bill?  While this decentralised identity lookups have historically been a
hard problem, there is a <em>lot</em> of promising work happening in this space
currently and the future looks promising.</p>
<h4 id="talking-to-bob">Talking to Bob</h4>
<p>Meanwhile, Alice still needs to talk to Bob. As already discussed, unless
everyone speaks the same end-to-end encrypted protocol (be it Matrix,
WhatsApp or anything else), we inevitably have a trade-off here between
interoperability and privacy if Bob is not on the same system as Alice
(assuming AliceChat is end-to-end encrypted) - and we will need to clearly
warn Alice that the conversation is no longer end-to-end encrypted:</p>
<div style="text-align: center">
<img src="/blog/img/2022-03-29-warning.jpg" width="430"/>
</div>
<br/>
<p>To be clear: right now, today, if Bob were on AliceChat, he could be
copy-pasting all your messages into (say) Google Translate in a frantic
effort to workaround the fact that his closed E2EE chat platform has no way
to do machine translation.  However, in a DMA world, Bob could legitimately
loop a translation bot into the conversation… and Alice would be warned that
the conversation was no longer secure (given the data is now being bridged
over to Google).</p>
<p>This is a clear improvement in user experience and transparency.  Likewise, if
I’m talking to a bridged user today on one of these platforms, I have no way
of telling that they have chosen to prioritise interop over E2EE - which is
frankly terrifying.  If I’m talking to someone on WhatsApp today I blindly
assume that they are E2EE as they are on the same platform - and if they’re
using an unofficial app or bridge, I have no way to tell.  Whereas in a DMA
world, you would expect the gatekeeper to transparently expose it.</p>
<p>If anything, this is good news for the gatekeeper in that it consciously
advertises a big selling point for them: that for full E2EE, users need to
talk to other users in the same walled garden (unless of course the platform
speaks the same protocol).  No more need for bus shelter adverts to remind
everywhere that WhatsApp is E2EE - instead they can remind the user every
time they talk to someone outside the walled garden!</p>
<p>Just to spell it out: the DMA does not require or encourage any reduction in
end-to-end encryption for WhatsApp or similar: full end-to-end encryption
will still be there for users in the same platform, including through to
users on custom clients (assuming the gatekeeper doesn’t flex and turn it off
for other reasons).</p>
<p>Obviously, this flow only considers the simple case of Alice inviting Bob. The
flow is of course symmetrical for Bob inviting Alice; AliceChat will need to
advertise bridges which can be used to connect to its users.  As Bob pops up
from BobChat, the bridge would use AliceChat’s newly open APIs to provision a
user for him, authing him as per any other user (thus ensuring that AliceChat
doesn’t need to have trusted BobChat to have authenticated the user).  The
bridge then sends/receives messages on Bob’s behalf within AliceChat.</p>
<h4 id="group-communication">Group communication</h4>
<p>This is all very well for 1:1 chats - which are the initial scope of the DMA.
However, over the coming years, we expect group chats to also be in scope.
The good news is that the same general architecture works for group chats
too.  We need a better source of identity though: AliceChat can’t possibly
independently authenticate all the new users which might be joining via group
conversations on other servers (especially if they join indirectly via
another server).  This means adopting one of the decentralised identity
lookup approaches outlined earlier to determine whether Charlie on
CharlieChat is the real Charlie or an imposter.</p>
<p>Another problem which emerges with group chats which span multiple service
providers is that of indirect routing, especially if the links between the
providers use different protocols.  What if AliceChat has a direct bridge to
BobChat (a bit like AIM and ICQ both spoke OSCAR), BobChat and CharlieChat
are connected by Matrix bridges, and AliceChat and CharlieChat are connected
via XMPP bridges?  We need a way for the bridges to decide who forwards
traffic for each network, and who bridges the users for which network.  If
they were all on Matrix or XMPP this would happen automatically, but with
mixed protocols we’d probably have to extend the lookup protocol to establish
a spanning tree for each conversation to prevent forwarding loops.</p>
<p>Here’s a deliberately twisty example to illustrate the above thought experiment:</p>
<p><img src="/blog/img/2022-03-29-alice-bob-charlie.jpg" alt="" /></p>
<p>There is also a risk of bridge proliferation here - in the worst case, every
service would have to source bridges to directly connect to every other
service who came along, creating a nightmarish n-by-m problem.  But in
practice, we expect direct proprietary-to-proprietary bridges to be rare:
instead, we already have open standard communication protocols like Matrix
and XMPP which provide a common language between bridges - so in practice,
you could just end up in a world where each service has to find a
them-to-Matrix or them-to-XMPP bridge (which could be run by them, or
whatever trusted party they delegate to).</p>
<h3 id="conclusion">Conclusion</h3>
<p>A mesh of bridges which connect together the open APIs of proprietary vendors
by converting them into open standards may seem unwieldy at first - but it’s
precisely the sort of ductwork which links both phone networks and the
Internet together in practice.  As long as the bridging provides for highest
common denominator fidelity at the best impedance ratio, then it’s
conceptually no different to converting circuit switched phone calls to VoIP,
or wired to wireless Ethernet, or any of the other bridges which we take
entirely for granted in our lives thanks to their transparency.</p>
<p>Meanwhile, while this means a bit more user interface in the communication
apps in order to select networks and warn about trustedness, the benefits to
users are enormous as they put the user squarely back in control of their
conversations. And the UX will improve as the tech evolves.</p>
<p>The bottom line is, we should not be scared of interoperability, just because
we’ve grown used to a broken world where nothing can interconnect.  There are
tractable ways to solve it in a way that empowers and informs the user - and
the DMA has now given the industry the opportunity to demonstrate that it can
work.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2022&#x2F;03&#x2F;25&#x2F;interoperability-without-sacrificing-privacy-matrix-and-the-dma&#x2F;" title="Interoperability without sacrificing privacy: Matrix and the DMA">Interoperability without sacrificing privacy: Matrix and the DMA</a></h2>
                <span>
                    25.03.2022 22:39
                    —
                    <a href="/category/general">
                        General
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                <br>
                <small>Last update: 25.03.2022 18:01</small>
            </header>
            <div>
                
                <p>Yesterday the EU Parliament &amp; Council agreed on the contents of the Digital
Markets Act - new legislation from the EU intended to limit anticompetitive
behaviour from tech “gatekeepers”, i.e. big tech companies (those with market
share larger than €75B or with more than €7.5B a year of revenue).</p>
<p>This is absolutely landmark legislation, where the EU has decided not to break
the gatekeepers up in order to create a more competitive marketplace - but
instead to “break them open”.  This is unbelievably good news for the open
Internet, as it is obligating the gatekeepers to provide open APIs for their
communication services.  In other words: no longer will the tech giants be
able to arbitrarily lock their users inside their walled gardens - there will
be a legal requirement for them to expose APIs to other services.</p>
<p>While the formal outcomes of yesterday’s agreement haven’t been published yet
(beyond <a href="https://www.europarl.europa.eu/news/en/press-room/20220315IPR25504/deal-on-digital-markets-act-ensuring-fair-competition-and-more-choice-for-users">this press release</a>),
our understanding is that the DMA will mandate:</p>
<ul>
<li>Gatekeepers will have to provide open and documented APIs to their
services, on request, in order to facilitate interoperability (i.e. so
that other services can communicate with their users).</li>
<li>These APIs must preserve the same level of end-to-end encryption (if any)
to remote users as is available to local users.</li>
<li>This applies to 1:1 messaging and file transfer in the short term, and
group messaging, file-transfer, 1:1 VoIP and group VoIP in the longer
term.</li>
</ul>
<p>This is the best possible outcome imaginable for the open internet.  Never
again will a big tech company be able to hold their users hostage in a walled
garden, or arbitrarily close down or sabotage their APIs.</p>
<h3 id="so-what-s-the-catch">So, what’s the catch?</h3>
<p>Since the DMA announcement on Thursday, there’s been <a href="https://twitter.com/alexstamos/status/1507145126006587411">quite a lot</a>
of <a href="https://twitter.com/AlecMuffett/status/1507366934412734491">yelling</a> from some very
experienced voices that mandating interoperability via open APIs is going to
irrevocably undermine end-to-end encrypted messengers like WhatsApp.  This
seems to mainly be born out of a concern that the DMA is somehow trying to
subvert end-to-end encryption, despite the fact that the DMA explicitly
mandates that the APIs must expose the same level of security, including
end-to-end encryption, that local users are using. (N.B. Signal doesn’t
qualify as a gatekeeper, so none of this is relevant to Signal).</p>
<p>So, for WhatsApp, it means that the API would expose both the message-passing
interface as well as the key management APIs required to interoperate with
WhatsApp using your own end-to-end-encrypted WhatsApp client - E2EE would be
preserved.</p>
<p>However, this does mean that if you were to actively interoperate between
providers (e.g. if Matrix turned up and asked WhatsApp, post DMA, to expose
an API we could use to write bridges against), then that bridge would need to
convert between WhatsApp’s E2EE’d payloads and Matrix’s E2EE’d payloads.
(Even though both WhatsApp and Matrix use the Double Ratchet, the actual
payloads within the encryption are completely different and would need to be
converted).  Therefore such a bridge has to re-encrypt the traffic - which
means that the plaintext is exposed on the bridge, putting it at risk and
breaking the end-to-end encryption guarantee.</p>
<p>There are solutions to this, however:</p>
<ul>
<li>
<p>We could run the bridge somewhere relatively safe - e.g. the user’s client.
There’s a bunch of work going on already in Matrix to run clientside
bridges, so that your laptop or phone effectively maintains a connection
over to iMessage or WhatsApp or whatever as if it were logged in… but then
relays the messages into Matrix once re-encrypted.  By decentralising the
bridges and spreading them around the internet, you avoid them becoming a
single honeypot that bad actors might look to attack: instead it becomes
more a question of endpoint compromise (which is already a risk today).</p>
</li>
<li>
<p>The gatekeeper could switch to a decentralised end-to-end encrypted protocol
like Matrix to preserve end-to-end encryption throughout.  This is
obviously significant work on the gatekeeper’s side, but we shouldn’t rule
it out.  For instance, making the transition for a non-encrypted service is
impressively little work, as <a href="https://matrix.org/blog/2020/12/07/gitter-now-speaks-matrix#how-do-you-make-an-existing-chat-system-talk-matrix">we proved with Gitter</a>.
(We’d ideally need to figure out decentralised/federated identity-lookup
first though, to avoid switching from one centralised identity database
to another).</p>
</li>
<li>
<p>Worst case, we could flag to the user that their conversation is insecure
(the chat equivalent of a scary TLS certificate warning).  Honestly, this
is something communication apps (including Matrix-based ones!) should be
doing anyway: as a user you should be able to tell what 3rd parties
(bots, integrations etc) have been added to a given conversation.  Adding
this sort of semantic actually opens up a much richer set of communication
interactions, by giving the user the flexibility over who to trust with
their data, even if it breaks the platonic ideal of pure E2E encryption.</p>
</li>
</ul>
<p>On balance, we think that the benefits of mandating open APIs outweigh the
risks that someone is going to run a vulnerable large-scale bridge and
undermine everyone’s E2EE.  It’s better to have the option to be able to get
at your data in the first place than be held hostage in a walled garden.</p>
<h3 id="other-considerations">Other considerations</h3>
<p>One other complaint which has come up a bunch is around speed of innovation:
the idea that WhatsApp or similar would be seriously slowed down by having
to (effectively) maintain stable documented federation APIs, and figure out
how to do backwards compatibility for new features.  It’s true that this will
take a bit more effort (similar to how adding GDPR compliance takes some
effort), but the ends make it more than worth it.  Plus, if the rag-tag
Matrix ecosystem can do it, it doesn’t seem unreasonable to think that a
$600B company like Meta can figure it out too...</p>
<p>Another consideration is that it might make it too easy to build malicious 3rd
party clients - e.g. building your own &quot;special&quot; version of Signal which
connects to the official service, but deliberately or otherwise has security
flaws.  The fact is that we're already in this position though: there are
illicit alternative clients flying around all over the place, and the onus is
on the app stores to protect their users from installing malware.  This isn't
reason to throw the baby of interoperability out with the bathwater of
bootleg clients.</p>
<p>The final complaint is about moderation and abuse: while open APIs are good
news for consumer choice, they can also be used by spammers, phishers and
other miscreants to cause problems for the users within the gatekeeper.  Much
like a mediaeval citadel; opening up your walled garden means that both good
and bad people can turn up.  And much like real life, this is a solvable problem,
even if it’s unfortunate: the benefits of free trade massively outweigh the
downsides of having to police strangers more effectively.  Frankly,
moderation and anti-abuse approaches on the Internet today are infamously
broken, with centralised moderation by gatekeepers producing increasingly
erratic results.  By opening the walled gardens, we are forcing a much-needed
opportunity to review how to empower users and admins to filter unwanted
content on their own terms.  There’s a recent write-up of the proposed
approach for Matrix at
<a href="https://element.io/blog/moderation-needs-a-radical-change/">https://element.io/blog/moderation-needs-a-radical-change/</a>,
which outlines one strategy - but there are many others.  Honestly, having to improve
moderation tooling is a worthwhile price to pay for the benefits of open
APIs.</p>
<p>So, there you have it. Hopefully you’ll agree that the benefits here outweigh
the risks: without open APIs we wouldn't even have the <em>option</em> to talk about
interoperability.  We should be celebrating a new dawn for open access,
rather than fearing that the sky is falling and this is nefarious attempt to
undermine end-to-end encryption.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;12&#x2F;22&#x2F;the-mega-matrix-holiday-special-2021&#x2F;" title="The Mega Matrix Holiday Special 2021">The Mega Matrix Holiday Special 2021</a></h2>
                <span>
                    22.12.2021 23:27
                    —
                    <a href="/category/general">
                        General
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                <br>
                <small>Last update: 22.12.2021 17:54</small>
            </header>
            <div>
                
                <p>Hi all,</p>
<p>If you’re reading this - congratulations; you made it through another year :)  Every winter we sit down and review Matrix’s progress over the last twelve months, and look forward to the next - for it’s all too easy to get lost in the day-to-day development and fail to realise how much the overall project is evolving, especially when it’s one as large and ambitious as Matrix!</p>
<p>Looking back at 2021, it’s unbelievable how much stuff has been going on in the core team (as you can tell by the length of this post - sorry!).  There’s been a really interesting mix of activity too - between massive improvements to the core functionality and baseline features that Matrix provides, and also major breakthroughs on next generation work.  But first, let’s check out what’s been happening in the wider ecosystem…</p>
<h2 id="the-matrix-ecosystem">The Matrix Ecosystem</h2>
<p>Over 2021 the Matrix ecosystem has expanded unrecognisably.  This time last year we were aware of 2 governments who were seriously adopting Matrix at scale (France and Germany), with the UK and US starting to roll out initial deployments.  12 months later, and we are now aware of <strong>12</strong> governments who are adopting Matrix in various capacities - and we hope to be able to talk about at least some of them in public in 2022!  The UK and US have both progressed significantly too.</p>
<p>Meanwhile, one of the most exciting new public sector stories this year has been <a href="https://www.gematik.de/anwendungen/ti-messenger">gematik</a>: Germany’s national healthcare agency, who <a href="https://matrix.org/blog/2021/07/21/germanys-national-healthcare-system-adopts-matrix">announced Matrix</a> as the basis for interoperable secure messaging throughout the whole healthcare sector.  This is a genuine step change for Matrix: rather than a government putting out tenders for “a secure messaging solution”, instead we are seeing tenders for Matrix solution providers.  The Matrix industry is real; it exists today, and we’re seeing more and more new providers such as <a href="https://famedly.com/">Famedly</a> (building on the <a href="https://gitlab.com/famedly/company/frontend">Flutter/Dart stack</a> which powers <a href="https://fluffychat.im">FluffyChat</a>) and <a href="https://folivo.net/portfolio/timmy-messenger/">Folivonet</a> (building on the <a href="https://gitlab.com/benkuly/trixnity">Trixnity</a> Kotlin Multiplatform stack) stepping up to get involved - as well as many more big incumbents.  We created Matrix in order to bootstrap a new decentralised communication industry, and frankly it’s amazing to see it actually taking shape.</p>
<p>Another big step change has been the number of existing chat providers looking to become part of the wider Matrix network. Back in September our friends at <a href="https://www.youtube.com/watch?v=jBtBiUXLqAk&amp;t=1691s">Rocket.Chat announced that they’re working on Matrix support</a> for federation, perhaps inspired by our case study in making <a href="https://matrix.org/blog/2020/12/07/gitter-now-speaks-matrix">Gitter speak Matrix</a> - and meanwhile Matrix comes up a lot in the context of Twitter’s Bluesky initiative, and a few big players we can’t yet mention have also been in touch wanting to natively talk Matrix too.</p>
<p>We’ve also seen a huge shift in big enterprises adopting Matrix for self-sovereign secure communication (although we can’t drop any names yet 😔). This may have been spurred on by such misadventures as Electronic Arts being compromised via a <a href="https://www.vice.com/en/article/7kvkqb/how-ea-games-was-hacked-slack">leaked Slack access token</a>, but it feels like many of the biggest organisations now realise that unquestioningly handing their data to Slack or Teams is a bad idea, when they could have an end-to-end encrypted deployment of their own instead.</p>
<p>There has also been a turning point in legislation in favour of Matrix - with the EU Digital Markets Act <a href="https://twitter.com/matrixdotorg/status/1471191916838633481">pushing hard for interoperability</a> for ‘big tech’ communication services in the EU (see <a href="https://interoperability.news/2021/12/eu-parliament-upgrades-dma-to-open-gatekeepers-gates/">Amandine’s take</a> here), and meanwhile Eric Migicovsky, CEO at <a href="https://www.beeper.com/">Beeper</a> has been busy <a href="https://www.c-span.org/video/?c4992173/user-clip-eric-migicovsky-testimony">testifying to US Congress</a> on the merits of interoperability too. It’s not inconceivable that we will soon live in a world where governments mandate that the walled gardens will finally have to open up, and we may see a whole new level of interest in communication providers wanting to join Matrix!</p>
<p>Communities themselves have also been embracing Matrix more and more over the last year: we were incredibly proud to host <a href="https://matrix.org/blog/2021/02/15/how-we-hosted-fosdem-2021-on-matrix">FOSDEM 2021</a>, the world’s biggest open source conference via Matrix (all 35K attendees!) - and we’re gearing up to do it again in February for <a href="https://twitter.com/fosdem/status/1451475324684980241">FOSDEM 2022</a> (this time with our <a href="https://matrix.org/blog/2021/12/02/call-for-participation-for-the-fosdem-2022-matrix-dev-room">very first FOSDEM Matrix dev room</a>!). We were also really glad that <a href="https://libera.chat/">Libera.chat</a> let us point a dedicated homeserver and IRC bridge at their new IRC network (meaning you can join anywhere on Libera from Matrix as #channel:libera.chat, and talk to anyone as @nick:libera.chat). High profile open source projects have been adopting Matrix all over the place - <a href="https://wiki.debian.org/Teams/DebianSocial/Matrix">Debian</a>, <a href="https://fedoramagazine.org/multiple-matrix-sessions-with-element-on-fedora-linux/">Fedora</a>, <a href="https://nixos.wiki/wiki/Matrix">NixOS</a>, <a href="https://wiki.archlinux.org/title/Matrix">Arch</a>, <a href="https://blog.torproject.org/entering-the-matrix/">Tor</a>, <a href="https://ansible.github.io/community/posts/matrix_and_ansible.html">Ansible</a>, <a href="https://whatwg.org/chat">WHATWG</a> and many others (check out <a href="https://www.ubuntubuzz.com/2021/10/matrix-chat-adoption-by-community-in.html">this list</a>!) now have their own Matrix servers and spaces.  (You know things are busy when we haven’t had time to do a big blog post to announce folk as important as these joining the network!)</p>
<p>Finally, there has been an explosion of new projects and milestones in the wider community - <a href="https://conduit.rs">Conduit</a> entered <a href="https://conduit.rs/release-0-2-0/">beta</a> as a super exciting lightweight Rust homeserver implementation; <a href="https://fluffychat.im">FluffyChat</a> hit 1.0 with an impressively polished Flutter-based experience; <a href="https://beeper.com">Beeper</a> pre-launched to huge amounts of mainstream excitement; <a href="https://cinny.in/">Cinny</a> exploded out of the blue as an incredibly elegant next-generation web client; <a href="https://keanu.im/">Keanu</a> materialised from <a href="https://guardianproject.info/">The Guardian Project</a> as their glossy Matrix client suite; <a href="https://commune.chat/">Commune</a> appeared as a hybrid messageboard/chatroom interface; <a href="https://github.com/Nheko-Reborn/nheko/">Nheko</a> has matured significantly with huge E2EE improvements and feature and VoIP polish; <a href="https://apps.kde.org/en-gb/neochat/">NeoChat</a> and <a href="https://github.com/quotient-im/libQuotient">libQuotient</a> development is progressing solidly; <a href="https://gitlab.gnome.org/GNOME/fractal">Fractal</a> is busy with the <a href="https://gitlab.gnome.org/GNOME/fractal/-/tree/fractal-next">fractal-next</a> rewrite to move everything over to matrix-rust-sdk and GTK 4;  <a href="https://syphon.org/">Syphon</a> continues to forge ahead as a privacy-focused Flutter-based client, and non-chat clients like <a href="https://github.com/toger5/TheBoard">The Board</a>, <a href="https://github.com/opentower/populus-viewer">Populus</a> and <a href="https://github.com/DanilaFe/matrix-highlight">Matrix Highlight</a> have started to appear in earnest too!  We also had a super successful <a href="https://matrix.org/blog/2021/05/20/google-summer-of-code-2021">Google Summer of Code</a> this year, with a record number of 7 students participating in both core team and community projects.</p>
<p>Please note this is just a random sample of all the community news over the last year - to get more colour on what’s been going on, we highly recommend flipping through the <a href="https://matrix.org/blog/category/this-week-in-matrix">This Week In Matrix archives</a>!</p>
<h2 id="the-matrix-spec">The Matrix Spec</h2>
<p>The Matrix spec is the single source of truth of what Matrix actually is, and this year it got some major improvements thanks to a beautiful new website at <a href="https://spec.matrix.org">https://spec.matrix.org</a> thanks to Will Bamberg, formerly of <a href="https://developer.mozilla.org/">MDN</a> (and who’s now back fighting the good fight with the MDN team at <a href="https://opencollective.com/open-web-docs/updates/will-bamberg-joins-open-web-docs-staff">OWD</a>).</p>
<p>Aside from the new spec site, we also released our first official point release in a while - <a href="https://matrix.org/blog/2021/11/09/matrix-v-1-1-release">Matrix 1.1</a>, and we’re going to aim to keep regular releases happening once a quarter from here on in.  It’s also worth noting that it’s very much a feature and not a bug that spec releases lag behind the various <a href="https://matrix.org/docs/spec/proposals">spec proposals</a> which fly around as the core team and community experiment with new features like spaces, threads, etc.  We very deliberately only merge change proposals to the spec which have been proven to work in real life implementations, and which have fully passed the spec review process (along with any dependencies they might have!).</p>
<p>Talking of which, in 2021 we saw a record <strong>109</strong> Matrix Spec Change proposals (MSCs) created. Even better, we closed <strong>62</strong> MSCs - so while the backlog is still growing, we’re still making very concrete progress.  Of the 109 new MSCs: 34 were from the wider Matrix community, 34 were from ex-community contributors who are now part of the core team, 13 were from the founding Matrix team, and 28 were from folks hired to work on Matrix by Element on behalf of the Matrix.org Foundation.  This feels like a pretty healthy blend of contributions, and while it’s true that spec work could always progress faster, things do seem to be heading in the right direction.</p>
<p><img src="/blog/img/2021-12-22-spec.png" alt="The latest MSC stats" /></p>
<p>In the new year, the Spec Core Team (responsible for reviewing MSCs and voting on what gets merged to the spec) is going to make a concerted effort to carve out more dedicated time for spec work - thankfully one of the side-effects of Matrix growing is that there are now a lot more people around with whom we can share other work, hopefully meaning that we can put significantly more hours into keeping the spec growing healthily.</p>
<h2 id="synapse">Synapse</h2>
<p>Synapse is the primary homeserver implementation published by the Matrix core team, and its maturity is unrecognisable from where we were a year ago.  One of the big breakthroughs has been stabilising memory usage through caching improvements - the Matrix.org synapse now reliably only uses 2-3GB of RAM on its main process, despite its activity having more than doubled over the last year (up from 513K monthly active users to 1.11M!).</p>
<p><img src="/blog/img/2021-12-22-perf.jpg" alt="Synapse memory performance fixes" /></p>
<p>Further signs of maturity include Synapse’s radically improved new <a href="https://matrix-org.github.io/synapse/latest/">documentation</a> and the new <a href="https://matrix-org.github.io/synapse/latest/modules/index.html">module API</a>, the fact that mypy type-safety coverage has improved from ~75% to over 89.7% (across 151,903 lines of code!), and the fact that Open Tracing support has matured to the point that visualising complex cross-worker behaviour is nowadays a genuine pleasure.  Frankly, Synapse should be feeling robust and stable these days - if you see folks claiming otherwise, please check they’re not basing that on outdated info (or failing that, get them to file bug reports that we can jump on!).</p>
<p>Meanwhile, on the feature side, we’ve landed a huge spate of long-awaited core functionality.  Probably the best way to track it is by the Matrix Spec Change proposals (MSCs) which have been implemented (although I dare you to also go and check out Synapse’s <a href="https://github.com/matrix-org/synapse/blob/develop/CHANGES.md">changelog</a>, all 675KB of it, which is frankly a thing of beauty and will take you down a rabbithole all the way back to v0.0.0 in Aug 2014 if you so desire ;P). Major MSCs which we’ve landed include:</p>
<ul>
<li>Spaces! It’s hard to overstate how positive this has been for Matrix’s usability: at last, we can group our rooms together however we please, both for our own edification and to share with others - and we can view space hierarchies over federation, complete with pagination (<a href="https://github.com/matrix-org/matrix-doc/pull/2946">MSC2946</a>) as well as specify who can join a room based on whether they’re a member of a given space/room (<a href="https://github.com/matrix-org/matrix-doc/pull/3083">MSC3083</a>).</li>
<li>Threads! Yes, that’s right - coming any day now to a Matrix client close to you, we have ‘classic’ threaded messaging landing, providing sidebars of conversation through the new m.thread relation type (<a href="https://github.com/matrix-org/matrix-doc/pull/3440">MSC3440</a>), building on Matrix’s existing aggregation API as used for edits and reactions.  We’ve chosen to prioritise single-level-deep-threads rather than arbitrarily-deep-trees (<a href="https://github.com/matrix-org/matrix-doc/pull/2836">MSC2836</a>) as it maps more easily to a chat UX, although the two approaches are not mutually exclusive.</li>
<li>Aggregations! Everyone’s favourite bête noire in Matrix tends to be that aggregations for edits &amp; reactions predate today’s Matrix Spec Change process and went mainstream without using a vendor prefix before their spec had been stabilised.  Better late than never, we’ve taken advantage of Threads to go back and fix what once went wrong - and now <a href="https://github.com/matrix-org/matrix-doc/pull/2674">MSC2674</a> and <a href="https://github.com/matrix-org/matrix-doc/pull/2675">MSC2675</a> and friends are hopefully on a much better track to provide a basis for how aggregations work - both in the spec and in the reference implementation in Synapse.</li>
</ul>
<p><img src="/blog/img/2021-12-22-aggs.png" alt="Anatomy of a bête noire" /></p>
<ul>
<li>Social Login via multiple SSO providers (<a href="https://github.com/matrix-org/matrix-doc/pull/2858">MSC2858</a>) - almost 50% of new registrations on the Matrix.org homeserver now use social login!  Interestingly the split of SSO usage is roughly 70% Google, 12% GitHub, 11% Apple, 6% Facebook and 1% GitLab. Make of that what you will!</li>
<li>Knocking (<a href="https://github.com/matrix-org/matrix-doc/pull/2403">MSC2403</a>)! Huge thanks to Sorunome and Anoa, we now support the ability to knock to ask to join a room if not yet invited. If this sounds unfamiliar, it may be because it hasn’t landed in Element yet, but expect it to land next year.</li>
<li>Refresh tokens (<a href="https://github.com/matrix-org/matrix-doc/pull/2918">MSC2918</a>)! At last, we have a standard way for clients to refresh their access tokens, so that if your access token leaks it will not give access to your account indefinitely.  (This also has yet to land in Element, but has been proved on a branch on Hydrogen).</li>
</ul>
<p>Finally, last but not least, Eric from Gitter has been fearlessly hacking his way through some of Matrix’s gnarliest problems in his quest to bring Matrix+Element up to full feature parity with Gitter. In practice, this means adding the ability to incrementally import old history into existing Matrix rooms (<a href="https://github.com/matrix-org/matrix-doc/pull/2716">MSC2716</a>), so we can expose the vast amounts of knowledge in Gitter’s archives directly into Matrix - and in future provide bridging in general of existing archives (Slack, Discord, mailing lists, newsgroups, forums, etc.) into Matrix.</p>
<p>This is a <em>tough</em> problem, as Matrix rooms are fundamentally immutable - events sent into a room cannot be changed.  However, we can bend time a bit and add old chapters of history to the room as if we’d just discovered them down the back of the sofa - and this is what <a href="https://github.com/matrix-org/matrix-doc/pull/2716">MSC2716</a> does.  The (rewritten!) <a href="https://github.com/matrix-org/matrix-doc/blob/matthew/%5BMSC2716%5D(https://github.com/matrix-org/matrix-doc/pull/2716)/proposals/2716-batch-send-historical-messages.md">spec proposal</a> is a thing of beauty and well worth a look, and you can see an early preview in action back on <a href="https://youtu.be/gSrqj2IzJew?t=529">Matrix Live in June</a>. Over the last few months it’s been merging and maturing in Synapse and we should see it in the wild in the near future!  And for bonus points Eric’s also just added in Jump-to-date support (<a href="https://github.com/matrix-org/matrix-doc/pull/3030">MSC3030</a>), letting clients jump around room history by timestamp - another Gitter feature that we sorely need, and will also help us publish excellent Gitter-style online chat archives in future.  You can see it in action in last week’s <a href="https://youtu.be/Hsyqa5ozWIo?t=581">Matrix Live</a>!</p>
<h2 id="element">Element</h2>
<p>Meanwhile, on the client side, Element continues to act as a flagship client to drive the development of the official client SDKs we ship as the Matrix.org Foundation - and our focus more than ever before has been to ensure that Matrix can be used to create mainstream-usable polished glossy apps.  After all, Matrix will only succeed if clients emerge which can punch their weight against the enormous incumbents - be they Slack, Teams, WhatsApp or Discord.</p>
<p>This year, improving UX quality has been front and center - and hopefully the shift has been obvious in the app (and huge thanks to everyone who tweeted/tooted/enthused about improvements when they saw them!).  Part of this has been ensuring that all new features are built in a design- and product-led fashion by folks who are explicitly focused on product engineering - with product design involved from the outset and with coordination and focus provided by product management folks. This is far from the typical way that FOSS operates, but if we’re to succeed against the incumbents we have to beat them at their own game (just as, for instance, Mozilla wields conventional product management in their browser wars).</p>
<p>More recently, there’s also been a major shift towards structured <a href="https://twitter.com/element_hq/status/1470798993122807809">user testing</a> in order to evaluate new features and analyse how users trip over the app in general, including radically improved analytics (for those who opt in!) to help visualise which bits of the app aren’t working.  In the new year, the expectation is to double down on user testing: quite simply, if you can hand Element to a casual mainstream user and they can get the core jobs done (sign up, chat to someone, call someone, etc.) without tripping over, then mission successful :)</p>
<p>The <a href="https://element.io/blog/">Element blog</a> covers the work this year from the Element side, but from the Matrix side, the key changes include:</p>
<ul>
<li>finalising <a href="https://element.io/blog/spaces-blast-out-of-beta/">Spaces</a> as a way to group together rooms - providing the equivalent of Discord servers or Slack workspaces, or alternatively letting you gather your own rooms together into a private space.</li>
<li>building out Threads (available in labs; launching soon!)</li>
<li>Social Login!</li>
<li>radically improving Element’s Information Architecture (i.e. the layout of the UI, so that the panels and buttons are correctly semantically grouped together in a visual hierarchy)</li>
<li>adding <a href="https://element.io/blog/introducing-voice-messages-and-so-much-more/">Voice Messages</a> as a really beautiful polished feature powered by <a href="https://github.com/matrix-org/matrix-doc/pull/3245">MSC3245</a></li>
<li>adding Location Share (available in labs; launching soon!) powered by <a href="https://github.com/matrix-org/matrix-doc/pull/3488">MSC3488</a> (and in future <a href="https://github.com/matrix-org/matrix-doc/pull/3489">MSC3489</a> for live-location sharing - in dev on iOS right now!)</li>
<li>adding <a href="https://element.io/blog/element-1-9-1-export-is-finally-here/">Chat Export</a>, thanks to the amazing GSOC work by Jaiwanth </li>
<li>adding Polls via <a href="https://github.com/matrix-org/matrix-doc/pull/3381">MSC3381</a>.</li>
</ul>
<p><img src="/blog/img/2021-12-22-spaces.gif" alt="Spaces in all their glory" /></p>
<p>From a spec perspective, it’s been particularly exciting to be finally using Extensible Events (<a href="https://github.com/matrix-org/matrix-doc/pull/1767">MSC1767</a>) for many of these new features: voice messages, location sharing and polls are all experimenting with this new idiom for expressing richer structured data over Matrix while presenting a consistent and useful ‘fallback’ representation for clients which don’t know how to natively render the richer data.</p>
<p>We’ve also done a huge amount of work this year in improving 1:1 VoIP - both via <a href="https://github.com/matrix-org/matrix-doc/pull/2746">MSC2746</a> and within the JS, iOS &amp; Android Matrix SDKs. If you haven’t tried doing a 1:1 call via Matrix recently we’d highly recommend giving it a go - probably the main remaining bug at this point is that we need to find a better default ringtone for Element(!). Huge thanks go to Šimon Brandner both for his community contributions to VoIP and across all of Element Web - including proper screensharing for 1:1 (and group!) VoIP calls. This has also laid excellent groundwork for native Group VoIP/Video over Matrix - more on that later.</p>
<p>On Element Mobile, work on all the above features has been balanced by fighting against the various platform’s quirks, and lots of under-the-hood work improving performance. iOS has gone through a long journey to get back to stability after iOS’s push notification API changes, while also improving incremental sync performance by rearchitecting the local cache in the client.  Android meanwhile has been working away improving the app; reworking Notifications, migrating to Kotlin coroutines and Hilt, and closing over 690 GH issues.  Android has also had its fair <a href="https://element.io/blog/element-on-google-play-store/">share of dramas</a>, including some recent long Play Store review times, but we’ve come through the other side intact.</p>
<p>However, we’ve been thinking more and more about the nightmarish pain point that is the amount of time we spend implementing the same features across the three different platforms. This becomes particularly apparent for security-sensitive features such as end-to-end encryption, or major API changes such as aggregations, spaces or sync v3 (more on that later). Or simply rapidly sharing improvements to implementation best practices between platforms.</p>
<p>Historically we consciously built platform-native Matrix SDKs in order to provide entirely idiomatic SDKs for other Matrix developers to use - and also to better dogfood the protocol and ensure that the heterogenous implementations could interoperate successfully. However, in practice, relatively few third party projects other than Element build on top of matrix-ios-sdk and matrix-android-sdk2 - and meanwhile there are more than enough other Matrix clients out there nowadays to dogfood interoperability against (including alternative experimental clients from the core team such as Hydrogen).</p>
<p>So, we’ve been thinking increasingly seriously about how to solve this…</p>
<h2 id="a-new-hope-matrix-rust-sdk">A new hope: matrix-rust-sdk</h2>
<p><a href="https://github.com/matrix-org/matrix-rust-sdk">matrix-rust-sdk</a> is an attempt to build a new reference client SDK for Matrix which can be used by as many platforms as possible - hopefully forever stopping us from reimplementing the wheel more than we need to. Work began towards the end of 2019, building on top of <a href="https://www.ruma.io/">Ruma</a>’s excellent Matrix rust crates, and poljar has been working away solidly at it ever since.  We teased matrix-rust-sdk in last year’s update, but as of this year it is properly coming of age and we’ve started using it in earnest - beginning by swapping out Element Android’s encryption implementation for matrix-rust-sdk-crypto (the E2EE cryptography crate provided by the SDK).</p>
<p>If you’re not familiar with Rust, the main benefits we get here are a heavy emphasis on safety and security without compromising performance; while providing a single codebase which can be used equally from iOS, native Desktop apps such as Fractal, Android (with native bindings) and even Web (via WASM, in future).  While technically this results in a “non-native” SDK relative to matrix-js-sdk, matrix-ios-sdk and matrix-android-sdk - in practice, it’s become so common to depend on native-code shared libraries (outside the web, at least) that it’s not really a problem.</p>
<p>Initial results look wildly promising here: “Element R” (formerly known as Corroded Element - the codename for the Rust-enhanced version of Element Android) builds are now out there, and out-perform the kotlin E2EE implementation by <a href="https://github.com/matrix-org/matrix-rust-sdk/pull/170">roughly 10x</a>, thanks to using native code and Rust’s improved parallelisation.</p>
<p>Our next step is to start using it on iOS, and we’ll be experimenting with a next-generation of Element iOS shortly in the new year with the SDK provided exclusively by matrix-rust-sdk.  Element will also be funding more people to work fulltime on matrix-rust-sdk itself, and to see what the developer experience is like when you use it seriously on the Web - watch this space!</p>
<h2 id="bridges-bots-widgets-and-integration-managers">Bridges, Bots, Widgets and Integration Managers</h2>
<p>Elsewhere in Matrix, the Bridge Crew has busy polishing bridges like crazy - working away on encrypted application services (<a href="https://github.com/matrix-org/matrix-doc/pull/3202">MSC3202</a>), massively improving the IRC bridge (particularly in the fallout of the great Freenode-&gt;Libera migration), stabilising and extending <a href="https://github.com/matrix-org/matrix-bifrost">matrix-bifrost</a> (our XMPP-and-more bridge), getting libpurple bridging working properly in bifrost, getting <a href="https://github.com/matrix-org/matrix-appservice-slack">matrix-appservice-slack</a> and <a href="https://github.com/Half-Shot/matrix-appservice-discord">matrix-appservice-discord</a> stable enough to be hosted by <a href="https://element.io/blog/slack-bridging/">EMS</a>, experimenting with <a href="https://github.com/turt2live/matrix-bot-sdk">matrix-bot-sdk</a> as an alternative bridging API, and even looking at adding <a href="https://github.com/matrix-org/matrix-rust-sdk/tree/main/crates/matrix-sdk-crypto">matrix-rust-sdk-crypto</a> into matrix-bot-sdk as an elegant way to power robust encrypted bridges (thus replacing Panatalaimon for that use case).</p>
<p>There’s also a new kid in town: <a href="https://github.com/Half-Shot/matrix-hookshot">matrix-hookshot</a> (formerly known as matrix-github) is a new all-singing-all-dancing general purpose integration built on matrix-bot-sdk, coming soon to an integration manager near you, which can bridge through to GitHub, GitLab, JIRA and freeform webhooks! Check it out a few weeks ago on <a href="https://youtu.be/55P-NdDa-UI?t=1018">Matrix Live</a>. matrix-hookshot is primarily Node, but is also getting in on the Rust action with some functions being implemented in native code.</p>
<p>Meanwhile, change is afoot for integration managers, which have been screaming out for an overhaul for years. There was a cheeky hint in last week’s <a href="https://youtu.be/Hsyqa5ozWIo?t=724">Matrix Live</a> where <a href="https://dimension.t2bot.io/">Dimension</a> did an unexpected cameo looking particularly swish…  All shall be revealed next year!</p>
<p><img src="/blog/img/2021-12-22-dimension.png" alt="A whole new Dimension" /></p>
<h2 id="dendrite-low-bandwidth-matrix-and-peer-to-peer-matrix">Dendrite, Low bandwidth Matrix and Peer-to-Peer Matrix</h2>
<p>Dendrite is our next-generation homeserver implementation written in Go, and having shipped the first beta in Oct 2020, we’ve cut another 11 releases over the course of this year - adding in features such as E2EE key backups, cross-signing, support for room versions 7, 8 and 9 (knocking and restricted join rules), massive state resolution performance improvements, an entirely new state storage implementation that uses ~15x less disk space, sync filtering, experimental support for peeking-over-federation (<a href="https://github.com/matrix-org/matrix-doc/pull/2444">MSC2444</a>) - not to mention huge numbers of bug fixes. Even more excitingly, we’re in the process of ditching Kafka in favour of native-Go message queuing in the form of <a href="https://github.com/matrix-org/dendrite/compare/nats">NATS</a>!</p>
<p>However, it’s been a bit of a weird year as the team has been repeatedly pulled onto other projects due to competing priorities - and there’s still a bunch of stuff left which is keeping us in beta.  Some of this is plain old missing features (search, push rules/notifications, room upgrades, presence etc) - but we’ve also run up against some problems over the last few months while implementing new room versions and similar thanks to the sheer number of different microservices which Dendrite is made out of. In retrospect, it feels like Dendrite has ended up too granular, and when hacking on it you get slowed down badly by all the boilerplate required to glue the various services together.  Therefore, we’ve just started to <a href="https://github.com/matrix-org/dendrite/pull/2055">merge some of the services together</a> - still preserving horizontal scaling of course, but refactoring the architecture a bit while we’re still in beta to help speed up development again. So far things are looking promising!  We’re also really looking forwards to <a href="https://github.com/matrix-org/dendrite/pulls?q=+is%3Apr+author%3As7evinK">s7evinK</a> joining the team to work on Dendrite fulltime in the coming weeks :)</p>
<p>Talking of competing priorities, there have been three other big missions going on at the same time as Dendrite dev: firstly - formalising Low Bandwidth Matrix. LB Matrix is super important for maximising battery life on mobile, as well as (obviously) supporting worse network conditions - and it’s effectively a prerequisite for P2P Matrix.  We did a bunch of experiments around it back in <a href="https://matrix.org/blog/2019/03/12/breaking-the-100-bps-barrier-with-matrix-meshsim-coap-proxy">2019</a>, but earlier in the year we needed it <a href="https://twitter.com/element_hq/status/1418632867626770433">for real</a> and <a href="https://github.com/matrix-org/matrix-doc/pull/3079">MSC3079</a> was the result. The low bandwidth dialect which we’ve proposed in the MSC is designed for use on the real Internet using standard IETF protocols (CoAP + DTLS + CBOR) and so isn’t quite as exotic as the 2019 version, but still gives a ~10-20x bandwidth improvement over normal HTTP+JSON based Matrix.  It hasn’t made it to Element yet, but if you’re interested go <a href="https://matrix.org/blog/2021/06/10/low-bandwidth-matrix-an-implementation-guide">check out the blog post</a>!</p>
<p>Secondly, we’ve been sidetracked by the entirety of P2P Matrix.  This is our long-term mission to let Matrix run peer-to-peer without the need for any servers (or indeed Internet connectivity, thanks to Bluetooth Low Energy) by embedding servers such as Dendrite into clients such as Element and so let each Matrix Client have its own personal local homeserver.  We’ve made massive progress over the course of the year on P2P - the biggest breakthroughs being <a href="https://matrix.org/blog/2021/05/06/introducing-the-pinecone-overlay-network">Pinecone</a> as an entirely new P2P overlay network, with the novel SNEK (sequentially networked edwards key) routing topology.  (The animation below shows a P2P network arranging itself into a SNEK!)</p>
<p><img src="/blog/img/2021-12-22-pinecone.gif" alt="SNEK" /></p>
<p>You can read all about it in <a href="https://matrix.org/blog/2021/05/06/introducing-the-pinecone-overlay-network">the blog post</a>, but suffice it to say that Pinecone outperformed all the other P2P overlay networks in <a href="https://github.com/mwarning/meshnet-lab">meshnet-lab</a>’s <a href="https://github.com/mwarning/meshnet-lab/tree/master/tests/mobility2">Mobility2</a> test:</p>
<p><img src="/blog/img/2021-12-22-pinecone-perf.png" alt="Pinecone perf benchmarks" /></p>
<p>You can play with P2P Matrix today on iOS and Android (head over to <a href="https://matrix.to/#/#p2p:matrix.org">#p2p:matrix.org</a> for builds), but there is some major work still to be done:</p>
<ul>
<li>We need to bridge to today’s Matrix network. Right now, having a weird experimental test network for P2P means that in practice nobody actually uses it other than for demos - whereas if you could actually talk to everything else in Matrix, it’d be way more compelling and interesting to use and dogfood.  We’re currently thinking about how best to do this!</li>
<li>We need to standardise the actual transport to be used over Pinecone.  Currently it uses HTTPS over <a href="https://en.wikipedia.org/wiki/Micro_Transport_Protocol">μTP</a> (purely because empirically it handled packet loss and congestion well, and LB Matrix wasn’t ready at the time).  We’re currently experimenting with switching to LB Matrix using our own CoAP implementation called PineCoAP (potentially using pCoCoA congestion control, given CoAP doesn’t provide any congestion control out of the box), but this is early days.</li>
<li>We still need to finalise store-and-forward: if your destination is offline, do you buffer your transactions in the network somehow, or do you use another Matrix node to buffer them?</li>
<li>Relatedly, we need to tweak federation so that if events get lost, federation for a room can recover more gracefully than it does today - for instance, by bundling redundant auth events on transactions, or by providing more recovery mechanisms.</li>
<li>We still need to spec and implement multihomed accounts, so that your identity on your phone is not divorced from your identity on your laptop.</li>
<li>…and obviously, we need a robust post-beta Dendrite to act as the local homeserver!</li>
</ul>
<p>Right now focus is going back to Dendrite for a bit, but P2P work will resume again in the new year :)</p>
<p>Finally, the third big distraction from Dendrite has been… sync v3.</p>
<h2 id="sync-v3">Sync v3</h2>
<p>Sync v3 is shaping up to be the single most significant improvement to Matrix since we began.</p>
<p>Syncing data from the homeserver to the client is obviously fundamental to Matrix - and the current behaviour (sync v2) is far from perfect, as it’s designed around the assumption that your client wants to receive information for every room that it’s in.  In the early days of Matrix, this was fine: a typical user might be in tens of conversations, and it’s useful to have them all available for offline access.  Nowadays, however, it’s a disaster: users can easily accumulate hundreds or thousands of rooms - especially with rooms used to describe spaces or profiles and other structured realtime data.  Moreover, the number of rooms you’re in typically increases linearly over time, unbounded, as nobody wants to archive their old conversations.</p>
<p>So, the idea of sync v3 is that you only sync the strict subset of data that your client actually cares about to display in its UI - effectively making both initial and incremental sync instant, incredibly low bandwidth, and completely independent of the number of rooms you’re in (just as filesystem performance should be independent of the number of directories or files present).</p>
<p>For instance, the full initial sync for @matthew:matrix.org in sync v2 is 417MB of JSON uncompressed - or ~100MB if gzipped, and takes about 5 minutes to calculate on matrix.org (during which it murders the sync worker responsible and hammers the database like crazy).  By contrast, sync v3’s initial sync is 15KB uncompressed, or 5106 bytes compressed - and synced in 250 microseconds from a local sync-v3 server.  <strong>Yes folks, that’s somewhere between a 30,000x to 1,200,000x improvement over sync v2, depending on how you count it.</strong></p>
<p>Sync v3 gets this unbelievable performance by the client defining a sliding window into the server’s datasets, sized and ordered as needed for the client’s UI. This effectively performs real-time serverside pagination, so that as the client scrolls around or filters their roomlist or membership list, the client requests new views from the server.  Meanwhile the server sends incremental updates to the client if they intersect with the sliding window.  This may sound unwieldy, but in practice it works fine (although we’ll have some interesting challenges when we get around to encrypting state events, given serverside ordering and filtering will become distinctly harder).  It also doesn’t design out offline access, as the client caches its view of the world so even if you do go offline you can still work with all the data that has sent to your client so far (and the client could even proactively paginate in other content, if it wanted to, similar to an email client synchronising for offline access).</p>
<p>Sync v3 exists today as a proxy called <a href="https://github.com/matrix-org/sync-v3">sync-v3</a> which sits between any existing homeserver and a sync-v3-capable Matrix client.  It’s very early days, but Hydrogen has <a href="https://github.com/vector-im/hydrogen-web/compare/kegan/syncv3">basic v3 support</a> on a branch which we’ve been using to experiment with the API and flesh it out - and you can see a demo and intro talk in <a href="https://youtu.be/Hsyqa5ozWIo?t=59">last week’s Matrix Live</a>!</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Hsyqa5ozWIo?t=59" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>The API itself is still in flux, but those interested can see the initial spec design at <a href="https://github.com/matrix-org/sync-v3/blob/main/api.md">https://github.com/matrix-org/sync-v3/blob/main/api.md</a> and also an MSC is emerging at <a href="https://github.com/matrix-org/matrix-doc/blob/kegan/sync-v3/proposals/3575-sync.md">MSC3575</a>.  Next steps will be to finish hooking up to Hydrogen (including filtering the room list), finish the MSC, and then start thinking about implementing it in other clients and servers!</p>
<h2 id="fast-joins-over-federation">Fast Joins over Federation</h2>
<p>While we’re on the subject of speeding up Matrix… it’s all very well being able to sync your client instantly, but the other big complaint everyone has about Matrix is how long it takes to join rooms - especially big ones.  As most people will know, it can easily take 5-10 minutes to join a large room like Matrix HQ on a new homeserver - and given this is the first experience most users have of running their own homeserver, it can prove pretty disastrous and we are determined to fix it.  It will become even more relevant when we implement peeking over federation, as the last thing you want is to have to wait 5 minutes to temporarily dip into some random federated room to see if you want to join it or not (or to sniff its room state for things like extensible profiles or <a href="https://github.com/matrix-org/matrix-doc/pull/2313">MSC2313</a> reputation rooms).</p>
<p>So, to address this, we’re currently in the middle of experimenting with <a href="https://github.com/matrix-org/matrix-doc/pull/2775">MSC2775</a> (Lazyloading over Federation) in Synapse. This MSC lets servers participate in a room before they’ve received the full room state by defining a subset of state which is mandatory for participation, and then letting the rest get added lazily.  It’s quite a violent change as it means the assumption that room state is complete (to the best of the server’s knowledge) is no longer true - but given Matrix already has to handle incomplete room state, it’s not necessarily a showstopper.</p>
<p>Watch this space for how well it works in practice, but we’re hoping for a ~20x speed improvement in joining Matrix HQ.</p>
<h2 id="hydrogen">Hydrogen</h2>
<p>2021 has been a busy year for Hydrogen - our ultra-lightweight Matrix Client, which provides a small but perfectly formed progressive web app for us to experiment on! There have been no fewer than 56 releases over the course of the year, with loads of contributions from Bruno, Midhun (who joined first as a GSOCcer and then as a fulltime Element employee) and also Danila who interned at Element on Hydrogen over the summer.</p>
<p>People often ask why Hydrogen exists as well as Element Web - and the reason is because Element Web is (for now at least) very far from a progressive web app and is stuffed full of features, whereas Hydrogen is intended to be as lightweight and simple and efficient as possible while also targeting as wide a range of web browsers as possible (even Internet Explorer!).  It also provides a simpler platform for experimenting with new approaches such as sync v3 or OIDC without getting entangled in the constant hive of activity around Element Web.  Finally, it gives us a playground to experiment with embeddable chat clients thanks to Hydrogen’s strict <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel">MVVM</a> component model.</p>
<p>In terms of features, 2021 has seen huge steps forwards as Hydrogen converges on feature parity with Element - proper mentions and replies; rich formatted linkified messages; reactions; redactions; memberlist; member info; webpush notifications; proper image, video &amp; file uploads; SSO login; sync v3(!) and so much more. Can’t wait to see what 2022 will bring!</p>
<h2 id="end-to-end-encryption">End-to-End Encryption</h2>
<p>2021 saw the long-awaited creation of a dedicated cryptography team to focus exclusively on improving encryption in Matrix: previously encryption expertise was split across various different areas, meaning that it could prove hard to carve out time to tackle the bigger remaining encryption challenges.</p>
<p>So far the team has been busy digging deep into the few remaining causes of UISIs (undecryptable messages), including automated UISI reporting and tracing E2EE flows end-to-end (from client to server to server to client).  There’s also been an initial wave of UX work - with much more to come next year as we overhaul cross-signing and device backups to make it way more user friendly.</p>
<p>Meanwhile, on the more foundational side of things, we’re continuing to define Decentralised MLS as a potential next-generation form of end-to-end encryption, building on the IETF’s <a href="https://datatracker.ietf.org/wg/mls/about/">MLS</a> work - providing much better scalability for large chat rooms and potentially helping with some causes of encryption failures.  Hubert (uhoreg) has been leading the charge here, with his <a href="https://gitlab.matrix.org/matrix-org/mls-ts/-/blob/decentralised2/decentralised.org">latest thoughts emerging here</a> alongside a <a href="https://www.youtube.com/watch?v=UiUyWZg3J7k">brand new demo</a> showing his <a href="https://gitlab.matrix.org/uhoreg/mls-demo">DMLS simulator</a> - which under the hood is actually sending real Matrix events over DMLS!</p>
<p><img src="/blog/img/2021-12-22-dmls.png" alt="DMLS" /></p>
<p>Otherwise, the team has had three big projects: adding matrix-rust-sdk-crypto into Element Android (which we already covered above), arranging a fresh security audit of Matrix’s end-to-end encryption (due to complete January 2022)… and, most excitingly: vodozemac.</p>
<p><a href="https://github.com/matrix-org/vodozemac">Vodozemac</a> (pronounced roughly vod-oz-eh-matz) is an entirely new implementation of our Olm and Megolm end-to-end encryption system, written from scratch in pure Rust, aiming to replace the original reference C/C++11 implementation in <a href="https://gitlab.matrix.org/matrix-org/olm">libolm</a>.  Originally written as an <a href="https://github.com/matrix-org/matrix-rust-sdk/compare/vodozemac-bench">experiment for matrix-rust-sdk</a> at the beginning of the year, in the last week it’s received a <a href="https://github.com/matrix-org/vodozemac/graphs/contributors">huge explosion of attention</a> from poljar and dkasak to bring it up to production quality… for we decided that if we are doing a full E2EE audit for Matrix, we should target the new and future codebase rather than burn money on re-auditing the legacy libolm library (much as the <a href="https://matrix.org/blog/2016/11/21/matrixs-olm-end-to-end-encryption-security-assessment-released-and-implemented-cross-platform-on-riot-at-last">original 2016 review of libolm</a> happened when the library was fresh and new).</p>
<p>The motivation for vodozemac in general is to benefit from the intrinsic type and memory safety and fearless parallelism provided by Rust - and also maintain full type &amp; memory safety throughout the matrix-rust-sdk stack, including encryption.  Over the last year we’ve been taking<a href="https://matrix.org/blog/2021/06/14/adventures-in-fuzzing-libolm"> more and more of a careful look at libolm</a>, and despite our best efforts a <a href="https://matrix.org/blog/2021/12/13/disclosure-buffer-overflow-in-libolm-and-matrix-js-sdk">few</a> memory management bugs have crept in - which vodozemac should be immune to.  Vodozemac will solve another embarrassing problem with libolm: that its default cryptography primitives are designed for correctness rather than performance or safety.  By switching to Rust’s ed25519-dalek and rustCrypto AES primitives we should be in a much better position in terms of performance and safety.</p>
<p>Next up, we’ll be fully integrating vodozemac into matrix-rust-sdk, and figuring out how best to provide it as a libolm replacement in general.</p>
<h2 id="matrix-security">Matrix Security</h2>
<p>Alongside the new Cryptography team we’ve also established a new dedicated Security team for Matrix, led by dkasak.  As well as <a href="https://matrix.org/blog/2021/06/14/adventures-in-fuzzing-libolm">fuzzing excursions</a> into libolm and similar research, Denis has been handling all our <a href="https://matrix.org/security-disclosure-policy">security disclosure policy</a> submissions, managing the <a href="https://blog.intigriti.com/matrix/">Intigriti bug bounty</a> programme, helping coordinate all our security releases, and coordinating the upcoming external independent security audit of vodozemac, matrix-rust-sdk, Element and Synapse.  It’s a huge step forwards to be able to fund full-time infosec researchers to focus exclusively on Matrix, and this is just the beginning!</p>
<h2 id="trust-and-safety">Trust and Safety</h2>
<p>Another place where we’ve created a dedicated team this year is around Trust &amp; Safety: building tools to fight spam and abuse on our own servers, while also empowering the wider network of users, moderators and admins to manage abuse as they see fit.  This includes lots of work on Mjolnir, our primary moderation bot, but also defining MSCs such as <a href="https://github.com/matrix-org/matrix-doc/pull/3215">MSC3215</a> (Aristotle: Moderation in all things) and <a href="https://github.com/matrix-org/matrix-doc/pull/3531">MSC3531</a> (Letting moderators hide messages pending moderation) and internal tooling as we experiment with different approaches.</p>
<p>We’ll have more updates on this in the coming year as we release the tools we’ve been working on, but suffice it to say that the goal is to empower mainstream users in the wider Matrix network to apply their own rules as they see fit, directly from the comfort of their favourite Matrix client - without having to know what a Mjolnir is (or how to run one), and without having to be a moderation expert.</p>
<h2 id="openid-connect">OpenID Connect</h2>
<p>A new project brewing throughout 2021 has been the investigation into replacing the entirety of Matrix’s authentication APIs with industry standard OpenID Connect.  Spearheaded by Quentin, this has proved to be a fascinating and challenging endeavour, but we’re starting to see some really interesting results.  The problem we’re trying to solve here is:</p>
<ul>
<li>As Matrix grows, we’re seeing more and more clients and services appearing which you might want to log into with your Matrix account.  But do you really want to trust each app with your account password?  And what if you only want to give it access to a small subset of your account?</li>
<li>Similarly, we’re seeing more and more login mechanisms used to access Matrix - it’s no longer just a matter just a username + password; many servers use single-sign-on (e.g. mozilla.org) or social login (fosdem.org, matrix.org), or layer on 2FA or MFA hardware tokens and similar to access their accounts via an SSO provider.  We also see passwordless login on the horizon.</li>
</ul>
<p>So, do we really want to mandate each new Matrix client to have to implement custom flows to handle this explosion of login/registration mechanisms?  And is it even really the client’s problem in the first place?  You’re securing access to your account on your chosen server, which isn’t really a client-specific thing at all.</p>
<p>The real turning point for the project however has been our recent experiences building out a new wave of single-use domain-specific clients (see below) for video conferencing, whiteboarding, metaverse-browsing etc… where by <em>far</em> the most painful bit of the project has been hooking up the UI for login, registration, guest access, incremental signup, password reset, email verification, CAPTCHA, SSO, etc.  And that’s even when building on top of matrix-react-sdk, which theoretically has it all already thanks to Element Web!</p>
<p>Frankly, it has become blindingly obvious that it’s crazy for clients to reimplement this every time, and they should instead chuck the user over to a sign-on portal provided by their homeserver - just like Google and everyone else’s single-sign-on does.  And rather than inventing our own homebrew way of doing that, we should just use the existing industry standard SSO best practices defined by OpenID Connect.</p>
<p>The main objections which have come up against this are: “what if my Matrix client doesn’t have a web browser, or what if I want to provide my own native login UI”, and “does this design out the idea of using a single password to access your account as well as your E2EE history”?  In both instances, we have workarounds: in practice, there are so many Matrix clients around that we won’t be removing today’s legacy login/registration APIs any time soon (just like HTTP Basic Auth is still very much a thing on the web!).  And in terms of “cryptographic login”, there are ways we could daisychain the auth required to unlock your E2EE storage to also authenticate you with your server - although this would be a major extension (much as cryptographic login is already today!)</p>
<p>The current status is that we’ve defined a set of initial MSCs (<a href="https://github.com/matrix-org/matrix-doc/pull/2964">MSC2964</a>, <a href="https://github.com/matrix-org/matrix-doc/pull/2965">MSC2965</a>, <a href="https://github.com/matrix-org/matrix-doc/pull/2966">MSC2966</a> and <a href="https://github.com/matrix-org/matrix-doc/pull/2967">MSC2967</a>), and are implementing an initial Open ID Connect auth server (in Rust!) called <a href="https://github.com/matrix-org/matrix-authentication-service">matrix-authentication-service</a> (better name suggestions welcome!) designed to sit alongside your homeserver, and we’re experimenting with hooking <a href="https://github.com/sandhose/hydrogen-web/tree/sandhose/oidc-login">Hydrogen</a> (and some of the new domain-specific clients) up to see how it feels.  But if it goes as well as we think it might, folks should prepare for 2022 to be the year where Matrix’s authentication system finally gets fixed!</p>
<h2 id="native-matrix-video-voip-conferencing">Native Matrix Video/VoIP Conferencing</h2>
<p>One of the most anticipated features in Matrix over the years has been the prospect of native, decentralised, end-to-end encrypted video and voice conferencing.  Today, voice and video conferencing in Matrix works by embedding Jitsi as a third party centralised service into your chatroom.  This works fairly well - but Jitsi is an entirely separate service with lots of moving parts, and its own concept of users and access control (provided by XMPP!) and its megolm-based end-to-end-encryption doesn’t actually integrate with Matrix’s own Olm identities, verification or cross-signing.  The fact that the conference is then logically centralised on whoever is hosting the Jitsi service also misses one Matrix’s main goals - that users should be able to hold a conversation without being dependent on any single service or provider.  Plus it’s really confusing that Matrix has proper native 1:1 calls for DMs… but then switches to a totally different system in group chats.</p>
<p>So, this year we set out to fix it - and succeeded :D  The solution hinges around <a href="https://github.com/matrix-org/matrix-doc/blob/matthew/group-voip/proposals/3401-group-voip.md">MSC3401</a> - a spec proposal that describes how to extend native 1:1 calls to work for groups, while providing real flexibility on how to actually mix the calls together.  At the simplest extreme, it defines how full mesh calls work (where every client simply calls every other client simultaneously) - but then also defines how you can mix calls together either using a single focus (conferencing server) or multiple foci run by different parties, where foci can either be Selective Forwarding Units (SFUs, like Jitsi) or Multipoint Conferencing Units (MCUs, like FreeSWITCH).  The end result is to give us decentralised, cascading, end-to-end encrypted conferencing which even has direct compatibility with today’s 1:1 Matrix calling, letting you easily hook in bots and bridges which already support 1:1 Matrix calls!</p>
<p>Robert Long has been frantically hacking away at the <a href="https://github.com/vector-im/matrix-video-chat">initial implementation</a> over the last few months, fleshing out full-mesh conferencing at first and getting it running in as many browsers as possible (including Mobile Safari and Chrome Android!).  We were hoping to fully unveil the end result in time for Christmas, but in practice we hit some last minute snags (turns out Matthew forgot guest users can’t use TURN, who knew? so much for incremental login! 😰) which have pushed the launch to early next year.  But hopefully in a few weeks, you’ll be able to start jumping on a native group call in Matrix!</p>
<p>Meanwhile, those interested can see all the gory details from our CommCon 2021 talk a few weeks ago, complete with a demo of the shape of things to come…</p>
<iframe width="736" height="414" src="https://www.youtube.com/embed/A4k7DVIK5TE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Next up, we’ll be working on building an <a href="https://github.com/matrix-org/matrix-doc/pull/3401">MSC3401</a>-compatible SFU so we can go beyond full mesh (which typically supports a maximum of ~7 callers).  Our candidates right now are mediasoup, ion-sfu, janus and signal-calling-service - we’ll let you know how it goes!  Also, if you’re interested in helping us build this out quicker, we are frantically searching for more WebRTC &amp; VoIP gurus to <a href="https://apply.workable.com/elementio/j/25BB112FBD/">join the team at Element</a> working on this.</p>
<h2 id="applications-beyond-chat">Applications Beyond Chat</h2>
<p>Finally, 2021 was the year where we seriously started building out functionality on Matrix which goes far beyond plain old chat rooms.</p>
<p>Work began in the summer as a research project led by Ryan, formerly tech lead for Element Web - looking at ways to store hierarchical structured data into Matrix while preserving real-time semantics; effectively using Matrix as a collaborative decentralised object tree, providing CRDT (Conflict-free Replicated Data Types) to allow richer applications to be built on Matrix.  This journey led him to create <a href="https://github.com/matrix-org/patience">Patience</a> as a test environment for building out these sort of clients, and meanwhile Timo (famous of <a href="https://github.com/toger5/TheBoard">The Board</a>) joined the team to build out <a href="https://youtu.be/Hsyqa5ozWIo?t=1054">Full Screen Widgets</a> in Element, providing a much better UI for beyond-chat experiments.</p>
<p>Meanwhile, Matthew Weidner and the Composable Systems Lab at CMU stunned us all by presenting a complete CRDT solution using Matrix named <a href="https://github.com/composablesys/collabs">Collabs</a> at <a href="https://youtu.be/Exr0iY_D-vw?t=382">Strange Loop 2021</a>.  This is <em>really</em> impressive stuff - the brave of heart can go and embed a Matrix-powered end-to-end-encrypted collaborative markdown editor straight into Element via Collabs by following the <a href="https://compoventuals-tests.herokuapp.com/">instructions here</a>.  In practice, Collabs works by serialising the CRDT updates as base64 blobs inside Matrix timeline events (hello <a href="https://svn.apache.org/repos/asf/incubator/wave/whitepapers/federation/wavespec.html#anchor35">Wave</a>, is that you?), but we’re now investigating how you might reconcile this with maintaining a proper realtime object tree in Matrix.</p>
<p>It’s hard to overstate how powerful storing freeform tree CRDTs in Matrix would be.  It could open up everything from decentralised encrypted collaborative document editing to collaborative whiteboarding and collaborative <a href="https://figma.com/">Figma</a>-style (or <a href="https://penpot.app/">Penpot</a>- or <a href="https://www.blender.org/">Blender</a>-style) design.  You could even start storing an HTML DOM into a room, alongside its binary assets, giving you a multiplayer DOM to build on… and then imagine if you could store the <a href="https://developer.mozilla.org/en-US/docs/WebAssembly/Understanding_the_text_format">syntax tree</a> of the code operating on that DOM alongside it, in the same room.  Before you know it, we will have created kind of some incredible <a href="https://en.wikipedia.org/wiki/Smalltalk">Smalltalk</a> / <a href="https://en.wikipedia.org/wiki/Croquet_Project">Croquet</a> / <a href="https://en.wikipedia.org/wiki/Alan_Kay">Alan Kay</a> nirvana where code is data and data is code and it’s all running live in some kind of decentralised encrypted multiplayer Metaverse :D</p>
<p>While we’ve been looking at storing object trees in Matrix, another obvious angle that has emerged is to use Matrix for encrypted decentralised file storage. <a href="https://github.com/matrix-org/matrix-doc/pull/3089">MSC3089</a> is a proposal on how you might represent hierarchies of files in Matrix - where each room acts effectively as a directory of files, with spaces forming a directory structure (much as they do already in today’s Matrix), leveraging Matrix’s existing decentralised access control mechanisms to control who can access what.  Combine such a file storage system with the collaborative editing capabilities mentioned above, and suddenly a really exciting proposition starts to emerge.  We’re investigating this right now, and all will be revealed early next year…</p>
<p>Finally, and last but not least, Robert Long has been building on top of our shiny new Native Matrix Voice/Video Conferencing capabilities to use Matrix as the communication backbone for a truly open, equitable and interoperable vision of the Metaverse.  The best way of describing it is to look at his awesome <a href="https://www.youtube.com/watch?v=e26UJRCGfGk&amp;t=2263s">Third Room demo from the Open Metaverse Interoperability Group demo session</a> in September:</p>
<iframe width="800" height="450" src="https://www.youtube.com/embed/e26UJRCGfGk?t=2263s" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Now, some folks will recall that since day one (in fact, since before day one) the hope for Matrix was that it might end up as the communications fabric of the Metaverse.  We were about 4 years early when we <a href="https://matrix.org/blog/2017/04/04/opening-up-cyberspace-with-matrix-and-webvr">first starting enthusing about this</a>, and then still ahead of our time when we did the world’s first <a href="https://matrix.org/blog/2018/02/05/3-d-video-calling-with-matrix-webrtc-and-webvr-at-fosdem-2018">3D Video calling</a> over Matrix.  However, it now feels like the world has finally caught up - and we’re in grave danger of being overtaken by a dystopia where the big tech companies balkanize the Metaverse into a series of closed proprietary user-exploiting walled gardens, much like today’s incumbent chat silos - but even worse.</p>
<p><strong>This is our chance to fix it before it’s too late</strong>, and <a href="https://element.io/careers">Element is funding a small but highly targeted team</a> to focus exclusively on building out open interoperable Metaverse over Matrix - ensuring that collaboration in 3D (and 2D) spatial environments in future is decentralised, secure and standards-based.  This obviously ties in directly with the rest of the Beyond Chat projects listed above: it’s early days, but it’s incredibly exciting to imagine where we could end up if this works!</p>
<p>Finally, a question which has kept coming up while working on Beyond Chat projects has been whether to implement this new functionality as Matrix widgets, bake them into existing Matrix clients, or build them as domain-specific dedicated Matrix clients.  But perhaps we’re thinking about this all wrong: what if your Matrix client was just a browser for Matrix rooms?  Some of these could be chatrooms.  Some of these could be VoIP/Video conferences or Discord-style voice/video rooms.  Some of these could be message boards or mailing lists.  Some of these could be collaborative editors or whiteboards.  Some of these could be 3D views into the metaverse.  Some of these could be rendered via widgets; some could be rendered natively if the client knows how.  And some of these could even be good old web pages(!!!).</p>
<p>Imagine if your Matrix client was effectively a genuine browser of arbitrary decentralised realtime content?  If your view into a Matrix room was just that: a full window view into that room, be it textual or 2D or 3D - and your Matrix client was just a browser which added the necessary chrome and navigation to help you tab between rooms, login and logout, manage your encryption, track who’s in the room, track your notifications, etc.?</p>
<p>Meanwhile, if you’re in a web browser, you might hop into a lightweight single-page domain-specific webapp which happens to use Matrix for collaboration.  Or if you’re in a Matrix client/browser, you could hop to the same matrix URL to get at the same functionality with all the supporting chrome and UI overlays sliding in as needed…</p>
<p>Perhaps the vision of Matrix as the missing communication layer of the open Web is more literal than we ever thought.  Eitherway, it will be fascinating to see how Applications Beyond Chat evolves over the next year.</p>
<h2 id="2022">2022</h2>
<p>Now, I dare you to cross-reference all of the above with <a href="https://matrix.org/blog/2020/12/25/the-matrix-holiday-special-2020#2021">last year’s predictions for 2021</a> to see how we did :D In practice, the only things from the list we haven’t got to are peeking-over-federation (although arguably fast joins are a key part of that), account portability, and restoring incremental sign-up (although our new clients have it!).</p>
<p>So, here go the predictions for 2022 (keeping it short, otherwise it’ll be 2023 before this blog post gets finished…):</p>
<ul>
<li><strong>Client polish and performance</strong> - our prime directive is to ensure that Matrix clients can be built with UX polish and quality which exceeds our centralised alternatives.  In practice, this means:
<ul>
<li><strong>Element must spark joy</strong>.  Ensuring Element’s Information Architecture continues to be simplified and refined, and that <em>nobody</em> who knows how to use a computer hits a WTF moment when first using the app.  Never again do we want to see someone on Twitter saying “I have no idea how to use Matrix”.</li>
<li><strong>Instant launch</strong>.  With Sync v3 and matrix-rust-sdk we hope to make Element launch instantly on all platforms - including initial sync.</li>
<li><strong>Fast joins</strong>.  We should never get bored while waiting to join a room or accept an invite.</li>
<li><strong>Spaces</strong>.  While Spaces are already a huge improvement in letting users organise and discover rooms, there’s still much more to be done:
<ul>
<li><strong>Flair</strong> - Users who are members of a space should be able to announce it loud and proud with a Flair badge on their avatar, like we used to with the old pre-spaces Communities feature (<a href="https://github.com/matrix-org/matrix-doc/pull/3219">MSC3219</a> being the potential proposal).</li>
<li><strong>Synchronising access controls</strong> - You should be able to apply access controls based on whether a user is a member of a given group (so that if you invite them to #moderators:example.com, they automatically get made moderator in all the rooms in a given space).  It looks likely that this will be implemented at last using joepie91’s <a href="https://github.com/matrix-org/matrix-doc/pull/3216">MSC3216</a> proposal for Synchronized access control for Spaces (rather than Matthew’s original <a href="https://github.com/matrix-org/matrix-doc/pull/2962">MSC2962</a> - an excellent example of the community steering the spec process :)</li>
<li><strong>Bulk joins</strong> - It should be a one-button operation to join all the rooms in a space.</li>
<li>**Subspaces **- as more and more spaces emerge, the ability to navigate them as a hierarchy becomes more and more useful.  We want to get to the point where we can turn off the Matrix.org public rooms list, and instead present a Space tree of all the good rooms we know about in Matrix… delegating over curation to the wider community; building a huge USENET-style hierarchy of where to go in Matrix.  To do that, we need subspaces to sing!</li>
<li><strong>Removing communities/groups</strong>, which will then be entirely superseded by spaces.</li>
</ul>
</li>
<li>**Threads **go-live!</li>
<li><strong>Location share</strong> go-live</li>
<li><strong>Pinned messages</strong>, so the most important messages are always visible to everyone n the room</li>
<li><strong>Starred messages</strong>, so you never lose a message ever again</li>
<li><strong>Custom emoji</strong>, finally merging in all the custom emoji work from the community.</li>
</ul>
</li>
<li><strong>matrix-rust-sdk</strong>
<ul>
<li><strong>Element iOS on rust-sdk</strong></li>
<li><strong>Element Android on rust-sdk-crypto</strong></li>
<li>…and experiment to see how matrix-rust-sdk feels on Web? It’s a real shame that <a href="https://github.com/daydream-mx/Daydream">Daydream</a> got archived…</li>
</ul>
</li>
<li><strong>Encryption</strong>
<ul>
<li><strong>Vodozemac</strong> in matrix-rust-sdk, maybe even elsewhere.</li>
<li>**Updated E2EE Audit **spanning vodozemac, olm+megolm, matrix-rust-sdk… and a representative sample of a typical Element+Synapse deployment.</li>
<li><strong>DMLS</strong> - getting to the point where we can experiment with it in real clients.</li>
<li><strong>Encryption Agility</strong> - the ability to <a href="https://github.com/matrix-org/matrix-doc/issues/3516">migrate encrypted history</a> is going to become really important as we evolve our E2EE, whether that’s by adding in post-quantum algorithms, or moving from Megolm to MLS, or any other shifts.  We will need to start thinking about it in 2022.</li>
</ul>
</li>
<li><strong>Next-generation MSCs</strong>
<ul>
<li><strong>Aggregations</strong> - finalising the foundational MSCs for aggregations, at last</li>
<li><strong>Extensible events</strong> - finalising the foundational MSCs for extensible events, at last</li>
<li>**Sync v3 **- finalising the MSC and implementing it in matrix-rust-sdk</li>
<li><strong>Fast joins</strong> - getting them implemented in Synapse and Dendrite</li>
<li><strong>Peeking over federation</strong> - getting them implemented in Synapse and Dendrite</li>
<li><strong>Extensible profiles</strong> - who needs a facebook wall when you have a profile room on Matrix?</li>
<li><strong>Open ID Connect</strong> - using OIDC as an alternative auth mechanism for new clients.</li>
</ul>
</li>
<li><strong>Gitter parity</strong>
<ul>
<li><strong>Importing the Gitter archives into Matrix</strong> via <a href="https://github.com/matrix-org/matrix-doc/pull/2716">MSC2716</a></li>
<li><strong>Implementing excellent public static Matrix archives</strong> (replacing both view.matrix.org and gitter.im’s static views)</li>
<li><strong>Transfiguring Gitter into a Gitter-themed Element</strong></li>
</ul>
</li>
<li><strong>Dendrite</strong>
<ul>
<li>**Parity with Synapse **- and out of beta, with any luck!</li>
</ul>
</li>
<li><strong>P2P Matrix</strong>
<ul>
<li><strong>Exposing the normal Matrix network via P2P!</strong></li>
<li><strong>Multihomed accounts</strong></li>
<li><strong>Store and forward</strong> (if only by relaying via other P2P Matrix nodes)</li>
<li>**Low bandwidth transports **- via PineCoAP or similar</li>
<li><strong>Making federation robust in a highly disconnected network.</strong></li>
</ul>
</li>
<li><strong>Hydrogen</strong>
<ul>
<li>**Daily Driver **- making sure that Hydrogen can be readily used as a daily driver Matrix client, even if it lacks full parity with Element.</li>
<li>**Embeddable Hydrogen **- making the most of Hydrogen as a tiny lightweight PWA to embed it into existing websites.</li>
</ul>
</li>
<li><strong>Bots and Bridges</strong>
<ul>
<li>**Landing End-to-Bridge-Encryption **for all existing matrix-appservice-bridge based bridges</li>
<li><strong>All the integrations!</strong></li>
<li><strong>First-class UI for configuring integrations!</strong></li>
</ul>
</li>
<li><strong>Trust &amp; Safety</strong>
<ul>
<li><strong>Empower users to manage abuse within their communities</strong>.</li>
</ul>
</li>
<li><strong>Native Group Voice/Video Conferencing</strong>
<ul>
<li><strong>Launch a standalone conferencing app!</strong></li>
<li><strong>Build a <a href="https://github.com/matrix-org/matrix-doc/pull/3401">MSC3401</a>-capable SFU</strong></li>
<li><strong>Add native group calling to Element</strong></li>
</ul>
</li>
<li><strong>Border gateways</strong>
<ul>
<li>Something we didn’t mention in 2021 is the increasing interest in building border gateways and hardware cross domain gateways to safely link different Matrix federations together.  We expect to see a lot of activity in this space in 2022, and there should be some new MSCs too :)</li>
</ul>
</li>
<li><strong>Beyond Chat</strong>
<ul>
<li>**Metaverse on Matrix **- building out the dream as per above!</li>
<li>**Collaborative editing **- extending Matrix to store trees of events, and collaborate on them in realtime - starting with a collaborative editor!</li>
<li><strong>File storage in Matrix</strong> - building out real-life file storage on top of Matrix.</li>
</ul>
</li>
</ul>
<p>So, there you have it. If you’ve got this far… it’s incredible; you’re amazing: thank you for reading!  The sheer length of this update shows just how much Matrix has grown in 2021 relative to previous years; it’s frankly terrifying to imagine how long the equivalent post will be next year.  We may have to change the format a little :)</p>
<p>And that’s a wrap for 2021: we hope you stay safe and have an excellent end of the year.  Huge thanks for flying Matrix and supporting the project - we literally wouldn’t be here without you.</p>
<p>- Matthew, Amandine &amp; the whole Matrix core team.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2021&#x2F;07&#x2F;27&#x2F;element-raises-30m-to-boost-matrix&#x2F;" title="Element raises $30M to boost Matrix">Element raises $30M to boost Matrix</a></h2>
                <span>
                    27.07.2021 00:00
                    —
                    <a href="/category/general">
                        General
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hi folks,</p>
<p>Big news today: Element, the startup founded by the team who created Matrix,
just raised $30M of Series B funding in order to further accelerate Matrix
development and improve Element, the flagship Matrix app. The round is led by
our friends at <a href="https://protocol.ai">Protocol Labs</a> and <a href="https://metaplanet.com">Metaplanet</a>,
the fund established by Jaan Tallinn (co-founder of
Skype and Kazaa).  Both Protocol Labs and Metaplanet are spectacularly on
board our decentralised communication quest, and you couldn't really ask for
a better source of funding to help take Matrix to the next level.  Thank you
for believing in Matrix and leading Element's latest funding!</p>
<p>You can read all about it from the Element perspective over at the
<a href="https://element.io/blog/element-raises-30m-as-matrix-explodes">Element Blog</a>,
but suffice it to say that this is enormous news for the Matrix ecosystem as a
whole.  In addition to transforming the Element app, on the Matrix side this
means that there is now concrete funding secured to:</p>
<ul>
<li>
<p>finish building out <a href="https://matrix.org/blog/2021/05/06/introducing-the-pinecone-overlay-network">P2P Matrix</a>
and get it live (including finishing Dendrite, given our P2P work builds on Dendrite!)</p>
</li>
<li>
<p>implement <a href="https://twitter.com/matrixdotorg/status/1419820122143961093">native decentralised E2EE voip/video conferencing</a> for Matrix</p>
</li>
<li>
<p>fully build out our
<a href="https://matrix.org/blog/2020/10/19/combating-abuse-in-matrix-without-backdoors">relative decentralised reputation system</a>
in order to combat abuse in Matrix.</p>
</li>
</ul>
<p>Obviously this is in addition to all the normal business-as-usual work going
on in terms of:</p>
<ul>
<li>getting <a href="https://element.io/blog/spaces-the-next-frontier/">Spaces</a> out of beta</li>
<li>adding Threading to Element (yes, it's finally happening!)</li>
<li>speeding up room joins over federation</li>
<li>creating 'sync v3' to lazy-load all content and make the API super-snappy</li>
<li>lots of little long-overdue fun bits and pieces (yes, custom emoji, we're looking at you).</li>
</ul>
<p>If you're wondering whether Protocol Labs' investment means that we'll be
seeing more overlap between <a href="https://ipfs.io">IPFS</a> and Matrix, then yes -
where it makes tech sense to do so, we're hoping to work more closely
together; for instance collaborating with the libp2p team on our P2P work
(we still need to experiment properly with gossipsub!), or perhaps giving
<a href="https://github.com/matrix-org/matrix-doc/blob/travis/msc/ipfs/proposals/2706-IPFS.md">MSC2706</a>
some attention.  However, there are no plans to use cryptocurrency incentives
in Matrix or Element any time soon.</p>
<p>So, exciting times ahead!  We'd like to inordinately thank everyone who has
supported Matrix over the years - especially our Patreon supporters, whose
donations pay for all the matrix.org infrastructure while inspiring others to
open their cheque books; the existing investors at Element (especially <a href="https://notion.vc">Notion</a>
and <a href="https://automattic.com">Automattic</a>, who have come in again on this round); all the large scale
Matrix deployments out there which are effectively turning Matrix into an
industry (hello <a href="https://matrix.org/blog/2021/07/21/germanys-national-healthcare-system-adopts-matrix">gematik!</a>) -
and everyone who has ever run a Matrix server, contributed code, used the
spec to make their own Matrix-powered creation, or simply chatted on Matrix.</p>
<p>Needless to say, Matrix wouldn't exist without you: the protocol and network
would have fizzled out long ago were it not for all the people supporting it
(the matrix.org server can now see over 35.5M addressable users on the
network!) - and meanwhile the ever-increasing energy of the community and the
core team combines to keep the protocol advancing forwards faster than ever.</p>
<p>We will do everything we possibly can to succeed in creating the long-awaited
secure communication layer of the open Web, and we look forward to large
amounts of Element's new funding being directed directly into core Matrix
development :)</p>
<p>thanks for flying Matrix,</p>
<p>Matthew, Amandine &amp; the whole Matrix core team.</p>

                
            </div>
        </article>
        
        <nav class="pagination">
    <div class="prev">
        
    </div>
    <span class="page-number">1 / 15</span>
    <div class="prev">
        
        <a href="&#x2F;author&#x2F;matthew-hodgson&#x2F;page&#x2F;2&#x2F;">Next ›</a>
        
    </div>
</nav>

    </div>
</div>

    </main>

    <footer class="site-footer">
    <div class="internal-links">
        
        <a href="&#x2F;faq">FAQs</a>
        
        <a href="&#x2F;security-disclosure-policy">Security Disclosure Policy</a>
        
        <a href="&#x2F;security-hall-of-fame">Security Hall of Fame</a>
        
        <a href="&#x2F;legal&#x2F;code-of-conduct">Code of Conduct for Matrix.org</a>
        
        <a href="&#x2F;legal">Legal</a>
        
        <a href="&#x2F;contact">Contact</a>
        
        <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org&#x2F;matrix.org&#x2F;">Site Source</a>
        
    </div>
    <div class="external-links">
        <div>
            
            <a href="&#x2F;code"><img src="/assets/github.svg" alt="GitHub"></a>
            
            <a href="https:&#x2F;&#x2F;gitlab.matrix.org&#x2F;"><img src="/assets/gitlab.svg" alt="GitLab"></a>
            
            <a href="https:&#x2F;&#x2F;mastodon.matrix.org&#x2F;@matrix"><img src="/assets/mastodon.svg" alt="Mastodon"></a>
            
            <a href="https:&#x2F;&#x2F;twitter.com&#x2F;matrixdotorg"><img src="/assets/twitter.svg" alt="Twitter"></a>
            
            <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCVFkW-chclhuyYRbmmfwt6w"><img src="/assets/youtube.svg" alt="YouTube"></a>
            
        </div>
    </div>
    <p>© 2022 The Matrix.org Foundation C.I.C.</p>
</footer>

</body>

</html>
