<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="twitter:widgets:csp" content="on" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="twitter:site" content="@matrixdotorg" />
    <meta name="twitter:creator" content="@matrixdotorg" />

    <title>Matrix.org - Matthew Hodgson</title>
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg" />
    <link rel="stylesheet" href="/style.css" />

    
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://matrix.turbo.fish/author/matthew-hodgson/atom.xml">
</head>

<body>
    
    <header class="site-header">
    <a href="/" class="brand">
        <img src="/images/matrix-logo-white.svg" alt="Matrix logo">
    </a>
    <input id="site-header-dropdown-checkbox" type="checkbox" class="dropdown-checkbox" aria-hidden="true">
    <label for="site-header-dropdown-checkbox" class="dropdown-button">&#xe602;</label>
    <label for="site-header-dropdown-checkbox" class="page-overlay"></label>
    <nav>
        
        
        <a href="&#x2F;about&#x2F;" class="
            ">
            About
        </a>
        
        
        
        <a href="&#x2F;blog&#x2F;" class="
            ">
            Blog
        </a>
        
        
        
        <a href="&#x2F;docs&#x2F;" class="
            ">
            Documentation
        </a>
        
        
        
        
        
        <div class="section-wrap">
            <input id="ecosystem-submenu-checkbox" type="checkbox" class="submenu-checkbox" aria-hidden="true"
                >
            <label for="ecosystem-submenu-checkbox" class="submenu-title">Ecosystem <div class="arrow">
                </div></label>

            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;clients&#x2F;">Clients</a>
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;bridges&#x2F;">Bridges</a>
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;servers&#x2F;">Servers</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;integrations&#x2F;">Integrations</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;sdks&#x2F;">SDKs</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;hosting&#x2F;">Hosting</a>
                    
                </div>
            </div>
        </div>
        
        
        
        <a href="&#x2F;podcasts&#x2F;" class="
            ">
            Podcasts
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;shop.matrix.org" class="
            ">
            Shop
        </a>
        
        
        
        <a href="&#x2F;try-matrix&#x2F;" class="primary
            ">
            Try Matrix
        </a>
        
        
    </nav>
</header>


    <main>
        
<div id="taxonomy-single">
    <div class="content">
        <header>
            <h1>Matthew Hodgson</h1>
            150 posts tagged with "Matthew Hodgson" <a href="/author">(See all Author)</a>
            
        </header>

        
        <article class="post">
            <header>
                <h2><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2018&#x2F;09&#x2F;05&#x2F;pre-disclosure-upcoming-critical-security-fix-for-synapse&#x2F;" title="Pre-disclosure: Upcoming critical security fix for Synapse">Pre-disclosure: Upcoming critical security fix for Synapse</a></h2>
                <span>
                    05.09.2018 00:00
                    —
                    <a href="/category/security">
                        Security
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hi all,</p>
<p>During the ongoing work to finalise a stable release of Matrix's Server-Server federation API, we've been doing a full audit of Synapse's implementation and have identified a serious vulnerability which we are going to release a security update to address (Synapse 0.33.3.1) on 
<b>Thursday Sept 6th 2018 at 12:00 UTC</b>.</p>
<p>We are coordinating with package maintainers to ensure that patched versions of packages will be available at that time - meanwhile, if you run your own Synapse, <strong>please be prepared to upgrade as soon as the patched versions are released</strong>.  All previous versions of Synapse are affected, so everyone will want to upgrade.</p>
<p>Thank you for your time, patience and understanding while we resolve the issue,</p>
<p><a href="/blog/wp-content/uploads/2018/09/signed_disclosure.txt">signed_predisclosure.txt</a></p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2018&#x2F;09&#x2F;03&#x2F;matrix-spec-update-august-2018&#x2F;" title="Matrix Spec Update August 2018">Matrix Spec Update August 2018</a></h2>
                <span>
                    03.09.2018 00:00
                    —
                    <a href="/category/tech">
                        Tech
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <h2 id="introducing-client-server-api-0-4-and-the-first-ever-stable-is-as-and-push-apis-spec-releases">Introducing Client Server API 0.4, and the first ever stable IS, AS and Push APIs spec releases!</h2>
<p>Hi folks,</p>
<p>As many know, we've been on a massive sprint to improve the spec - both fixing omissions where features have been implemented in the reference servers but were never formalised in the spec, and fixing bugs where the spec has thinkos which stop us from being able to ratify it as stable and thus fit for purpose .</p>
<p>In practice, our target has been to cut stable releases of all the primary Matrix APIs by the end of August - effectively declaring Matrix out of beta, at least at the specification level.  For context: historically only one API has ever been released as stable - the Client Server API, which was the result of a similar sprint back in Jan 2016. This means that the Server Server (SS) API, Identity Service (IS) API, Application Service (AS) API and Push Gateway API have never had an official stable release - which has obviously been problematic for those implementing them.</p>
<p>However, as of the end of Friday Aug 31, we're proud to announce the first ever stable releases of the <a href="/docs/spec">IS, AS and Push APIs</a>!</p>
<p><a href="/docs/spec"><img src="/_matrix/media/v1/download/t2l.io/587a1a86905b1e0e8f9342d76e57ffbe" /></a>
To the best of our knowledge, these API specs are now complete and accurately describe all the current behaviour implemented in the reference implementations (sydent, synapse and sygnal) and are fit for purpose. Any deviation from the spec in the reference implementations should probably be considered a bug in the impl. All changes take the form of filling in spec omissions and adding clarifications to the existing behaviour in order to get things to the point that an independent party can implement these APIs without having to refer to anything other than the spec.</p>
<p>This is the result of a lot of work which spans the whole Spec Core Team, but has been particularly driven by TravisR, who has taken the lead on this whole mission to improve the spec.  Huge thanks are due to Travis for his work here, and also massive thanks to everyone who has <del>suffered</del> <del>endured</del> reviewed his PRs and contributed to the releases.  The spec is looking unrecognisably better for it - and Matrix 1.0 is feeling closer than ever!</p>
<p>Alongside the work on the IS/AS/Push APIs, there has also been a massive attempt to plug all the spec omissions in the Client Server API.  Historically the CS API releases have missed some of the newer APIs (and of course always miss the ones which postdate a given release), but we've released the APIs which /have/ been specified as stable in order to declare them stable.  However, in this release we've tried to go through and fill in as many remaining gaps as possible.</p>
<p>The result is the release of <a href="/docs/spec/client_server/r0.4.0.html">Client Server API version 0.4</a>. This is a huge update - increasing the size of the CS API by ~40%. The biggest new stuff includes fully formalising support for end-to-end encryption (thanks to Zil0!), versioning for rooms (so we can upgrade rooms to new versions of the protocol), synchronised read markers, user directories, server ACLs, MSISDN 3rd party ids, and .well-known server discovery (not that it's widely used yet), but for the full picture, best bet is to look at <a href="/docs/spec/client_server/r0.4.0.html#changelog">the changelog</a> (now managed by <a href="https://pypi.org/project/towncrier/">towncrier</a>!).  It's probably fair to say that the CS API is growing alarmingly large at this point - Chrome says that it'd be 223 A4 pages if printed. Our solution to this will be to refactor it somehow (and perhaps switch to a more compact representation of the contents).</p>
<p>Some things got deliberately missed from the CS 0.4 release: particularly membership Lazy Loading (because we're still testing it out and haven't released it properly in the wild yet), the various GDPR-specific APIs (because they may evolve a bit as we refine them since the original launch), finalising ID grammars in the overall spec (because this is surprisingly hard and subtle and we don't want to rush it) and finally Communities (aka Groups), as they are still somewhat in flux.</p>
<p>Meanwhile, on the Server to Server API, there has also been a massive amount of work.  Since the beginning of July it's 
<b>tripled</b> in size as we've filled in the gaps, over the course of &gt;200 commits (&gt;150 of which from Travis).  If you take a look at the <a href="/docs/spec/server_server/unstable.html">current snapshot</a> it's pretty unrecognisable from the historical draft; with the main changes being:</p>
<ul>
 	<li style="font-weight: 400;">Adding the new State Resolution algorithm to address flaws in the original one.  This has been where much of our time has gone - see <a href="https://github.com/matrix-org/matrix-doc/pull/1441">MSC1442</a> for full details.  Adopting the new algorithm requires rooms to be recreated; we'll write more about this in the near future when we actually roll it out.
</li>
 	<li style="font-weight: 400;">Adding room versioning so we can upgrade to the new State Resolution algorithm.
</li>
 	<li style="font-weight: 400;">Everything is now properly expressed as Swagger (OpenAPI), just like the CS API
</li>
 	<li style="font-weight: 400;">Adding all the details for E2E encryption (including dependencies like to-device messaging and device-list synchronisation)
</li>
 	<li style="font-weight: 400;">Improvements in specifying how to authorize inbound events over federation
</li>
 	<li style="font-weight: 400;">Document federation APIs such as /event_auth and /query_auth and /get_missing_events
</li>
 	<li style="font-weight: 400;">Document 3rd party invites over federation
</li>
 	<li style="font-weight: 400;">Document the /user/* federation endpoints
</li>
 	<li style="font-weight: 400;">Document Server ACLs
</li>
 	<li style="font-weight: 400;">Document read receipts over federation
</li>
 	<li style="font-weight: 400;">Document presence over federation
</li>
 	<li style="font-weight: 400;">Document typing notifications over federation
</li>
 	<li style="font-weight: 400;">Document content repository over federation
</li>
 	<li style="font-weight: 400;">Document room directory over federation
</li>
 	<li style="font-weight: 400;">...and many many other minor bug fixes, omission fixes, and restructuring for coherency - see <a href="https://github.com/matrix-org/matrix-doc/issues/1464">https://github.com/matrix-org/matrix-doc/issues/1464</a> for an even longer list :)
</li>
</ul>
However, we haven't finished it all: despite our best efforts we're running slightly past the original target of Aug 31.  The current state of play for the r0 release overall (in terms of pending issues) is:
<a href="/blog/wp-content/uploads/2018/09/Screen-Shot-2018-09-03-at-16.56.18.png"><img class="aligncenter size-full wp-image-3525" src="/blog/wp-content/uploads/2018/09/Screen-Shot-2018-09-03-at-16.56.18.png" alt="" width="576" height="214" /></a>...and you can see the full breakdown over at the <a href="https://github.com/matrix-org/matrix-doc/projects/1">public Github project dashboard</a>.
<p>The main stuff we still have remaining on the Server/Server API at this point is:</p>
<ul>
 	<li style="font-weight: 400;">Better specifying how we validate inbound events. See <a href="https://github.com/matrix-org/matrix-doc/issues/1646">MSC1646</a> for details & progress.
</li>
 	<li style="font-weight: 400;">Switching event IDs to be hashes. See <a href="https://github.com/matrix-org/matrix-doc/issues/1640">MSC1640</a> for details and progress.
</li>
 	<li style="font-weight: 400;">Various other remaining security considerations (e.g. how to handle malicious auth events in the DAG; how to better handle DoS situations).
</li>
 	<li style="font-weight: 400;">Merging in the changes to authoring m.room.power_levels (as per <a href="https://github.com/matrix-org/matrix-doc/issues/1304">MSC1304</a>)
</li>
 	<li style="font-weight: 400;">Formally specifying the remaining identifiers which lack a formal grammar - <a href="https://github.com/matrix-org/matrix-doc/pull/1598">MSC1597</a> and particularly room aliases (
<a href="https://github.com/matrix-org/matrix-doc/pull/1607">MSC1608</a>)
</li>
</ul>
The plan here is to continue speccing and implementing these at top priority (with Travis continuing to work fulltime on spec work), and we'll obviously keep you up-to-date on progress.  Some of the changes here (e.g. event IDs) are quite major and we definitely want to implement them before speccing them, so we're just going to have to keep going as fast as we can. Needless to say we want to cut an r0 of the S2S API alongside the others asap and declare Matrix out of beta (at least at the spec level :)
<p>In terms of visualising progress on this spec mission it's interesting to look at the rate at which we've been closing PRs: this graph shows the total number of PRs which are in state ‘open' or ‘closed' on any given day:</p>
<p><a href="/blog/wp-content/uploads/2018/09/Screen-Shot-2018-09-03-at-00.56.38.png"><img class="aligncenter size-large wp-image-3526" src="/blog/wp-content/uploads/2018/09/Screen-Shot-2018-09-03-at-00.56.38-1024x722.png" alt="" width="1024" height="722" /></a></p>
<p>...which clearly shows the original sprint to get the r0 of the CS API out the door at the end 2015, and then a more leisurely pace until the beginning of July 2018 since which the pace has picked up massively.  Other ways of looking at include the number of open issues...</p>
<p><a href="/blog/wp-content/uploads/2018/09/image-1.png"><img class="aligncenter size-large wp-image-3527" src="/blog/wp-content/uploads/2018/09/image-1-1024x691.png" alt="" width="1024" height="691" /></a>
...or indeed the number of commits per week…</p>
<p><a href="/blog/wp-content/uploads/2018/09/Screen-Shot-2018-09-03-at-01.02.27.png"><img class="aligncenter wp-image-3528" src="/blog/wp-content/uploads/2018/09/Screen-Shot-2018-09-03-at-01.02.27-1024x195.png" alt="" width="710" height="135" /></a>
...or the overall Github Project activity for August.  (It's impressive to see Zil0 sneaking in there on second place on the commit count, thanks to all his GSoC work documenting E2E encryption in the spec as part of implementing it in matrix-python-sdk!)</p>
<p><a href="/blog/wp-content/uploads/2018/09/Screen-Shot-2018-09-03-at-01.03.57.png"><img class="aligncenter wp-image-3529" src="/blog/wp-content/uploads/2018/09/Screen-Shot-2018-09-03-at-01.03.57-1024x925.png" alt="" width="744" height="672" /></a>
Anyway, enough numerology.  It's worth noting that all of the dev for r0 has generally followed the proposed <a href="/blog/2018/06/20/towards-open-governance-for-matrix-org/">Open Governance Model for Matrix</a>, with the core spec team made up of both historical core team folk (erik, richvdh, dave &amp; matthew), new core team folk (uhoreg &amp; travis) and community folk (kitsune, anoa &amp; mujx) working together to review and approve the changes - and we've been doing MSCs (albeit with an accelerated pace) for anything which we feel requires input from the wider community.  Once the Server/Server r0 release is out the door we'll be finalising the open governance model and switching to a slightly more measured (but productive!) model of spec development as outlined there.</p>
<p>Meanwhile, Matrix 1.0 gets ever closer.  With (almost) all this spec mission done, our plan is to focus more on improving the reference implementations - particularly performance in Synapse, 
UX in matrix-{'{'}react,ios,android{'}'}-sdk as used by Riot (especially for E2E encryption), and then declare a 1.0 and get back to implementing new features (particularly Editable Messages and Reactions) at last.</p>
<p>We'd like to thank everyone for your patience whilst we've been playing catch up on the spec, and hope you agree it's been worth the effort :)</p>
<p>Matthew &amp; the core spec team.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2018&#x2F;07&#x2F;19&#x2F;synapse-0-33-0-is-here&#x2F;" title="Synapse 0.33.0 is here!!">Synapse 0.33.0 is here!!</a></h2>
                <span>
                    19.07.2018 00:00
                    —
                    <a href="/category/tech">
                        Tech
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hi all,</p>
<p>We've just released <a href="https://github.com/matrix-org/synapse/releases/tag/v0.33.0">Synapse 0.33.0</a>!  This is a <strong>major performance upgrade</strong> which speeds up /sync (i.e. receiving messages) by a factor of almost 2x!  This has already made a massive difference to the CPU usage and snappiness of the matrix.org homeserver since we rolled it out a few days ago - you can see the drop in sync worker CPU just before midday on July 17th; previously we were regularly hitting the CPU ceiling (at which point everything grinds to a halt) - now we're back down hovering between 40% and 60% CPU (at the current load).  This is actually fixing a bug which crept in around Synapse 0.31, so please upgrade - especially if Synapse has been feeling slower than usual recently, and especially if you are still on Synapse 0.31.</p>
<p><a href="/blog/wp-content/uploads/2018/07/Screen-Shot-2018-07-19-at-13.00.01-1.png"><img class="aligncenter wp-image-3406" src="/blog/wp-content/uploads/2018/07/Screen-Shot-2018-07-19-at-13.00.01-1-1024x639.png" alt="" width="813" height="507" /></a></p>
<p>Meanwhile we have a <strong>lot</strong> of new stuff coming on the horizon - a whole new algorithm for state resolution (watch this space for details); incremental state resolution (at last!) to massively speed up state resolution and mitigate extremities build up (and speed up the synapse master process, which is now the bottleneck again on the matrix.org homeserver); better admin tools for managing resource usage, and all the Python3 porting work (with associated speedups and RAM &amp; GC improvements).  Fun times ahead!</p>
<p>The full changelog follows below; as always you can grab Synapse from <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>.   Thanks for flying Matrix!</p>
<h3 id="synapse-0-33-0-2018-07-19">Synapse 0.33.0 (2018-07-19)</h3>
<h4 id="bugfixes">Bugfixes</h4>
<ul>
 	<li>Disable a noisy warning about logcontexts. (<a href="https://github.com/matrix-org/synapse/issues/3561">#3561</a>)</li>
</ul>
<h3 id="synapse-0-33-0rc1-2018-07-18">Synapse 0.33.0rc1 (2018-07-18)</h3>
<h4 id="features">Features</h4>
<ul>
 	<li>Enforce the specified API for report_event. (<a href="https://github.com/matrix-org/synapse/issues/3316">#3316</a>)</li>
 	<li>Include CPU time from database threads in request/block metrics. (<a href="https://github.com/matrix-org/synapse/issues/3496">#3496</a>, <a href="https://github.com/matrix-org/synapse/issues/3501">#3501</a>)</li>
 	<li>Add CPU metrics for _fetch_event_list. (<a href="https://github.com/matrix-org/synapse/issues/3497">#3497</a>)</li>
 	<li>Optimisation to make handling incoming federation requests more efficient. (<a href="https://github.com/matrix-org/synapse/issues/3541">#3541</a>)</li>
</ul>
<h4 id="bugfixes-1">Bugfixes</h4>
<ul>
 	<li>Fix a significant performance regression in /sync. (<a href="https://github.com/matrix-org/synapse/issues/3505">#3505</a>, <a href="https://github.com/matrix-org/synapse/issues/3521">#3521</a>, <a href="https://github.com/matrix-org/synapse/issues/3530">#3530</a>, <a href="https://github.com/matrix-org/synapse/issues/3544">#3544</a>)</li>
 	<li>Use more portable syntax in our use of the attrs package, widening the supported versions. (<a href="https://github.com/matrix-org/synapse/issues/3498">#3498</a>)</li>
 	<li>Fix queued federation requests being processed in the wrong order. (<a href="https://github.com/matrix-org/synapse/issues/3533">#3533</a>)</li>
 	<li>Ensure that erasure requests are correctly honoured for publicly accessible rooms when accessed over federation. (<a href="https://github.com/matrix-org/synapse/issues/3546">#3546</a>)</li>
</ul>
<h4 id="misc">Misc</h4>
<ul>
 	<li>Refactoring to improve testability. (<a href="https://github.com/matrix-org/synapse/issues/3351">#3351</a>, <a href="https://github.com/matrix-org/synapse/issues/3499">#3499</a>)</li>
 	<li>Use <code>isort</code> to sort imports. (<a href="https://github.com/matrix-org/synapse/issues/3463">#3463</a>, <a href="https://github.com/matrix-org/synapse/issues/3464">#3464</a>, <a href="https://github.com/matrix-org/synapse/issues/3540">#3540</a>)</li>
 	<li>Use parse and asserts from http.servlet. (<a href="https://github.com/matrix-org/synapse/issues/3534">#3534</a>, <a href="https://github.com/matrix-org/synapse/issues/3535">#3535</a>).</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2018&#x2F;07&#x2F;13&#x2F;this-week-in-matrix-2018-07-13&#x2F;" title="This Week in Matrix 2018-07-13">This Week in Matrix 2018-07-13</a></h2>
                <span>
                    13.07.2018 00:00
                    —
                    <a href="/category/this-week-in-matrix">
                        This Week in Matrix
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Welcome to TWIM for Friday the 13th! Nothing too scary, but lots of client updates and news.</p>
<h2 id="quaternion">Quaternion</h2>
<p><a href="https://matrix.to/#/@kitsune:matrix.org">kitsune</a>:</p>
<blockquote>
<p><a href="https://github.com/QMatrixClient/Quaternion">Quaternion</a> has gained a new <code>/html</code> command that allows one to send raw HTML. Note that an actually displayed HTML subset entirely depends on the receiving client; no HTML validation or sanitation is done; a plaintext version is automatically created by stripping all the HTML tags.</p>
</blockquote>
<h2 id="neo">neo</h2>
<p><a href="https://matrix.to/#/@f0x:lain.haus">f0x</a> is working on <a href="https://github.com/f0x52/neo">Neo</a> again:</p>
<blockquote>
<p>added emotes, working localecho and <code>/rainbow</code></p>
</blockquote>
<p><font color="#ff5500">r</font><font color="#ffaa00">a</font><font color="#ffff00">i</font><font color="#aaff00">n</font><font color="#55ff00">b</font><font color="#00ff00">o</font><font color="#00ff55">w</font><font color="#00ffaa">s</font><font color="#00ffff"> </font><font color="#00aaff">:</font><font color="#0055ff">D</font></p>
<h2 id="matrix-logger">matrix-logger</h2>
<p>A useful tool from <a href="https://matrix.to/#/@CromFr:matrix.org">CromFr</a> for anyone who wants to archive logs of rooms.</p>
<blockquote>
<p>I wrote a small matrix &quot;client&quot; for logging messages in joined rooms, and store them in a format very similar to Weechat logs.
<a href="https://gitlab.com/CromFr/matrix-logger/tree/master">Source code (Rust)</a> <a href="https://gitlab.com/CromFr/matrix-logger/tags">Binary release (x86_64 windows &amp; linux)</a>
Please open issues if encounter any bug or need specific features.\nAlso I'm new to rust, so any review / advices would be appreciated :)</p>
</blockquote>
<h2 id="matrique-client-progress">Matrique client progress</h2>
<p><a href="http://matrix.to/#/@bhat:encom.eu.org">Black Hat</a> has been working on <a href="https://gitlab.com/b0/matrique-go">Matrique</a>, and it's looking really good! Screenshot below.</p>
<blockquote>
<p>Matrique now has support for sending/receiving messages (plaintext, markdown, HTML, rainbow), emotes and notices. It also supports receiving images, videos, files and states. I am still working on file receiving functions.</p>
</blockquote>
<p><a href="/blog/wp-content/uploads/2018/07/matrique-client.png"><img class="alignnone size-full wp-image-3397" src="/blog/wp-content/uploads/2018/07/matrique-client.png" alt="" width="960" height="674" /></a></p>
<p>I love that all clients include rainbow messages.</p>
<h2 id="fluffychat-for-ubuntu-touch">fluffychat for Ubuntu Touch</h2>
<p>New to me, <a href="https://github.com/ChristianPauly/fluffychat">fluffychat</a> is a &quot;Simple Matrix Messenger for <a href="https://ubports.com">Ubuntu Touch</a>&quot;. The design philosophy for this app is focused on simplicity, and the hope is for it to complement <a href="https://github.com/uMatriks/uMatriks">uMatriks</a>, another Ubuntu Touch client.</p>
<blockquote>
<p>Why are you not just contributing to uMatriks?
uMatriks is great and it's superb, that someone has created a Matrix Client for Ubuntu Touch. But sometimes you have a so detailed vision of a user interface, which you want to implement, that you can not just contribute to an existing project. However, I would like to work with the uMatriks developers together. We could use the same push gateway for example.</p>
</blockquote>
<p><a href="/blog/wp-content/uploads/2018/07/fluffychat-client.png"><img class="alignnone size-large wp-image-3395" src="/blog/wp-content/uploads/2018/07/fluffychat-client-576x1024.png" alt="" width="576" height="1024" /></a></p>
<h2 id="riot-web">Riot/Web</h2>
<ul>
 	<li>Welcomed Bruno onto the Riot/Web team! (and said farewell to Luke)</li>
 	<li>Lots of bug blitzing</li>
 	<li>Riot 0.16 due next week, with Jitsi-everywhere (at last) and Slate for composer.</li>
 	<li>We now have an end-to-end test harness (via puppeteer!) at last - being applied at first to fix onboarding bugs.</li>
 	<li>Lazy loading members in progress</li>
</ul>
<h2 id="riot-mobile">Riot/Mobile</h2>
<ul>
 	<li>Major perf work ongoing</li>
 	<li>Decoupling members from state…</li>
 	<li>…and then lazyloading members.</li>
</ul>
<h2 id="synapse-0-32-2-available">Synapse 0.32.2 available</h2>
<p><a href="https://github.com/matrix-org/synapse/releases/tag/v0.32.2">v0.32.2</a> is now available, which includes the <code>m.room.server_acl</code> security feature discussed in a <a href="/blog/2018/07/06/security-update-synapse-0-32-0/">previous blog post</a>.</p>
<ul>
 	<li>If you're not running 0.32, please upgrade!!</li>
 	<li>Python 3 progresses!</li>
 	<li>Quite a lot of ops work to keep matrix.org alive. Status page coming soon! (We promise!!)</li>
 	<li>Looking at metrics and quotas for better experiences on limited-resource homeservers.</li>
</ul>
<h2 id="spec">Spec</h2>
<ul>
 	<li>State res fix</li>
 	<li>Version bump</li>
 	<li>Lots of omission PRs landing</li>
 	<li><a href="https://github.com/turt2live">TravisR</a> S2S work</li>
 	<li>Work on both IS & AS API too</li>
 	<li><a href="https://matrix.to/#/@uhoreg:matrix.org">Uhoreg</a> work - .well-known, and 3pid logins</li>
 	<li>Some internal discussions about improving the proposal process; particularly having a 5 day 'final comment period' similar to Rust's. Once we've got alignment within the core spec team we'll MSC it.</li>
</ul>
<h2 id="dendrite">Dendrite</h2>
<ul>
 	<li><a href="https://matrix.to/#/@andrewm:amorgan.xyz">Anoa</a> & <a href="@apwhitehat:matrix.org">APwhitehat</a> continue to blitz onwards on AS and federation</li>
 	<li>thirdparty protocol support for application services in the works.</li>
 	<li>continued progress on getting the AS query APIs supported. PR for /alias still being reviewed, PR for /users happened this week and now being reviewed</li>
 	<li>Timestamp massaging for application services ready and in review</li>
 	<li>APWhiteHat did a good chunk on federation, now migrating to supporting the various EDUs, starting with m.typing events.</li>
 	<li>…running out of low hanging fruit…</li>
</ul>
<h2 id="as">AS</h2>
<ul>
 	<li><a href="https://github.com/matrix-org/matrix-appservice-irc">matrix-appservice-irc</a> 0.9.1 is here with perf improvements!</li>
 	<li>Lots of work on trying to make it start up sooner</li>
</ul>
<h2 id="e2e">E2E</h2>
<ul>
 	<li>UISI stats</li>
 	<li>Device list syncing</li>
 	<li>Encrypted backup</li>
</ul>
<h2 id="debian-packages">Debian Packages</h2>
<p><a href="https://matrix.to/#/@andrew:shadura.me">andrewsh</a> has packaged <a href="https://packages.debian.org/search?keywords=matrix-synapse">synapse 0.32.2 for Debian</a></p>
<p><a href="https://matrix.to/#/@uhoreg:matrix.org">uhoreg</a> has packaged <a href="https://packages.debian.org/search?keywords=quaternion">quaternion 0.0.9.2 for Debian</a></p>
<h2 id="that-s-all-folks">That's all folks</h2>
<p>Watch Matrix Live below, and see you next week!</p>
<iframe src="https://www.youtube.com/embed/X1aGj3DFuWI" frameBorder="0" allowFullScreen="allowfullscreen"></iframe>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2018&#x2F;06&#x2F;22&#x2F;this-week-in-matrix-2018-06-22&#x2F;" title="This Week In Matrix 2018-06-22">This Week In Matrix 2018-06-22</a></h2>
                <span>
                    22.06.2018 00:00
                    —
                    <a href="/category/this-week-in-matrix">
                        This Week in Matrix
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p><em>[Ben is away today, so this week's edition is compiled again by Matthew]</em></p>
<h3 id="libqmatrixclient-0-3-0-2-and-quaternion-0-0-9-2">libQMatrixClient 0.3.0.2 and Quaternion 0.0.9.2</h3>
<p>kitsune writes:</p>
<blockquote>
<p><a href="https://github.com/QMatrixClient/libqmatrixclient">libQMatrixClient</a> 0.3.0.2 has been released - no new features, just small fixes including one for an unlucky typo preventing 0.3.0.1 from generating .cpp files with GTAD.</p>
<p><a href="https://github.com/QMatrixClient/Quaternion">Quaternion</a> 0.0.9.2 is out, another step towards 0.1. Aside from bugfixes and using the latest libQMatrixClient, it features an entirely new timeline layout similar to that of Riot (the old one is still around too). Also, you can now change some settings through the menu rather than by editing a configuration file or registry - including switching timeline layouts on the fly!</p>
</blockquote>
<p><a href="/blog/wp-content/uploads/2018/06/Screen-Shot-2018-06-22-at-23.18.28.png"><img class="aligncenter size-large wp-image-3348" src="/blog/wp-content/uploads/2018/06/Screen-Shot-2018-06-22-at-23.18.28-1024x563.png" alt="" width="1024" height="563" /></a></p>
<h3 id="loading-artist-sticker-packs">Loading Artist sticker packs!</h3>
<p>TravisR says:</p>
<blockquote>
<p>The Official Loading Artist sticker pack got added to <a href="http://dimension.t2bot.io/">Dimension</a> ?</p>
</blockquote>
<p><a href="/blog/wp-content/uploads/2018/06/Screen-Shot-2018-06-22-at-22.34.43.png"><img class="aligncenter wp-image-3347 size-medium" src="/blog/wp-content/uploads/2018/06/Screen-Shot-2018-06-22-at-22.34.43-275x300.png" alt="" width="275" height="300" /></a></p>
<p>It also got added to Modular (aka Scalar), the default integration manager for Riot :)</p>
<h3 id="releasetracker">releasetracker</h3>
<p>Ananace writes:</p>
<blockquote>
<p>Decided to actually start pushing code I've been slowly prodding at for the last while, ever since starting the Ruby Matrix SDK in fact. Working on a Sibbell like system that tracks new releases on GitHub projects, posting them into a specified Matrix room.</p>
<p>The <a href="https://github.com/ananace/matrix-releasetracker">release tracker</a> now tracks both full releases and just regular tags, though only one or the other at the moment.</p>
<p>Spun up a proper room for the release tracker, in case people want to help development / feel like using hosted alpha-level software more than running it themselves. <a class="" title="#releasetracker:kittenface.studio" href="https://riot.im/develop/#/room/#releasetracker:kittenface.studio" data-reactroot="">#releasetracker:kittenface.studio</a></p>
</blockquote>
<p><a href="/blog/wp-content/uploads/2018/06/releasetracker.png"><img class="aligncenter size-large wp-image-3346" src="/blog/wp-content/uploads/2018/06/releasetracker-779x1024.png" alt="" width="779" height="1024" /></a></p>
<h3 id="jeon-and-jmsdk-updates">jeon and jmsdk updates</h3>
<p>ma1uta writes about his <a href="https://github.com/ma1uta/jeon">jeon</a> Java HS, <a href="https://github.com/ma1uta/jmsdk">jmsdk</a> and Matrix <a href="https://ma1uta.github.io/matrix-api.html">spec work</a>:</p>
<blockquote>
<p>I reorganized my projects and extracted the sdk from the api. So, today I have one project for the api (<a class="linkified" href="https://github.com/ma1uta/jeon" target="_blank" rel="noopener">https://github.com/ma1uta/jeon</a>), another for the sdk (<a class="linkified" href="https://github.com/ma1uta/jmsdk" target="_blank" rel="noopener">https://github.com/ma1uta/jmsdk</a>) but last is very early and non-usable.<br />Also I covered the code with the swagger-annotation and now I can generate the swagger schema from the code. There is an example: <a class="linkified" href="https://github.com/ma1uta/jeon/blob/master/client-api/generated/swagger-ui/swagger.json" target="_blank" rel="noopener">https://github.com/ma1uta/jeon/blob/master/client-api/generated/swagger-ui/swagger.json</a><br />And there is an example of the spec was generated from swagger: <a class="linkified" href="https://ma1uta.github.io/matrix-api.html" target="_blank" rel="noopener">https://ma1uta.github.io/matrix-api.html</a> (plain and without sorting or grouping, I'll maybe fix it).<br />Everyone can ask me in the <a class="" title="#jeon:matrix.org" href="https://riot.im/develop/#/room/#jeon:matrix.org" data-reactroot="">#jeon:matrix.org</a> (matrix api) or <a class="" title="#mxtoot:matrix.org" href="https://riot.im/develop/#/room/#mxtoot:matrix.org" data-reactroot="">#mxtoot:matrix.org</a> (matrix-mastodon bridge).<br />Then I want to cover the remaining api (appservice, push, identity but not federation because it isn't completed yet), write sdk (client, bot). And publish api and sdk on the maven central repository.</p>
</blockquote>
<h3 id="ci-cd-for-plasma">CI/CD for Plasma!</h3>
<p>Nico gives updates on <a href="https://gitlab.com/beerfactory.org/plasma/">Plasma</a>, the new Scala/Akka homeserver:</p>
<blockquote>
<p>I've setup <a href="https://gitlab.com/beerfactory.org/plasma/pipelines" target="_blank" rel="noopener">CI/CD</a> for plasma HS. Now every time a push occur on the repo, the pipeline builds and deploys a plasma HS instance on a test server.<br />This test instance is reachable at <a class="linkified" href="http://matrix.beerfactory.org:9000/" target="_blank" rel="noopener">http://matrix.beerfactory.org:9000</a>. For now it is very modest and can only reply to a few C2S endpoints like <a href="http://matrix.beerfactory.org:9000/_matrix/client/versions" target="_blank" rel="noopener"><code>GET /_matrix/client/versions</code></a>. <code>POST /_matrix/client/r0/login</code> and <code>POST /_matrix/client/r0/register</code> are also available for testing registration and login flow. <code>POST /_matrix/client/r0/createRoom</code> is also available with the <code>TEST_TOKEN</code> auth token value, but it's only a mock.<br />I'm now working on implementing the concept of room servers: each room will be managed by a dedicated room server (an <a href="https://doc.akka.io/docs/akka/current/actors.html" target="_blank" rel="noopener">actor</a>), so they get fault tolerance and scalability by default (through <a href="https://doc.akka.io/docs/akka/current/common/cluster.html" target="_blank" rel="noopener">akka clustering</a>).<br />There's also a dedicated room for this project : <a class="" title="#plasma:beerfactory.org" href="https://riot.im/develop/#/room/#plasma:beerfactory.org" data-reactroot="">#plasma:beerfactory.org</a></p>
</blockquote>
<h3 id="matrix-python-sdk-0-3-2">matrix-python-sdk 0.3.2</h3>
<p>&amp;Adam says:</p>
<blockquote>
<p>v0.3.2 of matrix-python-sdk released. See <a href="https://github.com/matrix-org/matrix-python-sdk/releases/tag/v0.3.2" target="_blank" rel="noopener">the github release</a> for list of changes. (v0.3.0 and v0.3.1 are substantially the same with small formatting errors). There are a lot of hugely annoying bugs fixed in this one, so upgrading soon is recommended.</p>
</blockquote>
<p>There's also been a lot of work on adding E2E to the python-sdk from Zil0 and his GSoC project!</p>
<h3 id="gomatrixclient">gomatrixclient</h3>
<p>Black Hat writes:</p>
<blockquote>
<p>I am currently writing a high-level API on top of gomatrix. As gomatrix is suitable for bots but not for clients, I decided to write a layer above it.
(The motivation is to provide a backend for Matrique)
It will have similar API as libqmatrixclient, but in Golang.
It is currently under heavy development, and API breaking changes are frequent.
Sources are available in Gitlab: <a href="https://gitlab.com/b0/gomatrixclient">https://gitlab.com/b0/gomatrixclient</a>P.s. It is a library for writing clients in Golang. But it also provides useful APIs for basic functions, e.g. getting avatars.</p>
</blockquote>
<h3 id="fractal-3-29-1">Fractal 3.29.1</h3>
<p>Tobias says: New <a href="https://gitlab.gnome.org/World/fractal">Fractal release</a> 3.29.1, which includes a Eisha's new image viewer [implemented as part of GSoC]!</p>
<p>It looks like this (screenshot being a screenshot of, uh, last week's screenshot, for maximum fractalception...)</p>
<p><a href="/blog/wp-content/uploads/2018/06/fractal-screenie.png"><img class="aligncenter size-large wp-image-3345" src="/blog/wp-content/uploads/2018/06/fractal-screenie-1024x721.png" alt="" width="1024" height="721" /></a></p>
<h3 id="terraform-provider">Terraform Provider</h3>
<p>TravisR writes:</p>
<blockquote>
<p>I've been working on a Terraform provider for matrix. It is still a work in progress, however I plan to have the basics completed in the coming days. The provider gives you the opportunity to create users, rooms, and other objects on your homeserver, making your homeserver part of your infrastructure. This could be useful for people who want to set up a monitoring room, or for setting up default rooms on a homeserver instance. In particular, this provider will be used by the monitor bot (see last week's post) to set up the test homeservers for seeing how the bot scales with increased server counts. Source and information available on Github: <a class="linkified" href="https://github.com/turt2live/terraform-provider-matrix" target="_blank" rel="noopener">https://github.com/turt2live/terraform-provider-matrix</a></p>
</blockquote>
<h3 id="mxtoot-0-4-3">mxtoot 0.4.3</h3>
<blockquote>
<p>ma1uta says:</p>
<p>I've fixed a few bugs and added some new commands (show status by id and show n-last statuses), and now
<a href="https://gitlab.com/ma1uta/mxtoot">mxtoot 0.4.3</a> (Matrix-Mastodon bridge) can send public, private, unlisted and direct messages.
There are 4 features left to go:</p>
<ul>
 	<li>show, add and remove follows;</li>
 	<li>show threads;</li>
 	<li>show notification, public and federated lines (and optionally merge them with the home timeline);</li>
 	<li>show account info by id.</li>
</ul>
Also I think to implement a bridge Matrix-ActivityPub as S2S. For example, a room - is a ActivityPub's actor. Room participants is a bot corresponds to actors you follow to. Room timeline is a Inbox+Outbox. Reactions is a likes/favorites. Pinning message is a boost. Replies will be very useful.
</blockquote>
<h3 id="mautrix-telegram-now-puppets-via-user-specific-relay-bots">mautrix-telegram now puppets via user-specific relay bots!</h3>
<p>tulir sneaks in at the last minute with:</p>
<blockquote>
<p><a href="https://github.com/tulir/mautrix-telegram">mautrix-telegram</a> now supports logging in with your own bot. It means that you can look almost like a real user and even use direct messages without logging in with your real Telegram account!</p>
</blockquote>
<h3 id="and-finally">And finally...</h3>
<p>On the core team it's been an irregular week; as mentioned in last TWIM we spent most of it in workshops working through spec issues as part of the mission to finally get to an 'r0' stable release of the spec across all APIs - not just the Client/Server API.  The majority of this was spent making up for lost time on the S2S API, analysing its various holes and designing solutions to them.  Things are looking promising - we're keeping the work under wraps though given the potential for abuse, although we should see more gaps being fixed in the coming days.  Meanwhile we're aiming to get the r0 stable release out by the end of August.  We also unblocked a few longstanding MSCs (<a href="https://github.com/matrix-org/matrix-doc/issues/433">.well-known</a> URIs and <a href="https://github.com/matrix-org/matrix-doc/issues/1232">media limits</a>), although in the end the S2S stuff took priority.  On the client side we did a lot of design sessions on Riot/Mobile (working out how the new app design should work on Mobile - watch this space for details!) and also how to speed up app launch (the concept of Hybrid Sync; somewhere between an initial sync and an incremental sync - basically an initial sync which can be interrupted in order to let the user use the app whilst the initial sync is still ongoing) - we'll write up the notes and publish these asap.</p>
<p>We also announced the <a href="/blog/2018/06/20/towards-open-governance-for-matrix-org/">Open Governance</a> work which we've been doing in order to extend control of the Matrix spec to properly include the wider Matrix community - the plan is to get the Matrix.org Foundation legal entity set up roughly around the same time as the r0 release of the spec in August, and formally decouple control of the Matrix spec from New Vector (the company we set up last year to hire the core team).</p>
<p>We'd also like to welcome mujx (developer of nheko) and kitsune (developer of Quaternion and libQMatrixClient) to the new core team as we start trialling the new governance structure (which mainly amounts at this point to getting review approvals on spec proposals and changes from the relevant domain experts on the new team).  This brings us to a full complement for the team: Erik (servers), richvdh (servers, crypto &amp; clients), Dave (clients &amp; push/identity) and uhoreg (crypto, general) from the current core team; and Anoa (servers, AS API), TravisR (integrations, AS API; acting with Dimension hat on), mujx &amp; kitsune from the community.</p>
<p>Otherwise, spec work has taken priority over writing software, with the exception of: APwhitehat doing as much federation work in Dendrite as part of GSoC as the current unstable state of the API allows; Michael (t3chguy) has been blitzing through P1 Riot/Web issues.  Next week should be back on the normal (if not better!) trajectory however.  No Matrix Live this week however, as we're all exhausted.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2018&#x2F;06&#x2F;20&#x2F;towards-open-governance-for-matrix-org&#x2F;" title="Towards open governance for Matrix.org">Towards open governance for Matrix.org</a></h2>
                <span>
                    20.06.2018 00:00
                    —
                    <a href="/category/general">
                        General
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hi all,</p>
<p>Since we created Matrix.org back in 2014, the majority of the Matrix core team has worked for the same company - originally subsidiaries of Amdocs, and then since August 2017 for New Vector; the startup we incorporated to rehire the core team and support Matrix after we parted ways from Amdocs.</p>
<p>Despite working for a for-profit company, our prime directive has <b>always</b> been the long term mission to successfully run Matrix as a non-profit initiative for the benefit of the whole internet: to create a ubiquitous secure open network which gives users control back over their communication and avoids them ever being locked into silos again.  And even though Matrix.org hasn't been a formal non-profit foundation, we've treated it as such in all respects (e.g. gathering donations to support development on Matrix)</p>
<p>Running Matrix.org as a non-profit means prioritising to neutrally support all players in the whole ecosystem without ever giving unfair advantage to any individual participant (particularly New Vector) - where that ecosystem includes end-users, client devs, testers, spec devs, server admins, companies building products on Matrix, bridge devs, bot devs, widget devs, server devs, distro maintainers, moderators, even end-users who are using Matrix indirectly via bridges.</p>
<p>That being said, having the core team work for the same startup is still a somewhat unorthodox model for an open source project building an open standard, so we'd like to explain the main reasons for doing it up to this point:</p>
<ul>
 	<li style="font-weight: 400;">To ensure that Matrix is fit for real-world usage and to force us to dogfood it. To ensure that it is a protocol that works well enough that you can build a commercial startup around it if you so wanted, and to motivate us to build Matrix as something more than an academic or nerdy exercise in protocol design - rather one which can be commercially viable.</li>
 	<li style="font-weight: 400;">To help ensure the core team is aligned and pulling towards the same goal, especially during the process of actually designing and “giving birth” to the initial protocol and getting it to an ‘r0' release across all APIs.  We strongly believe that when a project is in the design phase you get faster and better design from a bunch of people who are collaborating together towards the same goal, rather than independent factions who might pursue their own agendas at the expense of the overall project.</li>
 	<li style="font-weight: 400;">Because we believe the value of Matrix lies in the size of the ecosystem, and if Matrix realises its full potential (i.e. it grows as big as the web), it only makes it more useful and valuable for *everyone*. We realise that it might be a leap of faith to believe that we don't have any incentive to sabotage Matrix by privileging specific players (after all, there are so many companies out there in it just for the cash), but the fact is that this is where we stand, and we're doing our best to prove it. To spell it out: it is in New Vector's interest (and also in the interests of other Matrix-focused companies) to grow Matrix to be as big, open, unfragmented and as neutral as possible.  Matrix should be big enough for a multitude of wildly successful companies and projects to benefit from it, and everyone wins - just like the web.</li>
</ul>
<b>However</b>, this approach is not perfect and comes with some major problems:
<ul>
 	<li style="font-weight: 400;">Without clear separation of responsibilities and incentives, we have to ask the community to take it on faith that our efforts are never intended to privilege New Vector ahead of the wider ecosystem. This leaves room for doubt, especially when our reasoning is unclear or our conclusions controversial.<br />A good example of a controversial decision is the lack of investment by the core team in the Server-Server API.  For the last ~2 years (since Mar 2016) we made the judgement call to prioritise user-facing features and experience.  The rationale was that to grow Matrix we need to provide a viable alternative to Slack/Discord/WhatsApp etc, and doing that means providing a Client-Server API which lets clients do just that, and server implementations capable of running at scale. This is why the CS API has had a stable release since Dec 2015 (currently at r0.3.0) and why we've put so much effort into server scaling/perf... but the SS API itself still has bugs and has still not yet made it to a stable release.<br />This is obviously incredibly frustrating to server devs who tried to implement the SS API despite it being unstable and unreleased. In retrospect it might have been a mistake and we could probably have turned off signup on matrix.org and diverted the resources to the SS API work instead.  However, this is a case of making the judgement call to prioritising the overall ecosystem over one class of stakeholders (server devs) by focusing on providing users usable and featureful decentralised communication apps. Indeed we strongly believe that users are the main means to grow the ecosystem (others have failed without them): no one joins a network with no friends, however popular it is among devs.  Nonetheless, we are finally in a position to <a href="/blog/2018/06/15/this-week-in-matrix-2018-06-15/">hire spec maintainers and get to a stable S2S</a> as fast as we possibly can, and frankly feel relieved to be able to unblock this situation.<br />Another good example is the recent <a href="/blog/2018/06/14/security-update-synapse-0-31-2/">0.31.2 security update</a><span style="font-weight: 400;"> of Synapse: this was a defensive patch to the protocol that we added to ensure that even if bugs occur when authing events over federation, it should be impossible for a random user to ever hijack a room again.  We specced this out as a formal proposal and are gathering feedback, but expedited implementation in Synapse to protect the overall ecosystem. However, it turns out that the change breaks a small number of highly custom rooms, and so we find ourselves accused of privileging NV.  The reality is that we made a judgement call to protect the vast majority of today's ecosystem (and hope to provide a longer-term fix in the relatively near future which /will/ be compatible with more custom room use cases).
</span>
</li>
 	<li style="font-weight: 400;"><span style="font-weight: 400;">Another problem is some companies find it a turn-off to participate in Matrix unless they have a well-defined process for influencing the direction of the protocol.  Now, sometimes this could be seen as a feature rather than a bug; the last thing the ecosystem needs is a greedy corp trying to subvert the protocol to its own competitive advantage, and we don't want to be locked in that kind of battle either.  However, there are also lots of well-meaning and constructive companies who want to participate too, and there's an argument that they want a well-defined process for doing so.
</span>
</li>
 	<li style="font-weight: 400;">The other main problem is simply one of checks & balances.  Even though NV may be a good guardian today, what if something changed in future? e.g. if NV got bought by Microsoft, or if someone on the team had some crisis and changed priorities?  Whilst one could always fork, such things are incredibly disruptive and fragmenting and it'd be good to engineer Matrix.org's governance to be resilient to such eventualities as much as is possible.
</li>
</ul>
To address these problems, in March of this year we started work on a long term proposal to establish an open governance model for Matrix which ensures the neutrality of the protocol, lets the community contribute as widely as possible, and incorporates a dedicated neutral non-profit Matrix.org Foundation separate to New Vector.
<p>As work progressed on the proposal, it became clear that actually transitioning to a new governance model would seriously slow down the sprint towards a stable r0 release. We therefore decided to put completing the governance model on hold until after the r0 release (scheduled for the end of August).</p>
<p>With the end of r0 now in sight, completing work on the governance model is back on the agenda. We obviously want to ensure that the proposed governance model is going to work for everyone, so we'd like to introduce the first draft of <a href="https://docs.google.com/document/d/1vASIt2v0UwKnUKHNEjA_P3SFCM0kcIUl1LQyM--ax04/edit#">Matrix Spec Change 1318: a proposal for open governance of the Matrix.org Spec</a>. This is quite an early draft; the idea is to gather feedback over the next few months and we'll then incorporate the Foundation and deploy the new governance model to coincide with the long-awaited stable release of all APIs of the Matrix Spec (assuming the release doesn't slip).</p>
<p>The main points in the proposal are:</p>
<ul>
 	<li style="font-weight: 400;">To adopt the new governance model once all APIs have had a stable r0 release.  For S2S API, this means fixing the remaining flaws in the federation protocol and closing the spec omissions such that compliant independent implementations can be written purely based on the spec.  For the AS and IS and Push API it means just closing spec omissions (if any) and doing a final review.
</li>
 	<li style="font-weight: 400;">To define the mission of Matrix: to return control of communication to users by building a standards-based open secure decentralised communication network.
</li>
 	<li style="font-weight: 400;">To define the mandate of the core team to act as a neutral custodian of the Matrix Spec, prioritising the long-term success and growth of the overall network over individual commercial concerns.
</li>
 	<li style="font-weight: 400;">To define the guiding principles of the core team, e.g. collaboration rather than competition and contrarianism.
</li>
 	<li style="font-weight: 400;">To restructure the core team to incorporate members of the community as well as the founding core team.
</li>
 	<li style="font-weight: 400;">To propose succession logistics for the core team
</li>
 	<li style="font-weight: 400;">To propose the role and governance structure of the Matrix.org Foundation legal entity.
</li>
</ul>
Feedback would be much appreciated on the <a href="https://docs.google.com/document/d/1vASIt2v0UwKnUKHNEjA_P3SFCM0kcIUl1LQyM--ax04/edit#">MSC1318 Google Doc</a> - or come talk about it on 
<a href="https://matrix.to/#/#matrix-spec-process:matrix.org">#matrix-spec-process:matrix.org</a> (which we might as well use for governance too).
<p>It's exciting times as we finally move towards an initial stable release of Matrix across all APIs - we are firmly on the road to a 1.0, and improving our governance model is a massive part of that process.</p>
<p>thanks,</p>
<p>Matthew, Amandine &amp; the core team.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2018&#x2F;06&#x2F;14&#x2F;security-update-synapse-0-31-2&#x2F;" title="Security update: Synapse 0.31.2">Security update: Synapse 0.31.2</a></h2>
                <span>
                    14.06.2018 00:00
                    —
                    <a href="/category/tech">
                        Tech
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hi all,</p>
<p>On Monday (2018-06-11) we had an incident where #matrix:matrix.org was hijacked by a malicious user pretending to join the room immediately after its creation in 2014 and then setting an m.room.power_levels event ‘before' the correct initial power_level for the room.</p>
<p>Under normal circumstances this should be impossible because the initial m.room.power_levels for a room should be set before its m.room.join_rules event, meaning users who join the room are subject to its power levels. However, back before we'd even released Synapse, the first two rooms ever created in Matrix (#test:matrix.org and #matrix:matrix.org) were manually created and set the join_rules before the power_levels event, letting users join before the room's power_levels were defined, and so were vulnerable to this attack. We've since re-created #matrix:matrix.org - please re-/join the room if you haven't already!</p>
<p>As a defensive measure, we are releasing a security update of Synapse (0.31.2) today which changes the rules used to authenticate power_level events, such that we fail-safe rather than fail-deadly if the existing auth mechanisms fail. In practice this means changing the default power level required to set state to be 50 rather than 0 if there is no power_levels event present, thus meaning that only the room creator can set the initial power_levels event.</p>
<p>We are not aware of anyone abusing this (other than the old #matrix:matrix.org room) but we'd rather be safe than sorry, so would recommend that everyone upgrade as soon as possible.</p>
<p>This of course constitutes a change to the spec, so full technical details and ongoing discussion around the Matrix Spec Change proposal can be followed over at <a href="https://github.com/matrix-org/matrix-doc/issues/1304">MSC1304</a>.</p>
<p><strong>EDIT</strong>: if you are aware of your server participating in rooms whose first power_levels event is deliberately set by a different user to their creator, please let us know asap (and don't upgrade!)</p>
<p>This work is all part of a general push to finalise and harden and fully specify the Server-Server API as we push towards a long-awaited stable release of Matrix!</p>
<p>As always, you can get the new update from <a href="https://github.com/matrix-org/synapse/releases/tag/v0.31.2">https://github.com/matrix-org/synapse/releases/tag/v0.31.2</a> or from any of the sources mentioned at <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>.</p>
<p>thanks, and apologies for the inconvenience.</p>
<h3 id="changes-in-synapse-v0-31-2-2018-06-14">Changes in synapse v0.31.2 (2018-06-14)</h3>
<p>SECURITY UPDATE: Prevent unauthorised users from setting state events in a room when there is no <code>m.room.power_levels</code> event in force in the room. (PR <a href="https://github.com/matrix-org/synapse/pull/3397">#3397</a>)</p>
<p>Discussion around the Matrix Spec change proposal for this change can be followed at <a href="https://github.com/matrix-org/matrix-doc/issues/1304">https://github.com/matrix-org/matrix-doc/issues/1304</a>.</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2018&#x2F;05&#x2F;17&#x2F;introducing-matrix-specification-changes&#x2F;" title="Introducing Matrix Specification Changes">Introducing Matrix Specification Changes</a></h2>
                <span>
                    17.05.2018 00:00
                    —
                    <a href="/category/tech">
                        Tech
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hi all,</p>
<p>We've been able to start investing more time in advancing the Matrix Specification itself over the last month or so thanks to <a href="https://matrix.to/#/@benpa:matrix.org">Ben</a> joining the core team (and should be able to accelerate even more with <a href="https://www.uhoreg.ca/blog/20180507-1019">uhoreg joining in a few weeks</a>!)  The first step in the new wave of work has been to provide much better infrastructure for the process of actually evolving the spec - whether that's from changes proposed by the core team or the wider Matrix Community.</p>
<p>So, without further ado, we'd like to introduce <a href="/docs/spec/proposals">https://matrix.org/docs/spec/proposals</a> - a dashboard for all the spec change proposals we've accumulated so far (ignoring most of the ones which have already been merged), as well as a clearer workflow for how everyone can help improve the Matrix spec itself.  Part of this is introducing a formal numbering system - e.g. <a href="https://github.com/matrix-org/matrix-doc/issues/1228">MSC1228</a> stands for Matrix Spec Change 1228 (where 1228 is the ID of the Github issue on the <a href="http://github.com/matrix-org/matrix-doc/issues">github.com/matrix-org/matrix-doc/issues</a> repository that tracks the proposal).</p>
<p>Please note that these are <em>NOT</em> like XEPs or RFCs - i.e. optional proposals or add-ons to the protocol; instead they are literally proposals for changes to the Matrix Spec itself.  Once merged into the spec, they are only of historical interest.</p>
<p>We've also created a new room: <a href="https://matrix.to/#/#matrix-spec:matrix.org">#matrix-spec:matrix.org</a> to discuss specific spec proposal changes - please join if you want to track how proposals are evolving! (Conversation is likely to fork off into per-proposal rooms or overflow into <a href="https://matrix.to/#/#matrix-dev:matrix.org">#matrix-dev:matrix.org</a> or <a href="https://matrix.to/#/#matrix-architecture:matrix.org">#matrix-architecture:matrix.org</a> depending on traffic levels, however).</p>
<p>Feedback would be much appreciated on this - so please head over to <a href="https://matrix.to/#/#matrix-spec:matrix.org">#matrix-spec:matrix.org</a> and let us know how it feels and how it could do better.</p>
<p>This is also a major step towards properly formalising Matrix.org's governance model - hopefully the changes above are sufficient to improve the health of the evolution of the Spec as we work towards an initial stable release later this year, and then you should expect to see a spec proposal for formal governance once we've (at last!) exited beta :)</p>
<p>Huge thanks to Ben for putting this together, and thanks to everyone who's contributed so far to the spec - we're looking forward to working through the backlog of proposals and turning them all into merged spec PRs!!</p>
<p>Matthew</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2018&#x2F;05&#x2F;08&#x2F;gdpr-compliance-in-matrix&#x2F;" title="GDPR Compliance in Matrix">GDPR Compliance in Matrix</a></h2>
                <span>
                    08.05.2018 00:00
                    —
                    <a href="/category/privacy">
                        Privacy
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hi all,</p>
<p>As the May 25th deadline looms, we've had lots and lots of questions about how GDPR (the EU's new General Data Protection Regulation legislation) applies to Matrix and to folks running Matrix servers - and so we've written this blog post to try to spell out what we're doing as part of maintaining the Matrix.org server (and bridges and hosted integrations etc), in case it helps folks running their own servers.</p>
<p>The main controversial point is how to handle Article 17 of the GDPR: '<a href="https://gdpr-info.eu/art-17-gdpr/">Right to Erasure</a>' (aka Right to be Forgotten). The question is particularly interesting for Matrix, because as a relatively new protocol with somewhat distinctive semantics it's not always clear how the rules apply - and there's no case law to seek inspiration from.</p>
<p>The key question boils down to whether Matrix should be considered more like email (where people would be horrified if senders could erase their messages from your mail spool), or should it be considered more like Facebook (where people would be horrified if their posts were visible <em>anywhere</em> after they avail themselves of their right to erasure).</p>
<p>Solving this requires making a judgement call, which we've approached from two directions: firstly, considering what the spirit of the GDPR is actually trying to achieve (in terms of empowering users to control their data and have the right to be forgotten if they regret saying something in a public setting) - and secondly, considering the concrete legal obligations which exist.  </p>
<p>The conclusion we've ended up with is to (obviously) prioritise that Matrix can support all the core concrete legal obligations that GDPR imposes on it - whilst also having a detailed plan for the full 'spirit of the GDPR' where the legal obligations are ambiguous.  The idea is to get as much of the longer term plan into place as soon as possible, but ensure that the core stuff is in place for May 25th.</p>
<p>Please note that we are still talking to GDPR lawyers, and we'd also very much appreciate feedback from the wider Matrix community - i.e. this plan is very much subject to change.  We're sharing it now to ensure everyone sees where our understanding stands today.</p>
<p>The current todo list breaks down into the following categories. Most of these issues have matching github IDs, which we'll track in a progress dashboard.</p>
<h3 id="right-to-erasure">Right to Erasure</h3>
<p>We're opting to follow the email model, where the act of sending an event (i.e. message) into a room shares a copy of that message to everyone who is <em><strong>currently</strong></em> in that room.  This means that in the privacy policy (see Consent below) users will have to consent to agreeing that a copy of their messages will be transferred to whoever they are addressing.  This is also the model followed by IM systems such as WhatsApp, Twitter DMs or (<a href="https://www.theinquirer.net/inquirer/news/3029749/facebook-zuckerberg-can-delete-old-messenger-conversations-you-cant">almost</a>) Facebook Messenger.</p>
<p>This means that if a user invokes their right to erasure, we will need to ensure that their events will only ever be visible to users who already have a copy - and must <strong>never</strong> be served to new users or the general public. Meanwhile, data which is no longer accessible by any user must of course be deleted entirely.</p>
<p>In the email analogy: this is like saying that you cannot erase emails that you have sent other people; you cannot try to rewrite history as witnessed by others... but you can erase your emails from a public mail archive or search engine and stop them from being visible to anyone else. </p>
<p>It is important to note that GDPR Erasure is <em>completely separate</em> from the existing Matrix functionality of &quot;redactions&quot; which let users remove events from the room. A &quot;redaction&quot; today represents a request for the human-facing details of an event (message, join/leave, avatar change etc) to be removed.  Technically, there is no way to enforce a redaction over federation, but there is a &quot;gentlemen's agreement&quot; that this request will be honoured.</p>
<p>The alternative to the 'email-analogue' approach would have been to facilitate users' automatically applying the existing redact function to <em>all</em> of the events they have ever submitted to a public room. The problem here is that defining a 'public room' is subtle, especially to uninformed users: for instance, if a message was sent in a private room (and so didn't get erased), what happens if that room is later made public? Conversely, if right-to-erasure removed messages from <em>all</em> rooms, it will end up destroying the history integrity of 1:1 conversations, which pretty much everyone agrees is abhorrent. Hence our conclusion to protect erased users from being visible to the general public (or anyone who comes snooping around after the fact) - but preserving their history from the perspective of the people they were talking to at the time.</p>
<p>In practice, our core to-do list for Right to Erasure is:</p>
<ul>
<li>As a first cut, provide Article 17 right-to-erasure at a per-account granularity. The simplest UX for this will be an option when calling the account deactivation API to request erasure as well as deactivation. There will be a 30 day grace period, and (ideally) a 2FA confirmation (if available) to avoid the feature being abused.</li>
<li>Homeservers must delete events that nobody has access to any more (i.e. if all the users in a room have GDPR-erased themselves). If users have deactivated their accounts without GDPR-erasure, then the data will persist in case they reactivate in future.</li>
<li>Homeservers must delete media that nobody has access to any more. This is hard, as media is referenced by <code>mxc://</code> URLs which may be shared across multiple events (e.g. stickers or forwarded events, including E2E encrypted events), and moreover <code>mxc://</code> URLs aren't currently authorized.  As a first cut, we track which user uploaded the <code>mxc://</code> content, and if they erase themselves then the content will also be erased.</li>
<li>Homeservers must not serve up unredacted events over federation to users who were not in the room at the time. This poses some interesting problems in terms of the privacy implications of sharing MXIDs of erased users over federation - see &quot;GDPR erasure of MXIDs&quot; below.</li>
<li>Matrix must specify a way of informing both servers and clients (especially bots and bridges) of GDPR erasures (as distinct from redactions), so that they can apply the appropriate erasure semantics.</li>
</ul>
<h4 id="gdpr-erasure-of-matrix-ids">GDPR erasure of Matrix IDs</h4>
<p>One interesting edge case that comes out of GDPR erasure is that we need a way to stop GDPR-erased events from leaking out over federation - when in practice they are cryptographically signed into the event Directed Acyclic Graph (DAG) of a given room. Today, we can remove the message contents (and preserve the integrity of the room's DAG) via redaction - but this still leaves personally identifying information in the form of the Matrix IDs (MXIDs) of the sender of these events.</p>
<p>In practice, this could be quite serious: imagine that you join a public chatroom for some sensitive subject (e.g. <code>#hiv:example.com</code>) and then later on decide that you want to erase yourself from the room. It would be very undesirable if any new homeserver joining that room received a copy of the DAG showing that your MXID had sent thousands of events into the room - especially if your MXID was clearly identifying (i.e. your real name).</p>
<p>Mitigating this is a hard problem, as MXIDs are baked into the DAG for a room in many places - not least to identify which servers are participating in a room. The problem is made even worse by the fact that in Matrix, server hostnames themselves are often personally identifying (for one-person homeservers sitting on a personal domain).</p>
<p>We've spent quite a lot time reasoning through how to fix this situation, and a full technical spec proposal for removing MXIDs from events can be found at <a href="https://docs.google.com/document/d/1ni4LnC_vafX4h4K4sYNpmccS7QeHEFpAcYcbLS-J21Q">https://docs.google.com/document/d/1ni4LnC_vafX4h4K4sYNpmccS7QeHEFpAcYcbLS-J21Q</a>. The high level proposal is to switch to giving each user a different ID in the form of a cryptographic public key for every room it participates in, and maintaining a mapping of today's MXIDs to these per-user-per-room keys.  In the event of a GDPR erasure, these mappings can be discarded, pseudonymising the user and avoiding correlation across different rooms. We'd also switch to using cryptographic public keys as the identifiers for Rooms, Events and Users (for cross-room APIs like presence).</p>
<p>This is obviously a significant protocol change, and we're not going to do it lightly - we're still waiting for legal confirmation on whether we need it for May 25th (it may be covered as an intrinsic technical limitation of the system).  However, the good news is that it paves the way towards many other desirable features: the ability to migrate accounts between homeservers; the ability to solve the problem of how to handle domain names being reused (or hijacked); the ability to decouple homeservers from DNS so that they can run clientside (for p2p matrix); etc.  The chances are high that this proposal will land in the relatively near future (especially if mandated by GDPR), so input is very appreciated at this point!</p>
<h3 id="consent">Consent</h3>
<p>GDPR describes <a href="https://gdpr-info.eu/art-6-gdpr/">six lawful bases for processing</a> personal data. For those running Matrix servers, it seems the best route to compliance is the most explicit and active one: <em>consent</em>.</p>
<p><em>Consent</em> requires that our users are <strong>fully informed</strong> as to exactly how their data will be used, where it will be stored, and (in our case) the specific caveats associated with a decentralised, federated communication system. They are then asked to provide their explicit approval before using (or continuing to use) the service.</p>
<p>In order to gather consent in a way that doesn't break all of the assorted Matrix clients connecting to matrix.org today, we have identified both an immediate- and a long-term approach.</p>
<p>The (immediate-term) todo list for gathering consent is:</p>
<ul>
<li>Modify Synapse to serve up a simple 'consent tool' static webapp to display the privacy notice/terms and conditions and gather consent to this API.
<ul>
<li>Add a 'consent API' to the CS API which lets a server track whether a given user has consented to the server's privacy policy or not.</li>
</ul>
</li>
<li>Send emails and push notifications to advise users of the upcoming change (and link through to the consent tool)</li>
<li>Develop a bot that automatically connects to all users (new and existing), posting a link to the consent tool. This bot can also be used in the future as a general 'server notice channel' for letting server admins inform users of privacy policy changes; planned downtime; security notices etc.</li>
<li>Modify synapse to reject message send requests for all users who have not yet provided consent
<ul>
<li>return a useful error message which contains a link to the consent tool</li>
</ul>
</li>
<li>Making our anonymised user analytics for Riot.im 'opt in' rather than 'opt out' - this isn't a requirement of GDPR (since our analytics are <a href="https://gdpr-info.eu/recitals/no-26/">fully anonymised</a>) but reflects our commitment to user data sovereignty</li>
</ul>
<p>Long-term:</p>
<ul>
<li>Add a User Interactive Auth flow for the <code>/register</code> API to gather consent at register</li>
<li>As an alternative to the bot:
<ul>
<li>Fix user authentication in general to distinguish between 'need to reauthorize without destroying user data' and 'destroy user data and login again', so we can use the re-authorize API to gather consent via <code>/login</code> without destroying user data on the client.</li>
<li>port the <code>/login</code> API to use User Interactive Auth and also use it to gather consent for existing users when logging in</li>
</ul>
</li>
</ul>
<h3 id="deactivation">Deactivation</h3>
<p>Account deactivation (the ability to terminate your account on your homeserver) intersects with GDPR in a number of places.</p>
<p>Todo list for account deactivation:</p>
<ul>
<li>Remove deactivated users from all rooms - this finally solves the problem where deactivated users leave zombie users around on bridged networks.</li>
<li>Remove deactivated users from the homeserver's user directory</li>
<li>Remove all 3PID bindings associated with a deactivated user from the identity servers</li>
<li>Improve the account deactivation UX to make sure users understand the full consequences of account deactivation</li>
</ul>
<h3 id="portability">Portability</h3>
<p>GDPR states that users have a right to extract their data in a <em>structured, commonly used and machine-readable format</em>.</p>
<p>In the medium term we would like to develop this as a core feature of Matrix (i.e. an API for exporting your logs and other data, or for that matter account portability between Matrix servers), but in the immediate term we'll be meeting our obligations by providing a manual service.</p>
<p>The immediate todo list for data portability is:</p>
<ul>
<li>Expose a simple interface for people to request their data</li>
<li>Implement the necessary tooling to provide full message logs (as a csv) upon request. As a first cut this would be the result of manually running something like <code>select * from events where user=?</code>.</li>
</ul>
<h3 id="other">Other</h3>
<p>GDPR mandates rules for all the personal data stored by a business, so there are some broader areas to bear in mind which aren't really Matrix specific, including:</p>
<ul>
<li>Making a clear statement as to how data is processed if you apply for a job</li>
<li>Ensuring you are seeking appropriate consent for cookies</li>
<li>Making sure all the appropriate documentation, processes and training materials are in place to meet GDPR obligations.</li>
</ul>
<h3 id="conclusion">Conclusion</h3>
<p>So, there you have it. We'll be tracking progress in github issues and an associated dashboard over the coming weeks; for now <a href="https://github.com/matrix-org/synapse/issues/1941">https://github.com/matrix-org/synapse/issues/1941</a> (for Right to Erasure) or <a href="https://github.com/vector-im/riot-meta/issues/149">https://github.com/vector-im/riot-meta/issues/149</a> (GDPR in general) is as good as place as any to gather feedback. Alternatively, feel free to comment on the original text of this blog post: <a href="https://docs.google.com/document/d/1JTEI6RENnOlnCwcU2hwpg3P6LmTWuNS9S-ZYDdjqgzA">https://docs.google.com/document/d/1JTEI6RENnOlnCwcU2hwpg3P6LmTWuNS9S-ZYDdjqgzA</a>.</p>
<p>It's worth noting that we feel that GDPR is an excellent piece of legislation from the perspective of forcing us to think more seriously about our privacy - it has forced us to re-prioritise all sorts of long-term deficiencies in Matrix (e.g. dependence on DNS; improving User Interactive authentication; improving logout semantics etc). There's obviously a lot of work to be done here, but hopefully it should all be worth it!</p>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2018&#x2F;05&#x2F;01&#x2F;security-update-synapse-0-28-1&#x2F;" title="SECURITY UPDATE: Synapse 0.28.1">SECURITY UPDATE: Synapse 0.28.1</a></h2>
                <span>
                    01.05.2018 00:00
                    —
                    <a href="/category/tech">
                        Tech
                    </a>
                    —
                    <a
                        href="/author/matthew-hodgson">
                        Matthew Hodgson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Hi all,</p>
<p>Many people will have noticed disruption in #matrix:matrix.org and #matrix-dev:matrix.org on Sunday, when a validation bug in Synapse was exploited which allowed a malicious event to be inserted into the room with 'depth' value that made the rooms temporarily unusable. Whilst a transient workaround was found at the time (thanks to /dev/ponies, kythyria and Po Shamil for the workaround and to Half-Shot for working on a proposed fix), we're doing an urgent release of Synapse 0.28.1 to provide a temporary solution which will mitigate the attack across all rooms in upgraded servers and un-break affected ones.  Meanwhile we have a full long-term fix on the horizon (hopefully) later this week.</p>
<p><strong>This vulnerability has already been exploited in the wild; please upgrade as soon as possible.</strong></p>
<p>Synapse 0.28.1 is available from <a href="https://github.com/matrix-org/synapse/releases/tag/v0.28.1">https://github.com/matrix-org/synapse/releases/tag/v0.28.1</a> as normal.</p>
<p>The 'depth' parameter is used primarily as a way for servers to signal the intended cosmetic order of their events within a room (particularly when the room's message graph has gaps in it due to the server being offline, or due to users backfilling old disconnected chunks of conversation). This means that affected rooms may experience message ordering problems until a full long-term fix is provided, which we're working on currently (and tentatively involves no longer trusting 'depth' information from servers).  For full details you can see the proposal documents for the <a href="https://docs.google.com/document/d/1I3fi2S-XnpO45qrpCsowZv8P8dHcNZ4fsBsbOW7KABI/edit#">temporary fix in 0.28.1</a> and the options for the<a href="https://docs.google.com/document/d/16ofbjluy8ZKYL6nt7WLHG4GqSodJUWLUxHhI6xPEjr4/edit#"> imminent long-term fix</a>.</p>
<p>We'd like to acknowledge jzk for identifying the vulnerability, and Max Dor for providing feedback on the fixes.</p>
<p>As a general reminder, Synapse is still beta (as is the Matrix spec) and the federation API particularly is still being debugged and refined and is pre-r0.0.0. For the benefit of the whole community, please disclose vulnerabilities and exploits responsibly by emailing security@ or DMing someone from +matrix:matrix.org. Thanks.</p>
<h2 id="changes-in-synapse-v0-28-1-2018-05-01">Changes in synapse v0.28.1 (2018-05-01)</h2>
<p><strong>SECURITY UPDATE</strong></p>
<ul>
 	<li>Clamp the allowed values of event depth received over federation to be [0, 2^63 - 1]. This mitigates an attack where malicious events injected with depth = 2^63 - 1 render rooms unusable. Depth is used to determine the cosmetic ordering of events within a room, and so the ordering of events in such a room will default to using stream_ordering rather than depth (topological_ordering). This is a temporary solution to mitigate abuse in the wild, whilst a long solution is being implemented to improve how the depth parameter is used.Full details at <a href="https://docs.google.com/document/d/1I3fi2S-XnpO45qrpCsowZv8P8dHcNZ4fsBsbOW7KABI" rel="nofollow">https://docs.google.com/document/d/1I3fi2S-XnpO45qrpCsowZv8P8dHcNZ4fsBsbOW7KABI</a></li>
 	<li>Pin Twisted to &lt;18.4 until we stop using the private _OpenSSLECCurve API.</li>
</ul>

                
            </div>
        </article>
        
        <nav class="pagination">
    <div class="prev">
        
        <a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;author&#x2F;matthew-hodgson&#x2F;page&#x2F;6&#x2F;">‹ Previous</a>
        
    </div>
    <span class="page-number">7 / 15</span>
    <div class="prev">
        
        <a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;author&#x2F;matthew-hodgson&#x2F;page&#x2F;8&#x2F;">Next ›</a>
        
    </div>
</nav>

    </div>
</div>

    </main>

    <footer class="site-footer">
    <div class="internal-links">
        
        <a href="&#x2F;faq">FAQs</a>
        
        <a href="&#x2F;security-disclosure-policy">Security Disclosure Policy</a>
        
        <a href="&#x2F;security-hall-of-fame">Security Hall of Fame</a>
        
        <a href="&#x2F;legal&#x2F;code-of-conduct">Code of Conduct for Matrix.org</a>
        
        <a href="&#x2F;legal">Legal</a>
        
        <a href="&#x2F;contact">Contact</a>
        
        <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org&#x2F;matrix.org&#x2F;">Site Source</a>
        
    </div>
    <div class="external-links">
        <div>
            
            <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org"><img src="/assets/github.svg" alt="GitHub"></a>
            
            <a href="https:&#x2F;&#x2F;gitlab.matrix.org&#x2F;"><img src="/assets/gitlab.svg" alt="GitLab"></a>
            
            <a href="https:&#x2F;&#x2F;mastodon.matrix.org&#x2F;@matrix"><img src="/assets/mastodon.svg" alt="Mastodon"></a>
            
            <a href="https:&#x2F;&#x2F;twitter.com&#x2F;matrixdotorg"><img src="/assets/twitter.svg" alt="Twitter"></a>
            
            <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCVFkW-chclhuyYRbmmfwt6w"><img src="/assets/youtube.svg" alt="YouTube"></a>
            
        </div>
    </div>
    <p><a href="/legal/copyright-notice">Copyright Notice</a></p>
</footer>

</body>

</html>
