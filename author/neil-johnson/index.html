<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="twitter:widgets:csp" content="on" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="twitter:site" content="@matrixdotorg" />
    <meta name="twitter:creator" content="@matrixdotorg" />

    <title>Matrix.org - Neil Johnson</title>
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="icon" type="image/png" href="/assets/favicon.png" />
    <link rel="stylesheet" href="/style.css" />

    
<link rel="alternate" type="application/rss+xml" title="RSS" href="/author/neil-johnson/atom.xml">
</head>

<body>
    
    <header class="site-header">
    <a href="/" class="brand">
        <img src="/images/matrix-logo-white.svg" alt="Matrix logo">
    </a>
    <input id="site-header-dropdown-checkbox" type="checkbox" class="dropdown-checkbox" aria-hidden="true">
    <label for="site-header-dropdown-checkbox" class="dropdown-button">&#xe602;</label>
    <label for="site-header-dropdown-checkbox" class="page-overlay"></label>
    <nav>
        
        
        <a href="&#x2F;about&#x2F;" class="
            ">
            About
        </a>
        
        
        
        <a href="&#x2F;blog&#x2F;" class="
            ">
            Blog
        </a>
        
        
        
        <a href="&#x2F;docs&#x2F;" class="
            ">
            Documentation
        </a>
        
        
        
        
        
        <div class="section-wrap">
            <input id="ecosystem-submenu-checkbox" type="checkbox" class="submenu-checkbox" aria-hidden="true" >
            <label for="ecosystem-submenu-checkbox" class="submenu-title">Ecosystem <div class="arrow"></div></label>

            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    <a href="&#x2F;ecosystem&#x2F;servers&#x2F;">Servers</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;bots&#x2F;">Bots</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;sdks&#x2F;">SDKs</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;hosting&#x2F;">Hosting</a>
                    
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;clients&#x2F;">Clients</a>
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;bridges&#x2F;">Bridges</a>
                    
                </div>
            </div>
        </div>
        
        
        
        <a href="&#x2F;podcasts&#x2F;" class="
            ">
            Podcasts
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;shop.matrix.org" class="
            ">
            Shop
        </a>
        
        
        
        <a href="&#x2F;try-matrix&#x2F;" class="primary
            ">
            Try Matrix
        </a>
        
        
    </nav>
</header>


    <main>
        
<div id="taxonomy-single">
    <div class="content">
        <header>
            <h1>Neil Johnson</h1>
            64 posts tagged with "Neil Johnson" <a href="/author">(See all Author)</a>
            
        </header>

        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;10&#x2F;13&#x2F;synapse-1-21-1-released&#x2F;" title="Synapse 1.21.1 released">Synapse 1.21.1 released</a></h2>
                <span>
                    13.10.2020 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.21.1 has landed!</p>
<p>Highlights of 1.21.1 include:-</p>
<ul>
<li>
<p>Add experimental support for sharding event persister. (<a href="https://github.com/matrix-org/synapse/issues/8294">#8294</a>, <a href="https://github.com/matrix-org/synapse/issues/8387">#8387</a>, <a href="https://github.com/matrix-org/synapse/issues/8396">#8396</a>, <a href="https://github.com/matrix-org/synapse/issues/8419">#8419</a>)</p>
</li>
<li>
<p>Add experimental prometheus metric to track numbers of &quot;large&quot; rooms for state resolutiom. (<a href="https://github.com/matrix-org/synapse/issues/8425">#8425</a>)</p>
</li>
<li>
<p>Add prometheus metrics to track federation delays. (<a href="https://github.com/matrix-org/synapse/issues/8430">#8430</a>)</p>
</li>
<li>
<p>Fix messages not being sent over federation until an event is sent into the same room. (<a href="https://github.com/matrix-org/synapse/issues/8230">#8230</a>, <a href="https://github.com/matrix-org/synapse/issues/8247">#8247</a>, <a href="https://github.com/matrix-org/synapse/issues/8258">#8258</a>, <a href="https://github.com/matrix-org/synapse/issues/8272">#8272</a>, <a href="https://github.com/matrix-org/synapse/issues/8322">#8322</a>)</p>
</li>
</ul>
<p>We've also made some improvements to SSO and added new admin APIs.</p>
<p>Get the new releases from any of the usual sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md. 1.21.1 is on github <a href="https://github.com/matrix-org/synapse/releases/tag/v1.21.1">here</a></p>
<p>The changelog for 1.21.1 is as follows:</p>
<h1 id="synapse-1-21-1-2020-10-13">Synapse 1.21.1 (2020-10-13)</h1>
<p>This release fixes a regression in v1.21.0 that prevented debian packages from being built.</p>
<p>It is otherwise identical to v1.21.0.</p>
<h1 id="synapse-1-21-0-2020-10-12">Synapse 1.21.0 (2020-10-12)</h1>
<p>No significant changes since v1.21.0rc3.</p>
<p>As <a href="https://github.com/matrix-org/synapse/blob/release-v1.21.1/CHANGES.md#synapse-1200-2020-09-22">noted in v1.20.0</a>, a future release will drop support for accessing Synapse's <a href="https://github.com/matrix-org/synapse/tree/master/docs/admin_api">Admin API</a> under the <code>/_matrix/client/*</code> endpoint prefixes. At that point, the Admin API will only be accessible under <code>/_synapse/admin</code>.</p>
<h1 id="synapse-1-21-0rc3-2020-10-08">Synapse 1.21.0rc3 (2020-10-08)</h1>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Fix duplication of events on high traffic servers, caused by PostgreSQL <code>could not serialize access due to concurrent update</code> errors. (<a href="https://github.com/matrix-org/synapse/issues/8456">#8456</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Add Groovy Gorilla to the list of distributions we build <code>.deb</code>s for. (<a href="https://github.com/matrix-org/synapse/issues/8475">#8475</a>)</li>
</ul>
<h1 id="synapse-1-21-0rc2-2020-10-02">Synapse 1.21.0rc2 (2020-10-02)</h1>
<h2 id="features">Features</h2>
<ul>
<li>Convert additional templates from inline HTML to Jinja2 templates. (<a href="https://github.com/matrix-org/synapse/issues/8444">#8444</a>)</li>
</ul>
<h2 id="bugfixes-1">Bugfixes</h2>
<ul>
<li>Fix a regression in v1.21.0rc1 which broke thumbnails of remote media. (<a href="https://github.com/matrix-org/synapse/issues/8438">#8438</a>)</li>
<li>Do not expose the experimental <code>uk.half-shot.msc2778.login.application_service</code> flow in the login API, which caused a compatibility problem with Element iOS. (<a href="https://github.com/matrix-org/synapse/issues/8440">#8440</a>)</li>
<li>Fix malformed log line in new federation &quot;catch up&quot; logic. (<a href="https://github.com/matrix-org/synapse/issues/8442">#8442</a>)</li>
<li>Fix DB query on startup for negative streams which caused long start up times. Introduced in <a href="https://github.com/matrix-org/synapse/issues/8374">#8374</a>. (<a href="https://github.com/matrix-org/synapse/issues/8447">#8447</a>)</li>
</ul>
<h1 id="synapse-1-21-0rc1-2020-10-01">Synapse 1.21.0rc1 (2020-10-01)</h1>
<h2 id="features-1">Features</h2>
<ul>
<li>Require the user to confirm that their password should be reset after clicking the email confirmation link. (<a href="https://github.com/matrix-org/synapse/issues/8004">#8004</a>)</li>
<li>Add an admin API <code>GET /_synapse/admin/v1/event_reports</code> to read entries of table <code>event_reports</code>. Contributed by @dklimpel. (<a href="https://github.com/matrix-org/synapse/issues/8217">#8217</a>)</li>
<li>Consolidate the SSO error template across all configuration. (<a href="https://github.com/matrix-org/synapse/issues/8248">#8248</a>, <a href="https://github.com/matrix-org/synapse/issues/8405">#8405</a>)</li>
<li>Add a configuration option to specify a whitelist of domains that a user can be redirected to after validating their email or phone number. (<a href="https://github.com/matrix-org/synapse/issues/8275">#8275</a>, <a href="https://github.com/matrix-org/synapse/issues/8417">#8417</a>)</li>
<li>Add experimental support for sharding event persister. (<a href="https://github.com/matrix-org/synapse/issues/8294">#8294</a>, <a href="https://github.com/matrix-org/synapse/issues/8387">#8387</a>, <a href="https://github.com/matrix-org/synapse/issues/8396">#8396</a>, <a href="https://github.com/matrix-org/synapse/issues/8419">#8419</a>)</li>
<li>Add the room topic and avatar to the room details admin API. (<a href="https://github.com/matrix-org/synapse/issues/8305">#8305</a>)</li>
<li>Add an admin API for querying rooms where a user is a member. Contributed by @dklimpel. (<a href="https://github.com/matrix-org/synapse/issues/8306">#8306</a>)</li>
<li>Add <code>uk.half-shot.msc2778.login.application_service</code> login type to allow appservices to login. (<a href="https://github.com/matrix-org/synapse/issues/8320">#8320</a>)</li>
<li>Add a configuration option that allows existing users to log in with OpenID Connect. Contributed by @BBBSnowball and @OmmyZhang. (<a href="https://github.com/matrix-org/synapse/issues/8345">#8345</a>)</li>
<li>Add prometheus metrics for replication requests. (<a href="https://github.com/matrix-org/synapse/issues/8406">#8406</a>)</li>
<li>Support passing additional single sign-on parameters to the client. (<a href="https://github.com/matrix-org/synapse/issues/8413">#8413</a>)</li>
<li>Add experimental reporting of metrics on expensive rooms for state-resolution. (<a href="https://github.com/matrix-org/synapse/issues/8420">#8420</a>)</li>
<li>Add experimental prometheus metric to track numbers of &quot;large&quot; rooms for state resolutiom. (<a href="https://github.com/matrix-org/synapse/issues/8425">#8425</a>)</li>
<li>Add prometheus metrics to track federation delays. (<a href="https://github.com/matrix-org/synapse/issues/8430">#8430</a>)</li>
</ul>
<h2 id="bugfixes-2">Bugfixes</h2>
<ul>
<li>Fix a bug in the media repository where remote thumbnails with the same size but different crop methods would overwrite each other. Contributed by @deepbluev7. (<a href="https://github.com/matrix-org/synapse/issues/7124">#7124</a>)</li>
<li>Fix inconsistent handling of non-existent push rules, and stop tracking the <code>enabled</code> state of removed push rules. (<a href="https://github.com/matrix-org/synapse/issues/7796">#7796</a>)</li>
<li>Fix a longstanding bug when storing a media file with an empty <code>upload_name</code>. (<a href="https://github.com/matrix-org/synapse/issues/7905">#7905</a>)</li>
<li>Fix messages not being sent over federation until an event is sent into the same room. (<a href="https://github.com/matrix-org/synapse/issues/8230">#8230</a>, <a href="https://github.com/matrix-org/synapse/issues/8247">#8247</a>, <a href="https://github.com/matrix-org/synapse/issues/8258">#8258</a>, <a href="https://github.com/matrix-org/synapse/issues/8272">#8272</a>, <a href="https://github.com/matrix-org/synapse/issues/8322">#8322</a>)</li>
<li>Fix a longstanding bug where files that could not be thumbnailed would result in an Internal Server Error. (<a href="https://github.com/matrix-org/synapse/issues/8236">#8236</a>, <a href="https://github.com/matrix-org/synapse/issues/8435">#8435</a>)</li>
<li>Upgrade minimum version of <code>canonicaljson</code> to version 1.4.0, to fix an unicode encoding issue. (<a href="https://github.com/matrix-org/synapse/issues/8262">#8262</a>)</li>
<li>Fix longstanding bug which could lead to incomplete database upgrades on SQLite. (<a href="https://github.com/matrix-org/synapse/issues/8265">#8265</a>)</li>
<li>Fix stack overflow when stderr is redirected to the logging system, and the logging system encounters an error. (<a href="https://github.com/matrix-org/synapse/issues/8268">#8268</a>)</li>
<li>Fix a bug which cause the logging system to report errors, if <code>DEBUG</code> was enabled and no <code>context</code> filter was applied. (<a href="https://github.com/matrix-org/synapse/issues/8278">#8278</a>)</li>
<li>Fix edge case where push could get delayed for a user until a later event was pushed. (<a href="https://github.com/matrix-org/synapse/issues/8287">#8287</a>)</li>
<li>Fix fetching malformed events from remote servers. (<a href="https://github.com/matrix-org/synapse/issues/8324">#8324</a>)</li>
<li>Fix <code>UnboundLocalError</code> from occurring when appservices send a malformed register request. (<a href="https://github.com/matrix-org/synapse/issues/8329">#8329</a>)</li>
<li>Don't send push notifications to expired user accounts. (<a href="https://github.com/matrix-org/synapse/issues/8353">#8353</a>)</li>
<li>Fix a regression in v1.19.0 with reactivating users through the admin API. (<a href="https://github.com/matrix-org/synapse/issues/8362">#8362</a>)</li>
<li>Fix a bug where during device registration the length of the device name wasn't limited. (<a href="https://github.com/matrix-org/synapse/issues/8364">#8364</a>)</li>
<li>Include <code>guest_access</code> in the fields that are checked for null bytes when updating <code>room_stats_state</code>. Broke in v1.7.2. (<a href="https://github.com/matrix-org/synapse/issues/8373">#8373</a>)</li>
<li>Fix theoretical race condition where events are not sent down <code>/sync</code> if the synchrotron worker is restarted without restarting other workers. (<a href="https://github.com/matrix-org/synapse/issues/8374">#8374</a>)</li>
<li>Fix a bug which could cause errors in rooms with malformed membership events, on servers using sqlite. (<a href="https://github.com/matrix-org/synapse/issues/8385">#8385</a>)</li>
<li>Fix &quot;Re-starting finished log context&quot; warning when receiving an event we already had over federation. (<a href="https://github.com/matrix-org/synapse/issues/8398">#8398</a>)</li>
<li>Fix incorrect handling of timeouts on outgoing HTTP requests. (<a href="https://github.com/matrix-org/synapse/issues/8400">#8400</a>)</li>
<li>Fix a regression in v1.20.0 in the <code>synapse_port_db</code> script regarding the <code>ui_auth_sessions_ips</code> table. (<a href="https://github.com/matrix-org/synapse/issues/8410">#8410</a>)</li>
<li>Remove unnecessary 3PID registration check when resetting password via an email address. Bug introduced in v0.34.0rc2. (<a href="https://github.com/matrix-org/synapse/issues/8414">#8414</a>)</li>
</ul>
<h2 id="improved-documentation">Improved Documentation</h2>
<ul>
<li>Add <code>/_synapse/client</code> to the reverse proxy documentation. (<a href="https://github.com/matrix-org/synapse/issues/8227">#8227</a>)</li>
<li>Add note to the reverse proxy settings documentation about disabling Apache's mod_security2. Contributed by Julian Fietkau (@jfietkau). (<a href="https://github.com/matrix-org/synapse/issues/8375">#8375</a>)</li>
<li>Improve description of <code>server_name</code> config option in <code>homserver.yaml</code>. (<a href="https://github.com/matrix-org/synapse/issues/8415">#8415</a>)</li>
</ul>
<h2 id="deprecations-and-removals">Deprecations and Removals</h2>
<ul>
<li>Drop support for <code>prometheus_client</code> older than 0.4.0. (<a href="https://github.com/matrix-org/synapse/issues/8426">#8426</a>)</li>
</ul>
<h2 id="internal-changes-1">Internal Changes</h2>
<ul>
<li>Fix tests on distros which disable TLSv1.0. Contributed by @danc86. (<a href="https://github.com/matrix-org/synapse/issues/8208">#8208</a>)</li>
<li>Simplify the distributor code to avoid unnecessary work. (<a href="https://github.com/matrix-org/synapse/issues/8216">#8216</a>)</li>
<li>Remove the <code>populate_stats_process_rooms_2</code> background job and restore functionality to <code>populate_stats_process_rooms</code>. (<a href="https://github.com/matrix-org/synapse/issues/8243">#8243</a>)</li>
<li>Clean up type hints for <code>PaginationConfig</code>. (<a href="https://github.com/matrix-org/synapse/issues/8250">#8250</a>, <a href="https://github.com/matrix-org/synapse/issues/8282">#8282</a>)</li>
<li>Track the latest event for every destination and room for catch-up after federation outage. (<a href="https://github.com/matrix-org/synapse/issues/8256">#8256</a>)</li>
<li>Fix non-user visible bug in implementation of <code>MultiWriterIdGenerator.get_current_token_for_writer</code>. (<a href="https://github.com/matrix-org/synapse/issues/8257">#8257</a>)</li>
<li>Switch to the JSON implementation from the standard library. (<a href="https://github.com/matrix-org/synapse/issues/8259">#8259</a>)</li>
<li>Add type hints to <code>synapse.util.async_helpers</code>. (<a href="https://github.com/matrix-org/synapse/issues/8260">#8260</a>)</li>
<li>Simplify tests that mock asynchronous functions. (<a href="https://github.com/matrix-org/synapse/issues/8261">#8261</a>)</li>
<li>Add type hints to <code>StreamToken</code> and <code>RoomStreamToken</code> classes. (<a href="https://github.com/matrix-org/synapse/issues/8279">#8279</a>)</li>
<li>Change <code>StreamToken.room_key</code> to be a <code>RoomStreamToken</code> instance. (<a href="https://github.com/matrix-org/synapse/issues/8281">#8281</a>)</li>
<li>Refactor notifier code to correctly use the max event stream position. (<a href="https://github.com/matrix-org/synapse/issues/8288">#8288</a>)</li>
<li>Use slotted classes where possible. (<a href="https://github.com/matrix-org/synapse/issues/8296">#8296</a>)</li>
<li>Support testing the local Synapse checkout against the <a href="https://github.com/matrix-org/complement/">Complement homeserver test suite</a>. (<a href="https://github.com/matrix-org/synapse/issues/8317">#8317</a>)</li>
<li>Update outdated usages of <code>metaclass</code> to python 3 syntax. (<a href="https://github.com/matrix-org/synapse/issues/8326">#8326</a>)</li>
<li>Move lint-related dependencies to package-extra field, update CONTRIBUTING.md to utilise this. (<a href="https://github.com/matrix-org/synapse/issues/8330">#8330</a>, <a href="https://github.com/matrix-org/synapse/issues/8377">#8377</a>)</li>
<li>Use the <code>admin_patterns</code> helper in additional locations. (<a href="https://github.com/matrix-org/synapse/issues/8331">#8331</a>)</li>
<li>Fix test logging to allow braces in log output. (<a href="https://github.com/matrix-org/synapse/issues/8335">#8335</a>)</li>
<li>Remove <code>__future__</code> imports related to Python 2 compatibility. (<a href="https://github.com/matrix-org/synapse/issues/8337">#8337</a>)</li>
<li>Simplify <code>super()</code> calls to Python 3 syntax. (<a href="https://github.com/matrix-org/synapse/issues/8344">#8344</a>)</li>
<li>Fix bad merge from <code>release-v1.20.0</code> branch to <code>develop</code>. (<a href="https://github.com/matrix-org/synapse/issues/8354">#8354</a>)</li>
<li>Factor out a <code>_send_dummy_event_for_room</code> method. (<a href="https://github.com/matrix-org/synapse/issues/8370">#8370</a>)</li>
<li>Improve logging of state resolution. (<a href="https://github.com/matrix-org/synapse/issues/8371">#8371</a>)</li>
<li>Add type annotations to <code>SimpleHttpClient</code>. (<a href="https://github.com/matrix-org/synapse/issues/8372">#8372</a>)</li>
<li>Refactor ID generators to use <code>async with</code> syntax. (<a href="https://github.com/matrix-org/synapse/issues/8383">#8383</a>)</li>
<li>Add <code>EventStreamPosition</code> type. (<a href="https://github.com/matrix-org/synapse/issues/8388">#8388</a>)</li>
<li>Create a mechanism for marking tests &quot;logcontext clean&quot;. (<a href="https://github.com/matrix-org/synapse/issues/8399">#8399</a>)</li>
<li>A pair of tiny cleanups in the federation request code. (<a href="https://github.com/matrix-org/synapse/issues/8401">#8401</a>)</li>
<li>Add checks on startup that PostgreSQL sequences are consistent with their associated tables. (<a href="https://github.com/matrix-org/synapse/issues/8402">#8402</a>)</li>
<li>Do not include appservice users when calculating the total MAU for a server. (<a href="https://github.com/matrix-org/synapse/issues/8404">#8404</a>)</li>
<li>Typing fixes for <code>synapse.handlers.federation</code>. (<a href="https://github.com/matrix-org/synapse/issues/8422">#8422</a>)</li>
<li>Various refactors to simplify stream token handling. (<a href="https://github.com/matrix-org/synapse/issues/8423">#8423</a>)</li>
<li>Make stream token serializing/deserializing async. (<a href="https://github.com/matrix-org/synapse/issues/8427">#8427</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;09&#x2F;22&#x2F;synapse-1-20-0-released&#x2F;" title="Synapse 1.20.0 released">Synapse 1.20.0 released</a></h2>
                <span>
                    22.09.2020 19:30
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.20.0 is here!</p>
<p>Highlights of 1.20.0 include:-</p>
<ul>
<li>Shadow ban support.</li>
<li>Unread message counts in the sync response to help our client developers, this is a precursor to improving notification support.</li>
<li>No less than 28 async/await PRs, so we can finally share all the hard work.</li>
</ul>
<p>Also take note that in a future release, we will be dropping support for accessing Synapse's Admin API using the <code>/_matrix/client/* prefixes</code>. More details follow in the changelog.</p>
<p>Get the new releases from any of the usual sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md. 1.20.0 is on github <a href="https://github.com/matrix-org/synapse/releases/tag/v1.20.0">here</a>, and 1.20.0rc4 is <a href="https://github.com/matrix-org/synapse/releases/tag/v1.20.0rc4">here</a>.</p>
<p>The changelog for 1.20.0 is as follows:</p>
<h1 id="synapse-1-20-0-2020-09-22">Synapse 1.20.0 (2020-09-22)</h1>
<p>No significant changes since v1.20.0rc5.</p>
<h2 id="removal-warning">Removal warning</h2>
<p>Historically, the <a href="https://github.com/matrix-org/synapse/tree/master/docs">Synapse Admin API</a> has been accessible under the <code>/_matrix/client/api/v1/admin</code>, <code>/_matrix/client/unstable/admin</code>, <code>/_matrix/client/r0/admin</code> and <code>/_synapse/admin</code> prefixes. In a future release, we will be dropping support for accessing Synapse's Admin API using the <code>/_matrix/client/*</code> prefixes. This makes it easier for homeserver admins to lock down external access to the Admin API endpoints.</p>
<h1 id="synapse-1-20-0rc5-2020-09-18">Synapse 1.20.0rc5 (2020-09-18)</h1>
<p>In addition to the below, Synapse 1.20.0rc5 also includes the bug fix that was included in 1.19.3.</p>
<h2 id="features">Features</h2>
<ul>
<li>Add flags to the <code>/versions</code> endpoint for whether new rooms default to using E2EE. (<a href="https://github.com/matrix-org/synapse/issues/8343">#8343</a>)</li>
</ul>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Fix rate limiting of federation <code>/send</code> requests. (<a href="https://github.com/matrix-org/synapse/issues/8342">#8342</a>)</li>
<li>Fix a longstanding bug where back pagination over federation could get stuck if it failed to handle a received event. (<a href="https://github.com/matrix-org/synapse/issues/8349">#8349</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Blacklist <a href="https://github.com/matrix-org/matrix-doc/pull/2753">MSC2753</a> SyTests until it is implemented. (<a href="https://github.com/matrix-org/synapse/issues/8285">#8285</a>)</li>
</ul>
<h1 id="synapse-1-20-0rc4-2020-09-16">Synapse 1.20.0rc4 (2020-09-16)</h1>
<p>Synapse 1.20.0rc4 is identical to 1.20.0rc3, with the addition of the security fix that was included in 1.19.2.</p>
<h1 id="synapse-1-20-0rc3-2020-09-11">Synapse 1.20.0rc3 (2020-09-11)</h1>
<h2 id="bugfixes-1">Bugfixes</h2>
<ul>
<li>Fix a bug introduced in v1.20.0rc1 where the wrong exception was raised when invalid JSON data is encountered. (<a href="https://github.com/matrix-org/synapse/issues/8291">#8291</a>)</li>
</ul>
<h1 id="synapse-1-20-0rc2-2020-09-09">Synapse 1.20.0rc2 (2020-09-09)</h1>
<h2 id="bugfixes-2">Bugfixes</h2>
<ul>
<li>Fix a bug introduced in v1.20.0rc1 causing some features related to notifications to misbehave following the implementation of unread counts. (<a href="https://github.com/matrix-org/synapse/issues/8280">#8280</a>)</li>
</ul>
<h1 id="synapse-1-20-0rc1-2020-09-08">Synapse 1.20.0rc1 (2020-09-08)</h1>
<h2 id="removal-warning-1">Removal warning</h2>
<p>Some older clients used a <a href="https://matrix.org/docs/spec/client_server/r0.6.1#post-matrix-client-r0-register-email-requesttoken">disallowed character</a> (<code>:</code>) in the <code>client_secret</code> parameter of various endpoints. The incorrect behaviour was allowed for backwards compatibility, but is now being removed from Synapse as most users have updated their client. Further context can be found at <a href="https://github.com/matrix-org/synapse/issues/6766">#6766</a>.</p>
<h2 id="features-1">Features</h2>
<ul>
<li>Add an endpoint to query your shared rooms with another user as an implementation of <a href="https://github.com/matrix-org/matrix-doc/pull/2666">MSC2666</a>. (<a href="https://github.com/matrix-org/synapse/issues/7785">#7785</a>)</li>
<li>Iteratively encode JSON to avoid blocking the reactor. (<a href="https://github.com/matrix-org/synapse/issues/8013">#8013</a>, <a href="https://github.com/matrix-org/synapse/issues/8116">#8116</a>)</li>
<li>Add support for shadow-banning users (ignoring any message send requests). (<a href="https://github.com/matrix-org/synapse/issues/8034">#8034</a>, <a href="https://github.com/matrix-org/synapse/issues/8092">#8092</a>, <a href="https://github.com/matrix-org/synapse/issues/8095">#8095</a>, <a href="https://github.com/matrix-org/synapse/issues/8142">#8142</a>, <a href="https://github.com/matrix-org/synapse/issues/8152">#8152</a>, <a href="https://github.com/matrix-org/synapse/issues/8157">#8157</a>, <a href="https://github.com/matrix-org/synapse/issues/8158">#8158</a>, <a href="https://github.com/matrix-org/synapse/issues/8176">#8176</a>)</li>
<li>Use the default template file when its equivalent is not found in a custom template directory. (<a href="https://github.com/matrix-org/synapse/issues/8037">#8037</a>, <a href="https://github.com/matrix-org/synapse/issues/8107">#8107</a>, <a href="https://github.com/matrix-org/synapse/issues/8252">#8252</a>)</li>
<li>Add unread messages count to sync responses, as specified in <a href="https://github.com/matrix-org/matrix-doc/pull/2654">MSC2654</a>. (<a href="https://github.com/matrix-org/synapse/issues/8059">#8059</a>, <a href="https://github.com/matrix-org/synapse/issues/8254">#8254</a>, <a href="https://github.com/matrix-org/synapse/issues/8270">#8270</a>, <a href="https://github.com/matrix-org/synapse/issues/8274">#8274</a>)</li>
<li>Optimise <code>/federation/v1/user/devices/</code> API by only returning devices with encryption keys. (<a href="https://github.com/matrix-org/synapse/issues/8198">#8198</a>)</li>
</ul>
<h2 id="bugfixes-3">Bugfixes</h2>
<ul>
<li>Fix a memory leak by limiting the length of time that messages will be queued for a remote server that has been unreachable. (<a href="https://github.com/matrix-org/synapse/issues/7864">#7864</a>)</li>
<li>Fix <code>Re-starting finished log context PUT-nnnn</code> warning when event persistence failed. (<a href="https://github.com/matrix-org/synapse/issues/8081">#8081</a>)</li>
<li>Synapse now correctly enforces the valid characters in the <code>client_secret</code> parameter used in various endpoints. (<a href="https://github.com/matrix-org/synapse/issues/8101">#8101</a>)</li>
<li>Fix a bug introduced in v1.7.2 impacting message retention policies that would allow federated homeservers to dictate a retention period that's lower than the configured minimum allowed duration in the configuration file. (<a href="https://github.com/matrix-org/synapse/issues/8104">#8104</a>)</li>
<li>Fix a long-standing bug where invalid JSON would be accepted by Synapse. (<a href="https://github.com/matrix-org/synapse/issues/8106">#8106</a>)</li>
<li>Fix a bug introduced in Synapse v1.12.0 which could cause <code>/sync</code> requests to fail with a 404 if you had a very old outstanding room invite. (<a href="https://github.com/matrix-org/synapse/issues/8110">#8110</a>)</li>
<li>Return a proper error code when the rooms of an invalid group are requested. (<a href="https://github.com/matrix-org/synapse/issues/8129">#8129</a>)</li>
<li>Fix a bug which could cause a leaked postgres connection if synapse was set to daemonize. (<a href="https://github.com/matrix-org/synapse/issues/8131">#8131</a>)</li>
<li>Clarify the error code if a user tries to register with a numeric ID. This bug was introduced in v1.15.0. (<a href="https://github.com/matrix-org/synapse/issues/8135">#8135</a>)</li>
<li>Fix a bug where appservices with ratelimiting disabled would still be ratelimited when joining rooms. This bug was introduced in v1.19.0. (<a href="https://github.com/matrix-org/synapse/issues/8139">#8139</a>)</li>
<li>Fix logging in via OpenID Connect with a provider that uses integer user IDs. (<a href="https://github.com/matrix-org/synapse/issues/8190">#8190</a>)</li>
<li>Fix a longstanding bug where user directory updates could break when unexpected profile data was included in events. (<a href="https://github.com/matrix-org/synapse/issues/8223">#8223</a>)</li>
<li>Fix a longstanding bug where stats updates could break when unexpected profile data was included in events. (<a href="https://github.com/matrix-org/synapse/issues/8226">#8226</a>)</li>
<li>Fix slow start times for large servers by removing a table scan of the <code>users</code> table from startup code. (<a href="https://github.com/matrix-org/synapse/issues/8271">#8271</a>)</li>
</ul>
<h2 id="updates-to-the-docker-image">Updates to the Docker image</h2>
<ul>
<li>Fix builds of the Docker image on non-x86 platforms. (<a href="https://github.com/matrix-org/synapse/issues/8144">#8144</a>)</li>
<li>Added curl for healthcheck support and readme updates for the change. Contributed by @maquis196. (<a href="https://github.com/matrix-org/synapse/issues/8147">#8147</a>)</li>
</ul>
<h2 id="improved-documentation">Improved Documentation</h2>
<ul>
<li>Link to matrix-synapse-rest-password-provider in the password provider documentation. (<a href="https://github.com/matrix-org/synapse/issues/8111">#8111</a>)</li>
<li>Updated documentation to note that Synapse does not follow <code>HTTP 308</code> redirects due to an upstream library not supporting them. Contributed by Ryan Cole. (<a href="https://github.com/matrix-org/synapse/issues/8120">#8120</a>)</li>
<li>Explain better what GDPR-erased means when deactivating a user. (<a href="https://github.com/matrix-org/synapse/issues/8189">#8189</a>)</li>
</ul>
<h2 id="internal-changes-1">Internal Changes</h2>
<ul>
<li>Add filter <code>name</code> to the <code>/users</code> admin API, which filters by user ID or displayname. Contributed by Awesome Technologies Innovationslabor GmbH. (<a href="https://github.com/matrix-org/synapse/issues/7377">#7377</a>, <a href="https://github.com/matrix-org/synapse/issues/8163">#8163</a>)</li>
<li>Reduce run times of some unit tests by advancing the reactor a fewer number of times. (<a href="https://github.com/matrix-org/synapse/issues/7757">#7757</a>)</li>
<li>Don't fail <code>/submit_token</code> requests on incorrect session ID if <code>request_token_inhibit_3pid_errors</code> is turned on. (<a href="https://github.com/matrix-org/synapse/issues/7991">#7991</a>)</li>
<li>Convert various parts of the codebase to async/await. (<a href="https://github.com/matrix-org/synapse/issues/8071">#8071</a>, <a href="https://github.com/matrix-org/synapse/issues/8072">#8072</a>, <a href="https://github.com/matrix-org/synapse/issues/8074">#8074</a>, <a href="https://github.com/matrix-org/synapse/issues/8075">#8075</a>, <a href="https://github.com/matrix-org/synapse/issues/8076">#8076</a>, <a href="https://github.com/matrix-org/synapse/issues/8087">#8087</a>, <a href="https://github.com/matrix-org/synapse/issues/8100">#8100</a>, <a href="https://github.com/matrix-org/synapse/issues/8119">#8119</a>, <a href="https://github.com/matrix-org/synapse/issues/8121">#8121</a>, <a href="https://github.com/matrix-org/synapse/issues/8133">#8133</a>, <a href="https://github.com/matrix-org/synapse/issues/8156">#8156</a>, <a href="https://github.com/matrix-org/synapse/issues/8162">#8162</a>, <a href="https://github.com/matrix-org/synapse/issues/8166">#8166</a>, <a href="https://github.com/matrix-org/synapse/issues/8168">#8168</a>, <a href="https://github.com/matrix-org/synapse/issues/8173">#8173</a>, <a href="https://github.com/matrix-org/synapse/issues/8191">#8191</a>, <a href="https://github.com/matrix-org/synapse/issues/8192">#8192</a>, <a href="https://github.com/matrix-org/synapse/issues/8193">#8193</a>, <a href="https://github.com/matrix-org/synapse/issues/8194">#8194</a>, <a href="https://github.com/matrix-org/synapse/issues/8195">#8195</a>, <a href="https://github.com/matrix-org/synapse/issues/8197">#8197</a>, <a href="https://github.com/matrix-org/synapse/issues/8199">#8199</a>, <a href="https://github.com/matrix-org/synapse/issues/8200">#8200</a>, <a href="https://github.com/matrix-org/synapse/issues/8201">#8201</a>, <a href="https://github.com/matrix-org/synapse/issues/8202">#8202</a>, <a href="https://github.com/matrix-org/synapse/issues/8207">#8207</a>, <a href="https://github.com/matrix-org/synapse/issues/8213">#8213</a>, <a href="https://github.com/matrix-org/synapse/issues/8214">#8214</a>)</li>
<li>Remove some unused database functions. (<a href="https://github.com/matrix-org/synapse/issues/8085">#8085</a>)</li>
<li>Add type hints to various parts of the codebase. (<a href="https://github.com/matrix-org/synapse/issues/8090">#8090</a>, <a href="https://github.com/matrix-org/synapse/issues/8127">#8127</a>, <a href="https://github.com/matrix-org/synapse/issues/8187">#8187</a>, <a href="https://github.com/matrix-org/synapse/issues/8241">#8241</a>, <a href="https://github.com/matrix-org/synapse/issues/8140">#8140</a>, <a href="https://github.com/matrix-org/synapse/issues/8183">#8183</a>, <a href="https://github.com/matrix-org/synapse/issues/8232">#8232</a>, <a href="https://github.com/matrix-org/synapse/issues/8235">#8235</a>, <a href="https://github.com/matrix-org/synapse/issues/8237">#8237</a>, <a href="https://github.com/matrix-org/synapse/issues/8244">#8244</a>)</li>
<li>Return the previous stream token if a non-member event is a duplicate. (<a href="https://github.com/matrix-org/synapse/issues/8093">#8093</a>, <a href="https://github.com/matrix-org/synapse/issues/8112">#8112</a>)</li>
<li>Separate <code>get_current_token</code> into two since there are two different use cases for it. (<a href="https://github.com/matrix-org/synapse/issues/8113">#8113</a>)</li>
<li>Remove <code>ChainedIdGenerator</code>. (<a href="https://github.com/matrix-org/synapse/issues/8123">#8123</a>)</li>
<li>Reduce the amount of whitespace in JSON stored and sent in responses. (<a href="https://github.com/matrix-org/synapse/issues/8124">#8124</a>)</li>
<li>Update the test federation client to handle streaming responses. (<a href="https://github.com/matrix-org/synapse/issues/8130">#8130</a>)</li>
<li>Micro-optimisations to <code>get_auth_chain_ids</code>. (<a href="https://github.com/matrix-org/synapse/issues/8132">#8132</a>)</li>
<li>Refactor <code>StreamIdGenerator</code> and <code>MultiWriterIdGenerator</code> to have the same interface. (<a href="https://github.com/matrix-org/synapse/issues/8161">#8161</a>)</li>
<li>Add functions to <code>MultiWriterIdGen</code> used by events stream. (<a href="https://github.com/matrix-org/synapse/issues/8164">#8164</a>, <a href="https://github.com/matrix-org/synapse/issues/8179">#8179</a>)</li>
<li>Fix tests that were broken due to the merge of 1.19.1. (<a href="https://github.com/matrix-org/synapse/issues/8167">#8167</a>)</li>
<li>Make <code>SlavedIdTracker.advance</code> have the same interface as <code>MultiWriterIDGenerator</code>. (<a href="https://github.com/matrix-org/synapse/issues/8171">#8171</a>)</li>
<li>Remove unused <code>is_guest</code> parameter from, and add safeguard to, <code>MessageHandler.get_room_data</code>. (<a href="https://github.com/matrix-org/synapse/issues/8174">#8174</a>, <a href="https://github.com/matrix-org/synapse/issues/8181">#8181</a>)</li>
<li>Standardize the mypy configuration. (<a href="https://github.com/matrix-org/synapse/issues/8175">#8175</a>)</li>
<li>Refactor some of <code>LoginRestServlet</code>'s helper methods, and move them to <code>AuthHandler</code> for easier reuse. (<a href="https://github.com/matrix-org/synapse/issues/8182">#8182</a>)</li>
<li>Fix <code>wait_for_stream_position</code> to allow multiple waiters on same stream ID. (<a href="https://github.com/matrix-org/synapse/issues/8196">#8196</a>)</li>
<li>Make <code>MultiWriterIDGenerator</code> work for streams that use negative values. (<a href="https://github.com/matrix-org/synapse/issues/8203">#8203</a>)</li>
<li>Refactor queries for device keys and cross-signatures. (<a href="https://github.com/matrix-org/synapse/issues/8204">#8204</a>, <a href="https://github.com/matrix-org/synapse/issues/8205">#8205</a>, <a href="https://github.com/matrix-org/synapse/issues/8222">#8222</a>, <a href="https://github.com/matrix-org/synapse/issues/8224">#8224</a>, <a href="https://github.com/matrix-org/synapse/issues/8225">#8225</a>, <a href="https://github.com/matrix-org/synapse/issues/8231">#8231</a>, <a href="https://github.com/matrix-org/synapse/issues/8233">#8233</a>, <a href="https://github.com/matrix-org/synapse/issues/8234">#8234</a>)</li>
<li>Fix type hints for functions decorated with <code>@cached</code>. (<a href="https://github.com/matrix-org/synapse/issues/8240">#8240</a>)</li>
<li>Remove obsolete <code>order</code> field from federation send queues. (<a href="https://github.com/matrix-org/synapse/issues/8245">#8245</a>)</li>
<li>Stop sub-classing from object. (<a href="https://github.com/matrix-org/synapse/issues/8249">#8249</a>)</li>
<li>Add more logging to debug slow startup. (<a href="https://github.com/matrix-org/synapse/issues/8264">#8264</a>)</li>
<li>Do not attempt to upgrade database schema on worker processes. (<a href="https://github.com/matrix-org/synapse/issues/8266">#8266</a>, <a href="https://github.com/matrix-org/synapse/issues/8276">#8276</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;09&#x2F;16&#x2F;synapse-1-19-2-released&#x2F;" title="Synapse 1.19.2 released">Synapse 1.19.2 released</a></h2>
                <span>
                    16.09.2020 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p><strong>Synapse 1.19.2 is a security patch. All federating instances should upgrade immediately.</strong></p>
<p>Today we are releasing Synapse 1.19.2, which is a security patch release containing a fix to encountering invalid events over federation. We are also putting out a fourth release candidate for the upcoming Synapse 1.20.0 release with the same fix.</p>
<p>The bug prevents affected Synapse instances from joining rooms with invalid events. Server administrators running federating instances are strongly encouraged to update as soon as possible.</p>
<p><strong>Those on Synapse 1.19.1 or earlier should upgrade to Synapse 1.19.2, while those who are running a release candidate of Synapse 1.20.0 should upgrade to 1.20.0rc4.</strong></p>
<p>Get the new releases from any of the usual sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md. 1.19.2 is on github <a href="https://github.com/matrix-org/synapse/releases/tag/v1.19.2">here</a>, and 1.20.0rc4 is <a href="https://github.com/matrix-org/synapse/releases/tag/v1.20.0rc4">here</a>.</p>
<p>The changelog for 1.19.2 is as follows:</p>
<h2 id="synapse-1-19-2-2020-09-16">Synapse 1.19.2 (2020-09-16)</h2>
<p>Due to the issue below server admins are encouraged to upgrade as soon as possible.
Bugfixes</p>
<ul>
<li>Fix joining rooms over federation that include malformed events. (#8324)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;08&#x2F;17&#x2F;synapse-1-19-0-released&#x2F;" title="Synapse 1.19.0 released">Synapse 1.19.0 released</a></h2>
                <span>
                    17.08.2020 00:00
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.19.0 is here and ready for action.</p>
<p>1.19.0 contains lots of async/await changes, 27 separate PRs to be precise(thanks Patrick). These changes will provide some level of performance improvement, but the real value to us is that it will improve our ability to profile Synapse more effectively.</p>
<p>It also features improved logging performance, this is in part to reduce IO but also to reduce the total amount logged. We’d be really interested to get some feedback on if the changes help. You may also want to take a look at our new logging defaults to see if they would help reduce total disk space usage.</p>
<p>Some admins will rejoice that we have added a <code>/health</code> end point to every configured HTTP listener which should make it easier to monitor multi-worker installs.</p>
<p>Finally 1.19.0 contains improvements to the Admin API allowing the admin to optionally purge rooms on deletion.</p>
<p>Get the new releases from any of the usual sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md. 1.19.0 is on github <a href="https://github.com/matrix-org/synapse/releases/tag/v1.19.0">here</a>.</p>
<p>Changelog for 1.19.0 follows:</p>
<h1 id="synapse-1-19-0-2020-08-17">Synapse 1.19.0 (2020-08-17)</h1>
<p>No significant changes since 1.19.0rc1.</p>
<h2 id="removal-warning">Removal warning</h2>
<p>As outlined in the <a href="https://github.com/matrix-org/synapse/releases/tag/v1.18.0">previous release</a>, we are no longer publishing Docker images with the <code>-py3</code> tag suffix. On top of that, we have also removed the <code>latest-py3</code> tag. Please see <a href="https://github.com/matrix-org/synapse/blob/develop/UPGRADE.rst#upgrading-to-v1180">the announcement in the upgrade notes for 1.18.0</a>.</p>
<h1 id="synapse-1-19-0rc1-2020-08-13">Synapse 1.19.0rc1 (2020-08-13)</h1>
<h2 id="features">Features</h2>
<ul>
<li>Add option to allow server admins to join rooms which fail complexity checks. Contributed by @lugino-emeritus. (<a href="https://github.com/matrix-org/synapse/issues/7902">#7902</a>)</li>
<li>Add an option to purge room or not with delete room admin endpoint (<code>POST /_synapse/admin/v1/rooms/&lt;room_id&gt;/delete</code>). Contributed by @dklimpel. (<a href="https://github.com/matrix-org/synapse/issues/7964">#7964</a>)</li>
<li>Add rate limiting to users joining rooms. (<a href="https://github.com/matrix-org/synapse/issues/8008">#8008</a>)</li>
<li>Add a <code>/health</code> endpoint to every configured HTTP listener that can be used as a health check endpoint by load balancers. (<a href="https://github.com/matrix-org/synapse/issues/8048">#8048</a>)</li>
<li>Allow login to be blocked based on the values of SAML attributes. (<a href="https://github.com/matrix-org/synapse/issues/8052">#8052</a>)</li>
<li>Allow guest access to the <code>GET /_matrix/client/r0/rooms/{room_id}/members</code> endpoint, according to MSC2689. Contributed by Awesome Technologies Innovationslabor GmbH. (<a href="https://github.com/matrix-org/synapse/issues/7314">#7314</a>)</li>
</ul>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Fix a bug introduced in Synapse v1.7.2 which caused inaccurate membership counts in the room directory. (<a href="https://github.com/matrix-org/synapse/issues/7977">#7977</a>)</li>
<li>Fix a long standing bug: 'Duplicate key value violates unique constraint &quot;event_relations_id&quot;' when message retention is configured. (<a href="https://github.com/matrix-org/synapse/issues/7978">#7978</a>)</li>
<li>Fix &quot;no create event in auth events&quot; when trying to reject invitation after inviter leaves. Bug introduced in Synapse v1.10.0. (<a href="https://github.com/matrix-org/synapse/issues/7980">#7980</a>)</li>
<li>Fix various comments and minor discrepancies in server notices code. (<a href="https://github.com/matrix-org/synapse/issues/7996">#7996</a>)</li>
<li>Fix a long standing bug where HTTP HEAD requests resulted in a 400 error. (<a href="https://github.com/matrix-org/synapse/issues/7999">#7999</a>)</li>
<li>Fix a long-standing bug which caused two copies of some log lines to be written when synctl was used along with a MemoryHandler logger. (<a href="https://github.com/matrix-org/synapse/issues/8011">#8011</a>, <a href="https://github.com/matrix-org/synapse/issues/8012">#8012</a>)</li>
</ul>
<h2 id="updates-to-the-docker-image">Updates to the Docker image</h2>
<ul>
<li>We no longer publish Docker images with the <code>-py3</code> tag suffix, as <a href="https://github.com/matrix-org/synapse/blob/develop/UPGRADE.rst#upgrading-to-v1180">announced in the upgrade notes</a>. (<a href="https://github.com/matrix-org/synapse/issues/8056">#8056</a>)</li>
</ul>
<h2 id="improved-documentation">Improved Documentation</h2>
<ul>
<li>Document how to set up a client .well-known file and fix several pieces of outdated documentation. (<a href="https://github.com/matrix-org/synapse/issues/7899">#7899</a>)</li>
<li>Improve workers docs. (<a href="https://github.com/matrix-org/synapse/issues/7990">#7990</a>, <a href="https://github.com/matrix-org/synapse/issues/8000">#8000</a>)</li>
<li>Fix typo in <code>docs/workers.md</code>. (<a href="https://github.com/matrix-org/synapse/issues/7992">#7992</a>)</li>
<li>Add documentation for how to undo a room shutdown. (<a href="https://github.com/matrix-org/synapse/issues/7998">#7998</a>, <a href="https://github.com/matrix-org/synapse/issues/8010">#8010</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Reduce the amount of whitespace in JSON stored and sent in responses. Contributed by David Vo. (<a href="https://github.com/matrix-org/synapse/issues/7372">#7372</a>)</li>
<li>Switch to the JSON implementation from the standard library and bump the minimum version of the canonicaljson library to 1.2.0. (<a href="https://github.com/matrix-org/synapse/issues/7936">#7936</a>, <a href="https://github.com/matrix-org/synapse/issues/7979">#7979</a>)</li>
<li>Convert various parts of the codebase to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7947">#7947</a>, <a href="https://github.com/matrix-org/synapse/issues/7948">#7948</a>, <a href="https://github.com/matrix-org/synapse/issues/7949">#7949</a>, <a href="https://github.com/matrix-org/synapse/issues/7951">#7951</a>, <a href="https://github.com/matrix-org/synapse/issues/7963">#7963</a>, <a href="https://github.com/matrix-org/synapse/issues/7973">#7973</a>, <a href="https://github.com/matrix-org/synapse/issues/7975">#7975</a>, <a href="https://github.com/matrix-org/synapse/issues/7976">#7976</a>, <a href="https://github.com/matrix-org/synapse/issues/7981">#7981</a>, <a href="https://github.com/matrix-org/synapse/issues/7987">#7987</a>, <a href="https://github.com/matrix-org/synapse/issues/7989">#7989</a>, <a href="https://github.com/matrix-org/synapse/issues/8003">#8003</a>, <a href="https://github.com/matrix-org/synapse/issues/8014">#8014</a>, <a href="https://github.com/matrix-org/synapse/issues/8016">#8016</a>, <a href="https://github.com/matrix-org/synapse/issues/8027">#8027</a>, <a href="https://github.com/matrix-org/synapse/issues/8031">#8031</a>, <a href="https://github.com/matrix-org/synapse/issues/8032">#8032</a>, <a href="https://github.com/matrix-org/synapse/issues/8035">#8035</a>, <a href="https://github.com/matrix-org/synapse/issues/8042">#8042</a>, <a href="https://github.com/matrix-org/synapse/issues/8044">#8044</a>, <a href="https://github.com/matrix-org/synapse/issues/8045">#8045</a>, <a href="https://github.com/matrix-org/synapse/issues/8061">#8061</a>, <a href="https://github.com/matrix-org/synapse/issues/8062">#8062</a>, <a href="https://github.com/matrix-org/synapse/issues/8063">#8063</a>, <a href="https://github.com/matrix-org/synapse/issues/8066">#8066</a>, <a href="https://github.com/matrix-org/synapse/issues/8069">#8069</a>, <a href="https://github.com/matrix-org/synapse/issues/8070">#8070</a>)</li>
<li>Move some database-related log lines from the default logger to the database/transaction loggers. (<a href="https://github.com/matrix-org/synapse/issues/7952">#7952</a>)</li>
<li>Add a script to detect source code files using non-unix line terminators. (<a href="https://github.com/matrix-org/synapse/issues/7965">#7965</a>, <a href="https://github.com/matrix-org/synapse/issues/7970">#7970</a>)</li>
<li>Log the SAML session ID during creation. (<a href="https://github.com/matrix-org/synapse/issues/7971">#7971</a>)</li>
<li>Implement new experimental push rules for some users. (<a href="https://github.com/matrix-org/synapse/issues/7997">#7997</a>)</li>
<li>Remove redundant and unreliable signature check for v1 Identity Service lookup responses. (<a href="https://github.com/matrix-org/synapse/issues/8001">#8001</a>)</li>
<li>Improve the performance of the register endpoint. (<a href="https://github.com/matrix-org/synapse/issues/8009">#8009</a>)</li>
<li>Reduce less useful output in the newsfragment CI step. Add a link to the changelog section of the contributing guide on error. (<a href="https://github.com/matrix-org/synapse/issues/8024">#8024</a>)</li>
<li>Rename storage layer objects to be more sensible. (<a href="https://github.com/matrix-org/synapse/issues/8033">#8033</a>)</li>
<li>Change the default log config to reduce disk I/O and storage for new servers. (<a href="https://github.com/matrix-org/synapse/issues/8040">#8040</a>)</li>
<li>Add an assertion on <code>prev_events</code> in <code>create_new_client_event</code>. (<a href="https://github.com/matrix-org/synapse/issues/8041">#8041</a>)</li>
<li>Add a comment to <code>ServerContextFactory</code> about the use of <code>SSLv23_METHOD</code>. (<a href="https://github.com/matrix-org/synapse/issues/8043">#8043</a>)</li>
<li>Log <code>OPTIONS</code> requests at <code>DEBUG</code> rather than <code>INFO</code> level to reduce amount logged at <code>INFO</code>. (<a href="https://github.com/matrix-org/synapse/issues/8049">#8049</a>)</li>
<li>Reduce amount of outbound request logging at <code>INFO</code> level. (<a href="https://github.com/matrix-org/synapse/issues/8050">#8050</a>)</li>
<li>It is no longer necessary to explicitly define <code>filters</code> in the logging configuration. (Continuing to do so is redundant but harmless.) (<a href="https://github.com/matrix-org/synapse/issues/8051">#8051</a>)</li>
<li>Add and improve type hints. (<a href="https://github.com/matrix-org/synapse/issues/8058">#8058</a>, <a href="https://github.com/matrix-org/synapse/issues/8064">#8064</a>, <a href="https://github.com/matrix-org/synapse/issues/8060">#8060</a>, <a href="https://github.com/matrix-org/synapse/issues/8067">#8067</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;07&#x2F;30&#x2F;synapse-1-18-0-released&#x2F;" title="Synapse 1.18.0 released">Synapse 1.18.0 released</a></h2>
                <span>
                    30.07.2020 18:34
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.18.0 has landed.</p>
<p>The most important thing to know about 1.18.0 is that it contains support for sharding multiple workers. Specifically this means being able to run multiple federation senders, multiple client readers to handle registration and multiple push workers. This will be important for anyone running a large scale install of Synapse. You can read more about how to benefit from these changes in <a href="https://github.com/matrix-org/synapse/blob/develop/docs/workers.md">docs/workers.md</a>. In the same spirit we also moved typing notifications from the main process.</p>
<p>Aside from that, we have new admin API support to list the users in a room, support for oEmbed for media previews (you can unfurl tweets again!) and a general slew of federation bug fixes.</p>
<p>Get the new releases from any of the usual sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md. 1.18.0 is on github <a href="https://github.com/matrix-org/synapse/releases/tag/v1.18.0">here</a>.</p>
<p>Changelog for 1.18.0 follows:</p>
<h1 id="synapse-1-18-0-2020-07-30">Synapse 1.18.0 (2020-07-30)</h1>
<h2 id="improved-documentation">Improved Documentation</h2>
<ul>
<li>Update worker docs with latest enhancements. (<a href="https://github.com/matrix-org/synapse/issues/7969">#7969</a>)</li>
</ul>
<h1 id="synapse-1-18-0rc2-2020-07-28">Synapse 1.18.0rc2 (2020-07-28)</h1>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Fix an <code>AssertionError</code> exception introduced in v1.18.0rc1. (<a href="https://github.com/matrix-org/synapse/issues/7876">#7876</a>)</li>
<li>Fix experimental support for moving typing off master when worker is restarted, which is broken in v1.18.0rc1. (<a href="https://github.com/matrix-org/synapse/issues/7967">#7967</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Further optimise queueing of inbound replication commands. (<a href="https://github.com/matrix-org/synapse/issues/7876">#7876</a>)</li>
</ul>
<h1 id="synapse-1-18-0rc1-2020-07-27">Synapse 1.18.0rc1 (2020-07-27)</h1>
<h2 id="features">Features</h2>
<ul>
<li>Include room states on invite events that are sent to application services. Contributed by @Sorunome. (<a href="https://github.com/matrix-org/synapse/issues/6455">#6455</a>)</li>
<li>Add delete room admin endpoint (<code>POST /_synapse/admin/v1/rooms/&lt;room_id&gt;/delete</code>). Contributed by @dklimpel. (<a href="https://github.com/matrix-org/synapse/issues/7613">#7613</a>, <a href="https://github.com/matrix-org/synapse/issues/7953">#7953</a>)</li>
<li>Add experimental support for running multiple federation sender processes. (<a href="https://github.com/matrix-org/synapse/issues/7798">#7798</a>)</li>
<li>Add the option to validate the <code>iss</code> and <code>aud</code> claims for JWT logins. (<a href="https://github.com/matrix-org/synapse/issues/7827">#7827</a>)</li>
<li>Add support for handling registration requests across multiple client reader workers. (<a href="https://github.com/matrix-org/synapse/issues/7830">#7830</a>)</li>
<li>Add an admin API to list the users in a room. Contributed by Awesome Technologies Innovationslabor GmbH. (<a href="https://github.com/matrix-org/synapse/issues/7842">#7842</a>)</li>
<li>Allow email subjects to be customised through Synapse's configuration. (<a href="https://github.com/matrix-org/synapse/issues/7846">#7846</a>)</li>
<li>Add the ability to re-activate an account from the admin API. (<a href="https://github.com/matrix-org/synapse/issues/7847">#7847</a>, <a href="https://github.com/matrix-org/synapse/issues/7908">#7908</a>)</li>
<li>Add experimental support for running multiple pusher workers. (<a href="https://github.com/matrix-org/synapse/issues/7855">#7855</a>)</li>
<li>Add experimental support for moving typing off master. (<a href="https://github.com/matrix-org/synapse/issues/7869">#7869</a>, <a href="https://github.com/matrix-org/synapse/issues/7959">#7959</a>)</li>
<li>Report CPU metrics to prometheus for time spent processing replication commands. (<a href="https://github.com/matrix-org/synapse/issues/7879">#7879</a>)</li>
<li>Support oEmbed for media previews. (<a href="https://github.com/matrix-org/synapse/issues/7920">#7920</a>)</li>
<li>Abort federation requests where the client disconnects before the ratelimiter expires. (<a href="https://github.com/matrix-org/synapse/issues/7930">#7930</a>)</li>
<li>Cache responses to <code>/_matrix/federation/v1/state_ids</code> to reduce duplicated work. (<a href="https://github.com/matrix-org/synapse/issues/7931">#7931</a>)</li>
</ul>
<h2 id="bugfixes-1">Bugfixes</h2>
<ul>
<li>Fix detection of out of sync remote device lists when receiving events from remote users. (<a href="https://github.com/matrix-org/synapse/issues/7815">#7815</a>)</li>
<li>Fix bug where Synapse fails to process an incoming event over federation if the server is missing too much of the event's auth chain. (<a href="https://github.com/matrix-org/synapse/issues/7817">#7817</a>)</li>
<li>Fix a bug causing Synapse to misinterpret the value <code>off</code> for <code>encryption_enabled_by_default_for_room_type</code> in its configuration file(s) if that value isn't surrounded by quotes. This bug was introduced in v1.16.0. (<a href="https://github.com/matrix-org/synapse/issues/7822">#7822</a>)</li>
<li>Fix bug where we did not always pass in <code>app_name</code> or <code>server_name</code> to email templates, including e.g. for registration emails. (<a href="https://github.com/matrix-org/synapse/issues/7829">#7829</a>)</li>
<li>Errors which occur while using the non-standard JWT login now return the proper error: <code>403 Forbidden</code> with an error code of <code>M_FORBIDDEN</code>. (<a href="https://github.com/matrix-org/synapse/issues/7844">#7844</a>)</li>
<li>Fix &quot;AttributeError: 'str' object has no attribute 'get'&quot; error message when applying per-room message retention policies. The bug was introduced in Synapse 1.7.0. (<a href="https://github.com/matrix-org/synapse/issues/7850">#7850</a>)</li>
<li>Fix a bug introduced in Synapse 1.10.0 which could cause a &quot;no create event in auth events&quot; error during room creation. (<a href="https://github.com/matrix-org/synapse/issues/7854">#7854</a>)</li>
<li>Fix a bug which allowed empty rooms to be rejoined over federation. (<a href="https://github.com/matrix-org/synapse/issues/7859">#7859</a>)</li>
<li>Fix 'Unable to find a suitable guest user ID' error when using multiple client_reader workers. (<a href="https://github.com/matrix-org/synapse/issues/7866">#7866</a>)</li>
<li>Fix a long standing bug where the tracing of async functions with opentracing was broken. (<a href="https://github.com/matrix-org/synapse/issues/7872">#7872</a>, <a href="https://github.com/matrix-org/synapse/issues/7961">#7961</a>)</li>
<li>Fix &quot;TypeError in <code>synapse.notifier</code>&quot; exceptions. (<a href="https://github.com/matrix-org/synapse/issues/7880">#7880</a>)</li>
<li>Fix deprecation warning due to invalid escape sequences. (<a href="https://github.com/matrix-org/synapse/issues/7895">#7895</a>)</li>
</ul>
<h2 id="updates-to-the-docker-image">Updates to the Docker image</h2>
<ul>
<li>Base docker image on Debian Buster rather than Alpine Linux. Contributed by @maquis196. (<a href="https://github.com/matrix-org/synapse/issues/7839">#7839</a>)</li>
</ul>
<h2 id="improved-documentation-1">Improved Documentation</h2>
<ul>
<li>Provide instructions on using <code>register_new_matrix_user</code> via docker. (<a href="https://github.com/matrix-org/synapse/issues/7885">#7885</a>)</li>
<li>Change the sample config postgres user section to use <code>synapse_user</code> instead of <code>synapse</code> to align with the documentation. (<a href="https://github.com/matrix-org/synapse/issues/7889">#7889</a>)</li>
<li>Reorder database paragraphs to promote postgres over sqlite. (<a href="https://github.com/matrix-org/synapse/issues/7933">#7933</a>)</li>
<li>Update the dates of ACME v1's end of life in <a href="https://github.com/matrix-org/synapse/blob/master/docs/ACME.md"><code>ACME.md</code></a>. (<a href="https://github.com/matrix-org/synapse/issues/7934">#7934</a>)</li>
</ul>
<h2 id="deprecations-and-removals">Deprecations and Removals</h2>
<ul>
<li>Remove unused <code>synapse_replication_tcp_resource_invalidate_cache</code> prometheus metric. (<a href="https://github.com/matrix-org/synapse/issues/7878">#7878</a>)</li>
<li>Remove Ubuntu Eoan from the list of <code>.deb</code> packages that we build as it is now end-of-life. Contributed by @gary-kim. (<a href="https://github.com/matrix-org/synapse/issues/7888">#7888</a>)</li>
</ul>
<h2 id="internal-changes-1">Internal Changes</h2>
<ul>
<li>Switch parts of the codebase from <code>simplejson</code> to the standard library <code>json</code>. (<a href="https://github.com/matrix-org/synapse/issues/7802">#7802</a>)</li>
<li>Add type hints to the http server code and remove an unused parameter. (<a href="https://github.com/matrix-org/synapse/issues/7813">#7813</a>)</li>
<li>Add type hints to synapse.api.errors module. (<a href="https://github.com/matrix-org/synapse/issues/7820">#7820</a>)</li>
<li>Ensure that calls to <code>json.dumps</code> are compatible with the standard library json. (<a href="https://github.com/matrix-org/synapse/issues/7836">#7836</a>)</li>
<li>Remove redundant <code>retry_on_integrity_error</code> wrapper for event persistence code. (<a href="https://github.com/matrix-org/synapse/issues/7848">#7848</a>)</li>
<li>Consistently use <code>db_to_json</code> to convert from database values to JSON objects. (<a href="https://github.com/matrix-org/synapse/issues/7849">#7849</a>)</li>
<li>Convert various parts of the codebase to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7851">#7851</a>, <a href="https://github.com/matrix-org/synapse/issues/7860">#7860</a>, <a href="https://github.com/matrix-org/synapse/issues/7868">#7868</a>, <a href="https://github.com/matrix-org/synapse/issues/7871">#7871</a>, <a href="https://github.com/matrix-org/synapse/issues/7873">#7873</a>, <a href="https://github.com/matrix-org/synapse/issues/7874">#7874</a>, <a href="https://github.com/matrix-org/synapse/issues/7884">#7884</a>, <a href="https://github.com/matrix-org/synapse/issues/7912">#7912</a>, <a href="https://github.com/matrix-org/synapse/issues/7935">#7935</a>, <a href="https://github.com/matrix-org/synapse/issues/7939">#7939</a>, <a href="https://github.com/matrix-org/synapse/issues/7942">#7942</a>, <a href="https://github.com/matrix-org/synapse/issues/7944">#7944</a>)</li>
<li>Add support for handling registration requests across multiple client reader workers. (<a href="https://github.com/matrix-org/synapse/issues/7853">#7853</a>)</li>
<li>Small performance improvement in typing processing. (<a href="https://github.com/matrix-org/synapse/issues/7856">#7856</a>)</li>
<li>The default value of <code>filter_timeline_limit</code> was changed from -1 (no limit) to 100. (<a href="https://github.com/matrix-org/synapse/issues/7858">#7858</a>)</li>
<li>Optimise queueing of inbound replication commands. (<a href="https://github.com/matrix-org/synapse/issues/7861">#7861</a>)</li>
<li>Add some type annotations to <code>HomeServer</code> and <code>BaseHandler</code>. (<a href="https://github.com/matrix-org/synapse/issues/7870">#7870</a>)</li>
<li>Clean up <code>PreserveLoggingContext</code>. (<a href="https://github.com/matrix-org/synapse/issues/7877">#7877</a>)</li>
<li>Change &quot;unknown room version&quot; logging from 'error' to 'warning'. (<a href="https://github.com/matrix-org/synapse/issues/7881">#7881</a>)</li>
<li>Stop using <code>device_max_stream_id</code> table and just use <code>device_inbox.stream_id</code>. (<a href="https://github.com/matrix-org/synapse/issues/7882">#7882</a>)</li>
<li>Return an empty body for OPTIONS requests. (<a href="https://github.com/matrix-org/synapse/issues/7886">#7886</a>)</li>
<li>Fix typo in generated config file. Contributed by @ThiefMaster. (<a href="https://github.com/matrix-org/synapse/issues/7890">#7890</a>)</li>
<li>Import ABC from <code>collections.abc</code> for Python 3.10 compatibility. (<a href="https://github.com/matrix-org/synapse/issues/7892">#7892</a>)</li>
<li>Remove unused functions <code>time_function</code>, <code>trace_function</code>, <code>get_previous_frames</code>
and <code>get_previous_frame</code> from <code>synapse.logging.utils</code> module. (<a href="https://github.com/matrix-org/synapse/issues/7897">#7897</a>)</li>
<li>Lint the <code>contrib/</code> directory in CI and linting scripts, add <code>synctl</code> to the linting script for consistency with CI. (<a href="https://github.com/matrix-org/synapse/issues/7914">#7914</a>)</li>
<li>Use Element CSS and logo in notification emails when app name is Element. (<a href="https://github.com/matrix-org/synapse/issues/7919">#7919</a>)</li>
<li>Optimisation to /sync handling: skip serializing the response if the client has already disconnected. (<a href="https://github.com/matrix-org/synapse/issues/7927">#7927</a>)</li>
<li>When a client disconnects, don't log it as 'Error processing request'. (<a href="https://github.com/matrix-org/synapse/issues/7928">#7928</a>)</li>
<li>Add debugging to <code>/sync</code> response generation (disabled by default). (<a href="https://github.com/matrix-org/synapse/issues/7929">#7929</a>)</li>
<li>Update comments that refer to Deferreds for async functions. (<a href="https://github.com/matrix-org/synapse/issues/7945">#7945</a>)</li>
<li>Simplify error handling in federation handler. (<a href="https://github.com/matrix-org/synapse/issues/7950">#7950</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;07&#x2F;13&#x2F;synapse-1-17-0-released&#x2F;" title="Synapse 1.17.0 released">Synapse 1.17.0 released</a></h2>
                <span>
                    13.07.2020 16:38
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                <br>
                <small>Last update: 13.07.2020 16:21</small>
            </header>
            <div>
                
                <p>Synapse 1.17.0 is here!</p>
<p>Hot on the heels of Synapse 1.16.1, 1.17.0 is a bug fix release most notably containing a fix for <a href="https://github.com/matrix-org/synapse/issues/2181">'stuck invites'</a> which happen when we are unable to reject a room invite received over federation.</p>
<p>Get the new releases from any of the usual sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md. 1.17.0 is on github <a href="https://github.com/matrix-org/synapse/releases/tag/v1.17.0">here</a>.</p>
<p>Changelog for 1.17.0 follows:</p>
<h1 id="synapse-1-17-0-2020-07-13">Synapse 1.17.0 (2020-07-13)</h1>
<p>Synapse 1.17.0 is identical to 1.17.0rc1, with the addition of the fix that was included in <a href="https://github.com/matrix-org/synapse/releases/v1.16.1">1.16.1</a>.</p>
<h1 id="synapse-1-17-0rc1-2020-07-09">Synapse 1.17.0rc1 (2020-07-09)</h1>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Fix inconsistent handling of upper and lower case in email addresses when used as identifiers for login, etc. Contributed by @dklimpel. (<a href="https://github.com/matrix-org/synapse/issues/7021">#7021</a>)</li>
<li>Fix &quot;Tried to close a non-active scope!&quot; error messages when opentracing is enabled. (<a href="https://github.com/matrix-org/synapse/issues/7732">#7732</a>)</li>
<li>Fix incorrect error message when database CTYPE was set incorrectly. (<a href="https://github.com/matrix-org/synapse/issues/7760">#7760</a>)</li>
<li>Fix to not ignore <code>set_tweak</code> actions in Push Rules that have no <code>value</code>, as permitted by the specification. (<a href="https://github.com/matrix-org/synapse/issues/7766">#7766</a>)</li>
<li>Fix synctl to handle empty config files correctly. Contributed by @kotovalexarian. (<a href="https://github.com/matrix-org/synapse/issues/7779">#7779</a>)</li>
<li>Fixes a long standing bug in worker mode where worker information was saved in the devices table instead of the original IP address and user agent. (<a href="https://github.com/matrix-org/synapse/issues/7797">#7797</a>)</li>
<li>Fix 'stuck invites' which happen when we are unable to reject a room invite received over federation. (<a href="https://github.com/matrix-org/synapse/issues/7804">#7804</a>, <a href="https://github.com/matrix-org/synapse/issues/7809">#7809</a>, <a href="https://github.com/matrix-org/synapse/issues/7810">#7810</a>)</li>
</ul>
<h2 id="updates-to-the-docker-image">Updates to the Docker image</h2>
<ul>
<li>Include libwebp in the Docker file to properly handle webp image uploads. (<a href="https://github.com/matrix-org/synapse/issues/7791">#7791</a>)</li>
</ul>
<h2 id="improved-documentation">Improved Documentation</h2>
<ul>
<li>Improve the documentation of the non-standard JSON web token login type. (<a href="https://github.com/matrix-org/synapse/issues/7776">#7776</a>)</li>
<li>Update doc links for caddy. Contributed by Nicolai Søborg. (<a href="https://github.com/matrix-org/synapse/issues/7789">#7789</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Refactor getting replication updates from database. (<a href="https://github.com/matrix-org/synapse/issues/7740">#7740</a>)</li>
<li>Send push notifications with a high or low priority depending upon whether they may generate user-observable effects. (<a href="https://github.com/matrix-org/synapse/issues/7765">#7765</a>)</li>
<li>Use symbolic names for replication stream names. (<a href="https://github.com/matrix-org/synapse/issues/7768">#7768</a>)</li>
<li>Add early returns to <code>_check_for_soft_fail</code>. (<a href="https://github.com/matrix-org/synapse/issues/7769">#7769</a>)</li>
<li>Fix up <code>synapse.handlers.federation</code> to pass mypy. (<a href="https://github.com/matrix-org/synapse/issues/7770">#7770</a>)</li>
<li>Convert the appserver handler to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7775">#7775</a>)</li>
<li>Allow to use higher versions of prometheus_client &lt;0.9.0 which are expected to introduce no breaking changes. Contributed by Oliver Kurz. (<a href="https://github.com/matrix-org/synapse/issues/7780">#7780</a>)</li>
<li>Update linting scripts and codebase to be compatible with <code>isort</code> v5. (<a href="https://github.com/matrix-org/synapse/issues/7786">#7786</a>)</li>
<li>Stop populating unused table <code>local_invites</code>. (<a href="https://github.com/matrix-org/synapse/issues/7793">#7793</a>)</li>
<li>Ensure that strings (not bytes) are passed into JSON serialization. (<a href="https://github.com/matrix-org/synapse/issues/7799">#7799</a>)</li>
<li>Switch from simplejson to the standard library json. (<a href="https://github.com/matrix-org/synapse/issues/7800">#7800</a>)</li>
<li>Add <code>signing_key</code> property to <code>HomeServer</code> to save code duplication. (<a href="https://github.com/matrix-org/synapse/issues/7805">#7805</a>)</li>
<li>Improve stacktraces from exceptions in background processes. (<a href="https://github.com/matrix-org/synapse/issues/7808">#7808</a>)</li>
<li>Fix various spelling errors in comments and log lines. (<a href="https://github.com/matrix-org/synapse/issues/7811">#7811</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;07&#x2F;08&#x2F;synapse-1-16-0-released&#x2F;" title="Synapse 1.16.0 released">Synapse 1.16.0 released</a></h2>
                <span>
                    08.07.2020 19:18
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                <br>
                <small>Last update: 08.07.2020 14:45</small>
            </header>
            <div>
                
                <p>Synapse 1.16.0 is here!</p>
<p>Notable additions in 1.16.0 include:-</p>
<ul>
<li>An important performance fix to improve room state resolution.</li>
<li>An option to enable e2e by default for new rooms.</li>
<li>Ability to run multiple media repo workers side by side.</li>
<li>Ability to mark specific content as being safe from quarantine.</li>
<li>Bug fixes to make migrating from SQLite to Postgres more reliable - if you are running sqlite for anything other than evaluation purposes then please migrate!</li>
</ul>
<p>Note, we have deprecated the <code>m.login.jwt</code> login method in favour of <code>org.matrix.login.jwt</code> see the changelog for more details.</p>
<p>Enjoy!</p>
<p>Get the new releases from any of the usual sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md. 1.16.0 is on github <a href="https://github.com/matrix-org/synapse/releases/tag/v1.16.0">here</a>.</p>
<p>Changelog for 1.16.0 follows:</p>
<h1 id="synapse-1-16-0-2020-07-08">Synapse 1.16.0 (2020-07-08)</h1>
<p>No significant changes since 1.16.0rc2.</p>
<p>Note that this release deprecates the <code>m.login.jwt</code> login method, renaming it to <code>org.matrix.login.jwt</code>, as <code>m.login.jwt</code> is not part of the Matrix spec. Otherwise the behaviour is identical. Synapse will accept both names for now, but this may change in a future release.</p>
<h1 id="synapse-1-16-0rc2-2020-07-02">Synapse 1.16.0rc2 (2020-07-02)</h1>
<p>Synapse 1.16.0rc2 includes the security fixes released with Synapse 1.15.2.
Please see the <a href="https://github.com/matrix-org/synapse/releases/tag/v1.15.2">1.15.2 release notes</a> for more details.</p>
<h2 id="improved-documentation">Improved Documentation</h2>
<ul>
<li>Update postgres image in example <code>docker-compose.yaml</code> to tag <code>12-alpine</code>. (<a href="https://github.com/matrix-org/synapse/issues/7696">#7696</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Add some metrics for inbound and outbound federation latencies: <code>synapse_federation_server_pdu_process_time</code> and <code>synapse_event_processing_lag_by_event</code>. (<a href="https://github.com/matrix-org/synapse/issues/7771">#7771</a>)</li>
</ul>
<h1 id="synapse-1-16-0rc1-2020-07-01">Synapse 1.16.0rc1 (2020-07-01)</h1>
<h2 id="features">Features</h2>
<ul>
<li>Add an option to enable encryption by default for new rooms. (<a href="https://github.com/matrix-org/synapse/issues/7639">#7639</a>)</li>
<li>Add support for running multiple media repository workers. See <a href="https://github.com/matrix-org/synapse/blob/release-v1.16.0/docs/workers.md">docs/workers.md</a> for instructions. (<a href="https://github.com/matrix-org/synapse/issues/7706">#7706</a>)</li>
<li>Media can now be marked as safe from quarantined. (<a href="https://github.com/matrix-org/synapse/issues/7718">#7718</a>)</li>
<li>Expand the configuration options for auto-join rooms. (<a href="https://github.com/matrix-org/synapse/issues/7763">#7763</a>)</li>
</ul>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Remove <code>user_id</code> from the response to <code>GET /_matrix/client/r0/presence/{userId}/status</code> to match the specification. (<a href="https://github.com/matrix-org/synapse/issues/7606">#7606</a>)</li>
<li>In worker mode, ensure that replicated data has not already been received. (<a href="https://github.com/matrix-org/synapse/issues/7648">#7648</a>)</li>
<li>Fix intermittent exception during startup, introduced in Synapse 1.14.0. (<a href="https://github.com/matrix-org/synapse/issues/7663">#7663</a>)</li>
<li>Include a user-agent for federation and well-known requests. (<a href="https://github.com/matrix-org/synapse/issues/7677">#7677</a>)</li>
<li>Accept the proper field (<code>phone</code>) for the <code>m.id.phone</code> identifier type. The legacy field of <code>number</code> is still accepted as a fallback. Bug introduced in v0.20.0. (<a href="https://github.com/matrix-org/synapse/issues/7687">#7687</a>)</li>
<li>Fix &quot;Starting db txn 'get_completed_ui_auth_stages' from sentinel context&quot; warning. The bug was introduced in 1.13.0. (<a href="https://github.com/matrix-org/synapse/issues/7688">#7688</a>)</li>
<li>Compare the URI and method during user interactive authentication (instead of the URI twice). Bug introduced in 1.13.0. (<a href="https://github.com/matrix-org/synapse/issues/7689">#7689</a>)</li>
<li>Fix a long standing bug where the response to the <code>GET room_keys/version</code> endpoint had the incorrect type for the <code>etag</code> field. (<a href="https://github.com/matrix-org/synapse/issues/7691">#7691</a>)</li>
<li>Fix logged error during device resync in opentracing. Broke in v1.14.0. (<a href="https://github.com/matrix-org/synapse/issues/7698">#7698</a>)</li>
<li>Do not break push rule evaluation when receiving an event with a non-string body. This is a long-standing bug. (<a href="https://github.com/matrix-org/synapse/issues/7701">#7701</a>)</li>
<li>Fixs a long standing bug which resulted in an exception: &quot;TypeError: argument of type 'ObservableDeferred' is not iterable&quot;. (<a href="https://github.com/matrix-org/synapse/issues/7708">#7708</a>)</li>
<li>The <code>synapse_port_db</code> script no longer fails when the <code>ui_auth_sessions</code> table is non-empty. This bug has existed since v1.13.0. (<a href="https://github.com/matrix-org/synapse/issues/7711">#7711</a>)</li>
<li>Synapse will now fetch media from the proper specified URL (using the r0 prefix instead of the unspecified v1). (<a href="https://github.com/matrix-org/synapse/issues/7714">#7714</a>)</li>
<li>Fix the tables ignored by <code>synapse_port_db</code> to be in sync the current database schema. (<a href="https://github.com/matrix-org/synapse/issues/7717">#7717</a>)</li>
<li>Fix missing <code>Content-Length</code> on HTTP responses from the metrics handler. (<a href="https://github.com/matrix-org/synapse/issues/7730">#7730</a>)</li>
<li>Fix large state resolutions from stalling Synapse for seconds at a time. (<a href="https://github.com/matrix-org/synapse/issues/7735">#7735</a>, <a href="https://github.com/matrix-org/synapse/issues/7746">#7746</a>)</li>
</ul>
<h2 id="improved-documentation-1">Improved Documentation</h2>
<ul>
<li>Spelling correction in sample_config.yaml. (<a href="https://github.com/matrix-org/synapse/issues/7652">#7652</a>)</li>
<li>Added instructions for how to use Keycloak via OpenID Connect to authenticate with Synapse. (<a href="https://github.com/matrix-org/synapse/issues/7659">#7659</a>)</li>
<li>Corrected misspelling of PostgreSQL. (<a href="https://github.com/matrix-org/synapse/issues/7724">#7724</a>)</li>
</ul>
<h2 id="deprecations-and-removals">Deprecations and Removals</h2>
<ul>
<li>Deprecate <code>m.login.jwt</code> login method in favour of <code>org.matrix.login.jwt</code>, as <code>m.login.jwt</code> is not part of the Matrix spec. (<a href="https://github.com/matrix-org/synapse/issues/7675">#7675</a>)</li>
</ul>
<h2 id="internal-changes-1">Internal Changes</h2>
<ul>
<li>Refactor getting replication updates from database. (<a href="https://github.com/matrix-org/synapse/issues/7636">#7636</a>)</li>
<li>Clean-up the login fallback code. (<a href="https://github.com/matrix-org/synapse/issues/7657">#7657</a>)</li>
<li>Increase the default SAML session expiry time to 15 minutes. (<a href="https://github.com/matrix-org/synapse/issues/7664">#7664</a>)</li>
<li>Convert the device message and pagination handlers to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7678">#7678</a>)</li>
<li>Convert typing handler to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7679">#7679</a>)</li>
<li>Require <code>parameterized</code> package version to be at least 0.7.0. (<a href="https://github.com/matrix-org/synapse/issues/7680">#7680</a>)</li>
<li>Refactor handling of <code>listeners</code> configuration settings. (<a href="https://github.com/matrix-org/synapse/issues/7681">#7681</a>)</li>
<li>Replace uses of <code>six.iterkeys</code>/<code>iteritems</code>/<code>itervalues</code> with <code>keys()</code>/<code>items()</code>/<code>values()</code>. (<a href="https://github.com/matrix-org/synapse/issues/7692">#7692</a>)</li>
<li>Add support for using <code>rust-python-jaeger-reporter</code> library to reduce jaeger tracing overhead. (<a href="https://github.com/matrix-org/synapse/issues/7697">#7697</a>)</li>
<li>Make Tox actions work on Debian 10. (<a href="https://github.com/matrix-org/synapse/issues/7703">#7703</a>)</li>
<li>Replace all remaining uses of <code>six</code> with native Python 3 equivalents. Contributed by @ilmari. (<a href="https://github.com/matrix-org/synapse/issues/7704">#7704</a>)</li>
<li>Fix broken link in sample config. (<a href="https://github.com/matrix-org/synapse/issues/7712">#7712</a>)</li>
<li>Speed up state res v2 across large state differences. (<a href="https://github.com/matrix-org/synapse/issues/7725">#7725</a>)</li>
<li>Convert directory handler to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7727">#7727</a>)</li>
<li>Move <code>flake8</code> to the end of <code>scripts-dev/lint.sh</code> as it takes the longest and could cause the script to exit early. (<a href="https://github.com/matrix-org/synapse/issues/7738">#7738</a>)</li>
<li>Explain the &quot;test&quot; conditional requirement for dependencies is not all of the modules necessary to run the unit tests. (<a href="https://github.com/matrix-org/synapse/issues/7751">#7751</a>)</li>
<li>Add some metrics for inbound and outbound federation latencies: <code>synapse_federation_server_pdu_process_time</code> and <code>synapse_event_processing_lag_by_event</code>. (<a href="https://github.com/matrix-org/synapse/issues/7755">#7755</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;06&#x2F;16&#x2F;synapse-1-15-1-released&#x2F;" title="Synapse 1.15.1 released">Synapse 1.15.1 released</a></h2>
                <span>
                    16.06.2020 12:25
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.15.1 is a bug fix release to fix two bugs introduced in 1.15.0.</p>
<p>The first prevented users of certain clients (including Riot) to add or remove third party identifiers such as email addresses.</p>
<p>The second caused Synapse not to start when configured with certain password auth providers.</p>
<p>Sorry if you have been bitten!</p>
<p>Get 1.15.1 from <a href="https://github.com/matrix-org/synapse/releases/tag/v1.15.1">github</a> or any of the sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md.</p>
<p>Changelog since v1.15.0</p>
<h1 id="synapse-1-15-1-2020-06-16">Synapse 1.15.1 (2020-06-16)</h1>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Fix a bug introduced in v1.15.0 that would crash Synapse on start when using certain password auth providers. (<a href="https://github.com/matrix-org/synapse/issues/7684">#7684</a>)</li>
<li>Fix a bug introduced in v1.15.0 which meant that some 3PID management endpoints were not accessible on the correct URL. (<a href="https://github.com/matrix-org/synapse/issues/7685">#7685</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;06&#x2F;11&#x2F;synapse-1-15-0-released&#x2F;" title="Synapse 1.15.0 released">Synapse 1.15.0 released</a></h2>
                <span>
                    11.06.2020 18:27
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                
            </header>
            <div>
                
                <p>Synapse 1.15.0 release day folks.</p>
<p>We continue our push to improve performance across the board. Factoring out event persistence into a separate worker pointed the way to a host of small but collectively important improvements. Expect further changes in coming releases.</p>
<p>Aside from that the admin API continues to grow (this time device management) and we have improved device list syncing to aid e2ee reliability.</p>
<p>We are receiving an increasing number of high quality PRs from the community, please keep them coming. Special thanks to <a href="https://github.com/cg505">cg505</a>, <a href="https://github.com/dklimpel">dklimpel</a>, <a href="https://github.com/WGH">WGH</a>, <a href="https://github.com/olof">olof</a> and <a href="https://github.com/ilmari">ilmari</a></p>
<p>Get 1.15.0 from <a href="https://github.com/matrix-org/synapse/releases/tag/v1.15.0">github</a> or any of the sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md.</p>
<p>Changelog since v1.14.0</p>
<h1 id="synapse-1-15-0-2020-06-11">Synapse 1.15.0 (2020-06-11)</h1>
<p>No significant changes.</p>
<h1 id="synapse-1-15-0rc1-2020-06-09">Synapse 1.15.0rc1 (2020-06-09)</h1>
<h2 id="features">Features</h2>
<ul>
<li>Advertise support for Client-Server API r0.6.0 and remove related unstable feature flags. (<a href="https://github.com/matrix-org/synapse/issues/6585">#6585</a>)</li>
<li>Add an option to disable autojoining rooms for guest accounts. (<a href="https://github.com/matrix-org/synapse/issues/6637">#6637</a>)</li>
<li>For SAML authentication, add the ability to pass email addresses to be added to new users' accounts via SAML attributes. Contributed by Christopher Cooper. (<a href="https://github.com/matrix-org/synapse/issues/7385">#7385</a>)</li>
<li>Add admin APIs to allow server admins to manage users' devices. Contributed by @dklimpel. (<a href="https://github.com/matrix-org/synapse/issues/7481">#7481</a>)</li>
<li>Add support for generating thumbnails for WebP images. Previously, users would see an empty box instead of preview image. Contributed by @WGH-. (<a href="https://github.com/matrix-org/synapse/issues/7586">#7586</a>)</li>
<li>Support the standardized <code>m.login.sso</code> user-interactive authentication flow. (<a href="https://github.com/matrix-org/synapse/issues/7630">#7630</a>)</li>
</ul>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Allow new users to be registered via the admin API even if the monthly active user limit has been reached. Contributed by @dklimpel. (<a href="https://github.com/matrix-org/synapse/issues/7263">#7263</a>)</li>
<li>Fix email notifications not being enabled for new users when created via the Admin API. (<a href="https://github.com/matrix-org/synapse/issues/7267">#7267</a>)</li>
<li>Fix str placeholders in an instance of <code>PrepareDatabaseException</code>. Introduced in Synapse v1.8.0. (<a href="https://github.com/matrix-org/synapse/issues/7575">#7575</a>)</li>
<li>Fix a bug in automatic user creation during first time login with <code>m.login.jwt</code>. Regression in v1.6.0. Contributed by @olof. (<a href="https://github.com/matrix-org/synapse/issues/7585">#7585</a>)</li>
<li>Fix a bug causing the cross-signing keys to be ignored when resyncing a device list. (<a href="https://github.com/matrix-org/synapse/issues/7594">#7594</a>)</li>
<li>Fix metrics failing when there is a large number of active background processes. (<a href="https://github.com/matrix-org/synapse/issues/7597">#7597</a>)</li>
<li>Fix bug where returning rooms for a group would fail if it included a room that the server was not in. (<a href="https://github.com/matrix-org/synapse/issues/7599">#7599</a>)</li>
<li>Fix duplicate key violation when persisting read markers. (<a href="https://github.com/matrix-org/synapse/issues/7607">#7607</a>)</li>
<li>Prevent an entire iteration of the device list resync loop from failing if one server responds with a malformed result. (<a href="https://github.com/matrix-org/synapse/issues/7609">#7609</a>)</li>
<li>Fix exceptions when fetching events from a remote host fails. (<a href="https://github.com/matrix-org/synapse/issues/7622">#7622</a>)</li>
<li>Make <code>synctl restart</code> start synapse if it wasn't running. (<a href="https://github.com/matrix-org/synapse/issues/7624">#7624</a>)</li>
<li>Pass device information through to the login endpoint when using the login fallback. (<a href="https://github.com/matrix-org/synapse/issues/7629">#7629</a>)</li>
<li>Advertise the <code>m.login.token</code> login flow when OpenID Connect is enabled. (<a href="https://github.com/matrix-org/synapse/issues/7631">#7631</a>)</li>
<li>Fix bug in account data replication stream. (<a href="https://github.com/matrix-org/synapse/issues/7656">#7656</a>)</li>
</ul>
<h2 id="improved-documentation">Improved Documentation</h2>
<ul>
<li>Update the OpenBSD installation instructions. (<a href="https://github.com/matrix-org/synapse/issues/7587">#7587</a>)</li>
<li>Advertise Python 3.8 support in <code>setup.py</code>. (<a href="https://github.com/matrix-org/synapse/issues/7602">#7602</a>)</li>
<li>Add a link to <code>#synapse:matrix.org</code> in the troubleshooting section of the README. (<a href="https://github.com/matrix-org/synapse/issues/7603">#7603</a>)</li>
<li>Clarifications to the admin api documentation. (<a href="https://github.com/matrix-org/synapse/issues/7647">#7647</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Convert the identity handler to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7561">#7561</a>)</li>
<li>Improve query performance for fetching state from a PostgreSQL database. Contributed by @ilmari. (<a href="https://github.com/matrix-org/synapse/issues/7567">#7567</a>)</li>
<li>Speed up processing of federation stream RDATA rows. (<a href="https://github.com/matrix-org/synapse/issues/7584">#7584</a>)</li>
<li>Add comment to systemd example to show postgresql dependency. (<a href="https://github.com/matrix-org/synapse/issues/7591">#7591</a>)</li>
<li>Refactor <code>Ratelimiter</code> to limit the amount of expensive config value accesses. (<a href="https://github.com/matrix-org/synapse/issues/7595">#7595</a>)</li>
<li>Convert groups handlers to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7600">#7600</a>)</li>
<li>Clean up exception handling in <code>SAML2ResponseResource</code>. (<a href="https://github.com/matrix-org/synapse/issues/7614">#7614</a>)</li>
<li>Check that all asynchronous tasks succeed and general cleanup of <code>MonthlyActiveUsersTestCase</code> and <code>TestMauLimit</code>. (<a href="https://github.com/matrix-org/synapse/issues/7619">#7619</a>)</li>
<li>Convert <code>get_user_id_by_threepid</code> to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7620">#7620</a>)</li>
<li>Switch to upstream <code>dh-virtualenv</code> rather than our fork for Debian package builds. (<a href="https://github.com/matrix-org/synapse/issues/7621">#7621</a>)</li>
<li>Update CI scripts to check the number in the newsfile fragment. (<a href="https://github.com/matrix-org/synapse/issues/7623">#7623</a>)</li>
<li>Check if the localpart of a Matrix ID is reserved for guest users earlier in the registration flow, as well as when responding to requests to <code>/register/available</code>. (<a href="https://github.com/matrix-org/synapse/issues/7625">#7625</a>)</li>
<li>Minor cleanups to OpenID Connect integration. (<a href="https://github.com/matrix-org/synapse/issues/7628">#7628</a>)</li>
<li>Attempt to fix flaky test: <code>PhoneHomeStatsTestCase.test_performance_100</code>. (<a href="https://github.com/matrix-org/synapse/issues/7634">#7634</a>)</li>
<li>Fix typos of <code>m.olm.curve25519-aes-sha2</code> and <code>m.megolm.v1.aes-sha2</code> in comments, test files. (<a href="https://github.com/matrix-org/synapse/issues/7637">#7637</a>)</li>
<li>Convert user directory, state deltas, and stats handlers to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7640">#7640</a>)</li>
<li>Remove some unused constants. (<a href="https://github.com/matrix-org/synapse/issues/7644">#7644</a>)</li>
<li>Fix type information on <code>assert_*_is_admin</code> methods. (<a href="https://github.com/matrix-org/synapse/issues/7645">#7645</a>)</li>
<li>Convert registration handler to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7649">#7649</a>)</li>
</ul>

                
            </div>
        </article>
        
        <article class="post">
            <header>
                <h2><a href="&#x2F;blog&#x2F;2020&#x2F;05&#x2F;28&#x2F;synapse-1-14-0-released&#x2F;" title="Synapse 1.14.0 released">Synapse 1.14.0 released</a></h2>
                <span>
                    28.05.2020 17:45
                    —
                    <a href="/category/releases">
                        Releases
                    </a>
                    —
                    <a
                        href="/author/neil-johnson">
                        Neil Johnson
                    </a>
                </span>
                <br>
                <small>Last update: 28.05.2020 17:23</small>
            </header>
            <div>
                
                <p>Synapse 1.14.0 has landed.</p>
<p>This release contains OpenId Connect support, so that admins can configure a whole range of SSO options. We're really excited about what this means for helping users sign up and are considering it for matrix.org.</p>
<p>1.14.0 also contains finer grained cache configuration support, so that admins can tune caches in a more granular way. Our experience is that cache tuning can make a big difference to Synapse performance and over time we hope to continue improving cache tooling. Potentially we could even have caches auto-tune.</p>
<p>You'll also find support for <a href="https://matrix.org/docs/spec/rooms/v6">rooms v6</a>. v6 contains some small but important changes to improve the security of the room model. As with all room version upgrades we can't switch to v6 as the default version immediately since we need to build up a critical mass of servers that can support it. So upgrade and watch this space for when we switch over properly.</p>
<p>As an aside we continue to be very happy with using Redis for worker inter-communication and will likely recommend it for production use in the coming weeks.</p>
<p>Get 1.14.0 from <a href="https://github.com/matrix-org/synapse/releases/tag/v1.14.0">github</a> or any of the sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md.</p>
<p>Changelog since v1.13.0</p>
<h1 id="synapse-1-14-0-2020-05-28">Synapse 1.14.0 (2020-05-28)</h1>
<p>No significant changes.</p>
<h1 id="synapse-1-14-0rc2-2020-05-27">Synapse 1.14.0rc2 (2020-05-27)</h1>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Fix cache config to not apply cache factor to event cache. Regression in v1.14.0rc1. (<a href="https://github.com/matrix-org/synapse/issues/7578">#7578</a>)</li>
<li>Fix bug where <code>ReplicationStreamer</code> was not always started when replication was enabled. Bug introduced in v1.14.0rc1. (<a href="https://github.com/matrix-org/synapse/issues/7579">#7579</a>)</li>
<li>Fix specifying individual cache factors for caches with special characters in their name. Regression in v1.14.0rc1. (<a href="https://github.com/matrix-org/synapse/issues/7580">#7580</a>)</li>
</ul>
<h2 id="improved-documentation">Improved Documentation</h2>
<ul>
<li>Fix the OIDC <code>client_auth_method</code> value in the sample config. (<a href="https://github.com/matrix-org/synapse/issues/7581">#7581</a>)</li>
</ul>
<h1 id="synapse-1-14-0rc1-2020-05-26">Synapse 1.14.0rc1 (2020-05-26)</h1>
<h2 id="features">Features</h2>
<ul>
<li>Synapse's cache factor can now be configured in <code>homeserver.yaml</code> by the <code>caches.global_factor</code> setting. Additionally, <code>caches.per_cache_factors</code> controls the cache factors for individual caches. (<a href="https://github.com/matrix-org/synapse/issues/6391">#6391</a>)</li>
<li>Add OpenID Connect login/registration support. Contributed by Quentin Gliech, on behalf of <a href="https://connecteu.rs">les Connecteurs</a>. (<a href="https://github.com/matrix-org/synapse/issues/7256">#7256</a>, <a href="https://github.com/matrix-org/synapse/issues/7457">#7457</a>)</li>
<li>Add room details admin endpoint. Contributed by Awesome Technologies Innovationslabor GmbH. (<a href="https://github.com/matrix-org/synapse/issues/7317">#7317</a>)</li>
<li>Allow for using more than one spam checker module at once. (<a href="https://github.com/matrix-org/synapse/issues/7435">#7435</a>)</li>
<li>Add additional authentication checks for <code>m.room.power_levels</code> event per <a href="https://github.com/matrix-org/matrix-doc/pull/2209">MSC2209</a>. (<a href="https://github.com/matrix-org/synapse/issues/7502">#7502</a>)</li>
<li>Implement room version 6 per <a href="https://github.com/matrix-org/matrix-doc/pull/2240">MSC2240</a>. (<a href="https://github.com/matrix-org/synapse/issues/7506">#7506</a>)</li>
<li>Add highly experimental option to move event persistence off master. (<a href="https://github.com/matrix-org/synapse/issues/7281">#7281</a>, <a href="https://github.com/matrix-org/synapse/issues/7374">#7374</a>, <a href="https://github.com/matrix-org/synapse/issues/7436">#7436</a>, <a href="https://github.com/matrix-org/synapse/issues/7440">#7440</a>, <a href="https://github.com/matrix-org/synapse/issues/7475">#7475</a>, <a href="https://github.com/matrix-org/synapse/issues/7490">#7490</a>, <a href="https://github.com/matrix-org/synapse/issues/7491">#7491</a>, <a href="https://github.com/matrix-org/synapse/issues/7492">#7492</a>, <a href="https://github.com/matrix-org/synapse/issues/7493">#7493</a>, <a href="https://github.com/matrix-org/synapse/issues/7495">#7495</a>, <a href="https://github.com/matrix-org/synapse/issues/7515">#7515</a>, <a href="https://github.com/matrix-org/synapse/issues/7516">#7516</a>, <a href="https://github.com/matrix-org/synapse/issues/7517">#7517</a>, <a href="https://github.com/matrix-org/synapse/issues/7542">#7542</a>)</li>
</ul>
<h2 id="bugfixes-1">Bugfixes</h2>
<ul>
<li>Fix a bug where event updates might not be sent over replication to worker processes after the stream falls behind. (<a href="https://github.com/matrix-org/synapse/issues/7384">#7384</a>)</li>
<li>Allow expired user accounts to log out their device sessions. (<a href="https://github.com/matrix-org/synapse/issues/7443">#7443</a>)</li>
<li>Fix a bug that would cause Synapse not to resync out-of-sync device lists. (<a href="https://github.com/matrix-org/synapse/issues/7453">#7453</a>)</li>
<li>Prevent rooms with 0 members or with invalid version strings from breaking group queries. (<a href="https://github.com/matrix-org/synapse/issues/7465">#7465</a>)</li>
<li>Workaround for an upstream Twisted bug that caused Synapse to become unresponsive after startup. (<a href="https://github.com/matrix-org/synapse/issues/7473">#7473</a>)</li>
<li>Fix Redis reconnection logic that can result in missed updates over replication if master reconnects to Redis without restarting. (<a href="https://github.com/matrix-org/synapse/issues/7482">#7482</a>)</li>
<li>When sending <code>m.room.member</code> events, omit <code>displayname</code> and <code>avatar_url</code> if they aren't set instead of setting them to <code>null</code>. Contributed by Aaron Raimist. (<a href="https://github.com/matrix-org/synapse/issues/7497">#7497</a>)</li>
<li>Fix incorrect <code>method</code> label on <code>synapse_http_matrixfederationclient_{requests,responses}</code> prometheus metrics. (<a href="https://github.com/matrix-org/synapse/issues/7503">#7503</a>)</li>
<li>Ignore incoming presence events from other homeservers if presence is disabled locally. (<a href="https://github.com/matrix-org/synapse/issues/7508">#7508</a>)</li>
<li>Fix a long-standing bug that broke the update remote profile background process. (<a href="https://github.com/matrix-org/synapse/issues/7511">#7511</a>)</li>
<li>Hash passwords as early as possible during password reset. (<a href="https://github.com/matrix-org/synapse/issues/7538">#7538</a>)</li>
<li>Fix bug where a local user leaving a room could fail under rare circumstances. (<a href="https://github.com/matrix-org/synapse/issues/7548">#7548</a>)</li>
<li>Fix &quot;Missing RelayState parameter&quot; error when using user interactive authentication with SAML for some SAML providers. (<a href="https://github.com/matrix-org/synapse/issues/7552">#7552</a>)</li>
<li>Fix exception <code>'GenericWorkerReplicationHandler' object has no attribute 'send_federation_ack'</code>, introduced in v1.13.0. (<a href="https://github.com/matrix-org/synapse/issues/7564">#7564</a>)</li>
<li><code>synctl</code> now warns if it was unable to stop Synapse and will not attempt to start Synapse if nothing was stopped. Contributed by Romain Bouyé. (<a href="https://github.com/matrix-org/synapse/issues/6590">#6590</a>)</li>
</ul>
<h2 id="updates-to-the-docker-image">Updates to the Docker image</h2>
<ul>
<li>Update docker runtime image to Alpine v3.11. Contributed by @Starbix. (<a href="https://github.com/matrix-org/synapse/issues/7398">#7398</a>)</li>
</ul>
<h2 id="improved-documentation-1">Improved Documentation</h2>
<ul>
<li>Update information about mapping providers for SAML and OpenID. (<a href="https://github.com/matrix-org/synapse/issues/7458">#7458</a>)</li>
<li>Add additional reverse proxy example for Caddy v2. Contributed by Jeff Peeler. (<a href="https://github.com/matrix-org/synapse/issues/7463">#7463</a>)</li>
<li>Fix copy-paste error in <code>ServerNoticesConfig</code> docstring. Contributed by @ptman. (<a href="https://github.com/matrix-org/synapse/issues/7477">#7477</a>)</li>
<li>Improve the formatting of <code>reverse_proxy.md</code>. (<a href="https://github.com/matrix-org/synapse/issues/7514">#7514</a>)</li>
<li>Change the systemd worker service to check that the worker config file exists instead of silently failing. Contributed by David Vo. (<a href="https://github.com/matrix-org/synapse/issues/7528">#7528</a>)</li>
<li>Minor clarifications to the TURN docs. (<a href="https://github.com/matrix-org/synapse/issues/7533">#7533</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Add typing annotations in <code>synapse.federation</code>. (<a href="https://github.com/matrix-org/synapse/issues/7382">#7382</a>)</li>
<li>Convert the room handler to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7396">#7396</a>)</li>
<li>Improve performance of <code>get_e2e_cross_signing_key</code>. (<a href="https://github.com/matrix-org/synapse/issues/7428">#7428</a>)</li>
<li>Improve performance of <code>mark_as_sent_devices_by_remote</code>. (<a href="https://github.com/matrix-org/synapse/issues/7429">#7429</a>, <a href="https://github.com/matrix-org/synapse/issues/7562">#7562</a>)</li>
<li>Add type hints to the SAML handler. (<a href="https://github.com/matrix-org/synapse/issues/7445">#7445</a>)</li>
<li>Remove storage method <code>get_hosts_in_room</code> that is no longer called anywhere. (<a href="https://github.com/matrix-org/synapse/issues/7448">#7448</a>)</li>
<li>Fix some typos in the <code>notice_expiry</code> templates. (<a href="https://github.com/matrix-org/synapse/issues/7449">#7449</a>)</li>
<li>Convert the federation handler to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7459">#7459</a>)</li>
<li>Convert the search handler to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7460">#7460</a>)</li>
<li>Add type hints to <code>synapse.event_auth</code>. (<a href="https://github.com/matrix-org/synapse/issues/7505">#7505</a>)</li>
<li>Convert the room member handler to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7507">#7507</a>)</li>
<li>Add type hints to room member handler. (<a href="https://github.com/matrix-org/synapse/issues/7513">#7513</a>)</li>
<li>Fix typing annotations in <code>tests.replication</code>. (<a href="https://github.com/matrix-org/synapse/issues/7518">#7518</a>)</li>
<li>Remove some redundant Python 2 support code. (<a href="https://github.com/matrix-org/synapse/issues/7519">#7519</a>)</li>
<li>All endpoints now respond with a 200 OK for <code>OPTIONS</code> requests. (<a href="https://github.com/matrix-org/synapse/issues/7534">#7534</a>, <a href="https://github.com/matrix-org/synapse/issues/7560">#7560</a>)</li>
<li>Synapse now exports <a href="https://doc.pypy.org/en/latest/gc_info.html#gc-get-stats">detailed allocator statistics</a> and basic GC timings as Prometheus metrics (<code>pypy_gc_time_seconds_total</code> and <code>pypy_memory_bytes</code>) when run under PyPy. Contributed by Ivan Shapovalov. (<a href="https://github.com/matrix-org/synapse/issues/7536">#7536</a>)</li>
<li>Remove Ubuntu Cosmic and Disco from the list of distributions which we provide <code>.deb</code>s for, due to end-of-life. (<a href="https://github.com/matrix-org/synapse/issues/7539">#7539</a>)</li>
<li>Make worker processes return a stubbed-out response to <code>GET /presence</code> requests. (<a href="https://github.com/matrix-org/synapse/issues/7545">#7545</a>)</li>
<li>Optimise some references to <code>hs.config</code>. (<a href="https://github.com/matrix-org/synapse/issues/7546">#7546</a>)</li>
<li>On upgrade room only send canonical alias once. (<a href="https://github.com/matrix-org/synapse/issues/7547">#7547</a>)</li>
<li>Fix some indentation inconsistencies in the sample config. (<a href="https://github.com/matrix-org/synapse/issues/7550">#7550</a>)</li>
<li>Include <code>synapse.http.site</code> in type checking. (<a href="https://github.com/matrix-org/synapse/issues/7553">#7553</a>)</li>
<li>Fix some test code to not mangle stacktraces, to make it easier to debug errors. (<a href="https://github.com/matrix-org/synapse/issues/7554">#7554</a>)</li>
<li>Refresh apt cache when building <code>dh_virtualenv</code> docker image. (<a href="https://github.com/matrix-org/synapse/issues/7555">#7555</a>)</li>
<li>Stop logging some expected HTTP request errors as exceptions. (<a href="https://github.com/matrix-org/synapse/issues/7556">#7556</a>, <a href="https://github.com/matrix-org/synapse/issues/7563">#7563</a>)</li>
<li>Convert sending mail to async/await. (<a href="https://github.com/matrix-org/synapse/issues/7557">#7557</a>)</li>
<li>Simplify <code>reap_monthly_active_users</code>. (<a href="https://github.com/matrix-org/synapse/issues/7558">#7558</a>)</li>
</ul>

                
            </div>
        </article>
        
        <nav class="pagination">
    <div class="prev">
        
    </div>
    <span class="page-number">1 / 7</span>
    <div class="prev">
        
        <a href="&#x2F;author&#x2F;neil-johnson&#x2F;page&#x2F;2&#x2F;">Next ›</a>
        
    </div>
</nav>

    </div>
</div>

    </main>

    <footer class="site-footer">
    <div class="internal-links">
        
        <a href="&#x2F;faq">FAQs</a>
        
        <a href="&#x2F;security-disclosure-policy">Security Disclosure Policy</a>
        
        <a href="&#x2F;security-hall-of-fame">Security Hall of Fame</a>
        
        <a href="&#x2F;legal&#x2F;code-of-conduct">Code of Conduct for Matrix.org</a>
        
        <a href="&#x2F;legal">Legal</a>
        
        <a href="&#x2F;contact">Contact</a>
        
        <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org&#x2F;matrix.org&#x2F;">Site Source</a>
        
    </div>
    <div class="external-links">
        <div>
            
            <a href="&#x2F;code"><img src="/assets/github.svg" alt="GitHub"></a>
            
            <a href="https:&#x2F;&#x2F;gitlab.matrix.org&#x2F;"><img src="/assets/gitlab.svg" alt="GitLab"></a>
            
            <a href="https:&#x2F;&#x2F;mastodon.matrix.org&#x2F;@matrix"><img src="/assets/mastodon.svg" alt="Mastodon"></a>
            
            <a href="https:&#x2F;&#x2F;twitter.com&#x2F;matrixdotorg"><img src="/assets/twitter.svg" alt="Twitter"></a>
            
            <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCVFkW-chclhuyYRbmmfwt6w"><img src="/assets/youtube.svg" alt="YouTube"></a>
            
        </div>
    </div>
    <p>© 2022 The Matrix.org Foundation C.I.C.</p>
</footer>

</body>

</html>
