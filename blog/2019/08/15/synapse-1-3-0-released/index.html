<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="twitter:widgets:csp" content="on" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="twitter:site" content="@matrixdotorg" />
    <meta name="twitter:creator" content="@matrixdotorg" />

    <title>Matrix.org - Synapse 1.3.0 released</title>
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg" />
    <link rel="stylesheet" href="/style.css" />

    


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "NewsArticle",
    "headline": "Synapse 1.3.0 released",
    "datePublished": "2019-08-15T00:00+00:00",
    
    "author": [
    
    {
        "@type": "Person",
        "name": "Neil Johnson",
        "url": "https://matrix.org/authors/neil-johnson"
    }
    
    ]
}
</script>
</head>

<body>
    
    <header class="site-header">
    <a href="/" class="brand">
        <img src="/images/matrix-logo-white.svg" alt="Matrix logo">
    </a>
    <input id="site-header-dropdown-checkbox" type="checkbox" class="dropdown-checkbox" aria-hidden="true">
    <label for="site-header-dropdown-checkbox" class="dropdown-button">&#xe602;</label>
    <label for="site-header-dropdown-checkbox" class="page-overlay"></label>
    <nav>
        
        
        <a href="&#x2F;about&#x2F;" class="
            ">
            About
        </a>
        
        
        
        <a href="&#x2F;blog&#x2F;" class="
            current">
            Blog
        </a>
        
        
        
        <a href="&#x2F;docs&#x2F;" class="
            ">
            Documentation
        </a>
        
        
        
        
        
        <div class="section-wrap">
            <input id="ecosystem-submenu-checkbox" type="checkbox" class="submenu-checkbox" aria-hidden="true"
                >
            <label for="ecosystem-submenu-checkbox" class="submenu-title">Ecosystem <div class="arrow">
                </div></label>

            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;clients&#x2F;">Clients</a>
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;bridges&#x2F;">Bridges</a>
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;servers&#x2F;">Servers</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;integrations&#x2F;">Integrations</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;sdks&#x2F;">SDKs</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;hosting&#x2F;">Hosting</a>
                    
                </div>
            </div>
        </div>
        
        
        
        <a href="&#x2F;podcasts&#x2F;" class="
            ">
            Podcasts
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;shop.matrix.org" class="
            ">
            Shop
        </a>
        
        
        
        <a href="&#x2F;try-matrix&#x2F;" class="primary
            ">
            Try Matrix
        </a>
        
        
    </nav>
</header>


    <main>
        
<article class="content post with-sidebar">
    <header>
        <h1>Synapse 1.3.0 released</h1>
        <span>
            15.08.2019 00:00
            
            —
            <a href="/category/releases">Releases</a>
            
            —
            <a
                href="/author/neil-johnson">Neil Johnson</a>
            
        </span>
        
    </header>
    <div class="post-main">
        <div class="post-content">
            <p>Well now, Synapse 1.3.0 is here.</p>
<p>The main thing to know about 1.3.0 is that is contains performance improvements to reduce disk I/O and reduce RAM usage. We’ve been running it on matrix.org for a week or so and are really pleased with the results.</p>
<p>Check out our message send heat map.</p>
<p><img src="/blog/img/2019-08-15-message-send.png" alt="Message Send" /></p>
<p>Other than that there are a bunch of bug fixes and tweaks to generally make things run more smoothly.</p>
<p>As ever, you can get the new update <a href="https://github.com/matrix-org/synapse/releases/tag/v1.3.0">here</a> or any of the sources mentioned at <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>. Also, check out our <a href="https://matrix.org/docs/guides/installing-synapse">Synapse installation guide page</a></p>
<p>The changelog since 1.2.1 follows:</p>
<h1 id="synapse-1-3-0-2019-08-15">Synapse 1.3.0 (2019-08-15)</h1>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Fix 500 Internal Server Error on <code>publicRooms</code> when the public room list was
cached. (<a href="https://github.com/matrix-org/synapse/issues/5851">#5851</a>)</li>
</ul>
<h1 id="synapse-1-3-0rc1-2019-08-13">Synapse 1.3.0rc1 (2019-08-13)</h1>
<h2 id="features">Features</h2>
<ul>
<li>Use <code>M_USER_DEACTIVATED</code> instead of <code>M_UNKNOWN</code> for errcode when a deactivated user attempts to login. (<a href="https://github.com/matrix-org/synapse/issues/5686">#5686</a>)</li>
<li>Add sd_notify hooks to ease systemd integration and allows usage of Type=Notify. (<a href="https://github.com/matrix-org/synapse/issues/5732">#5732</a>)</li>
<li>Synapse will no longer serve any media repo admin endpoints when <code>enable_media_repo</code> is set to False in the configuration. If a media repo worker is used, the admin APIs relating to the media repo will be served from it instead. (<a href="https://github.com/matrix-org/synapse/issues/5754">#5754</a>, <a href="https://github.com/matrix-org/synapse/issues/5848">#5848</a>)</li>
<li>Synapse can now be configured to not join remote rooms of a given &quot;complexity&quot; (currently, state events) over federation. This option can be used to prevent adverse performance on resource-constrained homeservers. (<a href="https://github.com/matrix-org/synapse/issues/5783">#5783</a>)</li>
<li>Allow defining HTML templates to serve the user on account renewal attempt when using the account validity feature. (<a href="https://github.com/matrix-org/synapse/issues/5807">#5807</a>)</li>
</ul>
<h2 id="bugfixes-1">Bugfixes</h2>
<ul>
<li>Fix UISIs during homeserver outage. (<a href="https://github.com/matrix-org/synapse/issues/5693">#5693</a>, <a href="https://github.com/matrix-org/synapse/issues/5789">#5789</a>)</li>
<li>Fix stack overflow in server key lookup code. (<a href="https://github.com/matrix-org/synapse/issues/5724">#5724</a>)</li>
<li>start.sh no longer uses deprecated cli option. (<a href="https://github.com/matrix-org/synapse/issues/5725">#5725</a>)</li>
<li>Log when we receive an event receipt from an unexpected origin. (<a href="https://github.com/matrix-org/synapse/issues/5743">#5743</a>)</li>
<li>Fix debian packaging scripts to correctly build sid packages. (<a href="https://github.com/matrix-org/synapse/issues/5775">#5775</a>)</li>
<li>Correctly handle redactions of redactions. (<a href="https://github.com/matrix-org/synapse/issues/5788">#5788</a>)</li>
<li>Return 404 instead of 403 when accessing /rooms/{roomId}/event/{eventId} for an event without the appropriate permissions. (<a href="https://github.com/matrix-org/synapse/issues/5798">#5798</a>)</li>
<li>Fix check that tombstone is a state event in push rules. (<a href="https://github.com/matrix-org/synapse/issues/5804">#5804</a>)</li>
<li>Fix error when trying to login as a deactivated user when using a worker to handle login. (<a href="https://github.com/matrix-org/synapse/issues/5806">#5806</a>)</li>
<li>Fix bug where user <code>/sync</code> stream could get wedged in rare circumstances. (<a href="https://github.com/matrix-org/synapse/issues/5825">#5825</a>)</li>
<li>The purge_remote_media.sh script was fixed. (<a href="https://github.com/matrix-org/synapse/issues/5839">#5839</a>)</li>
</ul>
<h2 id="deprecations-and-removals">Deprecations and Removals</h2>
<ul>
<li>Synapse now no longer accepts the <code>-v</code>/<code>--verbose</code>, <code>-f</code>/<code>--log-file</code>, or <code>--log-config</code> command line flags, and removes the deprecated <code>verbose</code> and <code>log_file</code> configuration file options. Users of these options should migrate their options into the dedicated log configuration. (<a href="https://github.com/matrix-org/synapse/issues/5678">#5678</a>, <a href="https://github.com/matrix-org/synapse/issues/5729">#5729</a>)</li>
<li>Remove non-functional 'expire_access_token' setting. (<a href="https://github.com/matrix-org/synapse/issues/5782">#5782</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Make Jaeger fully configurable. (<a href="https://github.com/matrix-org/synapse/issues/5694">#5694</a>)</li>
<li>Add precautionary measures to prevent future abuse of <code>window.opener</code> in default welcome page. (<a href="https://github.com/matrix-org/synapse/issues/5695">#5695</a>)</li>
<li>Reduce database IO usage by optimising queries for current membership. (<a href="https://github.com/matrix-org/synapse/issues/5706">#5706</a>, <a href="https://github.com/matrix-org/synapse/issues/5738">#5738</a>, <a href="https://github.com/matrix-org/synapse/issues/5746">#5746</a>, <a href="https://github.com/matrix-org/synapse/issues/5752">#5752</a>, <a href="https://github.com/matrix-org/synapse/issues/5770">#5770</a>, <a href="https://github.com/matrix-org/synapse/issues/5774">#5774</a>, <a href="https://github.com/matrix-org/synapse/issues/5792">#5792</a>, <a href="https://github.com/matrix-org/synapse/issues/5793">#5793</a>)</li>
<li>Improve caching when fetching <code>get_filtered_current_state_ids</code>. (<a href="https://github.com/matrix-org/synapse/issues/5713">#5713</a>)</li>
<li>Don't accept opentracing data from clients. (<a href="https://github.com/matrix-org/synapse/issues/5715">#5715</a>)</li>
<li>Speed up PostgreSQL unit tests in CI. (<a href="https://github.com/matrix-org/synapse/issues/5717">#5717</a>)</li>
<li>Update the coding style document. (<a href="https://github.com/matrix-org/synapse/issues/5719">#5719</a>)</li>
<li>Improve database query performance when recording retry intervals for remote hosts. (<a href="https://github.com/matrix-org/synapse/issues/5720">#5720</a>)</li>
<li>Add a set of opentracing utils. (<a href="https://github.com/matrix-org/synapse/issues/5722">#5722</a>)</li>
<li>Cache result of get_version_string to reduce overhead of <code>/version</code> federation requests. (<a href="https://github.com/matrix-org/synapse/issues/5730">#5730</a>)</li>
<li>Return 'user_type' in admin API user endpoints results. (<a href="https://github.com/matrix-org/synapse/issues/5731">#5731</a>)</li>
<li>Don't package the sytest test blacklist file. (<a href="https://github.com/matrix-org/synapse/issues/5733">#5733</a>)</li>
<li>Replace uses of returnValue with plain return, as returnValue is not needed on Python 3. (<a href="https://github.com/matrix-org/synapse/issues/5736">#5736</a>)</li>
<li>Blacklist some flakey tests in worker mode. (<a href="https://github.com/matrix-org/synapse/issues/5740">#5740</a>)</li>
<li>Fix some error cases in the caching layer. (<a href="https://github.com/matrix-org/synapse/issues/5749">#5749</a>)</li>
<li>Add a prometheus metric for pending cache lookups. (<a href="https://github.com/matrix-org/synapse/issues/5750">#5750</a>)</li>
<li>Stop trying to fetch events with event_id=None. (<a href="https://github.com/matrix-org/synapse/issues/5753">#5753</a>)</li>
<li>Convert RedactionTestCase to modern test style. (<a href="https://github.com/matrix-org/synapse/issues/5768">#5768</a>)</li>
<li>Allow looping calls to be given arguments. (<a href="https://github.com/matrix-org/synapse/issues/5780">#5780</a>)</li>
<li>Set the logs emitted when checking typing and presence timeouts to DEBUG level, not INFO. (<a href="https://github.com/matrix-org/synapse/issues/5785">#5785</a>)</li>
<li>Remove DelayedCall debugging from the test suite, as it is no longer required in the vast majority of Synapse's tests. (<a href="https://github.com/matrix-org/synapse/issues/5787">#5787</a>)</li>
<li>Remove some spurious exceptions from the logs where we failed to talk to a remote server. (<a href="https://github.com/matrix-org/synapse/issues/5790">#5790</a>)</li>
<li>Improve performance when making <code>.well-known</code> requests by sharing the SSL options between requests. (<a href="https://github.com/matrix-org/synapse/issues/5794">#5794</a>)</li>
<li>Disable codecov GitHub comments on PRs. (<a href="https://github.com/matrix-org/synapse/issues/5796">#5796</a>)</li>
<li>Don't allow clients to send tombstone events that reference the room it's sent in. (<a href="https://github.com/matrix-org/synapse/issues/5801">#5801</a>)</li>
<li>Deny redactions of events sent in a different room. (<a href="https://github.com/matrix-org/synapse/issues/5802">#5802</a>)</li>
<li>Deny sending well known state types as non-state events. (<a href="https://github.com/matrix-org/synapse/issues/5805">#5805</a>)</li>
<li>Handle incorrectly encoded query params correctly by returning a 400. (<a href="https://github.com/matrix-org/synapse/issues/5808">#5808</a>)</li>
<li>Handle pusher being deleted during processing rather than logging an exception. (<a href="https://github.com/matrix-org/synapse/issues/5809">#5809</a>)</li>
<li>Return 502 not 500 when failing to reach any remote server. (<a href="https://github.com/matrix-org/synapse/issues/5810">#5810</a>)</li>
<li>Reduce global pauses in the events stream caused by expensive state resolution during persistence. (<a href="https://github.com/matrix-org/synapse/issues/5826">#5826</a>)</li>
<li>Add a lower bound to well-known lookup cache time to avoid repeated lookups. (<a href="https://github.com/matrix-org/synapse/issues/5836">#5836</a>)</li>
<li>Whitelist history visbility sytests in worker mode tests. (<a href="https://github.com/matrix-org/synapse/issues/5843">#5843</a>)</li>
</ul>

        </div>
        
        <aside>
            <h3>Post Contents</h3>

            <ul style="list-style: none; padding-left: 0px;">
                
                <li>
                    <a href="https://matrix.org/blog/2019/08/15/synapse-1-3-0-released/#synapse-1-3-0-2019-08-15">Synapse 1.3.0 (2019-08-15)</a>
                    
                    <ul>
                        
                        <li>
                            <a href="https://matrix.org/blog/2019/08/15/synapse-1-3-0-released/#bugfixes">Bugfixes</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li>
                    <a href="https://matrix.org/blog/2019/08/15/synapse-1-3-0-released/#synapse-1-3-0rc1-2019-08-13">Synapse 1.3.0rc1 (2019-08-13)</a>
                    
                    <ul>
                        
                        <li>
                            <a href="https://matrix.org/blog/2019/08/15/synapse-1-3-0-released/#features">Features</a>
                        </li>
                        
                        <li>
                            <a href="https://matrix.org/blog/2019/08/15/synapse-1-3-0-released/#bugfixes-1">Bugfixes</a>
                        </li>
                        
                        <li>
                            <a href="https://matrix.org/blog/2019/08/15/synapse-1-3-0-released/#deprecations-and-removals">Deprecations and Removals</a>
                        </li>
                        
                        <li>
                            <a href="https://matrix.org/blog/2019/08/15/synapse-1-3-0-released/#internal-changes">Internal Changes</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
            </ul>
        </aside>
        
    </div>
</article>

    </main>

    <footer class="site-footer">
    <div class="internal-links">
        
        <a href="&#x2F;faq">FAQs</a>
        
        <a href="&#x2F;security-disclosure-policy">Security Disclosure Policy</a>
        
        <a href="&#x2F;security-hall-of-fame">Security Hall of Fame</a>
        
        <a href="&#x2F;legal&#x2F;code-of-conduct">Code of Conduct for Matrix.org</a>
        
        <a href="&#x2F;legal">Legal</a>
        
        <a href="&#x2F;contact">Contact</a>
        
        <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org&#x2F;matrix.org&#x2F;">Site Source</a>
        
    </div>
    <div class="external-links">
        <div>
            
            <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org"><img src="/assets/github.svg" alt="GitHub"></a>
            
            <a href="https:&#x2F;&#x2F;gitlab.matrix.org&#x2F;"><img src="/assets/gitlab.svg" alt="GitLab"></a>
            
            <a href="https:&#x2F;&#x2F;mastodon.matrix.org&#x2F;@matrix"><img src="/assets/mastodon.svg" alt="Mastodon"></a>
            
            <a href="https:&#x2F;&#x2F;twitter.com&#x2F;matrixdotorg"><img src="/assets/twitter.svg" alt="Twitter"></a>
            
            <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCVFkW-chclhuyYRbmmfwt6w"><img src="/assets/youtube.svg" alt="YouTube"></a>
            
        </div>
    </div>
    <p><a href="/legal/copyright-notice">Copyright Notice</a></p>
</footer>

</body>

</html>
