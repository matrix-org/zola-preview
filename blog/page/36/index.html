<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="twitter:widgets:csp" content="on" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="twitter:site" content="@matrixdotorg" />
    <meta name="twitter:creator" content="@matrixdotorg" />

    <title>Matrix.org - Blog</title>
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg" />
    <link rel="stylesheet" href="/style.css" />

    

<meta name="description" content="The Matrix.org Foundation blod is where the Matrix Foundation and Community
post updates on their activity. Every Friday evening they publish This Week In
Matrix, a digest of the past week activity.
">

</head>

<body>
    
    <header class="site-header">
    <a href="/" class="brand">
        <img src="/images/matrix-logo-white.svg" alt="Matrix logo">
    </a>
    <input id="site-header-dropdown-checkbox" type="checkbox" class="dropdown-checkbox" aria-hidden="true">
    <label for="site-header-dropdown-checkbox" class="dropdown-button">&#xe602;</label>
    <label for="site-header-dropdown-checkbox" class="page-overlay"></label>
    <nav>
        
        
        <a href="&#x2F;about&#x2F;" class="
            ">
            About
        </a>
        
        
        
        <a href="&#x2F;blog&#x2F;" class="
            current">
            Blog
        </a>
        
        
        
        <a href="&#x2F;docs&#x2F;" class="
            ">
            Documentation
        </a>
        
        
        
        
        
        <div class="section-wrap">
            <input id="ecosystem-submenu-checkbox" type="checkbox" class="submenu-checkbox" aria-hidden="true"
                >
            <label for="ecosystem-submenu-checkbox" class="submenu-title">Ecosystem <div class="arrow">
                </div></label>

            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;clients&#x2F;">Clients</a>
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;bridges&#x2F;">Bridges</a>
                    
                    
                    <a href="&#x2F;ecosystem&#x2F;servers&#x2F;">Servers</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;integrations&#x2F;">Integrations</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;sdks&#x2F;">SDKs</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;hosting&#x2F;">Hosting</a>
                    
                </div>
            </div>
        </div>
        
        
        
        <a href="&#x2F;podcasts&#x2F;" class="
            ">
            Podcasts
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;shop.matrix.org" class="
            ">
            Shop
        </a>
        
        
        
        <a href="&#x2F;try-matrix&#x2F;" class="primary
            ">
            Try Matrix
        </a>
        
        
    </nav>
</header>


    <main>
        <div class="content">
    
    <article class="post">
        <header>
            <h1><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2019&#x2F;10&#x2F;03&#x2F;synapse-1-4-0-released&#x2F;" title="Synapse 1.4.0 released">Synapse 1.4.0 released</a></h1>
            <span>
                03.10.2019 00:00
                —
                <a href="/category/releases">
                    Releases
                </a>
                —
                
                <a href="/author/neil-johnson">
                    Neil Johnson
                </a>
                
            </span>
            
        </header>
        <div>
            <p>Wheyhey as I live and breathe 1.4.0 is here!</p>
<p>1.4.0 should be considered ‘The Privacy Release’ and is the cumulation of a huge body of work spanning multiple projects to improve data privacy in the matrix ecosystem. You can read more about the <a href="https://matrix.org/blog/2019/09/27/privacy-improvements-in-synapse-1-4-and-riot-1-4">full project here</a>.</p>
<p>While we consider 1.4.0 to be a huge leap forward in terms of data privacy, it is really important to note that it contains breaking changes.</p>
<ul>
<li>If you currently rely on email or SMS delivery via an identity server you must modify your Synapse configuration.</li>
<li>If you have configured custom templates, then eight new templates must be added to your templates directory.</li>
</ul>
<p>If either apply to you failure to act will break your installation. Full details can be found in the <a href="https://github.com/matrix-org/synapse/blob/master/UPGRADE.rst#upgrading-to-v140">upgrade notes</a>.</p>
<h2 id="so-what-has-changed">So what has changed?</h2>
<p>It is possible for a user to associate an email address or phone number with their account, for a number of reasons:</p>
<ul>
<li>For use when logging in, as an alternative to the user id.</li>
<li>In the case of email, as an alternative contact to help with account recovery.</li>
<li>In the case of email, to receive notifications of missed messages.</li>
</ul>
<p>Before an email address or phone number can be added to a user's account, or before such an address is used to carry out a password-reset, Synapse must confirm the operation with the owner of the email address or phone number. It does this by sending an email or text giving the user a link or token to confirm receipt. This process is known as '3pid verification'. ('3pid', or 'threepid', stands for third-party identifier, and we use it to refer to external identifiers such as email addresses and phone numbers.)</p>
<p>Previous versions of Synapse delegated the task of 3pid verification to an identity server by default. In most cases this server is vector.im or matrix.org.</p>
<p>In Synapse 1.4.0, for security and privacy reasons, the homeserver will no longer delegate this task to an identity server by default. Instead, the server administrator will need to explicitly decide how they would like the verification messages to be sent.</p>
<p>In the medium term, the vector.im and matrix.org identity servers will disable support for delegated 3pid verification entirely. However, in order to ease the transition, they will retain the capability for a limited period. Delegated email verification will be disabled on Monday 2nd December 2019 (giving roughly 2 months notice). Disabling delegated SMS verification will follow some time after that once SMS verification support lands in Synapse.</p>
<p>Once delegated 3pid verification support has been disabled in the vector.im and matrix.org identity servers, all Synapse versions that depend on those instances will be unable to verify email and phone numbers through them. There are no imminent plans to remove delegated 3pid verification from Sydent generally. (Sydent is the identity server project that backs the vector.im and matrix.org instances).</p>
<h2 id="why-is-this-necessary">Why is this necessary?</h2>
<p>Prior to 1.4.0, the identity server was providing two related-but-separate functions:</p>
<p>a directory for users to publish their contact details and to look up their contacts by their email addresses and phone numbers.
a &quot;trusted third party communications network delegate&quot;, providing SMS- and email-sending functionality to all homeservers for registration and password reset.</p>
<p>The intention behind the identity server's providing 2. was one of convenience: to save homeserver admins the burden of configuring their homeservers to send email, as well as sparing us the effort of writing generic SMS-gateway integration that would allow any homeserver admin to configure their homeserver to send SMS via their chosen SMS aggregator.</p>
<p>By exposing this 'trusted email/sms delegate' functionality, however, and by including references to the New Vector identity servers in the default configuration for both Synapse and Riot, we created a situation in which users on non-New Vector run homeservers (who had never seen our privacy notice) could easily end up sharing their email addresses and phone numbers with a New Vector identity server.</p>
<p>Using identity servers for registration and password reset introduced yet further complexity - since password reset is a sensitive operation, it was important that the homeserver only use 'trusted' identity servers for this purpose (with the trust being configured by the homeserver admin in the homeserver config). But this created ambiguity over who was ultimately responsible for the choice of identity server and when they could make that choice - the client could present a default identity server at login/registration/password reset time, which the user could choose to override before logging in, but unless the identity server ultimately selected were on the homeserver admin's 'trusted identity servers' list, any identity server operations that were proxied via the homeserver would have been blocked by the homeserver. However, not all identity server operations initiated by the client were proxied via the homeserver - some were sent directly from the client to the identity server, and would not have been filtered.</p>
<p>The best way to solve this problem is to have individual homeservers take ownership for their own email and SMS needs. In the case of email this means configuring details of an appropriate SMTP server or continuing to delegate through an identity server that will allow it to do so. If a homeserver admin makes the active choice to use New Vector's identity servers for delegation (up until 1st December), they should make their own users aware through their privacy notice.</p>
<p>This delegation is entirely separate from the user's choice of identity server for user directory services. As of right now the user is free to choose and trust whichever identity server they wish, or to choose not to use an identity server at all.</p>
<h2 id="are-there-any-other-data-privacy-features">Are there any other data privacy features?</h2>
<p>Yes, 1.4.0 now <a href="https://github.com/matrix-org/synapse/issues/1287">automatically garbage collects redacted messages</a> (defaults to 7 days) and removes <a href="https://github.com/matrix-org/synapse/pull/6098/files">unused IP and user agent information</a> stored in the user_ips table (defaults to 30 days). Finally, Synapse now <a href="https://github.com/matrix-org/synapse/pull/6090/files">warns in its logs</a> if you are using matrix.org as a trusted key server, in case you wish to use a different server to help discover other servers’ keys.</p>
<h2 id="anything-else">Anything else?</h2>
<p>Aside from privacy, we’ve expanded our OpenTracing support and fixed a host of bugs. However the thing that is most exciting is switching on our solution for <a href="https://github.com/matrix-org/synapse/issues/5319">mitigating forward extremities build up</a>’ by default.</p>
<p>In some cases rooms can accumulate ‘forward extremities’, which are simply an artefact of attempting to resolve the room state over multiple servers. Forward extremities are necessary to ensure that each server can independently arrive at the same view of the room eventually, however processing these extremities can be <a href="https://github.com/matrix-org/synapse/issues/1760">computationally expensive and degrade server performance overall</a>.</p>
<p>Originally it was an experimental config option but we now feel confident to turn it on by default for all instances - it should make a big difference for the CPU of servers in fragmented rooms.</p>
<p>So that’s it folks, thanks for making it this far. As ever, you can get the new update <a href="https://github.com/matrix-org/synapse/releases/tag/v1.4.0">here</a> or any of the sources mentioned at <a href="https://github.com/matrix-org/synapse">https://github.com/matrix-org/synapse</a>. Also, check out our <a href="https://matrix.org/docs/guides/installing-synapse">Synapse installation guide page</a></p>
<p>The changelog since 1.3.1 follows:</p>
<h1 id="synapse-1-4-0-2019-10-03">Synapse 1.4.0 (2019-10-03)</h1>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Redact <code>client_secret</code> in server logs. (<a href="https://github.com/matrix-org/synapse/issues/6158">#6158</a>)</li>
</ul>
<h1 id="synapse-1-4-0rc2-2019-10-02">Synapse 1.4.0rc2 (2019-10-02)</h1>
<h2 id="bugfixes-1">Bugfixes</h2>
<ul>
<li>Fix bug in background update that adds last seen information to the <code>devices</code> table, and improve its performance on Postgres. (<a href="https://github.com/matrix-org/synapse/issues/6135">#6135</a>)</li>
<li>Fix bad performance of censoring redactions background task. (<a href="https://github.com/matrix-org/synapse/issues/6141">#6141</a>)</li>
<li>Fix fetching censored redactions from DB, which caused APIs like initial sync to fail if it tried to include the censored redaction. (<a href="https://github.com/matrix-org/synapse/issues/6145">#6145</a>)</li>
<li>Fix exceptions when storing large retry intervals for down remote servers. (<a href="https://github.com/matrix-org/synapse/issues/6146">#6146</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Fix up sample config entry for <code>redaction_retention_period</code> option. (<a href="https://github.com/matrix-org/synapse/issues/6117">#6117</a>)</li>
</ul>
<h1 id="synapse-1-4-0rc1-2019-09-26">Synapse 1.4.0rc1 (2019-09-26)</h1>
<p>Note that this release includes significant changes around 3pid verification. Administrators are reminded to review the <a href="UPGRADE.rst#upgrading-to-v140">upgrade notes</a>.</p>
<h2 id="features">Features</h2>
<ul>
<li>Changes to 3pid verification:
<ul>
<li>Add the ability to send registration emails from the homeserver rather than delegating to an identity server. (<a href="https://github.com/matrix-org/synapse/issues/5835">#5835</a>, <a href="https://github.com/matrix-org/synapse/issues/5940">#5940</a>, <a href="https://github.com/matrix-org/synapse/issues/5993">#5993</a>, <a href="https://github.com/matrix-org/synapse/issues/5994">#5994</a>, <a href="https://github.com/matrix-org/synapse/issues/5868">#5868</a>)</li>
<li>Replace <code>trust_identity_server_for_password_resets</code> config option with <code>account_threepid_delegates</code>, and make the <code>id_server</code> parameteter optional on <code>*/requestToken</code> endpoints, as per <a href="https://github.com/matrix-org/matrix-doc/pull/2263">MSC2263</a>. (<a href="https://github.com/matrix-org/synapse/issues/5876">#5876</a>, <a href="https://github.com/matrix-org/synapse/issues/5969">#5969</a>, <a href="https://github.com/matrix-org/synapse/issues/6028">#6028</a>)</li>
<li>Switch to using the v2 Identity Service <code>/lookup</code> API where available, with fallback to v1. (Implements <a href="https://github.com/matrix-org/matrix-doc/pull/2134">MSC2134</a> plus <code>id_access_token authentication</code> for v2 Identity Service APIs from <a href="https://github.com/matrix-org/matrix-doc/pull/2140">MSC2140</a>). (<a href="https://github.com/matrix-org/synapse/issues/5897">#5897</a>)</li>
<li>Remove <code>bind_email</code> and <code>bind_msisdn</code> parameters from <code>/register</code> ala <a href="https://github.com/matrix-org/matrix-doc/pull/2140">MSC2140</a>. (<a href="https://github.com/matrix-org/synapse/issues/5964">#5964</a>)</li>
<li>Add <code>m.id_access_token</code> to <code>unstable_features</code> in <code>/versions</code> as per <a href="https://github.com/matrix-org/matrix-doc/pull/2264">MSC2264</a>. (<a href="https://github.com/matrix-org/synapse/issues/5974">#5974</a>)</li>
<li>Use the v2 Identity Service API for 3PID invites. (<a href="https://github.com/matrix-org/synapse/issues/5979">#5979</a>)</li>
<li>Add <code>POST /_matrix/client/unstable/account/3pid/unbind</code> endpoint from <a href="https://github.com/matrix-org/matrix-doc/pull/2140">MSC2140</a> for unbinding a 3PID from an identity server without removing it from the homeserver user account. (<a href="https://github.com/matrix-org/synapse/issues/5980">#5980</a>, <a href="https://github.com/matrix-org/synapse/issues/6062">#6062</a>)</li>
<li>Use <code>account_threepid_delegate.email</code> and <code>account_threepid_delegate.msisdn</code> for validating threepid sessions. (<a href="https://github.com/matrix-org/synapse/issues/6011">#6011</a>)</li>
<li>Allow homeserver to handle or delegate email validation when adding an email to a user's account. (<a href="https://github.com/matrix-org/synapse/issues/6042">#6042</a>)</li>
<li>Implement new Client Server API endpoints <code>/account/3pid/add</code> and <code>/account/3pid/bind</code> as per <a href="https://github.com/matrix-org/matrix-doc/pull/2290">MSC2290</a>. (<a href="https://github.com/matrix-org/synapse/issues/6043">#6043</a>)</li>
<li>Add an unstable feature flag for separate add/bind 3pid APIs. (<a href="https://github.com/matrix-org/synapse/issues/6044">#6044</a>)</li>
<li>Remove <code>bind</code> parameter from Client Server POST <code>/account</code> endpoint as per <a href="https://github.com/matrix-org/matrix-doc/pull/2290/">MSC2290</a>. (<a href="https://github.com/matrix-org/synapse/issues/6067">#6067</a>)</li>
<li>Add <code>POST /add_threepid/msisdn/submit_token</code> endpoint for proxying submitToken on an <code>account_threepid_handler</code>. (<a href="https://github.com/matrix-org/synapse/issues/6078">#6078</a>)</li>
<li>Add <code>submit_url</code> response parameter to <code>*/msisdn/requestToken</code> endpoints. (<a href="https://github.com/matrix-org/synapse/issues/6079">#6079</a>)</li>
<li>Add <code>m.require_identity_server</code> flag to /version's unstable_features. (<a href="https://github.com/matrix-org/synapse/issues/5972">#5972</a>)</li>
</ul>
</li>
<li>Enhancements to OpenTracing support:
<ul>
<li>Make OpenTracing work in worker mode. (<a href="https://github.com/matrix-org/synapse/issues/5771">#5771</a>)</li>
<li>Pass OpenTracing contexts between servers when transmitting EDUs. (<a href="https://github.com/matrix-org/synapse/issues/5852">#5852</a>)</li>
<li>OpenTracing for device list updates. (<a href="https://github.com/matrix-org/synapse/issues/5853">#5853</a>)</li>
<li>Add a tag recording a request's authenticated entity and corresponding servlet in OpenTracing. (<a href="https://github.com/matrix-org/synapse/issues/5856">#5856</a>)</li>
<li>Add minimum OpenTracing for client servlets. (<a href="https://github.com/matrix-org/synapse/issues/5983">#5983</a>)</li>
<li>Check at setup that OpenTracing is installed if it's enabled in the config. (<a href="https://github.com/matrix-org/synapse/issues/5985">#5985</a>)</li>
<li>Trace replication send times. (<a href="https://github.com/matrix-org/synapse/issues/5986">#5986</a>)</li>
<li>Include missing OpenTracing contexts in outbout replication requests. (<a href="https://github.com/matrix-org/synapse/issues/5982">#5982</a>)</li>
<li>Fix sending of EDUs when OpenTracing is enabled with an empty whitelist. (<a href="https://github.com/matrix-org/synapse/issues/5984">#5984</a>)</li>
<li>Fix invalid references to None while OpenTracing if the log context slips. (<a href="https://github.com/matrix-org/synapse/issues/5988">#5988</a>, <a href="https://github.com/matrix-org/synapse/issues/5991">#5991</a>)</li>
<li>OpenTracing for room and e2e keys. (<a href="https://github.com/matrix-org/synapse/issues/5855">#5855</a>)</li>
<li>Add OpenTracing span over HTTP push processing. (<a href="https://github.com/matrix-org/synapse/issues/6003">#6003</a>)</li>
</ul>
</li>
<li>Add an admin API to purge old rooms from the database. (<a href="https://github.com/matrix-org/synapse/issues/5845">#5845</a>)</li>
<li>Retry well-known lookups if we have recently seen a valid well-known record for the server. (<a href="https://github.com/matrix-org/synapse/issues/5850">#5850</a>)</li>
<li>Add support for filtered room-directory search requests over federation (<a href="https://github.com/matrix-org/matrix-doc/pull/2197">MSC2197</a>, in order to allow upcoming room directory query performance improvements. (<a href="https://github.com/matrix-org/synapse/issues/5859">#5859</a>)</li>
<li>Correctly retry all hosts returned from SRV when we fail to connect. (<a href="https://github.com/matrix-org/synapse/issues/5864">#5864</a>)</li>
<li>Add admin API endpoint for setting whether or not a user is a server administrator. (<a href="https://github.com/matrix-org/synapse/issues/5878">#5878</a>)</li>
<li>Enable cleaning up extremities with dummy events by default to prevent undue build up of forward extremities. (<a href="https://github.com/matrix-org/synapse/issues/5884">#5884</a>)</li>
<li>Add config option to sign remote key query responses with a separate key. (<a href="https://github.com/matrix-org/synapse/issues/5895">#5895</a>)</li>
<li>Add support for config templating. (<a href="https://github.com/matrix-org/synapse/issues/5900">#5900</a>)</li>
<li>Users with the type of &quot;support&quot; or &quot;bot&quot; are no longer required to consent. (<a href="https://github.com/matrix-org/synapse/issues/5902">#5902</a>)</li>
<li>Let synctl accept a directory of config files. (<a href="https://github.com/matrix-org/synapse/issues/5904">#5904</a>)</li>
<li>Increase max display name size to 256. (<a href="https://github.com/matrix-org/synapse/issues/5906">#5906</a>)</li>
<li>Add admin API endpoint for getting whether or not a user is a server administrator. (<a href="https://github.com/matrix-org/synapse/issues/5914">#5914</a>)</li>
<li>Redact events in the database that have been redacted for a week. (<a href="https://github.com/matrix-org/synapse/issues/5934">#5934</a>)</li>
<li>New prometheus metrics:
<ul>
<li><code>synapse_federation_known_servers</code>: represents the total number of servers your server knows about (i.e. is in rooms with), including itself. Enable by setting <code>metrics_flags.known_servers</code> to True in the configuration.(<a href="https://github.com/matrix-org/synapse/issues/5981">#5981</a>)</li>
<li><code>synapse_build_info</code>: exposes the Python version, OS version, and Synapse version of the running server. (<a href="https://github.com/matrix-org/synapse/issues/6005">#6005</a>)</li>
</ul>
</li>
<li>Give appropriate exit codes when synctl fails. (<a href="https://github.com/matrix-org/synapse/issues/5992">#5992</a>)</li>
<li>Apply the federation blacklist to requests to identity servers. (<a href="https://github.com/matrix-org/synapse/issues/6000">#6000</a>)</li>
<li>Add <code>report_stats_endpoint</code> option to configure where stats are reported to, if enabled. Contributed by @Sorunome. (<a href="https://github.com/matrix-org/synapse/issues/6012">#6012</a>)</li>
<li>Add config option to increase ratelimits for room admins redacting messages. (<a href="https://github.com/matrix-org/synapse/issues/6015">#6015</a>)</li>
<li>Stop sending federation transactions to servers which have been down for a long time. (<a href="https://github.com/matrix-org/synapse/issues/6026">#6026</a>)</li>
<li>Make the process for mapping SAML2 users to matrix IDs more flexible. (<a href="https://github.com/matrix-org/synapse/issues/6037">#6037</a>)</li>
<li>Return a clearer error message when a timeout occurs when attempting to contact an identity server. (<a href="https://github.com/matrix-org/synapse/issues/6073">#6073</a>)</li>
<li>Prevent password reset's submit_token endpoint from accepting trailing slashes. (<a href="https://github.com/matrix-org/synapse/issues/6074">#6074</a>)</li>
<li>Return 403 on <code>/register/available</code> if registration has been disabled. (<a href="https://github.com/matrix-org/synapse/issues/6082">#6082</a>)</li>
<li>Explicitly log when a homeserver does not have the <code>trusted_key_servers</code> config field configured. (<a href="https://github.com/matrix-org/synapse/issues/6090">#6090</a>)</li>
<li>Add support for pruning old rows in <code>user_ips</code> table. (<a href="https://github.com/matrix-org/synapse/issues/6098">#6098</a>)</li>
</ul>
<h2 id="bugfixes-2">Bugfixes</h2>
<ul>
<li>Don't create broken room when <code>power_level_content_override.users</code> does not contain <code>creator_id</code>. (<a href="https://github.com/matrix-org/synapse/issues/5633">#5633</a>)</li>
<li>Fix database index so that different backup versions can have the same sessions. (<a href="https://github.com/matrix-org/synapse/issues/5857">#5857</a>)</li>
<li>Fix Synapse looking for config options <code>password_reset_failure_template</code> and <code>password_reset_success_template</code>, when they are actually <code>password_reset_template_failure_html</code>, <code>password_reset_template_success_html</code>. (<a href="https://github.com/matrix-org/synapse/issues/5863">#5863</a>)</li>
<li>Fix stack overflow when recovering an appservice which had an outage. (<a href="https://github.com/matrix-org/synapse/issues/5885">#5885</a>)</li>
<li>Fix error message which referred to <code>public_base_url</code> instead of <code>public_baseurl</code>. Thanks to @aaronraimist for the fix! (<a href="https://github.com/matrix-org/synapse/issues/5909">#5909</a>)</li>
<li>Fix 404 for thumbnail download when <code>dynamic_thumbnails</code> is <code>false</code> and the thumbnail was dynamically generated. Fix reported by rkfg. (<a href="https://github.com/matrix-org/synapse/issues/5915">#5915</a>)</li>
<li>Fix a cache-invalidation bug for worker-based deployments. (<a href="https://github.com/matrix-org/synapse/issues/5920">#5920</a>)</li>
<li>Fix admin API for listing media in a room not being available with an external media repo. (<a href="https://github.com/matrix-org/synapse/issues/5966">#5966</a>)</li>
<li>Fix list media admin API always returning an error. (<a href="https://github.com/matrix-org/synapse/issues/5967">#5967</a>)</li>
<li>Fix room and user stats tracking. (<a href="https://github.com/matrix-org/synapse/issues/5971">#5971</a>, <a href="https://github.com/matrix-org/synapse/issues/5998">#5998</a>, <a href="https://github.com/matrix-org/synapse/issues/6029">#6029</a>)</li>
<li>Return a <code>M_MISSING_PARAM</code> if <code>sid</code> is not provided to <code>/account/3pid</code>. (<a href="https://github.com/matrix-org/synapse/issues/5995">#5995</a>)</li>
<li><code>federation_certificate_verification_whitelist</code> now will not cause <code>TypeErrors</code> to be raised (a regression in 1.3). Additionally, it now supports internationalised domain names in their non-canonical representation. (<a href="https://github.com/matrix-org/synapse/issues/5996">#5996</a>)</li>
<li>Only count real users when checking for auto-creation of auto-join room. (<a href="https://github.com/matrix-org/synapse/issues/6004">#6004</a>)</li>
<li>Ensure support users can be registered even if MAU limit is reached. (<a href="https://github.com/matrix-org/synapse/issues/6020">#6020</a>)</li>
<li>Fix bug where login error was shown incorrectly on SSO fallback login. (<a href="https://github.com/matrix-org/synapse/issues/6024">#6024</a>)</li>
<li>Fix bug in calculating the federation retry backoff period. (<a href="https://github.com/matrix-org/synapse/issues/6025">#6025</a>)</li>
<li>Prevent exceptions being logged when extremity-cleanup events fail due to lack of user consent to the terms of service. (<a href="https://github.com/matrix-org/synapse/issues/6053">#6053</a>)</li>
<li>Remove POST method from password-reset <code>submit_token</code> endpoint until we implement <code>submit_url</code> functionality. (<a href="https://github.com/matrix-org/synapse/issues/6056">#6056</a>)</li>
<li>Fix logcontext spam on non-Linux platforms. (<a href="https://github.com/matrix-org/synapse/issues/6059">#6059</a>)</li>
<li>Ensure query parameters in email validation links are URL-encoded. (<a href="https://github.com/matrix-org/synapse/issues/6063">#6063</a>)</li>
<li>Fix a bug which caused SAML attribute maps to be overridden by defaults. (<a href="https://github.com/matrix-org/synapse/issues/6069">#6069</a>)</li>
<li>Fix the logged number of updated items for the <code>users_set_deactivated_flag</code> background update. (<a href="https://github.com/matrix-org/synapse/issues/6092">#6092</a>)</li>
<li>Add <code>sid</code> to <code>next_link</code> for email validation. (<a href="https://github.com/matrix-org/synapse/issues/6097">#6097</a>)</li>
<li>Threepid validity checks on msisdns should not be dependent on <code>threepid_behaviour_email</code>. (<a href="https://github.com/matrix-org/synapse/issues/6104">#6104</a>)</li>
<li>Ensure that servers which are not configured to support email address verification do not offer it in the registration flows. (<a href="https://github.com/matrix-org/synapse/issues/6107">#6107</a>)</li>
</ul>
<h2 id="updates-to-the-docker-image">Updates to the Docker image</h2>
<ul>
<li>Avoid changing <code>UID/GID</code> if they are already correct. (<a href="https://github.com/matrix-org/synapse/issues/5970">#5970</a>)</li>
<li>Provide <code>SYNAPSE_WORKER</code> envvar to specify python module. (<a href="https://github.com/matrix-org/synapse/issues/6058">#6058</a>)</li>
</ul>
<h2 id="improved-documentation">Improved Documentation</h2>
<ul>
<li>Convert documentation to markdown (from rst) (<a href="https://github.com/matrix-org/synapse/issues/5849">#5849</a>)</li>
<li>Update <code>INSTALL.md</code> to say that Python 2 is no longer supported. (<a href="https://github.com/matrix-org/synapse/issues/5953">#5953</a>)</li>
<li>Add developer documentation for using SAML2. (<a href="https://github.com/matrix-org/synapse/issues/6032">#6032</a>)</li>
<li>Add some notes on rolling back to v1.3.1. (<a href="https://github.com/matrix-org/synapse/issues/6049">#6049</a>)</li>
<li>Update the upgrade notes. (<a href="https://github.com/matrix-org/synapse/issues/6050">#6050</a>)</li>
</ul>
<h2 id="deprecations-and-removals">Deprecations and Removals</h2>
<ul>
<li>Remove shared-secret registration from <code>/_matrix/client/r0/register</code> endpoint. Contributed by Awesome Technologies Innovationslabor GmbH. (<a href="https://github.com/matrix-org/synapse/issues/5877">#5877</a>)</li>
<li>Deprecate the <code>trusted_third_party_id_servers</code> option. (<a href="https://github.com/matrix-org/synapse/issues/5875">#5875</a>)</li>
</ul>
<h2 id="internal-changes-1">Internal Changes</h2>
<ul>
<li>Lay the groundwork for structured logging output. (<a href="https://github.com/matrix-org/synapse/issues/5680">#5680</a>)</li>
<li>Retry well-known lookup before the cache expires, giving a grace period where the remote well-known can be down but we still use the old result. (<a href="https://github.com/matrix-org/synapse/issues/5844">#5844</a>)</li>
<li>Remove log line for debugging issue #5407. (<a href="https://github.com/matrix-org/synapse/issues/5860">#5860</a>)</li>
<li>Refactor the Appservice scheduler code. (<a href="https://github.com/matrix-org/synapse/issues/5886">#5886</a>)</li>
<li>Compatibility with v2 Identity Service APIs other than /lookup. (<a href="https://github.com/matrix-org/synapse/issues/5892">#5892</a>, <a href="https://github.com/matrix-org/synapse/issues/6013">#6013</a>)</li>
<li>Stop populating some unused tables. (<a href="https://github.com/matrix-org/synapse/issues/5893">#5893</a>, <a href="https://github.com/matrix-org/synapse/issues/6047">#6047</a>)</li>
<li>Add missing index on <code>users_in_public_rooms</code> to improve the performance of directory queries. (<a href="https://github.com/matrix-org/synapse/issues/5894">#5894</a>)</li>
<li>Improve the logging when we have an error when fetching signing keys. (<a href="https://github.com/matrix-org/synapse/issues/5896">#5896</a>)</li>
<li>Add support for database engine-specific schema deltas, based on file extension. (<a href="https://github.com/matrix-org/synapse/issues/5911">#5911</a>)</li>
<li>Update Buildkite pipeline to use plugins instead of buildkite-agent commands. (<a href="https://github.com/matrix-org/synapse/issues/5922">#5922</a>)</li>
<li>Add link in sample config to the logging config schema. (<a href="https://github.com/matrix-org/synapse/issues/5926">#5926</a>)</li>
<li>Remove unnecessary parentheses in return statements. (<a href="https://github.com/matrix-org/synapse/issues/5931">#5931</a>)</li>
<li>Remove unused <code>jenkins/prepare_sytest.sh</code> file. (<a href="https://github.com/matrix-org/synapse/issues/5938">#5938</a>)</li>
<li>Move Buildkite pipeline config to the pipelines repo. (<a href="https://github.com/matrix-org/synapse/issues/5943">#5943</a>)</li>
<li>Remove unnecessary return statements in the codebase which were the result of a regex run. (<a href="https://github.com/matrix-org/synapse/issues/5962">#5962</a>)</li>
<li>Remove left-over methods from v1 registration API. (<a href="https://github.com/matrix-org/synapse/issues/5963">#5963</a>)</li>
<li>Cleanup event auth type initialisation. (<a href="https://github.com/matrix-org/synapse/issues/5975">#5975</a>)</li>
<li>Clean up dependency checking at setup. (<a href="https://github.com/matrix-org/synapse/issues/5989">#5989</a>)</li>
<li>Update OpenTracing docs to use the unified <code>trace</code> method. (<a href="https://github.com/matrix-org/synapse/issues/5776">#5776</a>)</li>
<li>Small refactor of function arguments and docstrings in<code> RoomMemberHandler</code>. (<a href="https://github.com/matrix-org/synapse/issues/6009">#6009</a>)</li>
<li>Remove unused <code>origin</code> argument on <code>FederationHandler.add_display_name_to_third_party_invite</code>. (<a href="https://github.com/matrix-org/synapse/issues/6010">#6010</a>)</li>
<li>Add a <code>failure_ts</code> column to the <code>destinations</code> database table. (<a href="https://github.com/matrix-org/synapse/issues/6016">#6016</a>, <a href="https://github.com/matrix-org/synapse/issues/6072">#6072</a>)</li>
<li>Clean up some code in the retry logic. (<a href="https://github.com/matrix-org/synapse/issues/6017">#6017</a>)</li>
<li>Fix the structured logging tests stomping on the global log configuration for subsequent tests. (<a href="https://github.com/matrix-org/synapse/issues/6023">#6023</a>)</li>
<li>Clean up the sample config for SAML authentication. (<a href="https://github.com/matrix-org/synapse/issues/6064">#6064</a>)</li>
<li>Change mailer logging to reflect Synapse doesn't just do chat notifications by email now. (<a href="https://github.com/matrix-org/synapse/issues/6075">#6075</a>)</li>
<li>Move last-seen info into devices table. (<a href="https://github.com/matrix-org/synapse/issues/6089">#6089</a>)</li>
<li>Remove unused parameter to <code>get_user_id_by_threepid</code>. (<a href="https://github.com/matrix-org/synapse/issues/6099">#6099</a>)</li>
<li>Refactor the user-interactive auth handling. (<a href="https://github.com/matrix-org/synapse/issues/6105">#6105</a>)</li>
<li>Refactor code for calculating registration flows. (<a href="https://github.com/matrix-org/synapse/issues/6106">#6106</a>)</li>
</ul>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2019&#x2F;09&#x2F;27&#x2F;privacy-improvements-in-synapse-1-4-and-riot-1-4&#x2F;" title="Privacy improvements in Synapse 1.4 and Riot 1.4">Privacy improvements in Synapse 1.4 and Riot 1.4</a></h1>
            <span>
                27.09.2019 00:00
                —
                <a href="/category/privacy">
                    Privacy
                </a>
                —
                
                <a href="/author/matthew-hodgson">
                    Matthew Hodgson
                </a>
                
            </span>
            
        </header>
        <div>
            <p>Hi all,</p>
<p>Back in June we wrote about our <a href="https://matrix.org/blog/2019/06/30/tightening-up-privacy-in-matrix">plans to tighten up data
privacy</a>
in Matrix after some areas for improvement were brought to our attention.  To
quickly recap: the primary concern was that the default config for Riot
specifies identity servers and integration managers run by New Vector (the
company which the original Matrix team set up to build Riot and fund Matrix
dev) - and so folks using a standalone homeserver may end up using external
services without realising it.  There were some other legitimate issues raised
too (e.g. contact information should be obfuscated when checking if your
contacts are on Matrix; Riot defaulted to using Google for STUN (firewall
detection) if no TURN server had been set up on their server; Synapse defaults
to using matrix.org as a key notary server).</p>
<p>We’ve been working away at this fairly solidly over the last few months.  Some
of the simpler items shipped quickly (e.g. Riot/Web had a <a href="https://github.com/matrix-org/matrix-react-sdk/pull/3115">stupid
bug</a> where it kept
incorrectly loading the integration manager; Riot/Android <a href="https://news.ycombinator.com/item?id=20181515">wasn’t clear
enough</a> about when contact
discovery was happening; Riot/Web <a href="https://github.com/vector-im/riot-web/issues/10216">wasn’t clear
enough</a> about the fact
device names are publicly visible; etc) - but other bits have turned out to be
incredibly time-consuming to get right.</p>
<p>However, we’re in the process today of releasing Synapse 1.4.0 and Riot/Web
1.4.0 (it’s coincidence the version numbers have lined up!) which resolve the
majority of the remaining issues.  The main changes are as follows:</p>
<ol>
<li>
<p><strong>Riot no longer automatically uses identity servers by default</strong>.
Identity servers are only useful when inviting users by email address, or when
discovering whether your contacts are on Matrix.  Therefore, we now wait until
the user tries to perform one of these operations before explaining that they
need an identity server to do so, and we prompt them to select one if they
want to proceed. This makes it abundantly clear that the user is connecting to
an independent service, and why.</p>
</li>
<li>
<p><strong>Integration Managers and identity servers now have the ability to force
users to accept terms of use before using them</strong>.  This means they can
explicitly spell out the data privacy &amp; usage policy of the server as required
by GDPR, and it should now be impossible for a user to use these services
without realising it.  This was particularly fun in the case of identity
servers, which previously had no concept of users and so couldn’t track
whether users had agreed to their terms &amp; conditions or not… and because
homeservers sometimes talk to the identity server on behalf of users rather
than the user talking direct, the privacy policy flow gets even hairier.  But
it’s solved now, and a nice side-effect of this is that users can now
explicitly select their Integration Manager in Riot, in case they want to use
<a href="https://dimension.t2bot.io">Dimension</a> or similar rather than the default
provided by <a href="https://modular.im">Modular</a>.</p>
</li>
<li>
<p><strong>Synapse no longer uses identity servers for verifying registrations or
verifying password reset.</strong> Originally, Synapse made use of the fact that the
Identity Service contains email/msisdn verification logic to handle identity
verification in general on behalf of the homeserver. However, in retrospect
this was a mistake: why should the entity running your identity server have
the right to verify password resets or registration details on your
homeserver?  So, we have moved this logic into Synapse.  <strong>This means Synapse
1.4.0 requires new configuration for email/msisdn verification to work -
please see the upgrade notes for full details.</strong></p>
</li>
<li>
<p><strong>Sydent now supports discovering contacts based on hashed identifiers.</strong>
<a href="https://github.com/matrix-org/matrix-doc/blob/hs/hash-identity/proposals/2134-identity-hash-lookup.md">MSC2134</a>
specifies entirely new IS APIs for discovering contacts using a hash of their
identifier rather than directly exposing the raw identifiers being searched
for.  This is implemented in
<a href="https://github.com/vector-im/riot-ios/issues/2652">Riot/iOS</a> and
<a href="https://github.com/vector-im/riot-android/issues/3257">Riot/Android</a> and
should be in the next major release;
<a href="https://github.com/vector-im/riot-web/issues/10556">Riot/Web</a> 1.4.0 has it
already.</p>
</li>
<li>
<p>Synapse now <a href="https://github.com/matrix-org/synapse/pull/6090/files">warns in its
logs</a> if you are using
matrix.org as a default trusted key server, in case you wish to use a
different server to help discover other servers’ keys.</p>
</li>
<li>
<p>Synapse now <a href="https://github.com/matrix-org/synapse/issues/1287">garbage collects redacted
messages</a> after N days (7
days by default).  (It doesn’t yet garbage collect attachments referenced from
redacted messages; we’re still working on that).</p>
</li>
<li>
<p>Synapse now <a href="https://github.com/matrix-org/synapse/pull/6098/files">deletes account access
data</a> (IP addresses and
User Agent) after N days (28 days by default) of a device being deleted.</p>
</li>
<li>
<p>Riot warns before falling back to using STUN (and defaults to
turn.matrix.org rather than stun.google.com) for firewall discovery (STUN)
when placing VoIP calls, and makes it clear that this is an emergency fallback
for misconfigured servers which are missing TURN support.  (We originally
deleted the fallback entirely, but this broke things for too many people, so
we’ve kept it but warn instead).</p>
</li>
</ol>
<p>All of this is implemented in Riot/Web 1.4.0 and Synapse 1.4.0.  Riot/Web
1.4.0 shipped today (Fri Sept 27th) and we have a release candidate
for Synapse 1.4 (1.4.0rc1) today which fully ship on Monday.</p>
<p>For full details please go check out the <a href="https://medium.com/@RiotChat/new-privacy-controls-for-riot-dc3661888563">Riot 1.4.0</a>
and <a href="https://matrix.org/blog/2019/10/03/synapse-1-4-0-released">Synapse 1.4.0</a> blog posts.</p>
<p>Riot/Mobile is following fast behind - most of the above has been implemented
and everything should land in the next release.  RiotX/Android doesn’t really
have any changes to make given it hadn’t yet implemented Identity Service or
Integration Manager APIs.</p>
<p>This has involved a surprisingly large amount of spec work; no fewer than 9
new Matrix Spec Changes (MSC) have been required as part of the project.  In
particular, this results in a massive update to the Identity Service API,
which will be released very shortly with the new MSCs.  You can see the
upcoming changes on the <a href="https://matrix.org/docs/spec/identity_service/unstable">unstable
branch</a> and compare
with the <a href="https://matrix.org/docs/spec/identity_service/r0.2.1">previous 0.2.1 stable
release</a>, as well as
checking the detailed MSCs as follows:</p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/1961">MSC1961: Integration manager authentication APIs</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2078">MSC2078: Sending Third-Party Request Tokens via the Homeserver</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2134">MSC2134: Identity Hash Lookups</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2140">MSC2140: Terms of Service for ISes and IMs</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2229">MSC2229: Allowing 3PID Owners to Rebind</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2230">MSC2230: Store Identity Server in Account Data</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2263">MSC2263: Give homeservers the ability to handle their own 3PID registrations/password resets</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2264">MSC2264: Add an unstable feature flag to MSC2140 for clients to detect support</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2290">MSC2290: Separate Endpoints for Threepid Binding</a></li>
</ul>
<p>This said, there is still some work remaining for us to do here.  The main
things which haven’t made it into this release are:</p>
<ul>
<li>Preferring to get server keys from the source server rather than the notary server by default (<a href="https://github.com/matrix-org/synapse/pull/6110">https://github.com/matrix-org/synapse/pull/6110</a>). This almost made it in, but we need to test it more first - until then, your specified notary server will see roughly what servers your servers are trying to talk to.  In future this will be mitigated properly by <a href="https://github.com/matrix-org/matrix-doc/issues/1228">MSC1228 (removing mxids from events)</a>.</li>
<li>Configurable data retention periods for rooms.  We are tantalisingly close with this - <a href="https://github.com/matrix-org/synapse/pull/5815">https://github.com/matrix-org/synapse/pull/5815</a> is an implementation that the French Govt deployment is using; we need to port it into mainline Synapse.</li>
<li>Authenticating access to the media repository - for now, we still rely on media IDs being almost impossible to guess to protect the data rather than authenticating the user.</li>
<li>Deleting items from the media repository - we still need to hook up deletion APIs.</li>
<li>Garbage collecting forgotten rooms.  If everyone leaves &amp; forgets a room, we should delete it from the DB.</li>
<li><a href="https://github.com/matrix-org/matrix-doc/issues/1280">Communicating erasure requests over federation </a></li>
</ul>
<p>We’ll continue to work on these as part of our ongoing maintenance backlog.</p>
<p>Separately to the data privacy concerns, we’ve had a <a href="https://news.ycombinator.com/item?id=20515069">separate wave of
feedback</a> regarding how we
handle GDPR Data Subject Access Requests (DSARs). Particularly: whether DSAR
responses should contain solely the info your have directly keyed by the
requesting Matrix ID - or if we should provide all the data “visible” to that
ID (i.e. the history of the conversations they’ve been part of).  We went and
got professional legal advice on this one, and the conclusion is that we
should keep our responses to DSARs as tightly scoped as possible. We <a href="https://github.com/vector-im/policies/pull/7/files?short_path=09dc019#diff-09dc019b94b6efb90fa9f6e5c836f310">updated
Matrix.org’s privacy
policy</a>
and DSAR tools to reflect the new legal input.</p>
<p>Finally, it’s really worth calling out the amount of effort that went into
this project. Huge huge thanks to everyone involved (given it’s cut across
pretty much every project &amp; subteam we have working on the core of Matrix) who
have soldiered through the backlog.  We’ve been tracking progress using our
<a href="https://github.com/vector-im/feature-dashboard">feature-dashboard</a> tool which
summarises Github issues based on labels &amp; issue lifecycle, and for better or
worse it’s ended up being the biggest project board we’ve ever had.  You can
see the live data
<a href="https://vector-im.github.io/feature-dashboard/#/plan?label=privacy-sprint&amp;repo=vector-im/riot-web&amp;repo=vector-im/riot-ios&amp;repo=vector-im/riot-android&amp;repo=vector-im/riotX-android&amp;repo=matrix-org/matrix-doc&amp;repo=matrix-org/sydent&amp;repo=matrix-org/synapse">here</a>
(warning, it takes tens of seconds to spider Github to gather the data) - or,
for posterity and ease of reference, I’ve included the current issue list
below.  The issues which are completed have “done” after them; the ones still
in progress say “in progress”, and ones which haven’t started yet have
nothing. We split the project into 3 phases - phases 1 and 2 represent the
items needed to fully solve the privacy concerns, phase 3 is right now a mix
of &quot;nice to have&quot; polish and some more speculative items.  At this point we’ve
effectively finished phase 1 on Synapse &amp; Riot/Web, and Riot/Mobile is
following close behind.  We're continuing to work on phase 2, and we’ll work
through phase 3 (where appropriate) as part of our general maintenance
backlog.</p>
<p>I hope this gives suitable visibility on how we’re considering privacy; after
all, Matrix is useless as an open communication protocol if the openness comes
at the expense of user privacy.  We’ll give another update once the remaining
straggling issues are closed out; and meanwhile, now the bulk of the privacy
work is out of the way on Riot/Web, we can <strong>finally</strong> get back to
implementing the UI E2E cross-signing verification and improving first time
user experience.</p>
<p>Thanks for your patience and understanding while we’ve sorted this stuff out;
and thanks once again for flying Matrix :)</p>
<p><em>In the absence of comments on the current blog, please feel free to discuss
over at <a href="https://news.ycombinator.com/item?id=21091908">HN</a>, or alternatively come ask stuff in
our AMA over at
<a href="https://www.reddit.com/r/privacy/comments/da219t/im_project_lead_for_matrixorg_the_open_protocol/">/r/privacy</a>
(starting ~5pm GMT+1 (UK) on Friday Sept 27th).</em></p>
<h3 id="the-privacy-project-dashboard-of-doom">The Privacy Project Dashboard Of Doom</h3>
<ul>
<li>phase:1
<ul>
<li>vector-im/riot-web
<ul>
<li><a href="https://github.com/vector-im/riot-web/issues/5846">5846 Riot duplicates calls to Scalar</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/5921">5921 Ability to disable all identity server functionality via the config file</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/6802">6802 riot shouldn't try to load integrations from an integration manager unless the user has accepted that manager's privacy policies</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10088">10088 Prompt to accept integration manager polices on use</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10090">10090 Make sure there are no ugly edge cases running Riot without an integrations manager</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10091">10091 Decouple setting an email for password reset from publishing your threepid to the identity server and support choice of identity server (on registration)</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10092">10092 Prompt to accept Identity Server policies on registration</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10093">10093 Prompt to accept identity server policies before inviting them to a room</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10094">10094 Store identity server in Account Data and support choosing identity server integration in User Settings</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10159">10159 Enable toggling a threepid's association with the current IS in User Settings</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10173">10173 VoIP: Stop falling back to Google for STUN</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10216">10216 We should make it clear in the UI that device names are publicly readable</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10386">10386 Terms modal prompt should appear without a flash of the integration manager portal first</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10408">10408 Identity server v2 API authentication</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10423">10423 Deploy a develop environment for t's and c's flows for IM and IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10424">10424 Remove the bind true flag from 3PID calls on registration</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10425">10425 Ability to disconnect from the identity server by pressing buttons in user settings.</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10452">10452 Test IS v2 access tokens for validity</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10497">10497 Integration manager terms hides terms that need signing</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10510">10510 Remove the bind true flag from 3PID adds in settings</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10519">10519 Update discovery and account 3PID sections when either changes</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10522">10522 Handle terms agreement in the Discovery section of settings</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10525">10525 IS interactions proxied through the HS also need terms agreement</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10528">10528 don't try &amp; show threepids in discovery section if we don't have an ID server</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10539">10539 Inline terms agreement on change IS and IM</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10540">10540 When using Riot without an IS, identity requests are sent to server hosting Riot</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10546">10546 Prompt for fallback VOIP should only happen when the user tries to make a call</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10550">10550 warn when disconnecting ID server if there are any current bindings</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10552">10552 Allow email registration, password reset &amp; adding 3pids when no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10553">10553 Remove the ability to set an IS at login/registration</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10556">10556 Use the hashed v2 lookup API for 3PIDs</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10561">10561 Scalar should serve a .well-known file</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10566">10566 Use nicer APIs for toggling a 3PID's shared status</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10571">10571 Allow email registration when no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10572">10572 Allow password reset when no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10573">10573 Allow adding 3pids when no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10574">10574 Placeholder issue for MSCs that should land prior to the privacy release</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10593">10593 Placeholder issue for privacy migration path</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10597">10597 Ensure IS in account data is read / written as specced</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10599">10599 Send IS for adding MSISDNs only when required by HS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10603">10603 Getting a terms prompt when inviting an email address clears the address picker</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10619">10619 Handle the case of no IS in features that require IS to lookup</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10620">10620 Change auth flows so that you default to no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10634">10634 Changing to vector.im IS in Settings fails because /terms 404s</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10635">10635 Inline terms agreement in Discovery should still show change and do not use</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10636">10636 The UX is a little confusing if you haven't accepted the terms of the default identity server.</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10637">10637 Unable to add email address to HS account without IS set</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10660">10660 Sydent implementation: Unauthed v1, clone all endpoints, auth v2</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10666">10666 In login/register, riot freezes if you go to Advanced, remove the IS url and click next</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10669">10669 Checking email invite account is unclear when no IS set</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10674">10674 Email help text on registration should be updated without binding</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10677">10677 Change text about other users being able to invite you by email on registration page</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10744">10744 Only set terms URLs in the account when they change</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10749">10749 Changing from one IS to another does not trigger bound 3PID warning</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10750">10750 Bound 3PIDs warning should better explain what's being left behind</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10754">10754 Lowercase emails during IS lookup calls</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10755">10755 Terms account data is meant to be additive, but currently sets only new URLs</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10756">10756 After changing IS to termstest.matrix.org the text field isn't cleared and the button remains active</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10757">10757 After changing IS back to vector.im the text field isn't cleared and the button remains active</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10758">10758 Revoke may be too vague for unbinding a 3PID</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10779">10779 When publishing a threepid to an IS, if you click 'continue' before clicking the link in your email, we delete your threepid from the HS.</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10800">10800 Community invite should not talk about ISes at all.</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10823">10823 IS with unagreed terms will block you from adding even unshared 3PIDs to your HS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10839">10839 Use the new backend APIs for adding-3pid-to-homeserver and binding-3pid-on-identity-server when they exist.</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10878">10878 UX regression when trying to invite by email if no IS is configured</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10883">10883 Riot should check for r0.6.0 server support alongside feature flags</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10923">10923 Send validation tokens to submit_url from HS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10933">10933 Do not include ID server or access token when HS supports MSC2290</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10939">10939 Registration with MSISDN needs to use submit_url</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10941">10941 threepid_creds for registration and password reset still include id_server</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10959">10959 Remove id_server from email threepid_creds</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10604">10604 QA: Re-test ALL of the identity server interactions</a> (in progress)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10958">10958 Terms of Service nitpicks</a> (in progress)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10704">10704 We treat an empty string identity server as not having one</a></li>
</ul>
</li>
<li>vector-im/riot-ios
<ul>
<li><a href="https://github.com/vector-im/riot-ios/issues/2518">2518 Make sure there are no ugly edge cases running Riot without an integrations manager</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2521">2521 Privacy: Improve wording on contact upload UI</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2532">2532 VoIP: Stop falling back to Google for STUN</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2600">2600 Prompt to accept integration manager polices on use</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2601">2601 Decouple setting an email for password reset from publishing your threepid to the identity server and support choice of identity server (on registration)</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2602">2602 Prompt to accept identity server policies before inviting them to a room</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2603">2603 Identity server v2 API authentication</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2606">2606 Settings: Add a Discovery section</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2608">2608 Registration: Update consents flow</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2643">2643 Ability to disable all identity server functionality via the config file</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2646">2646 VoIP: Fallback to matrix.org STUN server with a confirmation dialog</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2647">2647 MXRestClient: Move IS API to its own</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2648">2648 Remove the bind true flag from 3PID calls on registration</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2650">2650 Remove the bind true flag from 3PID adds in settings</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2651">2651 Store identity server in Account Data and support choosing identity server integration in User Settings</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2652">2652 Use the hashed v2 lookup API for 3PIDs</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2653">2653 Allow email registration, password reset &amp; adding 3pids when no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2654">2654 Use nicer APIs for toggling a 3PID's shared status</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2657">2657 Allow email registration when no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2658">2658 Allow password reset when no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2659">2659 Allow adding 3pids when no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2660">2660 Handle terms agreement in the Discovery section of settings</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2661">2661 Remove the ability to set an IS at login/registration</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2662">2662 We should make it clear in the UI that device names are publicly readable</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2664">2664 Placeholder issue for privacy migration path</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2665">2665 Ensure IS in account data is read / written as specced</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2672">2672 Handle the case of no IS in features that require IS to lookup</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2675">2675 Email help text on registration should be updated without binding</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2682">2682 Send IS for adding MSISDNs only when required by HS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2686">2686 Use wellknown to discover the IS of a custom HS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2696">2696 Lowercase emails during IS lookup calls</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2704">2704 Use <code>id_access_token</code> in CS API when required</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2604">2604 Settings: Ability to change the identity server</a> (in progress)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2649">2649 Ability to disconnect from the identity server by pressing buttons in user settings</a> (in progress)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2713">2713 Use the new backend APIs for adding-3pid-to-homeserver and binding-3pid-on-identity-server when they exist.</a> (in progress)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2718">2718 Riot should check for r0.6.0 server support alongside feature flags</a> (in progress)</li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2683">2683 Checking email invite account is unclear when no IS set</a></li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2731">2731 Send validation tokens to submit_url from HS</a></li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2732">2732 Do not include ID server or access token when HS supports MSC2290</a></li>
<li><a href="https://github.com/vector-im/riot-ios/issues/2736">2736 IS terms cannot be accepted anymore</a></li>
</ul>
</li>
<li>vector-im/riot-android
<ul>
<li><a href="https://github.com/vector-im/riot-android/issues/3223">3223 VoIP: Stop falling back to Google for STUN</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3224">3224 Make sure there are no ugly edge cases running Riot without an integrations manager</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3225">3225 Prompt to accept integration manager polices on use </a>(done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3226">3226 Decouple setting an email for password reset from publishing your threepid to the identity server and support choice of identity server (on registration)</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3227">3227 Prompt to accept identity server policies before inviting them to a room</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3228">3228 Identity server v2 API authentication</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3229">3229 Settings: Ability to change the identity server</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3230">3230 Settings: Add a Discovery section</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3231">3231 Registration: Update consents flow</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3252">3252 Remove the bind true flag from 3PID calls on registration</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3253">3253 Ability to disconnect from the identity server by pressing buttons in user settings</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3254">3254 Remove the bind true flag from 3PID adds in settings</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3256">3256 Store identity server in Account Data and support choosing identity server integration in User Settings</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3257">3257 Use the hashed v2 lookup API for 3PIDs</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3258">3258 Allow email registration, password reset &amp; adding 3pids when no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3260">3260 Allow email registration when no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3261">3261 Allow password reset when no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3262">3262 Allow adding 3pids when no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3263">3263 Handle terms agreement in the Discovery section of settings</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3264">3264 Remove the ability to set an IS at login/registration</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3265">3265 We should make it clear in the UI that device names are publicly readable</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3268">3268 Placeholder issue for privacy migration path</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3269">3269 Ensure IS in account data is read / written as specced</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3277">3277 Handle the case of no IS in features that require IS to lookup</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3278">3278 Email help text on registration should be updated without binding</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3281">3281 Send IS for adding MSISDNs only when required by HS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3283">3283 Use wellknown to discover the IS of a custom HS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3289">3289 Lowercase emails during IS lookup calls</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3295">3295 Use <code>id_access_token</code> in CS API when required</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3300">3300 Use the new backend APIs for adding-3pid-to-homeserver and binding-3pid-on-identity-server when they exist. </a>(done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3312">3312 Riot should check for r0.6.0 server support alongside feature flags</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3316">3316 Implement MSC2290</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3324">3324 id_server param sent when registering an email on server that does not requires one</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3326">3326 Discovery Settings / infinite loading if terms not signed on existing IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3327">3327 vector.im is seen as having no terms, but it does</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3251">3251 VoIP: Fallback to matrix.org STUN server with a confirmation dialog</a> (in progress)</li>
<li><a href="https://github.com/vector-im/riot-android/issues/3248">3248 Ability to disable all identity server functionality via the config file</a></li>
<li><a href="https://github.com/vector-im/riot-android/issues/3318">3318 Send validation tokens to submit_url from HS</a></li>
<li><a href="https://github.com/vector-im/riot-android/issues/3322">3322 Do not include ID server or access token when HS supports MSC2290</a></li>
</ul>
</li>
<li>vector-im/riotX-android
<ul>
<li><a href="https://github.com/vector-im/riotX-android/issues/490">490 Allow email registration, password reset &amp; adding 3pids when no IS</a> (done)</li>
<li><a href="https://github.com/vector-im/riotX-android/issues/432">432 Prompt to accept integration manager polices on use</a> (in progress)</li>
<li><a href="https://github.com/vector-im/riotX-android/issues/431">431 Make sure there are no ugly edge cases running Riot without an integrations manager</a></li>
<li><a href="https://github.com/vector-im/riotX-android/issues/433">433 Decouple setting an email for password reset from publishing your threepid to the identity server and support choice of identity server (on registration)</a></li>
<li><a href="https://github.com/vector-im/riotX-android/issues/434">434 Prompt to accept identity server policies before inviting them to a room</a></li>
<li><a href="https://github.com/vector-im/riotX-android/issues/435">435 Identity server v2 API authentication</a></li>
<li><a href="https://github.com/vector-im/riotX-android/issues/436">436 Settings: Ability to change the identity server</a></li>
<li><a href="https://github.com/vector-im/riotX-android/issues/438">438 Settings: Add a Discovery section</a></li>
<li><a href="https://github.com/vector-im/riotX-android/issues/439">439 Registration: Update consents flow</a></li>
<li><a href="https://github.com/vector-im/riotX-android/issues/489">489 Use the hashed v2 lookup API for 3PIDs</a></li>
</ul>
</li>
<li>matrix-org/matrix-doc
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/1961">1961 MSC1961: Integration manager authentication APIs</a> (done)</li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2078">2078 MSC2078: Sending Third-Party Request Tokens via the Homeserver</a> (done)</li>
<li><a href="https://github.com/matrix-org/matrix-doc/issues/2130">2130 Identity service should do lookups based on hashed 3PIDs, not plaintext ones.</a> (done)</li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2134">2134 MSC2134: Identity Hash Lookups</a> (done)</li>
<li><a href="https://github.com/matrix-org/matrix-doc/issues/2139">2139 Method for ISes and Integration managers to provide terms of service</a> (done)</li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2140">2140 MSC2140: Terms of Service for ISes and IMs</a> (done)</li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2229">2229 MSC2229: Allowing 3PID Owners to Rebind</a> (done)</li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2230">2230 MSC2230: Store Identity Server in Account Data</a> (done)</li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2263">2263 MSC2263: Give homeservers the ability to handle their own 3PID registrations/password resets</a> (done)</li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2264">2264 MSC2264: Add an unstable feature flag to MSC2140 for clients to detect support</a> (done)</li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2290">2290 MSC2290: Separate Endpoints for Threepid Binding</a> (in progress)</li>
</ul>
</li>
<li>matrix-org/sydent
<ul>
<li><a href="https://github.com/matrix-org/sydent/issues/178">178 Support for MSC2140</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/179">179 Support testing with matrix-is-tester</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/180">180 Support for MSC2140</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/181">181 Deny bindings to anything other than the mxid you're authed as</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/184">184 Hash 3PID lookups</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/186">186 Don't fail the unbind request if the binding doesn't exist</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/187">187 Add more tweaks to terms branch</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/issues/189">189 Redact looked-up threepids from the application logs.</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/issues/191">191 Add OpenID auth to 3PID hash lookup</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/197">197 Have 'mappings' contain medium as well as address</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/198">198 Throw exception on bad args &amp; catch in wrapper</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/199">199 Return algorithm, lookup_pepper in M_INVALID_PEPPER response</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/200">200 Support MSC2140 register/terms endpoints</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/201">201 Port v1 endpoints to v2</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/202">202 Deny bindings to anything other than the mxid you're authed as</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/204">204 Fix the signing servlet</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/205">205 Correct API v1 path check in get_args</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/206">206 Fix terms POST</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/issues/207">207 Deploy policy file</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/208">208 Remove PII logging from log-level INFO</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/pull/213">213 Delete threepid assocs on unbind and remove existing with migration</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/issues/217">217 Allow non-matrix.org MXIDs via v2 only once terms are enabled</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/issues/218">218 Unbind fails to remove the binding on matrix.org IS</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/issues/220">220 Unbind fails to work for bindings where it was attempted with #213</a> (done)</li>
<li><a href="https://github.com/matrix-org/sydent/issues/192">192 Sydent doesn't delete 3PIDs from DB on unbind</a> (in progress)</li>
</ul>
</li>
<li>matrix-org/synapse
<ul>
<li><a href="https://github.com/matrix-org/synapse/issues/1287">1287 We need to actually censor redactions from the DB (SYN-284)</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/5751">5751 Make homeservers able to handle registration-with-email without depending on an Identity Server</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/5786">5786 Support IS v2 API with authentication for requests proxied to the IS</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/5827">5827 Add 3PID unbind API for MSC2140</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5835">5835 [1/2] Allow homeservers to send registration emails | Sending the email</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/5861">5861 Use the v2 lookup API for 3PID invites</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/5862">5862 Allow account owners to rebind 3PIDs as in MSC2229</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5868">5868 Add flag in /versions for whether clients should send id_server params</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/5874">5874 Placeholder issue for privacy migration path</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5875">5875 Remove trusted_third_party_id_servers functionality</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5876">5876 Replace trust_identity_server_for_password_resets with account_threepid_delegate</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5892">5892 Switch to using v2 Identity Service APIs other than lookup (MSC 2140)</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5897">5897 Use the v2 lookup API for 3PID invites</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/5927">5927 Add a m.id_access_token flag to unstable_features</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/5928">5928 Split account_threepid_handler into a msisdn and email versions</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/5929">5929 Use account_threepid_delegate for sending SMS</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5930">5930 Add m.id_access_token flag</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5934">5934 Censor redactions in DB after a month</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/5935">5935 Use federation blacklist for requests to identity servers</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5937">5937 Revert &quot;Use the v2 lookup API for 3PID invites&quot;</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5940">5940 [2/2] Allow homeservers to send registration emails | Accepting the verification</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5945">5945 Revert &quot;Add m.id_access_token flag&quot;</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5948">5948 Support v2 Identity Server APIs</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5964">5964 Remove bind_email and bind_msisdn</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5968">5968 Set m.require_identity_server to always be False</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5969">5969 Change account_threepid_delegate to a dictionary</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5972">5972 Add m.require_identity_server to /versions unstable_flags</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5974">5974 Add m.id_access_token to /versions unstable_features (MSC2264)</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5976">5976 Use the v2 Identity Service API for lookups (MSC2134 + MSC2140)</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5979">5979 v2 3PID Invites (part of MSC2140)</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5980">5980 Add POST /_matrix/client/r0/account/3pid/unbind (MSC2140)</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5987">5987 Allow Synapse to send registration emails + choose Synapse or an external server to handle 3pid validation</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/5996">5996 Allow users to rebind 3pids they own (MSC2229)</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/6000">6000 Use the federation blacklist for requests to untrusted Identity Servers</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/6011">6011 Use account_threepid_delegate for 3pid validation</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/6013">6013 Fix existing v2 identity server calls (MSC2140)</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/6042">6042 Allow HS to send emails when adding an email to the HS</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/6043">6043 Implement MSC2290</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/6044">6044 Add an unstable feature flag for separate add/bind 3pid APIs</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/6062">6062 Use unstable prefix for 3PID unbind API</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/6067">6067 Drop support for bind param on POST /account/3pid (MSC2290)</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/6076">6076 Synapse doesn't give clients a submit_url on requestToken breaking msisdn adding</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/6078">6078 Add POST submit_token endpoint for MSISDN</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/6079">6079 Add submit_url response parameter to msisdn /requestToken</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/6087">6087 Remove hardcoded defaults of matrix.org and vector.im in configuration</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/pull/6090">6090 Explicitly log when a homeserver does not have a trusted key server configured </a>(done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/6096">6096 Riot Web expects the email validation next_link to have the sid appended</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/6100">6100 Remove email from registration flows if it’s unsupported</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/6103">6103 _check_threepid in auth.py incorrect for MSISDN</a> (done)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/6045">6045 Support Client-Server API r0.6.0</a> (in progress)</li>
<li><a href="https://github.com/matrix-org/synapse/issues/1263">1263 When we redact events, any mxc content they refer to should be redacted too (SYN-216)</a></li>
<li><a href="https://github.com/matrix-org/synapse/issues/4565">4565 Metadata resistance.</a></li>
<li><a href="https://github.com/matrix-org/synapse/issues/6086">6086 Fetch signing-keys directly from servers before falling back to the trusted_key_servers</a></li>
</ul>
</li>
</ul>
</li>
<li>phase:2
<ul>
<li>vector-im/riot-web
<ul>
<li><a href="https://github.com/vector-im/riot-web/issues/4913">4913 Option for homeservers to set a default integration manager</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10161">10161 Store Integration Manager preferences in account data and allow user to change them somewhere sensible</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10967">10967 Disconnect from identity server fails</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10443">10443 Remove v1 IS API fallbacks once servers are updated</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10557">10557 Prompt users each time before sending data to an Identity Server that doesn't have a terms of service (unless you have actively set that IS in your account data).</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10696">10696 Allow users to disconnect from an integration manager entirely in the same way that we support doing this for identity servers</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10909">10909 Unable to disconnect from IS if the server is unavailable</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10936">10936 Refine submit_url handling to only activate with separate add and bind</a></li>
</ul>
</li>
<li>vector-im/riot-ios
<ul>
<li><a href="https://github.com/vector-im/riot-ios/issues/2711">2711 Provide a better UX for users considering sharing their contact list with an IS to discover people they know already using Matrix</a></li>
</ul>
</li>
<li>vector-im/riot-android
<ul>
<li><a href="https://github.com/vector-im/riot-android/issues/3282">3282 Checking email invite account is unclear when no IS set</a></li>
<li><a href="https://github.com/vector-im/riot-android/issues/3323">3323 Post MSC2290 bug / Clicking on the validation mail link fails registration</a></li>
</ul>
</li>
<li>matrix-org/matrix-doc
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/1957">1957 MSC1957: Integration manager discovery</a> (done)</li>
</ul>
</li>
<li>matrix-org/sydent
<ul>
<li><a href="https://github.com/matrix-org/sydent/issues/196">196 Remove the lookup_hash field from local_threepid_associations</a> (in progress)</li>
</ul>
</li>
<li>matrix-org/synapse
<ul>
<li><a href="https://github.com/matrix-org/synapse/issues/5881">5881 Remove trust_identity_server_for_password_resets and account_threepid_delegate options</a></li>
</ul>
</li>
</ul>
</li>
<li>phase:3
<ul>
<li>vector-im/riot-web
<ul>
<li><a href="https://github.com/vector-im/riot-web/issues/10563">10563 Add better domain for turn.matrix.org use as STUN server</a> (done)</li>
<li><a href="https://github.com/vector-im/riot-web/issues/10087">10087 Prompt to accept integration manager policies on registration</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10167">10167 Present an aggregated terms of service dialogue at registration if possible</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10168">10168 If a user has disabled the identity server integration on their account, we should make invite user handle this nicely</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10401">10401 Invite new users to publish their threepids to the identity server</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10422">10422 Use more contextual prompt for integration manager polices on use</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10453">10453 Log out from IM on Riot log out and IM removal</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10455">10455 Log out from IS on Riot log out and IS removal</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10487">10487 Store the date of users having read and accepted the IM policies in the IM db</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10488">10488 Store the date of users having read and accepted the IS policies in the IS db</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10498">10498 Terms test scalar requires the legacy ?v query param on the new account route</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10575">10575 We should show the 'must configure TURN' warning when a call fails, even after using the fallback turn.matrix.org</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10615">10615 Change all IS access token APIs to use getIdentityAccessToken only</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10671">10671 riot submits sign-ed25519 requests as POST requests with params in query string and empty body</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10746">10746 /invite doesn't force terms with older homeservers</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10830">10830 Show IS policy links in user settings somewhere.</a></li>
<li><a href="https://github.com/vector-im/riot-web/issues/10950">10950 Unhelpful 400 error when adding MSISDN and server doesn’t delegate</a></li>
</ul>
</li>
<li>vector-im/riot-ios
<ul>
<li><a href="https://github.com/vector-im/riot-ios/issues/2710">2710 Show IS policy links in user settings somewhere.</a></li>
</ul>
</li>
<li>matrix-org/matrix-doc
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/issues/447">447 We need a way to be able to expire data from a HS. (SPEC-141)</a></li>
</ul>
</li>
<li>matrix-org/synapse
<ul>
<li><a href="https://github.com/matrix-org/synapse/issues/5830">5830 <code>pushers</code> table contains user device names, which may include user real names</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2019&#x2F;09&#x2F;27&#x2F;this-week-in-matrix-2019-09-27&#x2F;" title="This Week in Matrix 2019-09-27">This Week in Matrix 2019-09-27</a></h1>
            <span>
                27.09.2019 00:00
                —
                <a href="/category/this-week-in-matrix">
                    This Week in Matrix
                </a>
                —
                
                <a href="/author/ben-parsons">
                    Ben Parsons
                </a>
                
            </span>
            
        </header>
        <div>
            <h2 id="dept-of-status-of-matrix-face-with-th">Dept of <em>Status of Matrix</em> 🌡</h2>
<h3 id="matrix-ama-on-r-privacy-happening-this-weekend">Matrix AMA on /r/privacy happening this weekend</h3>
<p>Go check out <a href="https://www.reddit.com/r/privacy/comments/da219t/im_project_lead_for_matrixorg_the_open_protocol/">https://www.reddit.com/r/privacy/comments/da219t/im_project_lead_for_matrixorg_the_open_protocol/</a> and join in asking questions!</p>
<h3 id="first-librem-5-smartphones-are-shipping">First Librem 5 Smartphones are Shipping</h3>
<p>Might be interesting to readers: the phone with Matrix at its core is starting to ship: <a href="https://puri.sm/posts/first-librem-5-smartphones-are-shipping/">https://puri.sm/posts/first-librem-5-smartphones-are-shipping/</a>.</p>
<h3 id="fork-awesome-includes-matrix-icon">Fork Awesome includes Matrix icon</h3>
<p><a href="https://forkaweso.me/">Fork Awesome</a> now include the <code>[ m ]</code> as an icon! View it at <a href="https://forkaweso.me/Fork-Awesome/icon/matrix-org/">https://forkaweso.me/Fork-Awesome/icon/matrix-org/</a></p>
<h2 id="dept-of-spec-scroll">Dept of Spec 📜</h2>
<p>Following on from last week, the 3 MSCs the spec core team have chosen to focus on this week are: <a href="https://github.com/matrix-org/matrix-doc/pull/2290">2290</a> (3pid binding endpoints), <a href="https://github.com/matrix-org/matrix-doc/pull/2176">2176</a> (redaction rules), and <a href="https://github.com/matrix-org/matrix-doc/issues/1219">1219</a> (key backups), spurred on by finishing off the spec work for the privacy sprint, and cross signing.</p>
<p>MSC Updates:</p>
<p>News from <strong>2019-09-20 09:00:00</strong> until <strong>2019-09-27 20:07:55</strong>.</p>
<p><strong>Merged MSCs</strong></p>
<p><em>No MSCs have been merged this week.</em></p>
<p><strong>Final Comment Period</strong></p>
<p><em>No MSCs have entered FCP this week.</em></p>
<p><strong>New MSCs</strong></p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2306">[WIP] MSC2306: Removing MSISDN password resets</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2299">MSC2299: Proposal to add m.textfile msgtype</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2300">MSC2300: /ping endpoint</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2301">MSC2301: server info endpoint</a></li>
</ul>
<h2 id="dept-of-servers-europea">Dept of Servers 🏢</h2>
<h3 id="synapse-v1-4-0rc1">Synapse v1.4.0rc1</h3>
<p><a href="https://matrix.to/#/@neilj:matrix.org">Neil</a> told us:</p>
<blockquote>
<p>This week we put out a <a href="https://github.com/matrix-org/synapse/releases/tag/v1.4.0rc1">release candidate for 1.4.0</a> which support a whole host of privacy features including greater control over interactions with identity servers, cleaning up redacted events and user meta data (like IPs and user agents) and warning users when they are using the default trusted key server (matrix.org).</p>
<p>Aside from privacy, the thing that is most exciting is switching on our solution for <a href="https://github.com/matrix-org/synapse/issues/5319">mitigating forward extremities build up</a> by default. It should make a big difference for the CPU of servers in fragmented rooms.</p>
</blockquote>
<h3 id="matrix-corporal-v1-6-0">matrix-corporal v1.6.0</h3>
<p><a href="https://matrix.to/#/@slavi:devture.com">Slavi</a> reported:</p>
<blockquote>
<p><a href="https://github.com/devture/matrix-corporal">matrix-corporal</a> v1.6.0 was recently released to address an issue when used in conjunction with Synapse Single-Sign-On login flows (CAS or SAML).</p>
<p>Until now, matrix-corporal used to interfere with <code>/login</code> requests and demand that users always authenticate with a username/password.
Since v1.6.0, you can use matrix-corporal for automatic management of users/rooms/communities, while letting authentication happen through SSO (as provided by Synapse).</p>
</blockquote>
<h2 id="dept-of-bridges-bridge-at-night">Dept of Bridges 🌉</h2>
<h3 id="famedly-email-bridge">famedly-email-bridge</h3>
<p><a href="https://matrix.to/#/@sorunome:sorunome.de">sorunome</a> offered:</p>
<blockquote>
<p><a href="https://gitlab.com/famedly/bridges/famedly-email-bridge">famedly-email-bridge</a> should be fully working now! Not only is there a readme now, but also a share of other changes:</p>
<ul>
<li>whitelist/blacklist who may use the bridge</li>
<li>threaded conversation: rooms in which you just send messages as if to chat and the bridge bundles them into emails and sends them off</li>
<li>invite ghosts to a room to start a threaded conversation</li>
<li>incoming emails in email rooms have a link to reply to, starting a threaded conversation</li>
<li>email templates for sending emails: add a header or footer, if you want</li>
<li>sanitize incoming HTML to make sure it is only matrix' subset</li>
</ul>
</blockquote>
<h3 id="new-twilio-bridge-mautrix-twilio">New Twilio bridge: mautrix-twilio</h3>
<p><a href="https://matrix.to/#/@tulir:maunium.net">Tulir</a> told us:</p>
<blockquote>
<p><a href="https://github.com/tulir/mautrix-twilio">https://github.com/tulir/mautrix-twilio</a> / <a href="https://matrix.to/#/#twilio:maunium.net">#twilio:maunium.net</a> is now a thing. Message (+formatting) and media bridging works. Unlike all my other bridges, this one is a relaybot-style bridge.</p>
<p>I'm also working on a maubot that accepts invites, announces them in a control room and then invites people from that control room when requested. That bot should be ready NWIM.</p>
</blockquote>
<h3 id="matrix-appservice-slack-1-0-0-rc3">matrix-appservice-slack 1.0.0-rc3</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> reported:</p>
<blockquote>
<p><a href="https://github.com/matrix-org/matrix-appservice-slack/releases/tag/1.0.0-rc3">The slack bridge got an RC3</a> today and it is now LIVE on matrix.org!! This brings in a whole host of new changes like speedups for message processing, typing notifications and more reliable edits/reactions/replies. Since the 1.0 release required a migration of data files, we have made every effort to migrate integrations across. If you find that your slack bridge (hosted on matrix.org) is no longer working, please contact me</p>
</blockquote>
<h3 id="matrix-appservice-irc-0-13-0">matrix-appservice-irc 0.13.0</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> told us:</p>
<blockquote>
<p>Hi folks, the IRC bridge has <em>finally</em> gotten its 0.13.0 release this morning. <a href="https://github.com/matrix-org/matrix-appservice-irc/releases">https://github.com/matrix-org/matrix-appservice-irc/releases</a> contains all the juicy details</p>
</blockquote>
<h3 id="bifrost-resumed">Bifrost resumed</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> offered:</p>
<blockquote>
<p>Work on Bifrost has resumed! We're doing our best to refactor and replace bits that were hacked together at the start of the year and really improve on reliability and documentation. The official matrix.org bridge awaiting our work on PostgreSQL before we can move it further, but the project is accelerating :) <a href="https://github.com/matrix-org/matrix-bifrost/tree/develop">https://github.com/matrix-org/matrix-bifrost/tree/develop</a></p>
</blockquote>
<h2 id="dept-of-clients-iphone">Dept of Clients 📱</h2>
<h3 id="riot-vim">&quot;riot-vim&quot;</h3>
<p><a href="https://matrix.to/#/@maze:sorunome.de">maze</a> reported:</p>
<blockquote>
<p>Hello. I made a thing for using the Vim text editor for sending messages in Riot, and a friend suggested I share it here. Here it is: <a href="https://gitlab.com/MRAAGH/riot-vim#riot-vim">https://gitlab.com/MRAAGH/riot-vim#riot-vim</a></p>
</blockquote>
<p>This thing is bananas - take a look at the gif.</p>
<h3 id="new-client-library-for-elixir-polyjuice-client">New client library for Elixir: polyjuice_client</h3>
<p><a href="https://matrix.to/#/@uhoreg:matrix.org">uhoreg</a> said:</p>
<blockquote>
<p>I have extracted <a href="https://gitlab.com/uhoreg/igor">Igor</a>'s guts, and have distilled them into a new client library for Elixir: <a href="https://hex.pm/packages/polyjuice_client">polyjuice_client</a>.  I've also started working on a library of Matrix utility functions for Elixir that would be relevant to multiple components (clients, application services, homeservers, identity servers): <a href="https://gitlab.com/uhoreg/polyjuice_util">polyjuice_util</a>.</p>
</blockquote>
<h3 id="continuum-0-9-25">Continuum 0.9.25</h3>
<p><a href="https://matrix.to/#/@uforia:matrix.org">yuforia</a> told us:</p>
<blockquote>
<p><a href="https://github.com/koma-im/continuum-desktop">Continuum</a>, desktop client written in Kotlin, version 0.9.25:</p>
<ul>
<li>Change text color of selected item in room list for higher contrast.</li>
</ul>
<p><a href="https://matrix.org/_matrix/media/r0/download/matrix.org/ubsrqTgTUzbzklPGnTbRfqQr">https://matrix.org/_matrix/media/r0/download/matrix.org/ubsrqTgTUzbzklPGnTbRfqQr</a></p>
<p><a href="https://github.com/koma-im/koma-library">koma</a>, the library behind Continuum:</p>
<ul>
<li>Force new TCP connection when a SocketTimeoutException occurs in a pooled connection to fix recurrent timeout errors caused by connection reuse.</li>
</ul>
</blockquote>
<h3 id="fractal-4-2-1">Fractal 4.2.1</h3>
<p><a href="https://matrix.to/#/@afranke:matrix.org">Alexandre Franke</a> reported:</p>
<blockquote>
<p>Fractal 4.2.1 got released, with a bunch of updated translations, a crasher fix and a couple of other bug fixes.</p>
</blockquote>
<h3 id="riot-android">Riot Android</h3>
<p><a href="https://matrix.to/#/@benoit.marty:matrix.org">benoit</a> told us:</p>
<blockquote>
<p>the privacy work is in review. The release will be done soon</p>
</blockquote>
<h3 id="riotx">RiotX</h3>
<p><a href="https://matrix.to/#/@benoit.marty:matrix.org">benoit</a> announced:</p>
<blockquote>
<p>RiotX: A big work to stabilize the application and to implement little missing feature has been done. Also Two releases has been done this week. Please refer the the changelog for a (rather) complete list of what has been done (<a href="https://github.com/vector-im/riotX-android/blob/develop/CHANGES.md">https://github.com/vector-im/riotX-android/blob/develop/CHANGES.md</a>)
Also the read marker feature is in review. There are still remaining bugs which will be fixed before the merge.</p>
</blockquote>
<p>RiotX is really coming along, please try it out.</p>
<h2 id="dept-of-ops">Dept of Ops 🛠</h2>
<h3 id="new-synapse-docker-image">New Synapse Docker Image</h3>
<p><a href="https://matrix.to/#/@bhat:encom.eu.org">Black Hat</a> reported:</p>
<blockquote>
<p>I made <a href="https://hub.docker.com/r/black0/synapse-pypy">a docker image</a> for Synapse (again). However, this time it uses PyPy3. It is a drop-in replacement for <a href="https://hub.docker.com/r/matrixdotorg/synapse/">matrixdotorg/synapse</a>. Anyone is welcomed to test the impact of it on CPU utilization.</p>
</blockquote>
<h3 id="opensaps">OpenSAPS</h3>
<p><a href="https://matrix.to/#/@pztrn:pztrn.name">Stanislav</a> told us:</p>
<blockquote>
<p>OpenSAPS (Open Slack APi Server, <a href="https://gitlab.com/pztrn/opensaps)">https://gitlab.com/pztrn/opensaps)</a> is now provides Docker container for ease of use. Just mount <code>/app/opensaps.yaml</code> and you're set. Registry is reachable at <a href="https://gitlab.com/pztrn/opensaps/container_registry">https://gitlab.com/pztrn/opensaps/container_registry</a></p>
</blockquote>
<h2 id="dept-of-bots-robot-face">Dept of Bots 🤖</h2>
<h3 id="matrix-nio-project-template">matrix-nio project template</h3>
<p><a href="https://matrix.to/#/@andrewm:amorgan.xyz">anoa</a> offered:</p>
<blockquote>
<p>I made a template repository for creating Matrix bots with poljar's <a href="https://github.com/poljar/matrix-nio/">matrix-nio</a>: <a href="https://github.com/anoadragon453/nio-template">https://github.com/anoadragon453/nio-template</a>! It also has a room: <a href="https://matrix.to/#/#nio-template:amorgan.xyz">#nio-template:amorgan.xyz</a>.</p>
<p>If you've ever wanted to make a Matrix bot with python, this repository can help you get started.</p>
</blockquote>
<h3 id="matrix-fly-paper-is-now-matrix-fly-swatter-has-new-scope">matrix-fly-paper is now &quot;matrix-fly-swatter&quot;, has new scope</h3>
<p><a href="https://matrix.to/#/@serra:lost-angles.im">serra-allgood</a> offered:</p>
<blockquote>
<p>The <code>matrix-fly-paper</code> bot has been renamed to <a href="https://github.com/serra-allgood/matrix-fly-swatter">matrix-fly-swatter</a>. On reflection, I realized the original goals for the bot were too ambitious and the project has become an exercise in becoming familiar with the client&lt;-&gt;server api. The planned features have been cut back to simply automating sending <code>m.room.server_acl</code> events to several rooms at once. At a later date, planned features may be expanded, but there are other projects I'd have more fun working on in the meantime.</p>
</blockquote>
<h2 id="dept-of-ping-table-tennis-paddle-and-ball">Dept of Ping 🏓</h2>
<p>It's the section where we reveal, rank, and applaud the homeservers with the lowest ping, as measured by <a href="https://github.com/maubot/echo">pingbot</a>, a <a href="https://github.com/maubot/maubot">maubot</a> that you can host on your own server. Join <a href="https://matrix.to/#/#ping:maunium.net">#ping:maunium.net</a> to experience the fun live, and to find out how to add YOUR server to the game.</p>
<table><thead><tr><th style="text-align: center">Rank</th><th style="text-align: center">Hostname</th><th style="text-align: center">Median ms</th></tr></thead><tbody>
<tr><td style="text-align: center">1</td><td style="text-align: center">matrix.tetraodon.nl</td><td style="text-align: center">294</td></tr>
<tr><td style="text-align: center">2</td><td style="text-align: center">ufc.tu-dortmund.de</td><td style="text-align: center">331</td></tr>
<tr><td style="text-align: center">3</td><td style="text-align: center">fachschaften.org</td><td style="text-align: center">353</td></tr>
<tr><td style="text-align: center">4</td><td style="text-align: center">matrix.okeso.net</td><td style="text-align: center">377</td></tr>
<tr><td style="text-align: center">5</td><td style="text-align: center">poddery.com</td><td style="text-align: center">392.5</td></tr>
<tr><td style="text-align: center">6</td><td style="text-align: center">privacytools.io</td><td style="text-align: center">422.5</td></tr>
<tr><td style="text-align: center">7</td><td style="text-align: center">dodsorf.as</td><td style="text-align: center">433.5</td></tr>
<tr><td style="text-align: center">8</td><td style="text-align: center">linuxgl.ch</td><td style="text-align: center">459.5</td></tr>
<tr><td style="text-align: center">9</td><td style="text-align: center">matrix.vgorcum.com</td><td style="text-align: center">471</td></tr>
<tr><td style="text-align: center">10</td><td style="text-align: center">wolkenplanet.de</td><td style="text-align: center">492</td></tr>
</tbody></table>
<h2 id="that-s-all-i-know-checkered-flag">That's all I know 🏁</h2>
<p>See you next week, and be sure to stop by <a href="https://matrix.to/#/#TWIM:matrix.org">#twim:matrix.org</a> with your updates!</p>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2019&#x2F;09&#x2F;20&#x2F;qt-based-clients-end-to-end-encryption-support-final-report-g-so-c-2019&#x2F;" title="Qt-based clients end-to-end encryption support -- final report (GSoC 2019)">Qt-based clients end-to-end encryption support -- final report (GSoC 2019)</a></h1>
            <span>
                20.09.2019 02:10
                —
                <a href="/category/gsoc">
                    GSOC
                </a>
                —
                
                <a href="/author/alexey-andreyev">
                    Alexey Andreyev
                </a>
                
            </span>
            
        </header>
        <div>
            <h2 id="overview">Overview</h2>
<p>*<em>libQMatrixClient was <a href="https://github.com/quotient-im/libQuotient/issues/325">renamed</a> to libQuotient</em></p>
<p>The project aimed at adding end-to-end encryption to <a href="https://github.com/quotient-im/libQuotient">libQuotient</a> for future support in Qt/libQuotient-based clients like <a href="https://matrix.org/docs/projects/client/quaternion">Quaternion</a> and <a href="https://matrix.org/docs/projects/client/spectral">Spectal</a>, or even <a href="https://github.com/TelepathyIM/telepathy-tank">Telepathy IM</a>.</p>
<h2 id="the-work-done">The work done</h2>
<p>Regarding my initial <a href="https://github.com/quotient-im/libQuotient/wiki/_GSoC-2019-E2EE-proposal">proposal</a>, I’ve completed tasks enough for message receiving, and not finished tasks related to message sending.</p>
<p>Focused on libQuotient, I've also <a href="https://github.com/quotient-im/Quaternion/commits/aa13q-e2ee">added changes to Quaternion client</a> to support the proposed API and test the results.
I've reused libQtOlm, which is a Qt wrapper to the matrix olm library and <a href="https://gitlab.com/b0/libqtolm/merge_requests?scope=all&amp;utf8=%E2%9C%93&amp;state=all&amp;author_username=aa13q">contributed to provide better compatibility during its building and deployment</a>.
This also required to dive into the olm library itself and provide <a href="https://gitlab.matrix.org/matrix-org/olm/commit/aa0c9ab6b51d182cb78ab4cc75c81c0054765bde">minor patch</a> for the olm CMake files too.</p>
<p>So, the basic structure of the project changed a bit, libQtOlm was added as a dependency to support libolm:</p>
<pre style="background-color:#1e1e1e;color:#dcdcdc;"><code><span>                              +--------------------------------------------+
</span><span>                              |   Quaternion/Spectral/Telepathy|Tank/etc   |
</span><span>+------------------+          +--------------------------------------------+
</span><span>|      CS API      |  &lt;----&gt;  |                  libQuotient               |
</span><span>+------------------+          +-------------------------------+------------+
</span><span>|Synapse homeserver|          |               Qt              |  libQtOlm  |
</span><span>+------------------+          +--------------------------------------------+
</span><span>                                                              |   libolm   |
</span><span>                                                              +------------+
</span></code></pre>
<p>During the coding period, I've resorted to <a href="https://matrix.org/docs/spec/client_server/latest">the specification</a>, <a href="https://matrix.org/docs/guides/end-to-end-encryption-implementation-guide">the guide</a> and the <a href="https://github.com/Zil0/matrix-python-sdk/wiki">last year GSoC python implementation</a> actively. And added <a href="https://github.com/matrix-org/matrix-doc/pull/2157">minor fix for the documentation</a> about names constants at the documentation examples.</p>
<h2 id="demonstration">Demonstration</h2>
<p><a href="https://youtu.be/gGykLh4mVDg"><img src="https://i.imgur.com/BKmhvni.jpg" alt="Imgur" /></a></p>
<h2 id="future-work">Future work</h2>
<p>Talking about future work, the status is going to be captured at <a href="https://github.com/quotient-im/libQuotient/projects">libQuotient project board</a>. Next steps are:</p>
<ul>
<li>Managing devices list for users in the room</li>
<li>Sending encrypted messages</li>
</ul>
<p>While olm account management architecture and <code>device_one_time_keys_count</code> sync data handling is here, such tasks as session management after a restart and device verification still requires additional efforts. After that encrypted attachments support and key backups could also be added.</p>
<p>I'm going to take care about that, but it definitely will be harder as just a side project. I still have enthusiasm though :)</p>
<h2 id="conclusion">Conclusion</h2>
<p>To take part in the Google Summer of Code project was my dream. I'm very happy I've managed to took part this year, since it was the last year of my study, while I had doubts about my personal results until I've received final confirmation and the review.</p>
<p>From the beginning of the project, I've realized I'm very lucky since I've got all the chances to provide perfect results. <a href="https://github.com/Kaffeine">@Kaffeine</a> helped me a lot with my TelepathyIM contribution. He helped me to evolve my CMake, git and Qt/C++ skills and that's how I've started contributing to the libQuotient before GSoC. After that, it turns out that I've accepted and received even two mentors. <a href="https://github.com/uhoreg">@uhoreg</a> from the Matrix team, who helped me with End-to-End Encryption logic and olm/megolm understanding. And <a href="https://github.com/KitsuneRal">@kitsune</a> from the Quotient project, who helped me a lot with the code review, with the architecture decisions and the library logic, and even with the time management (he was the one who watched carefully about my results). The last year GSoC python implementation and guide from <a href="https://github.com/Zil0">@Zil0</a> were also here, and it turns out that Spectral developer <a href="https://github.com/encombhat">@BHat</a> provided QtOlm wrapper right before GSoC stated.</p>
<p>However, planning and updating the plan were my weak points, where I've made key mistakes, such as poor combination with my regular part-time job. And I definitely should have reserved a small vacation at least for the final period of the project to handle tasks better.</p>
<p>In the end, I've managed to debug the mistakes and provided encrypted messages receiving that could already be used at the clients. Also, I evolved my skills and dived into the megolm E2EE subject. I'm willing to continue my contribution to develop libQuotient as full-featured Qt-based Matrix library. </p>
<p>In general, I am not disappointed. I'm wishing luck to all the future students who are reading this. I'm happy to receive support and contribute to an international open project not only for myself, but also for the other developers and users.</p>
<h2 id="appendix-additional-links">Appendix: Additional links</h2>
<p><strong>GSoC project page</strong>: <a href="https://summerofcode.withgoogle.com/organizations/6624344617254912/#5821516577505280">link</a></p>
<p><strong>Mentors</strong>: <a href="https://matrix.to/#/@kitsune:matrix.org">Alexey Rusakov</a>, <a href="https://matrix.to/#/@uhoreg:matrix.org">Hubert Chathi</a></p>
<p><strong>GSoC Matrix room</strong>: <a href="https://matrix.to/#/#gsoc:matrix.org">link</a></p>
<p><strong>Contribution</strong>: <a href="https://github.com/quotient-im/libQuotient/issues?q=author%3Aa-andreyev+label%3AGSoC2019">libQuotient GSoC E2EE PRs list</a>, <a href="https://github.com/quotient-im/libQuotient/wiki/_GSoC-2019-E2EE-final-evaluation">full final report at the project wiki</a></p>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2019&#x2F;09&#x2F;20&#x2F;this-week-in-matrix-2019-09-20&#x2F;" title="This Week in Matrix 2019-09-20">This Week in Matrix 2019-09-20</a></h1>
            <span>
                20.09.2019 00:00
                —
                <a href="/category/this-week-in-matrix">
                    This Week in Matrix
                </a>
                —
                
                <a href="/author/ben-parsons">
                    Ben Parsons
                </a>
                
            </span>
            
        </header>
        <div>
            <h2 id="matrix-live">Matrix Live 🎙</h2>
<iframe src="https://www.youtube.com/embed/OETjvoWQxiQ?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>I spoke to Half-Shot about LOTS of topics in bridging, well worth a watch if you're interested in using Slack, IRC and other platforms with Matrix.</p>
<h2 id="dept-of-spec-scroll">Dept of Spec 📜</h2>
<p><strong>Approved MSCs</strong></p>
<p><em>No MSCs have cleared FCP this week.</em></p>
<p><strong>Final Comment Period</strong></p>
<p><em>No MSCs have entered FCP this week</em></p>
<p><strong>In Progress MSCs</strong></p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2291">MSC2291: Configuration to Control Crawling</a></li>
</ul>
<p>The Spec Core Team is going to try and select 3 MSCs to prioritise per week to work on, in order to not stretch resources too thin and to communicate clearly what it is we're actually up to. More details to follow.</p>
<p>Otherwise this week has been continuing to iterate on existing MSCs, as well as <a href="https://github.com/matrix-org/matrix-doc/pull/2296">updating the MSC template</a> to rename the &quot;Tradeoffs&quot; section to &quot;Alternatives&quot;, and to get rid of &quot;Conclusion&quot; which was always just an unnecessary repeat of the introduction.</p>
<h2 id="dept-of-servers-europea">Dept of Servers 🏢</h2>
<h3 id="construct">Construct</h3>
<p>Notes from Jason:</p>
<blockquote>
<p>Construct did a round of performance work and pursued some of the easier opportunities with the most effective returns. At present, the biggest performance bottleneck Construct experiences is with I/O, specifically latency from accessing disks in a random pattern. This week a few open opportunities for prefetch pipelines were taken, allowing the server to stream data directly from the disk to the client with minimal buffering. This was implemented in several places, mostly for the <code>/media/</code> system, and also for the <code>/members</code> lists, improving the performance of requesting the members of a room like #whalepool:ericmartindale.com .</p>
<p>There is one area though that requires a special mention for being an order of magnitude more impactful than any other area where a pipelined stream was placed. We have analyzed the way Riot conducts a room change, and by the simple placement of a prefetch operation when the server receives an <code>im.vector.breadcrumb_rooms</code>, which comes early during the room change, Construct is able to populate the room's timeline significantly faster. That has a compounding effect, as the browser initiates several requests based on (and after) the received timeline data- meaning those responses come significantly faster.</p>
<p>Construct is the community driven Matrix server written in C++ for maximum performance. Swing by <a href="https://matrix.to/#/#test:zemos.net">#test:zemos.net</a> or <a href="https://github.com/matrix-construct/construct/">https://github.com/matrix-construct/construct/</a> for more.</p>
</blockquote>
<h3 id="synapse">Synapse</h3>
<p><a href="https://matrix.to/#/@neilj:matrix.org">Neil</a> said:</p>
<blockquote>
<p>Synapse
This week, lots of hacking but not much in the way of news. We’ve been focusing on more privacy improvements as well as polishing up the SAML integration.
Next week, expect a wodge of privacy related features to land.</p>
</blockquote>
<h2 id="dept-of-bridges-bridge-at-night">Dept of Bridges 🌉</h2>
<h3 id="matrix-slack-bridge-1-0-rc2">Matrix Slack bridge 1.0 RC2</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> said:</p>
<blockquote>
<p>The Matrix Slack bridge has had another release candidate this week. <a href="https://github.com/matrix-org/matrix-appservice-slack/releases/tag/1.0.0-rc2">1.0 RC2</a> is out now. We've rewritten the codebase in Typescript and made many changes, and need your feedback before release so please do not hold back on testing it! The 1.0 release is slated to arrive sometime next week :)</p>
</blockquote>
<h3 id="famedly-email-bridge-new-email-bridge">famedly-email-bridge - new email bridge!!</h3>
<p><a href="https://matrix.to/#/@sorunome:sorunome.de">sorunome</a> told us:</p>
<blockquote>
<p>Presenting <a href="https://gitlab.com/famedly/bridges/famedly-email-bridge">famedly-email-bridge</a>, a new email bridge! It is still early in development but can already send and receive emails.</p>
<p>Features so far:</p>
<ul>
<li>Receive emails by a prefix (e.g. <code>matrix_sorunome@myserver.com</code>, <code>matrix_otheruser@myserver.com</code>)</li>
<li>Send emails with said prefix</li>
<li>Receiving emails parses plain body, html body and attachments</li>
<li>Sending emails collects all messages for a given amount of time. After that it creates an email based on that! Supports edits, redactions and files (image, video, audio, file)!</li>
</ul>
<p>Things planned for the future:</p>
<ul>
<li>Route emails to channels based on threading (reply-chain)</li>
<li>Send emails by making a new channel and inviting an email ghost and just sending messages!</li>
</ul>
</blockquote>
<h3 id="irc-bridge-progress-postgres">IRC bridge progress: postgres</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> told us:</p>
<blockquote>
<p>My other news that I forgot to mention is that I have a branch of the IRC bridge that runs off postgres, rather than flat file storage. It's much less memory/cpu intensive and might even offer a bit of a speedup :)</p>
<p>For ref: The current room/user store files for the freenode bridge take up 250MB when stored to disk. The existing storage system works on the principle of loading the whole datastore into memory and periodically saving to disk. Hopefully by <em>not</em> requiring the bridge to load all the state into memory, there are savings to be made.</p>
</blockquote>
<h3 id="mautrix-telegram-v0-6-1">mautrix-telegram v0.6.1</h3>
<p><a href="https://matrix.to/#/@tulir:maunium.net">Tulir</a> told us:</p>
<blockquote>
<p>mautrix-telegram v0.6.1 has been released, no changes since the release candidates two weeks ago. mautrix-telegram v0.7.0 is scheduled to be released within 6 weeks.</p>
<p>Also, there's a WhatsApp business API bridge using Twilio in development, though I'm guessing most people won't have any use for that.</p>
</blockquote>
<h2 id="dept-of-clients-iphone">Dept of Clients 📱</h2>
<h3 id="continuum-progress">Continuum progress</h3>
<p><a href="https://matrix.to/#/@uforia:matrix.org">yuforia</a> said:</p>
<blockquote>
<p><a href="https://github.com/koma-im/continuum-desktop">Continuum</a> desktop client written in pure Kotlin, version 0.9.24:</p>
<ul>
<li>Non-square avatar images are scaled up and cropped to fit a square, instead of being scaled down and put into a square.</li>
<li>Scale avatar images when font size is increased/decreased with Ctrl and +/-. Below is a screenshot of Continuum with UI scaled to be 67% larger.</li>
<li>After signing-in, open the messaging view each time it's launched instead of showing the login view and requiring one extra click.</li>
<li>Shutdown background threads and close database so it won't be busy if Continuum is closed and immediately re-launched.</li>
</ul>
<p><a href="https://matrix.org/_matrix/media/r0/download/matrix.org/yLOmalevIOxrKATqZVjsmfvr">https://matrix.org/_matrix/media/r0/download/matrix.org/yLOmalevIOxrKATqZVjsmfvr</a></p>
</blockquote>
<h3 id="riot-web">Riot Web</h3>
<p><a href="https://matrix.to/#/@jryans:matrix.org">Ryan</a> offered:</p>
<blockquote>
<p>Riot Web worked on the last remaining bits of the current privacy sprint. We are planning to do a release soon that includes this privacy work from the last few months. We are also working on a few improvements for first time users around the create room dialog. We also shipped several patch releases (1.3.5 and 1.3.6) to fix high priority bugs.</p>
</blockquote>
<h3 id="riot-ios">Riot-iOS</h3>
<p><a href="https://matrix.to/#/@Manu:matrix.org">Manu</a> said:</p>
<blockquote>
<p>Riot-iOS has made some progress on the privacy sprint. We fixed some major issues with VoiceOver. Those fixes will be released soon in a hot fix release: 0.9.5.</p>
</blockquote>
<h3 id="riot-android">Riot Android</h3>
<p><a href="https://matrix.to/#/@benoit.marty:matrix.org">Benoit</a>:</p>
<blockquote>
<p>Riot Android: Still working on privacy</p>
</blockquote>
<h3 id="riotx">RiotX</h3>
<p><a href="https://matrix.to/#/@benoit.marty:matrix.org">Benoit</a> reported:</p>
<blockquote>
<p>A release has been done (0.5.0) with login with SSO support. There is also a new &quot;no network&quot; indicator, which is a bit bugged, we will fix that.
Stabilization sprint is still ongoing. We already have fixed quite a lot of issues.
François is still working on the read marker and is also fixing issues related to the permalinks.</p>
</blockquote>
<p><a href="https://matrix.to/#/@krombel:msg-net.de">krombel</a> reported:</p>
<blockquote>
<p>It might be interesting to some of you that the F-Droid repo for RiotX is finally working again.
There was an issue with buildkite which in the end led to the situation that the built apk had a lower versionCode as the apps already in the repo. The repo was then &quot;intelligent enough&quot; to no offer it as update.
benoit was able to resolve that so the repos are updating again.</p>
</blockquote>
<h2 id="dept-of-ping-table-tennis-paddle-and-ball">Dept of Ping 🏓</h2>
<p>New!! A new section where we will reveal, rank, and applaud the homeservers with the lowest ping, as measured by <a href="https://github.com/maubot/echo">pingbot</a>, a <a href="https://github.com/maubot/maubot">maubot</a> that you can host on your own server. Join <a href="https://matrix.to/#/#ping:maunium.net">#ping:maunium.net</a> to experience the fun live, and to find out how to add YOUR server to the game.</p>
<table><thead><tr><th style="text-align: center">Rank</th><th style="text-align: center">Hostname</th><th style="text-align: center">Median MS</th></tr></thead><tbody>
<tr><td style="text-align: center">1</td><td style="text-align: center">g24.at</td><td style="text-align: center">267</td></tr>
<tr><td style="text-align: center">2</td><td style="text-align: center">matrix.tetraodon.nl</td><td style="text-align: center">305</td></tr>
<tr><td style="text-align: center">3</td><td style="text-align: center">nltrix.net</td><td style="text-align: center">335</td></tr>
<tr><td style="text-align: center">4</td><td style="text-align: center">flip.earth</td><td style="text-align: center">355</td></tr>
<tr><td style="text-align: center">5</td><td style="text-align: center">matrix.vgorcum.com</td><td style="text-align: center">438</td></tr>
<tr><td style="text-align: center">6</td><td style="text-align: center">c-base.org</td><td style="text-align: center">439</td></tr>
<tr><td style="text-align: center">7</td><td style="text-align: center">flobob.ovh</td><td style="text-align: center">444</td></tr>
<tr><td style="text-align: center">8</td><td style="text-align: center">im.leptonics.com</td><td style="text-align: center">485</td></tr>
<tr><td style="text-align: center">9</td><td style="text-align: center">mtx.liftm.de</td><td style="text-align: center">499.5</td></tr>
<tr><td style="text-align: center">10</td><td style="text-align: center">uraziel.de</td><td style="text-align: center">537.5</td></tr>
</tbody></table>
<h2 id="final-thoughts-thought-balloon">Final thoughts 💭</h2>
<p>Slack have <a href="https://slackhq.com/slack-shared-channels">invented bridging</a>, very creative of them.</p>
<p>Nico has reappeared, on the <a href="https://www.kudutravel.com/images/uploads/hero/main/BpmVvTd7q60m7R5.jpeg">tropical island Reunion</a> and is looking again at his <a href="https://gitlab.com/beerfactory.org/plasma/tree/master">Elixir Homeserver project: Plasma</a>.</p>
<h2 id="that-s-all-i-know-checkered-flag">That's all I know 🏁</h2>
<p>See you next week, and be sure to stop by <a href="https://matrix.to/#/#TWIM:matrix.org">#twim:matrix.org</a> with your updates!</p>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2019&#x2F;09&#x2F;13&#x2F;this-week-in-matrix-2019-09-13&#x2F;" title="This Week in Matrix 2019-09-13">This Week in Matrix 2019-09-13</a></h1>
            <span>
                13.09.2019 00:00
                —
                <a href="/category/this-week-in-matrix">
                    This Week in Matrix
                </a>
                —
                
                <a href="/author/ben-parsons">
                    Ben Parsons
                </a>
                
            </span>
            
        </header>
        <div>
            <h2 id="matrix-live">Matrix Live 🎙</h2>
<iframe src="https://www.youtube.com/embed/VYIEY6TspYE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2 id="dept-of-spec-scroll">Dept of Spec 📜</h2>
<p><strong>Approved MSCs</strong></p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/1802">MSC1802: Remove the '200' value from some federation responses</a></li>
</ul>
<p><strong>Final Comment Period</strong></p>
<p><em>No MSCs have entered FCP</em></p>
<p><strong>In Progress MSCs</strong></p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2290">MSC2290: Separate Endpoints for Threepid Binding</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2260">MSC2260: Update the auth rules for <code>m.room.aliases</code> events</a></li>
</ul>
<h2 id="dept-of-status-of-matrix-face-with-th">Dept of <em>Status of Matrix</em> 🌡</h2>
<h3 id="mozilla-trialling-matrix-as-an-irc-replacement">Mozilla trialling Matrix as an IRC replacement</h3>
<p>In fact they're <a href="http://exple.tive.org/blarg/2019/09/06/forward-motion/">having a standoff</a> between Matrix, Mattermost, Rocket.chat and Slack.</p>
<p>We're eager to see the results of this trial, the feedback will be very valuable for everyone regardless of the final outcome. (Though of course, we are optimistic..!)</p>
<p>Keep up with the <a href="https://discourse.mozilla.org/t/synchronous-messaging-at-mozilla-trial-servers-feedback/44871">discussion</a> in <a href="https://news.ycombinator.com/item?id=20945551">various</a> <a href="https://www.reddit.com/r/rust/comments/d387mm/mozilla_irc_replacement_finalists_rejects_discord/">places</a>.</p>
<h2 id="dept-of-servers-europea">Dept of Servers 🏢</h2>
<h3 id="synapse">Synapse</h3>
<p>This week sees us complete the last items on the privacy sprint and we expect a release to land early next week. Aside from that OpenTracing is now live, the configuration tool is ready to go (modulo the new Synapse release)  and we’ve been trialling out room directory improvements.</p>
<p>Next week expect Synapse 1.4 to land which will contain privacy sprint support as well as a host of bug fixes and perf improvements.</p>
<h2 id="dept-of-bridges-bridge-at-night">Dept of Bridges 🌉</h2>
<h3 id="matrix-appservice-slack-1-0-0-rc1">matrix-appservice-slack 1.0.0-rc1</h3>
<p>MAJOR milestone for <a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> this week!</p>
<blockquote>
<p>Hello Twimians! After many weeks of creativity, pain, and slack, the bridge team are proud to present our first release candidate for the <a href="https://github.com/matrix-org/matrix-appservice-slack/releases/tag/1.0.0-rc1">slack bridge</a>. This release brings in a ton of new changes that should massively improve the slack&lt;-&gt;matrix experience. The headline features are Postgres support, Puppeting, RTM (websocket) support as well as an entirely refactored codebase written in Typescript.</p>
<p>This release has made heavy changes to the schema of the slack bridge and as such we are not recommending that anyone upgrade their existing slack bridge instances to 1.0.0-rc1. A migration script is currently being worked on, but for the time being <strong>existing installs</strong> should not be upgraded to 1.0.0 release candidates.</p>
</blockquote>
<h3 id="matrix-appservice-irc-0-13-0-rc2">matrix-appservice-irc 0.13.0-rc2</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> announced:</p>
<blockquote>
<p>HELLO IRC FANS. Or possibly not irc fans, if you are running a Matrix bridge.. After a long period of not-being-ready the IRC bridge has a new RC, <a href="https://github.com/matrix-org/matrix-appservice-irc/releases/tag/0.13.0-rc2">https://github.com/matrix-org/matrix-appservice-irc/releases/tag/0.13.0-rc2</a>. Hopefully the last, but time will tell.</p>
</blockquote>
<h3 id="keybase-bridge-mega-pre-alpha">Keybase bridge, mega-pre-alpha</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> reported:</p>
<blockquote>
<p>There is also now a <a href="https://github.com/Half-Shot/matrix-keybase">keybase bridge</a></p>
</blockquote>
<p>This is ready for testing, room here: <a href="https://matrix.to/#/#keybase:half-shot.uk">#keybase:half-shot.uk</a></p>
<h2 id="dept-of-clients-iphone">Dept of Clients 📱</h2>
<h3 id="scylla">Scylla</h3>
<p><a href="https://matrix.to/#/@daniel:riot.danilafe.com">@daniel:riot.danilafe.com</a> reported:</p>
<blockquote>
<p>Hi all! I haven't been around much because our homeserver chugs a little when federation is enabled, but I've got a few updates to share about Scylla, the Elm-based web client for Matrix:</p>
<ol>
<li>There have been a few optimization changes. The naive Elm approach leads to recomputing room names and usernames on every keystroke, which causes huge performance issues in rooms with many users (like #freenode_#haskell!). The new versions of Scylla avoid recomputing room names and message HTML, leading to much better performance in large rooms and rooms where a lot of history is loaded.</li>
<li>The recommended fixes in the spec regarding flickering have been implemented, and messages should no longer flicker.</li>
<li>&quot;m.notice&quot; and &quot;m.emote&quot; events are now supported</li>
<li>There has been a minor visual update to make the interface look a little more consistent and professional.</li>
</ol>
</blockquote>
<p><img src="https://github.com/DanilaFe/Scylla/raw/master/screenshots/screenshot-1.png" alt="Scylla" /></p>
<h3 id="fluffychat-11-16">FluffyChat 11.16</h3>
<p><a href="https://matrix.to/#/@krille:ubports.chat">@krille:ubports.chat</a> offered:</p>
<blockquote>
<p>We have released FluffyChat 11.16 with minor bug fixes and updated translations. A nice new feature: Messages which contains emojis only are now displayed with a much bigger font. 💕</p>
</blockquote>
<h3 id="continuum-0-9-23">Continuum 0.9.23</h3>
<p><a href="https://matrix.to/#/@uforia:matrix.org">yuforia</a> reported:</p>
<blockquote>
<p><a href="https://github.com/koma-im/continuum-desktop">Continuum</a> desktop client written in pure Kotlin, version 0.9.23:</p>
<ul>
<li>
<p>Include Elliptic Curve module to be able to connect to HTTPS servers using ECDSA</p>
</li>
<li>
<p>Removed dependency on kotlin-reflect and tornadofx completely and make packaged size about 5 MB smaller, which is a 10% to 20% reduction, depending on the target platform and package format</p>
</li>
<li>
<p>In addition to automatic scaling when HiDPI is detected, font size scaling is added. Press Ctrl and + or - to increase or decrease the font size. Font size scaling is not limited to texts, components with their size defined relative to the font size also gets scaled.</p>
</li>
<li>
<p>When a image message is clicked, a viewer is opened to provide a closer look. Now the updated viewer is opened in new windows, multiple images can be viewed at once, and interaction with the main window is not blocked. Images also gets scaled when the viewer window is resized.</p>
</li>
<li>
<p>Removed borders and backgrounds from 3 buttons and give them a flat appearance.</p>
</li>
</ul>
</blockquote>
<p><img src="/blog/img/2019-09-13-continuum.png" alt="continuum" /></p>
<h3 id="fractal">Fractal</h3>
<p><a href="https://matrix.to/#/@afranke:matrix.org">Alexandre Franke</a> told us:</p>
<blockquote>
<p>Since last time, Fractal got many translation updates. Current coverage can be seen <a href="https://l10n.gnome.org/module/fractal/">here</a>. We’re also now <a href="https://gitlab.gnome.org/GNOME/fractal/merge_requests/439">disabling the message entry if the user is not allowed to send messages to the room</a> and <a href="https://gitlab.gnome.org/GNOME/fractal/merge_requests/458">fixed a crashed when logging out or logging in with the wrong password</a>.</p>
</blockquote>
<h3 id="brawl-new-web-client-from-bruno-the-riot-dev">Brawl, new web client from Bruno the Riot dev</h3>
<p><a href="https://matrix.to/#/@bwindels:matrix.org">Bruno</a> told us:</p>
<blockquote>
<p>I've been working occasionally for the past months on a basic matrix web client called Brawl, focusing on performance, offline usage and working on my old phone. I recently got it in still limited, but somewhat useful state. Unsure how much time I'll have to keep working on this regularly, but wanted to share it here anyways. Check it out on <a href="https://github.com/bwindels/brawl-chat">https://github.com/bwindels/brawl-chat</a>, there's a GIF of it in action 🙂</p>
</blockquote>
<h3 id="riot-web">Riot Web</h3>
<p>From the team:</p>
<blockquote>
<p>We’ve made good progress on our first FTUE (First Time User Experience) project: “Improve add &amp; create room”, with only the makeover of the create room dialog remaining. Next week more FTUE projects, and we hope to get some progress on cross-signing, barring any other distractions.</p>
</blockquote>
<h3 id="riot-ios">Riot iOS</h3>
<p>From the team:</p>
<blockquote>
<ul>
<li>Finalising privacy</li>
<li>Release 0.9.4 with support of the new Riot configuration link to quickly customise servers on the authentication screen.</li>
</ul>
</blockquote>
<h3 id="riot-android">Riot Android</h3>
<p>From the team:</p>
<blockquote>
<ul>
<li>Two minor releases have been made (0.9.5 and 0.9.6), to allow auto configuration of the homeserver in the login screen with a configuration link, and to fix an issue with SSO using Google account.</li>
<li>Still working on privacy</li>
</ul>
</blockquote>
<h3 id="riotx-android">RiotX (Android)</h3>
<p>From the team:</p>
<blockquote>
<ul>
<li>Working on stabilization. We already have fixed some issues.</li>
<li>François is still working on ReadMarker</li>
<li>Benoit is working on saving draft (storing unsent messages)</li>
<li>Also implementing SSO login and M_CONSENT_NOT_GIVEN error</li>
</ul>
</blockquote>
<h3 id="also-bashtrix">ALSO: &quot;bashtrix&quot;</h3>
<p><a href="https://matrix.to/#/@matthew:matrix.org">Matthew</a> reported:</p>
<blockquote>
<p>i wrote a toy client in ~8 lines of bash (thanks to <a href="https://matrix.to/#/@andrewm:amorgan.xyz">anoa</a> for fixing it up): <a href="https://github.com/ara4n/random/blob/master/bashtrix.sh">https://github.com/ara4n/random/blob/master/bashtrix.sh</a>; context: <a href="https://news.ycombinator.com/item?id=20948530">https://news.ycombinator.com/item?id=20948530</a></p>
</blockquote>
<h2 id="dept-of-ops">Dept of Ops 🛠</h2>
<h3 id="synapse-simple-antispam-now-available-in-matrix-docker-ansible-deploy">synapse-simple-antispam now available in matrix-docker-ansible-deploy</h3>
<p><a href="https://matrix.to/#/@slavi:devture.com">Slavi</a> offered:</p>
<blockquote>
<p>due to the large number of invite-spam attacks and increased interest in the <a href="https://github.com/t2bot/synapse-simple-antispam">synapse-simple-antispam</a> spam checker module, <a href="https://github.com/spantaleev/matrix-docker-ansible-deploy">matrix-docker-ansible-deploy</a> now has support for installing and configuring it.</p>
</blockquote>
<h2 id="dept-of-bots-robot-face">Dept of Bots 🤖</h2>
<h3 id="release-tracking-bot-from-ananace">Release Tracking Bot from Ananace</h3>
<p><a href="https://matrix.to/#/@ace:kittenface.studio">Ananace</a> reported:</p>
<blockquote>
<p>Had some free time and ideas this week, so I've improved my <a href="https://github.com/ananace/matrix-releasetracker">release tracking bot</a> to now correctly handle repos mixing full releases as well as tags (lightweight and/or annotated). GitHub's API really sucks in the tags department, so this required a rework to GraphQL queries instead, and it's looking good on that so far.
The bot currently still only handles tracking all starred repos of a given account on GitHub, but I'm working on GitLab support, as well as support for tracking arbitrary repos. And a provisioning API is also somewhere on the roadmap,</p>
</blockquote>
<h2 id="that-s-all-i-know-checkered-flag">That's all I know 🏁</h2>
<p>See you next week, and be sure to stop by <a href="https://matrix.to/#/#TWIM:matrix.org">#twim:matrix.org</a> with your updates!</p>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2019&#x2F;09&#x2F;10&#x2F;dendrite-development-final-report-g-so-c-2019&#x2F;" title="Dendrite development final report (GSoC 2019)">Dendrite development final report (GSoC 2019)</a></h1>
            <span>
                10.09.2019 18:21
                —
                <a href="/category/gsoc">
                    GSOC
                </a>
                —
                
                <a href="/author/alex-chen">
                    Alex Chen
                </a>
                
            </span>
            
        </header>
        <div>
            <h2 id="overview">Overview</h2>
<p>During GSoC 2019, I participated in and pushed forward the development of
<a href="https://github.com/matrix-org/dendrite">Dendrite</a>, a high-performance, scalable <a href="https://matrix.org/docs/guides/introduction">Matrix
homeserver</a> implementation written
in Go.</p>
<p>Like many others passionate about Dendrite, I've been eager to see the day when
it finally joins the decentralised, federated <a href="https://matrix.org/">Matrix
network</a>, so I worked on the project to see how much I
could do to bridge the gap between it and the current reference homeserver
implementation, <a href="https://github.com/matrix-org/synapse">Synapse</a>, in terms of
feature completeness.</p>
<p>Working on Dendrite in just one area would be insufficient to propel it, so my
work covers various
<a href="https://github.com/matrix-org/dendrite/blob/master/WIRING.md">components</a>
in the project, including the Client/Server API, Sync Server, Room Server,
and Federation Component. I also spent time refining the project's
documentation, improving its testing/continuous integration process, as well as
reviewing pull requests from Matrix.org members and the community.</p>
<p>Below is the major portion of my work presented as pull requests, categorised by
the components they belong to; a list of links to all the pull requests I
created/reviewed is also available at the end of this report.</p>
<h2 id="work-in-component-client-server-api">Work in Component: Client/Server API</h2>
<p><em>This component is the main handler of HTTP requests from the clients, except for
<code>/sync</code> requests - see next part.</em></p>
<p>Work done:</p>
<ul>
<li><a href="https://github.com/matrix-org/dendrite/pull/693">Implement client single event retrieval (#693)</a></li>
<li><a href="https://github.com/matrix-org/dendrite/pull/726">Implement profile retrieval over federation (#726)</a></li>
<li><a href="https://github.com/matrix-org/dendrite/pull/732">Add missing servers field in /directory/room/:alias response (#732)</a></li>
<li><a href="https://github.com/matrix-org/dendrite/pull/754">Implement room creation content (#754)</a></li>
<li>...and other fixes and improvements</li>
</ul>
<p>Work left:</p>
<ul>
<li><a href="https://github.com/matrix-org/dendrite/issues/668">Implement guest access (#668)</a>
<ul>
<li>This was removed from the plan for GSoC so work with higher priorities
according to the
<a href="https://github.com/matrix-org/dendrite/milestone/5">milestone</a> could be
done first.</li>
</ul>
</li>
</ul>
<h2 id="work-in-component-sync-server">Work in Component: Sync Server</h2>
<p><em>The Sync Server is responsible for handling the long polling notification
requests (<code>/sync</code> requests) and some other related requests from the clients.</em></p>
<p>Work done:</p>
<ul>
<li><a href="https://github.com/matrix-org/dendrite/pull/718">Add EDU support and typing notifications to /sync (#718)</a>
<ul>
<li>EDU stands for Ephemeral Data Units; they are events carrying short-term
status in the room, for example typing notifications.</li>
</ul>
</li>
<li><a href="https://github.com/matrix-org/dendrite/pull/751">Implement &quot;full_state&quot; query parameter for /sync (#751)</a></li>
<li>...and other fixes and improvements</li>
</ul>
<p>Work left:</p>
<ul>
<li>Support for other types of EDUs</li>
</ul>
<h2 id="work-in-component-room-server">Work in Component: Room Server</h2>
<p><em>The Room Server is, as its name suggests, where room events, state, etc. are
handled.</em></p>
<p>Work done:</p>
<ul>
<li><a href="https://github.com/matrix-org/dendrite/pull/768">Implement event redaction (#768)</a>
<ul>
<li>This also includes a relatively large chunk of changes in the Sync Server.</li>
</ul>
</li>
<li><a href="https://github.com/matrix-org/dendrite/pull/706">Fix permission and 404 response for alias deletion (#706)</a></li>
<li>...and other fixes and improvements</li>
</ul>
<p>Work left:</p>
<ul>
<li>Support for alias deletion by admins</li>
<li>Discussion on and implementation of event retention policies</li>
</ul>
<h2 id="work-in-component-federation">Work in Component: Federation</h2>
<p><em>The Federation Component sends requests to and receives requests from other
Matrix homeservers.</em></p>
<p>Work done:</p>
<ul>
<li><a href="https://github.com/matrix-org/dendrite/pull/781">Add joined hosts query APIs (#781)</a></li>
<li>(In <a href="https://github.com/matrix-org/gomatrixserverlib">matrix-org/gomatrixserverlib</a>) Support for more query
types in Federation Client: <a href="https://github.com/matrix-org/gomatrixserverlib/pull/130">Leave
API</a>, <a href="https://github.com/matrix-org/gomatrixserverlib/pull/129">Public Rooms
API</a>, <a href="https://github.com/matrix-org/gomatrixserverlib/pull/128">Profile Query
API</a></li>
<li>...and other fixes and improvements</li>
</ul>
<p>Work left:</p>
<ul>
<li>Implementation of a &quot;Most Recent Transaction Sender&quot; In-Memory Cache
<ul>
<li>There is a delay in this part of work because some dependency problems
took longer than expected to resolve, but this has been planned and will
be worked on after GSoC.</li>
</ul>
</li>
<li>Implementation of a component that handles backoff/retries for federation requests</li>
</ul>
<h2 id="general-fixes-improvements-maintenance-work">General Fixes, Improvements, Maintenance Work</h2>
<ul>
<li>Data race fixes
<ul>
<li><a href="https://github.com/matrix-org/dendrite/pull/748">Fix data races reported by go test -race ./... (#748)</a></li>
<li><a href="https://github.com/matrix-org/dendrite/pull/787">Fix data race in clientapi/routing/register.go (#787)</a></li>
</ul>
</li>
<li>Fixes for incorrect transaction ID scopes
<ul>
<li><a href="https://github.com/matrix-org/dendrite/pull/772">Fix transaction IDs in transaction cache have global scope (#772)</a></li>
<li><a href="https://github.com/matrix-org/dendrite/pull/789">Associate transactions with session IDs instead of device IDs (#789)</a></li>
</ul>
</li>
<li>Improvements for building/testing process
<ul>
<li><a href="https://github.com/matrix-org/dendrite/pull/714">Refine config and docs for sytest (#714)</a></li>
<li><a href="https://github.com/matrix-org/dendrite/pull/598">Fix build conflict between docker environment and host (#598)</a></li>
</ul>
</li>
</ul>
<h2 id="links-to-all-pull-requests">Links to All Pull Requests</h2>
<p>Here is a list of links to all the pull requests I have created/reviewed (by 26
Aug, 2019):</p>
<table><thead><tr><th>Repository</th><th>Pull Requests</th></tr></thead><tbody>
<tr><td><a href="https://github.com/matrix-org/dendrite">matrix-org/dendrite</a></td><td><a href="https://github.com/matrix-org/dendrite/pulls?utf8=%E2%9C%93&amp;q=is%3Apr+author%3ACnly+created%3A%3C2019-08-26">Created (36)</a> / <a href="https://github.com/matrix-org/dendrite/pulls?utf8=%E2%9C%93&amp;q=is%3Apr+reviewed-by%3ACnly+-author%3ACnly+created%3A%3C2019-08-26">Reviewed (27)</a></td></tr>
<tr><td><a href="https://github.com/matrix-org/gomatrixserverlib">matrix-org/gomatrixserverlib</a></td><td><a href="https://github.com/matrix-org/gomatrixserverlib/pulls?utf8=%E2%9C%93&amp;q=is%3Apr+author%3ACnly+created%3A%3C2019-08-26">Created (12)</a> / <a href="https://github.com/matrix-org/gomatrixserverlib/pulls?utf8=%E2%9C%93&amp;q=is%3Apr+reviewed-by%3ACnly+-author%3ACnly+created%3A%3C2019-08-26">Reviewed (1)</a></td></tr>
<tr><td><a href="https://github.com/matrix-org/sytest">matrix-org/sytest</a></td><td><a href="https://github.com/matrix-org/sytest/pulls?utf8=%E2%9C%93&amp;q=is%3Apr+author%3ACnly+created%3A%3C2019-08-26">Created (5)</a></td></tr>
</tbody></table>
<h2 id="appendix-on-dendrite-being-a-gsoc-project">Appendix: On Dendrite Being a GSoC Project</h2>
<p>I believe that Dendrite is a pretty special project to work on in the GSoC
program.</p>
<p>At its current state, Dendrite isn't a complete homeserver yet. This has left a
large portion of work on Dendrite wide open: As I worked on Dendrite, more than
often I'd find myself in a place to answer questions related to topics like
design or project architecture which, if not thoroughly thought through, might
have consequences in the future development of the project. For this reason, I
think working on Dendrite involves a set of challenges quite different from what
attempting to improve an already functioning piece of software would have
presented.</p>
<p>For the same reason, I think what Dendrite has taught me during the
summer was less about how to become more fluent in Go or more familiar with
various tools, but more about developing the mindset that powers software
projects behind the scenes. But this mindset, to myself, seems more valuable
than the former, indeed.</p>
<p>And at the end of this report, I'd like to thank my mentors
<a href="https://matrix.to/#/@andrewm:amorgan.xyz">anoa</a> and
<a href="https://matrix.to/#/@brendan:abolivier.bzh">Brendan</a>, as well as everyone else
at Matrix who has answered my questions, discussed with me, and helped me
understand the code, and at the same time being super responsive. Without your
help, my GSoC experience wouldn't have been this enjoyable! :)</p>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2019&#x2F;09&#x2F;09&#x2F;matrix-visualisations-final-report-g-so-c-2019&#x2F;" title="Matrix Visualisations final report (GSoC 2019)">Matrix Visualisations final report (GSoC 2019)</a></h1>
            <span>
                09.09.2019 00:00
                —
                <a href="/category/gsoc">
                    GSOC
                </a>
                —
                
                <a href="/author/eisha-chen-yen-su">
                    Eisha Chen-yen-su
                </a>
                
            </span>
            
        </header>
        <div>
            <p>The Google Summer of Code 2019 is coming to an end for me, so it means that it’s time for the final report.</p>
<h2 id="the-work-done">The work done</h2>
<p>I’ve been taking care of the project “Matrix Visualisations” during these past months. This project aimed at initiating the development of a tool which allows the real-time visualisation of the events DAG of a given Matrix room, as seen from the perspective of one or more homeservers (HS’s).</p>
<p>Regarding my initial proposal, I’ve completed every task proposed and even implemented some additional functionalities. The application is not finished yet and there could be a lot of improvements added to it (especially regarding the design of the UI) but the core functionalities have been implemented.<br/>
I am going to precise what has been accomplished and then give some ideas of features to improve.</p>
<p>During GSoC, I have used two separate repositories for <a href="https://github.com/Kagamihime/matrix-visualisations">the frontend</a> and <a href="https://github.com/Kagamihime/matrix-visualisations-backend">the backend</a>. I will keep both of them because I’m referencing PRs from them (as PRs are easier to link than lengthy lists of commits).<br/>
However, this is <a href="https://github.com/Kagamihime/matrix-visualisations-complete">the repository</a> regrouping these two parts and this one will be moved to matrix-org for the continuation of this project.</p>
<h3 id="complete-the-implementation-of-the-cs-api-backend">Complete the implementation of the CS API backend</h3>
<p>During the application period, I wrote a prototype for this project. This prototype implemented some requests to the CS API (like <a href="https://matrix.org/docs/spec/client_server/r0.5.0#get-matrix-client-r0-login">/login</a>, <a href="https://matrix.org/docs/spec/client_server/r0.5.0#post-matrix-client-r0-logout">/logout</a> or <a href="https://matrix.org/docs/spec/client_server/r0.5.0#get-matrix-client-r0-sync">/sync</a>) but there were more requests to implement in order to be able to fully use this API:</p>
<ul>
<li>In order for the application to automatically join (and leave at the end) a room if the provided account hasn’t already joined it, I implemented the requests to <a href="https://matrix.org/docs/spec/client_server/r0.5.0#get-matrix-client-r0-joined-rooms">/joined_rooms</a>, <a href="https://matrix.org/docs/spec/client_server/r0.5.0#post-matrix-client-r0-rooms-roomid-join">/join</a> and <a href="https://matrix.org/docs/spec/client_server/r0.5.0#post-matrix-client-r0-rooms-roomid-leave">/leave</a>.</li>
<li>The request <a href="https://matrix.org/docs/spec/client_server/r0.5.0#get-matrix-client-r0-rooms-roomid-messages">/messages</a> has been implemented to allow the application to fetch previous messages.</li>
<li>For retrieving in real-time new events, I used the field <code>from</code> in the <a href="https://matrix.org/docs/spec/client_server/r0.5.0#get-matrix-client-r0-sync">/sync</a> request.</li>
</ul>
<p>I also did a lot of clean up in the source code from the prototype during this task. You can have more details in <a href="https://github.com/Kagamihime/matrix-visualisations/pull/1">this PR</a>.</p>
<h3 id="implement-the-first-ui-to-interact-with-the-dag">Implement the first UI to interact with the DAG</h3>
<p>First of all, a lot of work had to be made in order to properly update the displayed DAG when adding new events to it. At this point, I previously used the <code>setData</code> method of the <code>Network</code> object of <a href="https://visjs.org/">the visjs library</a> (which is used for displaying the graph and interacting with it) each time a node was added, but it was resetting the display each time it was called.<br/>
The proper solution was to progressively add nodes and edges to the <code>DataSet</code> object passed to the constructor of the network (see the documentation of <a href="https://visjs.github.io/vis-data/data/index.html">DataSet</a> and <a href="https://visjs.github.io/vis-network/docs/network/">Network</a> for more details).</p>
<p>The DAG has been set to be displayed vertically, the events with the same depth are at the same level, the deepest events are at the bottom. The events which origin is the HS on which we are making the observation are in green, those which are coming from other servers are in orange.
Here is a picture of what it looks like:
<img src="https://raw.githubusercontent.com/Kagamihime/gsoc-2019-final-report/master/events_display.png" alt="Events display" title="Events display" /></p>
<p>In the graph, there is a special node just after the earliest event which allows us to ask the application to load more events. Here is what it looks like:
<img src="https://raw.githubusercontent.com/Kagamihime/gsoc-2019-final-report/master/more_events_button.png" alt="More Events button" title="More Events button" /></p>
<p>When you double click on the node of an event, there is a text area on the right which displays its complete JSON body, like this:
<img src="https://raw.githubusercontent.com/Kagamihime/gsoc-2019-final-report/master/body_display.png" alt="JSON body display" title="JSON body display" /></p>
<p>I’ve also implemented the possibility to choose which particular fields of the event can be directly displayed in the labels of the nodes of the displayed graph:
<img src="https://raw.githubusercontent.com/Kagamihime/gsoc-2019-final-report/master/fields_selection.png" alt="Fields selection" title="Fields selection" /></p>
<h3 id="synapse-postgresql-backend">Synapse PostgreSQL backend</h3>
<p>Next, I implemented a backend for retrieving events from the PostgreSQL database of a Synapse HS. It is a small HTTP server which receives requests from the frontend application and then makes queries to the Synapse database to get the requested events.<br/>
You can find details about the API for using this backend in <a href="https://github.com/Kagamihime/matrix-visualisations-backend/blob/master/README.md">this readme</a>, in the “HTTP REST API” section.<br/>
You can find more details about this initial implementation: <a href="https://github.com/Kagamihime/matrix-visualisations-backend/pull/1">here</a>, <a href="https://github.com/Kagamihime/matrix-visualisations-backend/pull/2">here</a>, <a href="https://github.com/Kagamihime/matrix-visualisations-backend/pull/3">here</a> (my mentor helped me on this one, thanks to him), and <a href="https://github.com/Kagamihime/matrix-visualisations-backend/pull/5">here</a>.<br/>
I’ve added the support of this backend in the frontend application, as well as a way to choose which backend to use (between this one and the CS API) in <a href="https://github.com/Kagamihime/matrix-visualisations/pull/4">this PR</a>.</p>
<h3 id="multiple-views">Multiple views</h3>
<p>I implemented the ability to observe the same DAG of a room from multiple HS’s. This is done with “views”.</p>
<p><img src="https://raw.githubusercontent.com/Kagamihime/gsoc-2019-final-report/master/backend_selection.png" alt="View selection" title="View selection" /></p>
<p>In the picture above, you can see that there is a drop down menu from which you can select the view. The fields under this line are used to control the selected view: indicate where it will be connecting, for which room (you could as well observe a different room in a different view), etc…<br/>
By default, there is only one view but you can add as many as you want by clicking “Add a view”.</p>
<p>All the DAGs from the different views are displayed side-by-side within the same canvas, like this:
<img src="https://raw.githubusercontent.com/Kagamihime/gsoc-2019-final-report/master/multiple_dags.png" alt="Multiple DAGs" title="Multiple DAGs" /></p>
<p>You can have a look at the details of the implementation in <a href="https://github.com/Kagamihime/matrix-visualisations/pull/6">this PR</a>.</p>
<h3 id="add-federation-api-support">Add Federation API support</h3>
<p>The next major task I had to do was the implementation of a backend for retrieving events via the Federation API. I thought a lot about the possible options for the location of this backend and I decided to extend the web server created for the PostgreSQL Synapse backend, so that we could launch it in a “postgres mode” or “federation mode”. But the backend would offer the same HTTP API in both modes.</p>
<p>The backend uses <a href="https://matrix.org/docs/spec/server_server/r0.1.3">the Federation API</a> in the following way:</p>
<ul>
<li>Before being able to retrieve events from a certain room, the backend must join it with <a href="https://matrix.org/docs/spec/server_server/r0.1.3#get-matrix-federation-v1-make-join-roomid-userid">/make_join</a> and <a href="https://matrix.org/docs/spec/server_server/r0.1.3#put-matrix-federation-v1-send-join-roomid-eventid">/send_join</a> requests, it creates an “imaginary user” in this room. The join event created during this process will be the one returned by the endpoint <code>/deepest</code>.</li>
<li>To get earlier events, the backend uses <a href="https://matrix.org/docs/spec/server_server/r0.1.3#get-matrix-federation-v1-backfill-roomid">/backfill</a> requests.</li>
<li>In order to get new events, the backend listens for pushed events from other HS’s with the <a href="https://matrix.org/docs/spec/server_server/r0.1.3#put-matrix-federation-v1-send-txnid">/send</a> request.</li>
<li>When the observation is done, the backend makes the “imaginary user” leave the room by sending <a href="https://matrix.org/docs/spec/server_server/r0.1.3#get-matrix-federation-v1-make-leave-roomid-userid">/make_leave</a> and <a href="https://matrix.org/docs/spec/server_server/r0.1.3#put-matrix-federation-v1-send-leave-roomid-eventid">/send_leave</a> requests.</li>
</ul>
<p>The full details of the implementation are in <a href="https://github.com/Kagamihime/matrix-visualisations-backend/pull/8">this PR</a>. My mentor also helped me get the usage of the <code>Future</code>s  right thanks to <a href="https://github.com/Kagamihime/matrix-visualisations-backend/pull/7">this PR</a>.<br/>
There has been a small modification in the frontend too, because of the addition of the <code>/stop</code> endpoint in the backend’s HTTP API, these modifications are in <a href="https://github.com/Kagamihime/matrix-visualisations/pull/7">this PR</a>.</p>
<h3 id="display-the-state-of-the-room-for-a-given-event">Display the state of the room for a given event</h3>
<p>For each event, there is a state of the room associated with it, which describes what was the state of the room at the moment this event was accepted (the name of the room, its topic, its members and parameters, etc…).<br/>
So I’ve added a way to display this: when you have selected and displayed the JSON body of a given event, you can also request the associated room’s state. I have made it possible to use this feature with every backends: the CS API, the PostgreSQL database and the Federation API. You can have the full details of the implementation <a href="https://github.com/Kagamihime/matrix-visualisations-backend/pull/9">here</a> (for the backend) and <a href="https://github.com/Kagamihime/matrix-visualisations/pull/8">here</a> (for the frontend).</p>
<p>You can see the result of this feature in the picture below (there is a button “Room state at the selected event”, which allows to ask the application to fetch the state, and the text area under this button where the state is displayed):
<img src="https://raw.githubusercontent.com/Kagamihime/gsoc-2019-final-report/master/room_state.png" alt="Room's state display" title="Room's state display" /></p>
<h3 id="additional-fixes">Additional fixes</h3>
<p>Lastly, I’ve applied small fixes to the code of the backend, you can see them in <a href="https://github.com/Kagamihime/matrix-visualisations/pull/9">this PR</a>.</p>
<h2 id="possible-improvements">Possible improvements</h2>
<p>The objective of this project was to develop the core functionalities of this application, however there are a lot of improvements to bring to it, like:</p>
<ul>
<li>Adding the possibility to start the observation of a room from any events (provided that we have the ID of this events) instead of the latest one.</li>
<li>These hasn’t been any UI/UX work design, the CSS style sheet is minimal and the overall look isn’t beautiful or correctly organised. So there would be a lot of work to be done in this area by people with better knowledge in this field than me.</li>
<li>The timestamps of the events are not displayed in a human readable format and would be written as dates and hours to greatly improve the readability.</li>
<li>The application has been tested a lot, especially in situations of misusage. I’ve fixed some bugs which occurred when I was testing it but it was far from being an exhaustive testing, so there could be many improvements regarding the overall robustness of this software.</li>
<li>The backend supports HTTPS connections but has no mechanism for controlling the access of the data behind it (in particular, it means that if you should not run on a production database as it would basically allow anyone to access any data on it). So more work would be needed to make it secure.</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>This experience has been really rewarding for me. I could discover more about the Matrix community and how the Matrix ecosystem works (on a technical point of view). I want to thank my mentor, Erik Johnston, for his guidance during these past months, and the people in this community who gave me advice.</p>
<p>GSoC has also allowed me to further improve my programming skills in general and discover many various things: the WASM technology, how to use Rust in this context thanks to the various existing libraries/frameworks available, the practical usage of SQL requests as well as TLS certificates and how to apply cryptographic signatures.<br/>
It was sometimes challenging to use such experimental technologies (due to the lack of clear documentation) but also very exiting!</p>
<p>Mid-September, I will start my class for my second and final year of my master degree (software engineering, specialised in distributed systems and applications) at Sorbonne Université so I will definitely have less free time. So I don’t think I’ll be able to actively continue to contribute but I will do my best to help other people to continue the work I’ve initiated.</p>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2019&#x2F;09&#x2F;06&#x2F;this-week-in-matrix-2019-09-06&#x2F;" title="This Week in Matrix 2019-09-06">This Week in Matrix 2019-09-06</a></h1>
            <span>
                06.09.2019 00:00
                —
                <a href="/category/this-week-in-matrix">
                    This Week in Matrix
                </a>
                —
                
                <a href="/author/ben-parsons">
                    Ben Parsons
                </a>
                
            </span>
            
        </header>
        <div>
            <h2 id="matrix-live">Matrix Live 🎙</h2>
<iframe src="https://www.youtube.com/embed/LIDCgYcd8LE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2 id="dept-of-servers-europea">Dept of Servers 🏢</h2>
<h3 id="synapse">Synapse</h3>
<p>Neil from Synapseland:</p>
<blockquote>
<p>This week privacy items have dominated, but we’ve also been edging towards getting our room directory improvements out, shipping a new configuration creator and making further progress on the federation side bus project to improve performance of smaller instances.</p>
<p>We also deployed open tracing on matrix.org, which will help a lot in tracking down all sorts of strange behaviour in the wild and fixing some bugs in the sqlite -&gt; postgres migrator.</p>
<p>Next week we’ll land the room directory improvements, much of the privacy work, and have the configuration creator ready for testing.</p>
</blockquote>
<h3 id="construct">Construct</h3>
<p>Jason:</p>
<blockquote>
<p><a href="https://github.com/jevolk/charybdis">Construct</a> added user room listing support so that you can find out what public rooms a user is a member of should they choose to not be invisible. To find out the list of rooms for a user, simply open the room directory in Riot and type a user mxid starting with @...</p>
</blockquote>
<p>Construct is implementing the concept of invisibility for users:</p>
<blockquote>
<p>The exact mechanism for invisibility is not completely finished but there are obviously some limitations for this feature:</p>
<ul>
<li>Only users who are local to the server can set any kind of invisibility. Remote users are always fully listed. One day when the spec has &quot;user's rooms&quot; we would be glad to adhere to an <code>m.user.invisible</code>-etc configuration state event in such a room</li>
<li>Since there is no federation support for user's rooms list publication, the rooms list for a user is limited to what the server knows (rooms it has seen the user in).</li>
</ul>
<p>Construct is eager to implement any MSC's regarding user room and group membership listing over the federation.</p>
</blockquote>
<p>Construct is written for maximum performance in C++, and is developing rapidly - join <a href="https://matrix.to/#/#construct:maunium.net">#construct:maunium.net</a> for more info.</p>
<h3 id="matrix-media-repo-updates-for-quarantining-and-purging-media">matrix-media-repo updates for quarantining and purging media</h3>
<p><a href="https://github.com/turt2live">TravisR</a> announced:</p>
<blockquote>
<p><a href="https://github.com/turt2live/matrix-media-repo">matrix-media-repo</a> has received a bunch of updates regarding quarantining and purging media - see the admin docs for more information. There's also an s3 upload bug fix if you're using that.</p>
</blockquote>
<h2 id="dept-of-bridges-bridge-at-night">Dept of Bridges 🌉</h2>
<h3 id="gitlab-bot-to-be-re-written-as-a-maubot">GitLab bot to be re-written as a maubot</h3>
<p><a href="https://matrix.to/#/@tulir:maunium.net">Tulir</a> announced:</p>
<blockquote>
<p><a href="https://matrix.to/#/@lorico:uraziel.de">lorico</a> has been rewriting my old GitLab bot to python/maubot: <a href="https://github.com/maubot/gitlab/pull/23.">https://github.com/maubot/gitlab/pull/23.</a> Progress on that is looking very good and it'll probably be ready within a week or two.</p>
</blockquote>
<p>Check the <a href="https://github.com/maubot/">maubot GH page for more</a>.</p>
<h3 id="mautrix-telegram-small-release">mautrix-telegram, small release</h3>
<p><a href="https://matrix.to/#/@tulir:maunium.net">Tulir</a> again:</p>
<blockquote>
<p>I decided to make a minor mautrix-telegram release with some small fixes, since v0.7.0 will take a while still. v0.6.1-rc2 is out now, the full release will probably happen next week if nobody finds any problems. Main changes:</p>
<ul>
<li>Invalid reply fallbacks sent by Riot web in edits are now ignored</li>
<li>User and portal sync errors are now caught so that the <code>sync</code> command wouldn't fail if one telegram chat disappears.</li>
</ul>
</blockquote>
<h2 id="dept-of-clients-iphone">Dept of Clients 📱</h2>
<h3 id="riot-web">Riot Web</h3>
<p>Tidy update from Bruno this week:</p>
<blockquote>
<p>This week we were doing the last bits of the privacy work, and fixing bugs and adding a format bar in the new composer (still behind labs flag).</p>
<p>We’ve also been planning the First Time User Experience work, which will start at full speed next week. This is an effort to address some issues that new users hit in the first days of using Riot. See <a href="https://github.com/vector-im/riot-web/projects/16#card-25137120">https://github.com/vector-im/riot-web/projects/16#card-25137120</a> and Matthew talking over the details at <a href="https://youtu.be/JYsiHSL0lEA?t=710">https://youtu.be/JYsiHSL0lEA?t=710</a>. Letterboxes in the left panel will likely only be removed as part of the new community project though, as we need parts of the new community UX to keep things usable for power users.</p>
</blockquote>
<p>Also, if you're using <a href="https://riot.im/develop">https://riot.im/develop</a> please enable the new composer in Labs, it works well and deserves testing.</p>
<h3 id="continuum-desktop-client-many-updates">Continuum desktop client, many updates</h3>
<p><a href="https://matrix.to/#/@uforia:matrix.org">yuforia</a> reported:</p>
<blockquote>
<p><a href="https://github.com/koma-im/continuum-desktop">Continuum</a> desktop client written in pure Kotlin, version 0.9.20:</p>
<ul>
<li>Updated login page appearance</li>
<li>Added validation to user ID and server address fields</li>
<li>The server address gets automatically filled with <code>https://</code> followed by server name when user ID is being typed</li>
<li>After signing in, the token and server address are automatically saved</li>
<li>Added progress indicator when being signed in. It doesn't block user from controlling Continuum,  pressing Esc will cancel the signing-in process.</li>
<li>Speed up application start-up by drawing the window and opening the database in parallel. Now the window typically appears within half a second with its size and position on screen restored to be the same as the last time it was opened. The most recently used accounts get loaded and automatically filled within a second.</li>
<li>Added drop shadow effect to scroll-to-latest-messages button to increase contrast</li>
<li>Fix: Always retry synchronization after getting a network error. Previous versions didn't retrieve new messages in a timely manner when the network is unreliable. A delay is added if the error is not a time-out to avoid stressing the homeserver.</li>
</ul>
</blockquote>
<p><img src="/blog/img/2019-09-06-continuum.png" alt="continuum" /></p>
<blockquote>
<p><a href="https://github.com/koma-im/koma-library">koma</a> the Kotlin library behind Continuum:</p>
<ul>
<li>
<p>Fix suspend/hibernate detection. Synchronization is restarted automatically after the computer resumes from sleeping. The reason is that any previously opened connection is unlikely to be still alive, opening new connections reduces delay.</p>
</li>
<li>
<p>Fix incorrect interface declaration that caused login to fail</p>
</li>
</ul>
</blockquote>
<h3 id="pattle-0-13-0-released">Pattle 0.13.0 released</h3>
<p><a href="https://matrix.to/#/@wilko:pattle.im">Wilko</a> said:</p>
<blockquote>
<p>A new version has been made available and should soon be on F-Droid, Google Play and TestFlight!</p>
<p>Expect the new version to be on most platforms in 2 days.</p>
<p>It's not the biggest release, but a release nonetheless.</p>
<h4 id="changes">Changes</h4>
<ul>
<li>Separate public and personal chats</li>
<li>Use a bullhorn icon for public chats without an avatar</li>
<li>Fix sync being started multiple times on startup</li>
<li>Fix the <code>room.member_count</code> error (might require clearing of data)</li>
<li>Many SDK changes, for features in future releases</li>
</ul>
<h3 id="get-pattle">Get Pattle</h3>
<ul>
<li><strong>Android</strong>
<ul>
<li><strong><a href="https://f-droid.org/en/packages/im.pattle.app/">F-Droid</a></strong></li>
<li><strong><a href="https://play.google.com/store/apps/details?id=im.pattle.app">Google Play</a></strong></li>
</ul>
</li>
<li><strong><a href="https://testflight.apple.com/join/uTytydST">iOS (TestFlight)</a></strong></li>
</ul>
<p>Please let me know what you think of the separation of personal and public chats! Currently it's implemented using a bottom navigation bar, but tabs could also be an option (which is closer to what WhatsApp does)</p>
</blockquote>
<p><img src="/blog/img/2019-09-06-pattle.png" alt="Pattle" /></p>
<h3 id="riot-mobile-versions">Riot Mobile versions</h3>
<p>All teams when I asked responded:</p>
<blockquote>
<p>Privacy, privacy and privacy.</p>
</blockquote>
<h2 id="dept-of-services-rocket">Dept of Services 🚀</h2>
<h3 id="t2bot-io-has-300k-mau">t2bot.io has 300k MAU</h3>
<p><a href="https://github.com/turt2live">TravisR</a> told us:</p>
<blockquote>
<p><a href="https://t2bot.io/">t2bot.io</a> has surpassed 300k monthly active users (about 35k daily) 🎉</p>
<p>roughly 250k are (bridged) from Telegram, the rest is from Discord. (there's some very small numbers which include the bots, webhooks, and other tiny bridges, but together they form less than 100 users)</p>
</blockquote>
<h3 id="room-list-viewer-tool">room list viewer tool</h3>
<p><a href="https://matrix.to/#/@joepie91:pixie.town">joepie91</a> offered:</p>
<blockquote>
<p>Inspired by a question in the Matrix HQ channel, I've built a (rudimentary) room list viewer at <a href="https://matrix-rooms.cryto.net/">https://matrix-rooms.cryto.net/</a> - you can just enter a homeserver (hostname) and see all the public rooms on it, without needing to log into anything. This might be useful for showing other people what kinds of rooms exist on Matrix!</p>
</blockquote>
<h2 id="dept-of-blockchain-shrug">Dept of Blockchain 🤷‍</h2>
<h3 id="oi-chat-matrix-based-chat-uses-blockchain-for-authentication">OI Chat, Matrix based chat uses blockchain for authentication</h3>
<p><a href="https://matrix.to/#/@friedger:matrix.org">@friedger:matrix.org</a> said:</p>
<blockquote>
<p>OI Chat has been updated and now connects blockchain users on Blockstack and EOS (and the rest of the matrix universe): <a href="https://www.producthunt.com/posts/oi-chat-2">https://www.producthunt.com/posts/oi-chat-2</a>
The sever has no passwords or requires permissions by other social account providers, it verifies the authenticity of the user using properties of the blockchain IDs, it names registered on the blockchain.</p>
</blockquote>
<h2 id="dept-of-ops">Dept of Ops 🛠</h2>
<h3 id="matrixmon">Matrixmon</h3>
<blockquote>
<p><a href="https://github.com/matrix-org/matrixmon">Matrixmon new release 0.4.0</a>, featuring Docker image hosted on Docker Hub and an option to specify custom config file location.</p>
</blockquote>
<h2 id="dept-of-bots-robot-face">Dept of Bots 🤖</h2>
<h3 id="matrix-fly-paper-new-project-for-room-moderation">matrix-fly-paper: new project for room moderation</h3>
<p><a href="https://matrix.to/#/@serra:lost-angles.im">@serra:lost-angles.im</a> reported:</p>
<blockquote>
<p><a href="https://github.com/serra-allgood/matrix-fly-paper">matrix-fly-paper</a> is a new bot project intended to help automate server and room moderation. It's currently not ready for any kind of use, as I'm trying out serious TDD and attempting a functional approach to break from my OO training. Feedback is appreciated, stop by <a href="https://matrix.to/#/#matrix-fly-paper:lost-angles.im">#matrix-fly-paper:lost-angles.im</a> to talk shop</p>
</blockquote>
<p>If you're interested in such things, there is an existing tutorial on how to use <a href="https://github.com/turt2live/matrix-bot-sdk">matrix-bot-sdk</a> for exactly this at <a href="https://matrix.org/docs/guides/matrix-bot-sdk-room-admin-features">https://matrix.org/docs/guides/matrix-bot-sdk-room-admin-features</a>.</p>
<h2 id="dept-of-merch-runnin">Dept of Merch 👕</h2>
<p>About a month ago we started selling merch at <a href="https://shop.matrix.org">shop.matrix.org</a>, and WOWEE ZOMG we sold a lot of stuff! If you are happy with your purchase I'd love to hear from you - share photos of where you put the stickers or you happily wearing the t-shirt in <a href="https://matrix.to/#/#TWIM:matrix.org">#twim:matrix.org</a> and I'll make a little collage.</p>
<p><em>If you are not happy with your purchase then please message me at <a href="https://matrix.to/#/@benpa:matrix.org">@benpa:matrix.org</a> and I will try to make it right.</em></p>
<h2 id="final-thoughts-thought-balloon">Final thoughts 💭</h2>
<p>You should complete <a href="https://ec.europa.eu/eusurvey/runner/EUFOSSA2-Survey">this EU-related FOSS survey</a>, and if you wanted to say nice things about Matrix that would be fine by us.</p>
<h2 id="that-s-all-i-know-checkered-flag">That's all I know 🏁</h2>
<p>See you next week, and be sure to stop by <a href="https://matrix.to/#/#TWIM:matrix.org">#twim:matrix.org</a> with your updates!</p>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;2019&#x2F;08&#x2F;30&#x2F;this-week-in-matrix-2019-08-30&#x2F;" title="This Week in Matrix 2019-08-30">This Week in Matrix 2019-08-30</a></h1>
            <span>
                30.08.2019 00:00
                —
                <a href="/category/this-week-in-matrix">
                    This Week in Matrix
                </a>
                —
                
                <a href="/author/ben-parsons">
                    Ben Parsons
                </a>
                
            </span>
            
        </header>
        <div>
            <h2 id="matrix-live">Matrix Live 🎙</h2>
<iframe src="https://www.youtube.com/embed/jxdlH7wccbc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2 id="dept-of-spec-scroll">Dept of Spec 📜</h2>
<p><strong>Approved MSCs</strong></p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/195">MSC1957: Integration manager discovery</a></li>
</ul>
<p><strong>Final Comment Period</strong></p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2263">MSC2263: Give homeservers the ability to handle their own 3PID registrations/password resets</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2264">MSC2264: Add an unstable feature flag to MSC2140 for clients to detect support</a></li>
</ul>
<p><strong>In Progress MSCs</strong></p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2246">MSC2246: Asynchronous media uploads</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2249">[WIP] MSC2249: Require users to have visibility on an event when submitting reports</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2260">[WIP] MSC2260: Update the auth rules for <code>m.room.aliases</code> events</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2261">MSC2261: Allow <code>m.room.aliases</code> events to be redacted by room admins</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2244">MSC2244: Mass redactions</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2265">MSC2265: Proposal for mandating lowercasing when processing e-mail address localparts</a></li>
</ul>
<h3 id="notes-on-the-spec-from-tulir">Notes on the Spec from tulir</h3>
<blockquote>
<p>I made a few spec proposals: <a href="https://github.com/matrix-org/matrix-doc/pull/2244">MSC2244: Mass redactions</a> and <a href="https://github.com/matrix-org/matrix-doc/pull/2246">MSC2246: Asynchronous media uploads</a>. Mass redactions are useful for fighting spam (and bridging telegram deletions) more efficiently. Asynchronous media uploads would make it possible for bridges (like telegram) to handle messages synchronously and thus keep message ordering without blocking all messages behind some media upload.</p>
</blockquote>
<h2 id="dept-of-servers-europea">Dept of Servers 🏢</h2>
<h3 id="synapse">Synapse</h3>
<p>Erik reported:</p>
<blockquote>
<ul>
<li>Busy landing the remaining items for the privacy project.</li>
<li>Reviewing and landing the room stats work Oliver has been busy with before he finishes his internship this week (thanks Oliver!).</li>
<li>Jorik has been doing the finishing touches to the Synapse installer (which looks awesome fyi).</li>
<li>We’ve also been looking at a basic message retention implementation in Synapse.</li>
<li>Finally, Hawkowl had a lot of fun at Kiwi Pycon last week (woo keynote!), and is now back and looking at improving performance of outbound requests.</li>
</ul>
</blockquote>
<h3 id="construct">Construct</h3>
<p>Jason from Construct:</p>
<blockquote>
<p>Construct added support for server notice rooms. As the server administrator I've placed quick access to the server control room for myself in this section.</p>
<p>Construct has also added support for the server-side commands <code>\\read &lt;room-tag&gt;</code>, for example <code>\\read m.low_priority</code> will mark all low-priority tagged rooms as read. The command <code>\\read *</code> also will mark all rooms as read.</p>
<p>Also, we now allow users to configure whether they transmit typing events by setting state events in their home-room. If a user creates an event with the <code>type</code> of <code>ircd.typing.disable.send</code> and the <code>state_key</code> of the room_id, typing events will not be sent to that room for them. Further variations exist, such as <code>ircd.typing.disable.sync</code> to prevent the client from receiving typing events for a particular room or all rooms.</p>
</blockquote>
<p>Learn more in <a href="https://matrix.to/#/#construct:zemos.net">#construct:zemos.net</a></p>
<h3 id="matrix-visualisations-gsoc-project-mortar-board">Matrix Visualisations GSOC project 🎓</h3>
<p><a href="https://matrix.to/#/@eisha:matrix.org">Eisha</a> announced:</p>
<blockquote>
<p>I've finished my GSoC project &quot;Matrix Visualisations&quot;, you can view my final report at this address <a href="https://gist.github.com/Kagamihime/d0e7ac434b0d80eb201260d213dea0b7">https://gist.github.com/Kagamihime/d0e7ac434b0d80eb201260d213dea0b7</a></p>
</blockquote>
<h2 id="dept-of-bridges-bridge-at-night">Dept of Bridges 🌉</h2>
<h3 id="mx-puppet-twitter-new">mx-puppet-twitter NEW</h3>
<p><a href="https://matrix.to/#/@sorunome:sorunome.de">sorunome</a> reported:</p>
<blockquote>
<p><a href="https://github.com/Sorunome/mx-puppet-twitter">mx-puppet-twitter</a>....do they ever stop?!</p>
<p>Now there is a twitter DM bridge based on <a href="https://github.com/Sorunome/mx-puppet-bridge">mx-puppet-bridge</a>! It uses twitters webhook API to receive direct messages instantly.</p>
<p>So far implemented:</p>
<ul>
<li>basic message sending in both directions</li>
<li>Image, Gif and Video sending (twitter special-cases those) in both directions</li>
<li>twitter oauth to authenticate</li>
</ul>
<p>Support room: <a href="https://matrix.to/#/#mx-puppet-bridge:sorunome.de">#mx-puppet-bridge:sorunome.de</a> 
Donate on liberapay: <a href="https://liberapay.com/Sorunome/donate">https://liberapay.com/Sorunome/donate</a></p>
</blockquote>
<h3 id="jojii-email-bridge-new">Jojii email bridge NEW</h3>
<p><a href="https://matrix.to/#/@jojii:matrix.jojii.de">Jojii</a> announced:</p>
<blockquote>
<p>For all those who want a new emailbridge, I have great news for you! The new bridge supports sending and writing emails, using multiple rooms for multiple email-addresses. In addition you can use markup to improve the style of your emailbody, which gets translated to HTML.  Here you can find the repository: <a href="https://github.com/JojiiOfficial/Matrix-EmailBridge">Matrix-EmailBridge</a></p>
</blockquote>
<p>Go join <a href="https://matrix.to/#/#jojiiMail:matrix.jojii.de">#jojiiMail:matrix.jojii.de</a> for more.</p>
<h3 id="big-news-for-the-slack-bridges">Big news for the Slack bridges</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> offered:</p>
<blockquote>
<p>The Slack bridge has had a whole week of care applied to it. We've <a href="https://github.com/matrix-org/matrix-appservice-slack/pull/152">switched the bridge entirely over to Typescript</a>, and overhauled large parts of the codebase to make future work easier (for ex, <a href="https://github.com/matrix-org/matrix-appservice-slack/pull/185">using the Slack node library rather than request calls</a>). If that's not exciting enough, we've also <a href="https://github.com/matrix-org/matrix-appservice-slack/pull/164">added support for the RTM API</a>, which means the bridge can use websockets when talking to slack. This gives us nice things like typing updates, and the ability to deploy without needing a webserver to listen for events. Release 1.0 is imminent, but before then we are hoping to land <a href="https://github.com/matrix-org/matrix-appservice-slack/pull/186">Postgresql support</a> so that the bridge can scale up to meet the high demands placed upon it.</p>
</blockquote>
<h3 id="mautrix-whatsapp">mautrix-whatsapp</h3>
<p><a href="https://matrix.to/#/@tulir:maunium.net">Tulir</a> told us:</p>
<blockquote>
<p><a href="https://github.com/tulir/mautrix-whatsapp">mautrix-whatsapp</a> got a bunch of small fixes and a dbms migration tool.</p>
</blockquote>
<h2 id="dept-of-clients-iphone">Dept of Clients 📱</h2>
<h3 id="riot-web">Riot Web</h3>
<blockquote>
<p>Ironed the bugs out of the new composer, which is available on <a href="https://riot.im/develop">https://riot.im/develop</a> behind a labs flag. Please test!</p>
</blockquote>
<h3 id="riot-ios">Riot iOS</h3>
<blockquote>
<p>Privacy, privacy and privacy.</p>
</blockquote>
<h3 id="riot-android">Riot Android</h3>
<blockquote>
<p>A security release has been done on thursday. More details here: <a href="https://medium.com/@RiotChat/matrix-android-sdk-security-issue-affecting-riot-android-36b4792ea0d6">https://medium.com/@RiotChat/matrix-android-sdk-security-issue-affecting-riot-android-36b4792ea0d6</a></p>
<p>In parallel we continued working on privacy.</p>
</blockquote>
<h3 id="riotx-android">RiotX (Android)</h3>
<blockquote>
<p>A release has been done today (v0.4.0). The main new feature is Read Receipts!</p>
</blockquote>
<h3 id="neo-renaming">Neo Renaming</h3>
<p><a href="https://matrix.to/#/@f0x:pixie.town">f0x</a> reported:</p>
<blockquote>
<p>I'm considering renaming Neo, to help with getting a nice domain, and better findability in general. Any suggestions welcome in <a href="https://matrix.to/#/#neo:pixie.town">#neo:pixie.town</a>.</p>
</blockquote>
<h3 id="pattle-0-12-0">Pattle 0.12.0</h3>
<p><a href="https://matrix.to/#/@wilko:pattle.im">Wilko</a> told us:</p>
<blockquote>
<p>A new version has been pushed to F-Droid, Google Play and TestFlight!</p>
<p>⚠️ <strong>This update requires a reinstall or clearing of data</strong> ⚠️: Because of some database
changes which were not that easy to migrate, you'll have to reinstall the app or clear the data.</p>
<p>Expect the new version to be on most platforms in 2 days, and on Google Play
in a few hours.</p>
<h4 id="changes">Changes</h4>
<ul>
<li>Add a dark theme!</li>
<li>Add basic settings page</li>
<li>Add ability to change your own display name</li>
<li>Allow multiple lines while typing a message</li>
<li>Render line breaks in messages</li>
<li>Fix issue where homeserver setting was overridden by the user domain</li>
<li>Mark new messages as read while chat is opened</li>
<li>Fix chats being sorted by your own display name change</li>
<li>Fix multiple issues regarding the member count of room being null</li>
<li>Use Flutter beta, which means that you can paste in textfields again!</li>
</ul>
<h4 id="get-pattle">Get Pattle</h4>
<ul>
<li>
<p><strong>Android</strong></p>
<ul>
<li><strong><a href="https://f-droid.org/en/packages/im.pattle.app/">F-Droid</a></strong></li>
<li><strong><a href="https://play.google.com/store/apps/details?id=im.pattle.app">Google Play</a></strong></li>
<li><strong><a href="https://git.pattle.im/pattle/app/-/jobs/1243/artifacts/download">APK</a></strong></li>
</ul>
</li>
<li>
<p><strong><a href="https://testflight.apple.com/join/uTytydST">iOS (TestFlight)</a></strong></p>
</li>
</ul>
<h4 id="issues-or-suggestions">Issues or suggestions</h4>
<p>If you stumble upon any issues or would like to suggest features, <a href="https://git.pattle.im/pattle/app/issues">please do so here</a>!
You can <a href="https://git.pattle.im/users/sign_in">login via GitHub and Gitlab.com</a>!</p>
<h4 id="follow-development">Follow development</h4>
<p>Follow development in <a href="https://matrix.to/#/#app:pattle.im">#app:pattle.im</a>!</p>
</blockquote>
<h3 id="continuum-0-9-19">Continuum 0.9.19</h3>
<p><a href="https://matrix.to/#/@uforia:matrix.org">yuforia</a> reported:</p>
<blockquote>
<p><a href="https://github.com/koma-im/continuum-desktop">Continuum</a> the pure Kotlin desktop client</p>
<ul>
<li>Provide builds of self-contained executables that have no external dependency. The Linux version has been done. AppImage is used, producing a binary of about 50 MB.</li>
<li>Adjust appearance. Remove alternating row high-lighting in list views. Remove extra padding between messages.</li>
</ul>
</blockquote>
<p><img src="/blog/img/2019-08-30-continuum.png" alt="Continuum" /></p>
<h3 id="quaternion-has-many-visual-improvements">Quaternion has many visual improvements</h3>
<p><a href="https://matrix.to/#/@kitsune:matrix.org">kitsune</a> reported:</p>
<blockquote>
<p>Thanks to <a href="https://github.com/rpallai">Roland Pallai</a>, Quaternion master branch is now able to use customised fonts and sports a faster timeline, better copying and a few other improvements. Settings dialog window is coming.</p>
</blockquote>
<h2 id="dept-of-sdks-and-frameworks">Dept of SDKs and Frameworks 🧰</h2>
<h3 id="igor-a-matrix-bot-framework-for-elixir">igor: a Matrix bot framework for Elixir</h3>
<p><a href="https://matrix.to/#/@uhoreg:matrix.org">uhoreg</a> offered:</p>
<blockquote>
<p>for fans of strange programming languages or of monster movie clichés, I've created a Matrix bot framework for Elixir: <a href="https://gitlab.com/uhoreg/igor">https://gitlab.com/uhoreg/igor</a></p>
</blockquote>
<h2 id="dept-of-encryption-closed-lock-with-key">Dept of Encryption 🔐</h2>
<p><a href="https://github.com/poljar">poljar</a>:</p>
<blockquote>
<p>Initial code dump of Seshat, a Matrix event indexer/database that should enable search for encrypted rooms in riot-desktop. The dump contains a rust library as well as node bindings. The <a href="https://github.com/matrix-org/seshat/tree/master/seshat-node">repo can be found here</a>.</p>
</blockquote>
<h2 id="dept-of-ops">Dept of Ops 🛠</h2>
<h3 id="arm-docker-images-for-synapse">ARM docker images for synapse</h3>
<p><a href="https://matrix.to/#/@bhat:encom.eu.org">Black Hat</a> told us:</p>
<blockquote>
<p>Apparently there are no ARM docker images for synapse, so I built a <a href="https://hub.docker.com/r/black0/synapse">multi-arch synapse docker image</a>. Supported CPU architectures include armv7, aarch64 and amd64.</p>
</blockquote>
<h2 id="dept-of-bots-robot-face">Dept of Bots 🤖</h2>
<p><a href="https://matrix.to/#/@tulir:maunium.net">tulir</a>:</p>
<blockquote>
<p>There's a useless <a href="https://github.com/maubot/exec">new maubot plugin</a> that lets you run python and soon shell scripts from Matrix. Not intended as a public bot as it doesn't have any sandboxing, but it does have a &quot;userbot&quot; mode to run it under your own account so that you can use it in any room.</p>
</blockquote>
<p>Slightly mean to call your own bot useless :(</p>
<h2 id="final-thoughts-thought-balloon">Final thoughts 💭</h2>
<p>If you've suffered from invite spam lately, you can solve the problem by following <a href="https://gist.github.com/turt2live/7bf1e589664298d786dfa6aeccda294a">these instructions</a>:</p>
<blockquote>
<p>There's 3 methods to block the room:</p>
<ol>
<li>Use the synapse admin API for it:</li>
</ol>
<pre data-lang="bash" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-bash "><code class="language-bash" data-lang="bash"><span>curl -s -X POST -H </span><span style="color:#d69d85;">&quot;Authorization: Bearer YOUR_ACCESS_TOKEN&quot;</span><span> -H </span><span style="color:#d69d85;">&quot;Content-Type: application/json&quot;</span><span> -d </span><span style="color:#d69d85;">&#39;{&quot;new_room_user_id&quot;:&quot;@abuse:YOUR_SERVER.org&quot;}&#39; &#39;https://YOUR_SERVER/_matrix/client/unstable/admin/shutdown_room/!BAD_ROOM:example.org&#39;
</span></code></pre>
<ol start="2">
<li>Block the room with an antispam module ( https://github.com/t2bot/synapse-simple-antispam )</li>
<li>Ignore the user with <code>/ignore</code></li>
</ol>
</blockquote>
<h2 id="that-s-all-i-know-checkered-flag">That's all I know 🏁</h2>
<p>See you next week, and be sure to stop by <a href="https://matrix.to/#/#TWIM:matrix.org">#twim:matrix.org</a> with your updates!</p>

        </div>
    </article>
    
    <nav class="pagination">
    <div class="prev">
        
        <a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;page&#x2F;35&#x2F;">‹ Previous</a>
        
    </div>
    <span class="page-number">36 / 67</span>
    <div class="prev">
        
        <a href="https:&#x2F;&#x2F;matrix.turbo.fish&#x2F;blog&#x2F;page&#x2F;37&#x2F;">Next ›</a>
        
    </div>
</nav>

</div>
    </main>

    <footer class="site-footer">
    <div class="internal-links">
        
        <a href="&#x2F;faq">FAQs</a>
        
        <a href="&#x2F;security-disclosure-policy">Security Disclosure Policy</a>
        
        <a href="&#x2F;security-hall-of-fame">Security Hall of Fame</a>
        
        <a href="&#x2F;legal&#x2F;code-of-conduct">Code of Conduct for Matrix.org</a>
        
        <a href="&#x2F;legal">Legal</a>
        
        <a href="&#x2F;contact">Contact</a>
        
        <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org&#x2F;matrix.org&#x2F;">Site Source</a>
        
    </div>
    <div class="external-links">
        <div>
            
            <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org"><img src="/assets/github.svg" alt="GitHub"></a>
            
            <a href="https:&#x2F;&#x2F;gitlab.matrix.org&#x2F;"><img src="/assets/gitlab.svg" alt="GitLab"></a>
            
            <a href="https:&#x2F;&#x2F;mastodon.matrix.org&#x2F;@matrix"><img src="/assets/mastodon.svg" alt="Mastodon"></a>
            
            <a href="https:&#x2F;&#x2F;twitter.com&#x2F;matrixdotorg"><img src="/assets/twitter.svg" alt="Twitter"></a>
            
            <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCVFkW-chclhuyYRbmmfwt6w"><img src="/assets/youtube.svg" alt="YouTube"></a>
            
        </div>
    </div>
    <p><a href="/legal/copyright-notice">Copyright Notice</a></p>
</footer>

</body>

</html>
