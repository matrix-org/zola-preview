<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="twitter:widgets:csp" content="on" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="twitter:site" content="@matrixdotorg" />
    <meta name="twitter:creator" content="@matrixdotorg" />

    <title>Matrix.org - Blog</title>
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="icon" type="image/png" href="/assets/favicon.png" />
    <link rel="stylesheet" href="/style.css" />

    </head>

<body>
    
    <header class="site-header">
    <a href="/" class="brand">
        <img src="/images/matrix-logo-white.svg" alt="Matrix logo">
    </a>
    <input id="site-header-dropdown-checkbox" type="checkbox" class="dropdown-checkbox" aria-hidden="true">
    <label for="site-header-dropdown-checkbox" class="dropdown-button">&#xe602;</label>
    <label for="site-header-dropdown-checkbox" class="page-overlay"></label>
    <nav>
        
        
        <a href="&#x2F;about&#x2F;" class="
            ">
            About
        </a>
        
        
        
        <a href="&#x2F;blog&#x2F;" class="
            current">
            Blog
        </a>
        
        
        
        
        
        <div class="section-wrap">
            <a href="&#x2F;docs&#x2F;" class="section ">
                Documentation
            </a>
            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    
                    
                    <a href="&#x2F;docs&#x2F;users&#x2F;">Users</a>
                    
                    
                    <a href="&#x2F;docs&#x2F;communities&#x2F;">Communities</a>
                    
                    
                    <a href="&#x2F;docs&#x2F;developers&#x2F;">Developers</a>
                    
                    
                    <a href="&#x2F;docs&#x2F;legacy&#x2F;">Legacy documentation</a>
                    
                </div>
            </div>
        </div>
        
        
        
        
        
        <div class="section-wrap">
            <a href="&#x2F;ecosystem&#x2F;" class="section ">
                Ecosystem
            </a>
            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    <a href="&#x2F;ecosystem&#x2F;clients&#x2F;">Clients</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;servers&#x2F;">Servers</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;bots&#x2F;">Bots</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;bridges&#x2F;">Bridges</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;sdks&#x2F;">SDKs</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;hosting&#x2F;">Hosting</a>
                    
                    
                </div>
            </div>
        </div>
        
        
        
        <a href="&#x2F;podcasts&#x2F;" class="
            ">
            Podcasts
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;shop.matrix.org" class="
            ">
            Shop
        </a>
        
        
        
        <a href="&#x2F;try-matrix&#x2F;" class="primary
            ">
            Try Matrix
        </a>
        
        
    </nav>
</header>


    <main>
        <div class="content">
    
    <article class="post">
        <header>
            <h1><a href="&#x2F;blog&#x2F;2020&#x2F;10&#x2F;13&#x2F;synapse-1-21-1-released&#x2F;" title="Synapse 1.21.1 released">Synapse 1.21.1 released</a></h1>
            <span>
                13.10.2020 00:00
                —
                <a href="/category/releases">
                    Releases
                </a>
                —
                <a href="/author/neil-johnson">
                    Neil Johnson
                </a>
            </span>
            
        </header>
        <div>
            <p>Synapse 1.21.1 has landed!</p>
<p>Highlights of 1.21.1 include:-</p>
<ul>
<li>
<p>Add experimental support for sharding event persister. (<a href="https://github.com/matrix-org/synapse/issues/8294">#8294</a>, <a href="https://github.com/matrix-org/synapse/issues/8387">#8387</a>, <a href="https://github.com/matrix-org/synapse/issues/8396">#8396</a>, <a href="https://github.com/matrix-org/synapse/issues/8419">#8419</a>)</p>
</li>
<li>
<p>Add experimental prometheus metric to track numbers of &quot;large&quot; rooms for state resolutiom. (<a href="https://github.com/matrix-org/synapse/issues/8425">#8425</a>)</p>
</li>
<li>
<p>Add prometheus metrics to track federation delays. (<a href="https://github.com/matrix-org/synapse/issues/8430">#8430</a>)</p>
</li>
<li>
<p>Fix messages not being sent over federation until an event is sent into the same room. (<a href="https://github.com/matrix-org/synapse/issues/8230">#8230</a>, <a href="https://github.com/matrix-org/synapse/issues/8247">#8247</a>, <a href="https://github.com/matrix-org/synapse/issues/8258">#8258</a>, <a href="https://github.com/matrix-org/synapse/issues/8272">#8272</a>, <a href="https://github.com/matrix-org/synapse/issues/8322">#8322</a>)</p>
</li>
</ul>
<p>We've also made some improvements to SSO and added new admin APIs.</p>
<p>Get the new releases from any of the usual sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md. 1.21.1 is on github <a href="https://github.com/matrix-org/synapse/releases/tag/v1.21.1">here</a></p>
<p>The changelog for 1.21.1 is as follows:</p>
<h1 id="synapse-1-21-1-2020-10-13">Synapse 1.21.1 (2020-10-13)</h1>
<p>This release fixes a regression in v1.21.0 that prevented debian packages from being built.</p>
<p>It is otherwise identical to v1.21.0.</p>
<h1 id="synapse-1-21-0-2020-10-12">Synapse 1.21.0 (2020-10-12)</h1>
<p>No significant changes since v1.21.0rc3.</p>
<p>As <a href="https://github.com/matrix-org/synapse/blob/release-v1.21.1/CHANGES.md#synapse-1200-2020-09-22">noted in v1.20.0</a>, a future release will drop support for accessing Synapse's <a href="https://github.com/matrix-org/synapse/tree/master/docs/admin_api">Admin API</a> under the <code>/_matrix/client/*</code> endpoint prefixes. At that point, the Admin API will only be accessible under <code>/_synapse/admin</code>.</p>
<h1 id="synapse-1-21-0rc3-2020-10-08">Synapse 1.21.0rc3 (2020-10-08)</h1>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Fix duplication of events on high traffic servers, caused by PostgreSQL <code>could not serialize access due to concurrent update</code> errors. (<a href="https://github.com/matrix-org/synapse/issues/8456">#8456</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Add Groovy Gorilla to the list of distributions we build <code>.deb</code>s for. (<a href="https://github.com/matrix-org/synapse/issues/8475">#8475</a>)</li>
</ul>
<h1 id="synapse-1-21-0rc2-2020-10-02">Synapse 1.21.0rc2 (2020-10-02)</h1>
<h2 id="features">Features</h2>
<ul>
<li>Convert additional templates from inline HTML to Jinja2 templates. (<a href="https://github.com/matrix-org/synapse/issues/8444">#8444</a>)</li>
</ul>
<h2 id="bugfixes-1">Bugfixes</h2>
<ul>
<li>Fix a regression in v1.21.0rc1 which broke thumbnails of remote media. (<a href="https://github.com/matrix-org/synapse/issues/8438">#8438</a>)</li>
<li>Do not expose the experimental <code>uk.half-shot.msc2778.login.application_service</code> flow in the login API, which caused a compatibility problem with Element iOS. (<a href="https://github.com/matrix-org/synapse/issues/8440">#8440</a>)</li>
<li>Fix malformed log line in new federation &quot;catch up&quot; logic. (<a href="https://github.com/matrix-org/synapse/issues/8442">#8442</a>)</li>
<li>Fix DB query on startup for negative streams which caused long start up times. Introduced in <a href="https://github.com/matrix-org/synapse/issues/8374">#8374</a>. (<a href="https://github.com/matrix-org/synapse/issues/8447">#8447</a>)</li>
</ul>
<h1 id="synapse-1-21-0rc1-2020-10-01">Synapse 1.21.0rc1 (2020-10-01)</h1>
<h2 id="features-1">Features</h2>
<ul>
<li>Require the user to confirm that their password should be reset after clicking the email confirmation link. (<a href="https://github.com/matrix-org/synapse/issues/8004">#8004</a>)</li>
<li>Add an admin API <code>GET /_synapse/admin/v1/event_reports</code> to read entries of table <code>event_reports</code>. Contributed by @dklimpel. (<a href="https://github.com/matrix-org/synapse/issues/8217">#8217</a>)</li>
<li>Consolidate the SSO error template across all configuration. (<a href="https://github.com/matrix-org/synapse/issues/8248">#8248</a>, <a href="https://github.com/matrix-org/synapse/issues/8405">#8405</a>)</li>
<li>Add a configuration option to specify a whitelist of domains that a user can be redirected to after validating their email or phone number. (<a href="https://github.com/matrix-org/synapse/issues/8275">#8275</a>, <a href="https://github.com/matrix-org/synapse/issues/8417">#8417</a>)</li>
<li>Add experimental support for sharding event persister. (<a href="https://github.com/matrix-org/synapse/issues/8294">#8294</a>, <a href="https://github.com/matrix-org/synapse/issues/8387">#8387</a>, <a href="https://github.com/matrix-org/synapse/issues/8396">#8396</a>, <a href="https://github.com/matrix-org/synapse/issues/8419">#8419</a>)</li>
<li>Add the room topic and avatar to the room details admin API. (<a href="https://github.com/matrix-org/synapse/issues/8305">#8305</a>)</li>
<li>Add an admin API for querying rooms where a user is a member. Contributed by @dklimpel. (<a href="https://github.com/matrix-org/synapse/issues/8306">#8306</a>)</li>
<li>Add <code>uk.half-shot.msc2778.login.application_service</code> login type to allow appservices to login. (<a href="https://github.com/matrix-org/synapse/issues/8320">#8320</a>)</li>
<li>Add a configuration option that allows existing users to log in with OpenID Connect. Contributed by @BBBSnowball and @OmmyZhang. (<a href="https://github.com/matrix-org/synapse/issues/8345">#8345</a>)</li>
<li>Add prometheus metrics for replication requests. (<a href="https://github.com/matrix-org/synapse/issues/8406">#8406</a>)</li>
<li>Support passing additional single sign-on parameters to the client. (<a href="https://github.com/matrix-org/synapse/issues/8413">#8413</a>)</li>
<li>Add experimental reporting of metrics on expensive rooms for state-resolution. (<a href="https://github.com/matrix-org/synapse/issues/8420">#8420</a>)</li>
<li>Add experimental prometheus metric to track numbers of &quot;large&quot; rooms for state resolutiom. (<a href="https://github.com/matrix-org/synapse/issues/8425">#8425</a>)</li>
<li>Add prometheus metrics to track federation delays. (<a href="https://github.com/matrix-org/synapse/issues/8430">#8430</a>)</li>
</ul>
<h2 id="bugfixes-2">Bugfixes</h2>
<ul>
<li>Fix a bug in the media repository where remote thumbnails with the same size but different crop methods would overwrite each other. Contributed by @deepbluev7. (<a href="https://github.com/matrix-org/synapse/issues/7124">#7124</a>)</li>
<li>Fix inconsistent handling of non-existent push rules, and stop tracking the <code>enabled</code> state of removed push rules. (<a href="https://github.com/matrix-org/synapse/issues/7796">#7796</a>)</li>
<li>Fix a longstanding bug when storing a media file with an empty <code>upload_name</code>. (<a href="https://github.com/matrix-org/synapse/issues/7905">#7905</a>)</li>
<li>Fix messages not being sent over federation until an event is sent into the same room. (<a href="https://github.com/matrix-org/synapse/issues/8230">#8230</a>, <a href="https://github.com/matrix-org/synapse/issues/8247">#8247</a>, <a href="https://github.com/matrix-org/synapse/issues/8258">#8258</a>, <a href="https://github.com/matrix-org/synapse/issues/8272">#8272</a>, <a href="https://github.com/matrix-org/synapse/issues/8322">#8322</a>)</li>
<li>Fix a longstanding bug where files that could not be thumbnailed would result in an Internal Server Error. (<a href="https://github.com/matrix-org/synapse/issues/8236">#8236</a>, <a href="https://github.com/matrix-org/synapse/issues/8435">#8435</a>)</li>
<li>Upgrade minimum version of <code>canonicaljson</code> to version 1.4.0, to fix an unicode encoding issue. (<a href="https://github.com/matrix-org/synapse/issues/8262">#8262</a>)</li>
<li>Fix longstanding bug which could lead to incomplete database upgrades on SQLite. (<a href="https://github.com/matrix-org/synapse/issues/8265">#8265</a>)</li>
<li>Fix stack overflow when stderr is redirected to the logging system, and the logging system encounters an error. (<a href="https://github.com/matrix-org/synapse/issues/8268">#8268</a>)</li>
<li>Fix a bug which cause the logging system to report errors, if <code>DEBUG</code> was enabled and no <code>context</code> filter was applied. (<a href="https://github.com/matrix-org/synapse/issues/8278">#8278</a>)</li>
<li>Fix edge case where push could get delayed for a user until a later event was pushed. (<a href="https://github.com/matrix-org/synapse/issues/8287">#8287</a>)</li>
<li>Fix fetching malformed events from remote servers. (<a href="https://github.com/matrix-org/synapse/issues/8324">#8324</a>)</li>
<li>Fix <code>UnboundLocalError</code> from occurring when appservices send a malformed register request. (<a href="https://github.com/matrix-org/synapse/issues/8329">#8329</a>)</li>
<li>Don't send push notifications to expired user accounts. (<a href="https://github.com/matrix-org/synapse/issues/8353">#8353</a>)</li>
<li>Fix a regression in v1.19.0 with reactivating users through the admin API. (<a href="https://github.com/matrix-org/synapse/issues/8362">#8362</a>)</li>
<li>Fix a bug where during device registration the length of the device name wasn't limited. (<a href="https://github.com/matrix-org/synapse/issues/8364">#8364</a>)</li>
<li>Include <code>guest_access</code> in the fields that are checked for null bytes when updating <code>room_stats_state</code>. Broke in v1.7.2. (<a href="https://github.com/matrix-org/synapse/issues/8373">#8373</a>)</li>
<li>Fix theoretical race condition where events are not sent down <code>/sync</code> if the synchrotron worker is restarted without restarting other workers. (<a href="https://github.com/matrix-org/synapse/issues/8374">#8374</a>)</li>
<li>Fix a bug which could cause errors in rooms with malformed membership events, on servers using sqlite. (<a href="https://github.com/matrix-org/synapse/issues/8385">#8385</a>)</li>
<li>Fix &quot;Re-starting finished log context&quot; warning when receiving an event we already had over federation. (<a href="https://github.com/matrix-org/synapse/issues/8398">#8398</a>)</li>
<li>Fix incorrect handling of timeouts on outgoing HTTP requests. (<a href="https://github.com/matrix-org/synapse/issues/8400">#8400</a>)</li>
<li>Fix a regression in v1.20.0 in the <code>synapse_port_db</code> script regarding the <code>ui_auth_sessions_ips</code> table. (<a href="https://github.com/matrix-org/synapse/issues/8410">#8410</a>)</li>
<li>Remove unnecessary 3PID registration check when resetting password via an email address. Bug introduced in v0.34.0rc2. (<a href="https://github.com/matrix-org/synapse/issues/8414">#8414</a>)</li>
</ul>
<h2 id="improved-documentation">Improved Documentation</h2>
<ul>
<li>Add <code>/_synapse/client</code> to the reverse proxy documentation. (<a href="https://github.com/matrix-org/synapse/issues/8227">#8227</a>)</li>
<li>Add note to the reverse proxy settings documentation about disabling Apache's mod_security2. Contributed by Julian Fietkau (@jfietkau). (<a href="https://github.com/matrix-org/synapse/issues/8375">#8375</a>)</li>
<li>Improve description of <code>server_name</code> config option in <code>homserver.yaml</code>. (<a href="https://github.com/matrix-org/synapse/issues/8415">#8415</a>)</li>
</ul>
<h2 id="deprecations-and-removals">Deprecations and Removals</h2>
<ul>
<li>Drop support for <code>prometheus_client</code> older than 0.4.0. (<a href="https://github.com/matrix-org/synapse/issues/8426">#8426</a>)</li>
</ul>
<h2 id="internal-changes-1">Internal Changes</h2>
<ul>
<li>Fix tests on distros which disable TLSv1.0. Contributed by @danc86. (<a href="https://github.com/matrix-org/synapse/issues/8208">#8208</a>)</li>
<li>Simplify the distributor code to avoid unnecessary work. (<a href="https://github.com/matrix-org/synapse/issues/8216">#8216</a>)</li>
<li>Remove the <code>populate_stats_process_rooms_2</code> background job and restore functionality to <code>populate_stats_process_rooms</code>. (<a href="https://github.com/matrix-org/synapse/issues/8243">#8243</a>)</li>
<li>Clean up type hints for <code>PaginationConfig</code>. (<a href="https://github.com/matrix-org/synapse/issues/8250">#8250</a>, <a href="https://github.com/matrix-org/synapse/issues/8282">#8282</a>)</li>
<li>Track the latest event for every destination and room for catch-up after federation outage. (<a href="https://github.com/matrix-org/synapse/issues/8256">#8256</a>)</li>
<li>Fix non-user visible bug in implementation of <code>MultiWriterIdGenerator.get_current_token_for_writer</code>. (<a href="https://github.com/matrix-org/synapse/issues/8257">#8257</a>)</li>
<li>Switch to the JSON implementation from the standard library. (<a href="https://github.com/matrix-org/synapse/issues/8259">#8259</a>)</li>
<li>Add type hints to <code>synapse.util.async_helpers</code>. (<a href="https://github.com/matrix-org/synapse/issues/8260">#8260</a>)</li>
<li>Simplify tests that mock asynchronous functions. (<a href="https://github.com/matrix-org/synapse/issues/8261">#8261</a>)</li>
<li>Add type hints to <code>StreamToken</code> and <code>RoomStreamToken</code> classes. (<a href="https://github.com/matrix-org/synapse/issues/8279">#8279</a>)</li>
<li>Change <code>StreamToken.room_key</code> to be a <code>RoomStreamToken</code> instance. (<a href="https://github.com/matrix-org/synapse/issues/8281">#8281</a>)</li>
<li>Refactor notifier code to correctly use the max event stream position. (<a href="https://github.com/matrix-org/synapse/issues/8288">#8288</a>)</li>
<li>Use slotted classes where possible. (<a href="https://github.com/matrix-org/synapse/issues/8296">#8296</a>)</li>
<li>Support testing the local Synapse checkout against the <a href="https://github.com/matrix-org/complement/">Complement homeserver test suite</a>. (<a href="https://github.com/matrix-org/synapse/issues/8317">#8317</a>)</li>
<li>Update outdated usages of <code>metaclass</code> to python 3 syntax. (<a href="https://github.com/matrix-org/synapse/issues/8326">#8326</a>)</li>
<li>Move lint-related dependencies to package-extra field, update CONTRIBUTING.md to utilise this. (<a href="https://github.com/matrix-org/synapse/issues/8330">#8330</a>, <a href="https://github.com/matrix-org/synapse/issues/8377">#8377</a>)</li>
<li>Use the <code>admin_patterns</code> helper in additional locations. (<a href="https://github.com/matrix-org/synapse/issues/8331">#8331</a>)</li>
<li>Fix test logging to allow braces in log output. (<a href="https://github.com/matrix-org/synapse/issues/8335">#8335</a>)</li>
<li>Remove <code>__future__</code> imports related to Python 2 compatibility. (<a href="https://github.com/matrix-org/synapse/issues/8337">#8337</a>)</li>
<li>Simplify <code>super()</code> calls to Python 3 syntax. (<a href="https://github.com/matrix-org/synapse/issues/8344">#8344</a>)</li>
<li>Fix bad merge from <code>release-v1.20.0</code> branch to <code>develop</code>. (<a href="https://github.com/matrix-org/synapse/issues/8354">#8354</a>)</li>
<li>Factor out a <code>_send_dummy_event_for_room</code> method. (<a href="https://github.com/matrix-org/synapse/issues/8370">#8370</a>)</li>
<li>Improve logging of state resolution. (<a href="https://github.com/matrix-org/synapse/issues/8371">#8371</a>)</li>
<li>Add type annotations to <code>SimpleHttpClient</code>. (<a href="https://github.com/matrix-org/synapse/issues/8372">#8372</a>)</li>
<li>Refactor ID generators to use <code>async with</code> syntax. (<a href="https://github.com/matrix-org/synapse/issues/8383">#8383</a>)</li>
<li>Add <code>EventStreamPosition</code> type. (<a href="https://github.com/matrix-org/synapse/issues/8388">#8388</a>)</li>
<li>Create a mechanism for marking tests &quot;logcontext clean&quot;. (<a href="https://github.com/matrix-org/synapse/issues/8399">#8399</a>)</li>
<li>A pair of tiny cleanups in the federation request code. (<a href="https://github.com/matrix-org/synapse/issues/8401">#8401</a>)</li>
<li>Add checks on startup that PostgreSQL sequences are consistent with their associated tables. (<a href="https://github.com/matrix-org/synapse/issues/8402">#8402</a>)</li>
<li>Do not include appservice users when calculating the total MAU for a server. (<a href="https://github.com/matrix-org/synapse/issues/8404">#8404</a>)</li>
<li>Typing fixes for <code>synapse.handlers.federation</code>. (<a href="https://github.com/matrix-org/synapse/issues/8422">#8422</a>)</li>
<li>Various refactors to simplify stream token handling. (<a href="https://github.com/matrix-org/synapse/issues/8423">#8423</a>)</li>
<li>Make stream token serializing/deserializing async. (<a href="https://github.com/matrix-org/synapse/issues/8427">#8427</a>)</li>
</ul>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="&#x2F;blog&#x2F;2020&#x2F;10&#x2F;09&#x2F;this-week-in-matrix-2020-10-09&#x2F;" title="This Week in Matrix 2020-10-09">This Week in Matrix 2020-10-09</a></h1>
            <span>
                10.10.2020 00:28
                —
                <a href="/category/this-week-in-matrix">
                    This Week in Matrix
                </a>
                —
                <a href="/author/ben-parsons">
                    Ben Parsons
                </a>
            </span>
            <br>
            <small>Last update: 09.10.2020 20:29</small>
        </header>
        <div>
            <h2 id="matrix-live">Matrix Live 🎙</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/DOHTmJFrvbM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2 id="dept-of-status-of-matrix-face-with-th">Dept of <em>Status of Matrix</em> 🌡️</h2>
<h3 id="matrix-in-use-at-ietf-and-teamspeak">Matrix in use at IETF and TeamSpeak</h3>
<p><a href="https://matrix.to/#/@matthew:matrix.org">Matthew</a> said:</p>
<blockquote>
<p>IETF is trialling Matrix as a replacement to Slack and a complement to XMPP: <a href="https://mailarchive.ietf.org/arch/msg/tools-discuss/cUd9P35cj-nGsaioZ9HmMLmf1G4/">https://mailarchive.ietf.org/arch/msg/tools-discuss/cUd9P35cj-nGsaioZ9HmMLmf1G4/</a></p>
</blockquote>
<p>ALSO</p>
<p><a href="https://matrix.to/#/@matthew:matrix.org">Matthew</a> commented:</p>
<blockquote>
<p>looks like teamspeak is using Matrix (a Matrix endpoint was previously noticed at https://tschat-1.teamspeak.com/)</p>
</blockquote>
<p><a href="https://matrix.to/#/@deepbluev7:neko.dev">Nico (@deepbluev7:neko.dev)</a> offered:</p>
<blockquote>
<p>More info here: <a href="https://community.teamspeak.com/t/teamspeak-development-status-update/11419/36">https://community.teamspeak.com/t/teamspeak-development-status-update/11419/36</a></p>
</blockquote>
<h2 id="dept-of-spec-scroll">Dept of Spec 📜</h2>
<p><a href="https://matrix.to/#/@andrewm:amorgan.xyz">anoa</a> told us:</p>
<blockquote>
<p>Here's your weekly spec update! The heart of Matrix is the specification - and this is modified by Matrix Spec Change (MSC) proposals. Learn more about how the process works at <a href="https://matrix.org/docs/spec/proposals">https://matrix.org/docs/spec/proposals</a></p>
<h4 id="msc-status">MSC Status</h4>
<p><strong>Merged MSCs:</strong></p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2788">MSC2788: Room version 6 as the default room version</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2414">MSC2414: Make reason and score parameters optional for reporting content</a></li>
</ul>
<p><strong>MSCs in Final Comment Period:</strong></p>
<ul>
<li><em>No MSCs are in FCP.</em></li>
</ul>
<p><strong>New MSCs:</strong></p>
<ul>
<li>
<p><a href="https://github.com/matrix-org/matrix-doc/pull/2812">[WIP] MSC2812: Role-based power/permissions</a></p>
</li>
<li>
<p><a href="https://github.com/matrix-org/matrix-doc/pull/2810">MSC2810: Consistent globs specification</a></p>
</li>
<li>
<p><a href="https://github.com/matrix-org/matrix-doc/pull/2802">[WIP] MSC2802: Flip The Table for Full Room Abstraction</a></p>
</li>
</ul>
<h4 id="spec-core-team">Spec Core Team</h4>
<p>In terms of Spec Core Team MSC focus for this week, we're going to be keeping the same three MSCs as last week, as their review is still a work in progress. As a reminder, those are <a href="https://github.com/matrix-org/matrix-doc/issues/2774">MSC2774</a> (widget URL template parameters), <a href="https://github.com/matrix-org/matrix-doc/issues/2765">MSC2765</a> (widget avatars), and <a href="https://github.com/matrix-org/matrix-doc/issues/2790">MSC2790</a> (modal widgets).</p>
</blockquote>
<p><img src="/blog/img/2020-10-09--3RtA-stacked_area_chart.png" alt="2020-10-09--3RtA-stacked_area_chart.png" /></p>
<h2 id="dept-of-servers-europea">Dept of Servers 🏢</h2>
<h3 id="dendrite-goes-beta">Dendrite goes beta</h3>
<p>Dendrite is a next-generation homeserver written in Go</p>
<p><a href="https://matrix.to/#/@kegan:matrix.org">kegan</a> told us:</p>
<blockquote>
<p>Dendrite <a href="https://matrix.org/blog/2020/10/08/dendrite-is-entering-beta">has officially entered beta</a>!</p>
<p>It aims to be an efficient, reliable and scalable alternative to Synapse.</p>
<p>We encourage early adopters to try it out starting with v0.1.0 in Monolith/Postgres mode.</p>
<p>Dendrite supports a large amount of the Matrix spec including:</p>
<ul>
<li>
<p>All room versions</p>
</li>
<li>
<p>E2E encryption (but not cross-signing)</p>
</li>
<li>
<p>Federation</p>
</li>
<li>
<p>and many others!</p>
</li>
</ul>
<p>We'll be hard at work in the coming weeks ironing out any issues that crop up as Dendrite enters the global</p>
<p>federation of Matrix servers. At present, Dendrite has not been optimised for memory/CPU usage, nor does it
fully support sharding, so there is still much scope to improve the already impressive resource usage whilst</p>
<p>heading towards 100% spec compliance.</p>
<p>Spec compliance:</p>
<ul>
<li>
<p>Client-Server APIs: 56%, same as last week</p>
</li>
<li>
<p>Server-Server APIs: 77%, same as last week</p>
</li>
</ul>
</blockquote>
<p><a href="https://matrix.to/#/@rumpelsepp:hackbrettl.de">stefan</a> announced:</p>
<blockquote>
<p>I created an <a href="https://aur.archlinux.org/packages/dendrite/">AUR package</a> for dendrite. So it is easy to get it running on Arch Linux.</p>
</blockquote>
<h3 id="conduit">Conduit</h3>
<p>Conduit is a Matrix homeserver written in Rust <a href="https://conduit.rs">https://conduit.rs</a></p>
<p><a href="https://matrix.to/#/@timo:koesters.xyz">timo</a> told us:</p>
<blockquote>
<p>This week I worked on a new feature: the Admin Room. This is a room that is automatically created for the first user of a new homeserver. This room will be used to send warnings to server admins in the future and can be used to control Conduit (like querying information, running cleanup, banning servers, hiding public rooms or restarting Conduit). Power levels can be used to control who in the room has access to which commands. The admin room will work over federation, so it's easy to help someone fix his server.</p>
<p>Other news:</p>
<ul>
<li>
<p>Federation is now disabled by default and can be enabled in the config</p>
</li>
<li>
<p>Bug with typing notifications is fixed</p>
</li>
</ul>
<p>Thanks to everyone who supports me on <a href="https://liberapay.com/timokoesters">Liberapay</a> or Bitcoin!</p>
</blockquote>
<h2 id="synapse">Synapse</h2>
<p><a href="https://matrix.to/#/@neilj:matrix.org">Neil</a> told us:</p>
<blockquote>
<p>This week we put out <a href="https://github.com/matrix-org/synapse/releases/tag/v1.21.0rc3">v1.21.0rc3</a>, which fixes a duplicate messages bug. We expect the full release to go out early next week.</p>
<p>After a long and sometimes painful journey we plan to run sharded event persisters on matrix.org from Monday. All being well we will start running background processes on their own worker to free up the main process.
These two projects combined should noticeably improve performance of matrix.org and any large scale deployments.</p>
<p>Aside from that we are continuing to work on room knocking as a feature and have been considering ways to reduce load attributable to state resolution.</p>
<p>We will also dust off the notifications project.</p>
</blockquote>
<h2 id="dept-of-bridges-bridge-at-night">Dept of Bridges 🌉</h2>
<h3 id="gitter">Gitter</h3>
<p><a href="https://matrix.to/#/@madlittlemods:matrix.org">Eric Eastwood</a> told us:</p>
<blockquote>
<p>The native Gitter &lt;-&gt; Matrix bridge is underway and we're working on <a href="https://gitlab.com/gitlab-org/gitter/webapp/-/merge_requests/2027">virtual users</a> which is the first piece to making the bridge feel native. You can see what this will look like in this ominous and exciting tweet: <a href="https://twitter.com/gitchat/status/1314252991705292800">https://twitter.com/gitchat/status/1314252991705292800</a></p>
<p>There is also a <a href="https://gitlab.com/groups/gitlab-org/gitter/-/epics/10#note_426385967">GitLab epic</a> you can track which breaks down some of the tasks and holds more details of what we're thinking of for the bridge.</p>
</blockquote>
<h3 id="rainbow-once-more-into-the-bifrost">🌈 Once more into the Bifrost</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> announced:</p>
<blockquote>
<p>Asgardians rejoice, for Bifrost development resumed this week! We've worked extremely hard this week to improve general gateway performance, edge case bugs and basically plowing on with the project. A 0.2.0 release will shortly be due with the new changes, and matrix.org is already running the latest and greatest. You can checkout the project over at <a href="https://github.com/matrix-org/matrix-bifrost">https://github.com/matrix-org/matrix-bifrost</a></p>
</blockquote>
<h2 id="dept-of-clients-iphone">Dept of Clients 📱</h2>
<h3 id="fractal">Fractal</h3>
<p><a href="https://matrix.to/#/@afranke:matrix.org">Alexandre Franke</a> reported:</p>
<blockquote>
<p>Former Fractal GSoC intern Alejandro Dominguez 😎️ got his <a href="https://gitlab.gnome.org/GNOME/fractal/-/merge_requests/626">Integrate matrix-sdk (I)</a> merge request in “Ready for review” state. That’s a +3910/-5439, 38 commits diff‼️ poljar, who is the main contributor of matrix-rust-sdk, already had a look and provided some insights, but given 😱️ the sheer size of the changeset, the moar 👀️ we can get on it the better.</p>
</blockquote>
<h3 id="fluffychat">fluffychat</h3>
<p><a href="https://matrix.to/#/@krille:janian.de">krille</a> offered:</p>
<blockquote>
<p>FluffyChat now runs on native Linux desktop (x86).</p>
<p>You can download Linux tarballs from the CI and run them on any system which has sqlite3 installed (which all distros may have). If you have libolm3 installed, you can also use e2ee.
Oh and by the way. Its NOT electron or any html5 stuff! Its a native Linux app.
We are working on packaging solutions like snap and Flatpak. 😊</p>
</blockquote>
<h3 id="vtx">Vtx</h3>
<p><a href="https://matrix.to/#/@craftedcart:matrix.org">CraftedCart</a> offered:</p>
<blockquote>
<p>I've started to make a Matrix client over the past few weeks, just as a hobby project for now, using Qt and a 'lil C++20! :D</p>
<p>There's not a whole lot to show right now - currently we've got password login, and a simple timeline that can show plain text or <code>m.image</code> thumbnails.</p>
<p>Source code's up at <a href="https://gitlab.com/CraftedCart/vtx">https://gitlab.com/CraftedCart/vtx</a></p>
</blockquote>
<p><img src="/blog/img/2020-10-09-TATmq-vtx_main.png" alt="2020-10-09-TATmq-vtx_main.png" /></p>
<h3 id="nheko">Nheko</h3>
<p><a href="https://github.com/Nheko-Reborn/nheko">Nheko</a> is a desktop client using Qt, Boost.Asio and C++17. It supports E2EE (with the notable exception being device verification for now) and intends to be full featured and nice to look at</p>
<p><a href="https://matrix.to/#/@deepbluev7:neko.dev">Nico (@deepbluev7:neko.dev)</a> reported:</p>
<blockquote>
<p>This week we finally cleaned up the remaining parts of Chethans GSoC work and merged it. This means Nheko now has partial support for cross-signing. You can either start the verification from another client or when viewing the profile of a user. There are a few things still missing though:</p>
<ul>
<li>
<p>Nheko does not use the verification status at all at the moment. So while you can verify your master key and let others verify your master key, from Nhekos perspective there is not much benefit yet. You will however show up with a green checkmark in other clients.</p>
</li>
<li>
<p>While nheko supports verifying your own master key and after that will also let others verify your master key, it does not yet download the self and user signing keys. This means you won't be able to upload cross-signing signatures for your own devices and other users master keys yet. I'll see if I can implement in the next weeks or so (since literally only the private key download or sharing is missing).</p>
</li>
<li>
<p>Nheko can't bootstrap cross-signing yet. This means you need to bootstrap it from Element or another client once. That will probably take a bit until this is complete.</p>
</li>
<li>
<p>The UX is still WIP. Currently it shows a lot of unnecessary buttons, that are a bit confusing as well as not enough green checkmarks, so that needs some work.</p>
</li>
</ul>
<p>Other things that happened in the mean time or are work in progress:</p>
<ul>
<li>
<p>Decryption errors should be reduced by a bit now. This is still work in progress though. With device trust landed now, we should be able to do automatic key requests, sharing and key backup soon.</p>
</li>
<li>
<p>Lurkki is currently cleaning up the design of the built in video player.</p>
</li>
<li>
<p>manu_kamath is improving the design when showing images at the same time.</p>
</li>
<li>
<p>LorenDB has been updating our screenshots and working on an Esperanto translation.</p>
</li>
<li>
<p>trilene has been ever busy improving edge cases around the Voip support in Nheko.</p>
</li>
</ul>
<p>So far Hacktoberfest seems to be going well with quite a few people trying to clean up some of the rougher edges in Nheko. If you are using Nheko and think some things could be better, why not try to fix it yourself? October is the perfect time for that!</p>
<p>Featurework of this cycle is also slowly nearing its end. Once cross-signing, voip and the new event store are stable, we plan to improve the UX a bit more as well as some other annoyances and maybe we can do a new release then! A nice and spooky Hacktober everyone!</p>
</blockquote>
<p><a href="https://matrix.to/#/@davebloggt:kif.rocks">David Mehren</a> told us:</p>
<blockquote>
<p>I just built <code>nheko-git 0.7.2.r2021.517a126a-1</code> from the AUR and cross-signing works</p>
</blockquote>
<h3 id="element-web">Element Web</h3>
<p><a href="https://matrix.to/#/@neilj:matrix.org">Neil</a> offered:</p>
<blockquote>
<p>This week we put out 1.7.9-rc.1 which is available at <a href="https://staging.element.io">https://staging.element.io</a></p>
<p>Highlights include</p>
<ul>
<li>
<p>Many small fixes with edits and replies</p>
</li>
<li>
<p>Fixed a race during cross-signing key upload at registration time</p>
</li>
<li>
<p>Clarified when you have unsaved changes in profile settings</p>
</li>
</ul>
<p>Finally, the improved widget support is looking very exciting. Here is a design grab to give you an idea of what to expect. Note this is not a real Element screen shot, the base functionality is there, but the look and feel of the final version is subject to change.</p>
</blockquote>
<p><img src="/blog/img/2020-10-09-oANj9-widgets.png" alt="2020-10-09-oANj9-widgets.png" /></p>
<p><a href="https://matrix.to/#/@x:riot.ovh">Michael (t3chguy)</a> added:</p>
<blockquote>
<p>Element Web is currently transitioning the codebase over to TypeScript - track our progress at <a href="http://arewetsyet.bit.ovh/">http://arewetsyet.bit.ovh/</a></p>
</blockquote>
<h3 id="hydrogen">Hydrogen</h3>
<p><a href="https://matrix.to/#/@bwindels:matrix.org">Bruno</a> told us:</p>
<blockquote>
<p>This week, Hydrogen gained better caching (and a little over-eager on Safari), room list filtering, a grid layout to show up to 6 rooms simultaneously (see screenshot) and work is well on its way for url-based navigation within the app.</p>
</blockquote>
<p><img src="/blog/img/2020-10-09-taU-L-hydrogen-grid.png" alt="2020-10-09-taU-L-hydrogen-grid.png" /></p>
<blockquote>
<p>also adding the screenshot on iOS that I didn't get in last week, showing the full range of display formats supported 🙂</p>
</blockquote>
<p><img src="/blog/img/2020-10-09-OJHmu-hydrogen-ios.jpg" alt="2020-10-09-OJHmu-hydrogen-ios.jpg" /></p>
<blockquote>
<p>The app also received some visual polish, thanks to Nad, our designer.</p>
</blockquote>
<h3 id="element-ios">Element-iOS</h3>
<p><a href="https://matrix.to/#/@Manu:matrix.org">Manu</a> offered:</p>
<blockquote>
<p>We blocked the last week release (1.0.14) because of 2 issues: <a href="https://github.com/vector-im/element-ios/issues/3721">Unable to decrypt errors</a> and <a href="https://github.com/vector-im/element-ios/issues/3672#issuecomment-703510893">timeline not updating when coming from a notification</a>.</p>
<p><a href="https://github.com/vector-im/element-ios/releases/tag/v1.0.15">1.0.15</a> fixes those issues and more. The release should be available in TF soon. Hopefully, we will be able to publish it on the App Store on Monday</p>
</blockquote>
<h2 id="dept-of-voip-call-me-hand">Dept of VoIP 🤙</h2>
<h3 id="matrix-voip-tester">Matrix VoIP Tester</h3>
<p><a href="https://matrix.to/#/@reivilibre:librepush.net">reivilibre</a> said:</p>
<blockquote>
<p><a href="https://github.com/matrix-org/voip-tester/pull/18">https://github.com/matrix-org/voip-tester/pull/18</a> (updated demo: <a href="https://test.voip.librepush.net">https://test.voip.librepush.net</a>)</p>
<p>This week, I have improved the scoring rubric, so that the verdict given to you by the tester more accurately reflects the likelihood of connection establishment.</p>
<p>I have also added more hints on what the verdicts mean.</p>
<p>Finally, I have added workarounds to support Chromium browsers that decided to break their WebRTC API so that they could pedantically rename <code>ip</code> to <code>address</code>. In any case, it now seems to be on par with Firefox.</p>
<p>The VoIP tester is now roughly 'usable' but please note that IPv6 support is totally untested (I don't have IPv6) — it is also suspected that some browsers won't try IPv6 anyway.</p>
<p>There are also some more features on the wish list, such as screenshot safety and extra help when things go wrong.</p>
<p>For discussion, feel free to join <a href="https://matrix.to/#/#voip-tester:librepush.net">#voip-tester:librepush.net</a> .</p>
</blockquote>
<h2 id="dept-of-encryption-closed-lock-with-key">Dept of Encryption 🔐</h2>
<h3 id="olm-lizard">Olm 🦎</h3>
<p><a href="https://matrix.to/#/@hubert:uhoreg.ca">uhoreg</a> reported:</p>
<blockquote>
<p>Versions 3.2.0 and 3.2.1 of libolm have been released.  3.2.0 supports fallback keys (<a href="https://github.com/matrix-org/matrix-doc/pull/2732">MSC2732</a>) in the C library and the JavaScript binding, and includes several JavaScript/TypeScript fixes and improvements.  3.2.1 was just a fix to the TypeScript definition file.</p>
</blockquote>
<h2 id="dept-of-sdks-and-frameworks">Dept of SDKs and Frameworks 🧰</h2>
<h3 id="ruma">Ruma</h3>
<p>Ruma is a Rust project to create a comprehensive set of APIs for Matrix. Previously there was a Ruma homeserver project.</p>
<p><a href="https://matrix.to/#/@jplatte:matrix.org">jplatte</a> said:</p>
<blockquote>
<p>This week, q-b <a href="https://github.com/ruma/ruma/pull/289">implemented</a> moderation policy events, bringing us to full compatibility with r0.6.1 of the client-server API. iinuwa <a href="https://github.com/ruma/ruma/pull/288">added</a> the only endpoint we were missing from the appservice API. Additionally, I <a href="https://github.com/ruma/ruma/pull/286">improved</a> Ruma's JSON canonicalization, making it both simpler and more efficient.</p>
<p>Due to <a href="https://github.com/ruma/ruma/issues/215">two</a> <a href="https://github.com/ruma/ruma/issues/171">issues</a> regarding future-compatibility, we're still a while away from our next set of releases, but we're working on it!</p>
</blockquote>
<h3 id="new-library-objmatrix-objective-c">New library: ObjMatrix (Objective-C)</h3>
<p><a href="https://mtrix.to/#/@js:nil.im">js</a> introduced it with:</p>
<blockquote>
<p><a href="https://fossil.nil.im/objmatrix">ObjMatrix</a> (<a href="https://github.com/ObjFW/ObjMatrix">GitHub</a>) is a new Matrix client library written in modern Objective-C for <a href="https://objfw.nil.im/">ObjFW</a>. Because it uses ObjFW, it is not limited to Apple platforms, and instead is <a href="https://objfw.nil.im/doc/trunk/PLATFORMS.md">extremely portable</a> and should run on basically everything.</p>
<p>This is currently in its very early stages and is intended to be suitable to develop bots and clients with very soon. Being suitable to develop bridges with it is another goal for later.</p>
<p>Since ObjFW also works on platforms that are usually hard to support or port software to (e.g. <a href="https://www.morphos-team.net/">MorphOS</a>), this will hopefully also bring clients for these less mainstream operating systems. I'm especially hopeful about MorphOS here, since ObjFW already runs quite well there (parts of it are included with the OS even!), and hardware on which MorphOS runs on is usually not powerful enough to run Element Web. And eventually, I will want to have a Matrix client on my Amiga, too 😉 (which this should enable).</p>
<p>This currently does not have a decicated Matrix room yet, so all discussions about it currently happen in <a href="https://matrix.to/#/#objfw:nil.im">#objfw:nil.im</a>. So please feel free to join there and follow along development. And contributions are of course <em>very</em> welcome!</p>
</blockquote>
<h2 id="dept-of-ops">Dept of Ops 🛠</h2>
<h3 id="famedly-matrix-ansible-collection">famedly.matrix ansible collection</h3>
<p><a href="https://matrix.to/#/@jan.christian:gruenhage.xyz">JCG</a> told us:</p>
<blockquote>
<p>the <code>famedly.matrix</code> ansible collection has seen a release v0.2.0. Highlights since the last TWIM mention:</p>
<ul>
<li>
<p><strong>synapse_register</strong>: a new module for registering users using synapse's admin API.</p>
</li>
<li>
<p><strong>matrix_member</strong>: another new module, for inviting/kicking/banning people to/from rooms.</p>
</li>
<li>
<p>updates to synapse and element have been merged into their roles</p>
</li>
<li>
<p>support deploying release candidates of synapse and element</p>
</li>
</ul>
</blockquote>
<h2 id="dept-of-guides">Dept of Guides 🧭</h2>
<h3 id="noteworthy-hub-guide">Noteworthy Hub Guide</h3>
<p><a href="https://matrix.to/#/@balaa:a.noteworthy.im">balaa</a> told us:</p>
<blockquote>
<p>We’ve put together a write up on how to deploy a Noteworthy Hub (transparent TLS proxy) in order to make it easy to run a federation capable matrix home server behind a firewall or NAT: <a href="https://noteworthy.tech/hub">https://noteworthy.tech/hub</a></p>
</blockquote>
<h2 id="dept-of-ping-table-tennis-paddle-and-ball">Dept of Ping 🏓</h2>
<p>Here we reveal, rank, and applaud the homeservers with the lowest ping, as measured by <a href="https://github.com/maubot/echo">pingbot</a>, a <a href="https://github.com/maubot/maubot">maubot</a> that you can host on your own server. Join <a href="https://matrix.to/#/#ping:maunium.net">#ping:maunium.net</a> to experience the fun live, and to find out how to add YOUR server to the game.</p>
<table><thead><tr><th style="text-align: center">Rank</th><th style="text-align: center">Hostname</th><th style="text-align: center">Median MS</th></tr></thead><tbody>
<tr><td style="text-align: center">1</td><td style="text-align: center">helderferreira.io</td><td style="text-align: center">487</td></tr>
<tr><td style="text-align: center">2</td><td style="text-align: center">heitkoetter.net</td><td style="text-align: center">627</td></tr>
<tr><td style="text-align: center">3</td><td style="text-align: center">asra.gr</td><td style="text-align: center">802</td></tr>
<tr><td style="text-align: center">4</td><td style="text-align: center">conduit.rs</td><td style="text-align: center">1178</td></tr>
<tr><td style="text-align: center">5</td><td style="text-align: center">matrix.thedisco.zone</td><td style="text-align: center">1275.5</td></tr>
<tr><td style="text-align: center">6</td><td style="text-align: center">shortestpath.dev</td><td style="text-align: center">1803</td></tr>
<tr><td style="text-align: center">7</td><td style="text-align: center">lelux.net</td><td style="text-align: center">2419</td></tr>
<tr><td style="text-align: center">8</td><td style="text-align: center">elcyb.org</td><td style="text-align: center">2685</td></tr>
<tr><td style="text-align: center">9</td><td style="text-align: center">test.zemos.net</td><td style="text-align: center">2800</td></tr>
<tr><td style="text-align: center">10</td><td style="text-align: center">blob.cat</td><td style="text-align: center">2882</td></tr>
</tbody></table>
<h2 id="that-s-all-i-know-checkered-flag">That's all I know 🏁</h2>
<p>Thanks anoa for TCB* the last two weeks! Was fun to be the one to read TWIM for myself. :D</p>
<p>See you next week, and be sure to stop by <a href="https://matrix.to/#/#TWIM:matrix.org">#twim:matrix.org</a> with your updates!</p>
<p>* Taking Care of Business</p>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="&#x2F;blog&#x2F;2020&#x2F;10&#x2F;08&#x2F;dendrite-is-entering-beta&#x2F;" title="Dendrite is entering Beta!">Dendrite is entering Beta!</a></h1>
            <span>
                08.10.2020 00:00
                —
                <a href="/category/releases">
                    Releases
                </a>
                —
                <a href="/author/matthew-hodgson">
                    Matthew Hodgson
                </a>
            </span>
            
        </header>
        <div>
            <p>Hi all,</p>
<p>We’re very excited to announce that Dendrite, the next-generation Matrix homeserver from the core Matrix team, is at last exiting alpha development and entering beta testing!</p>
<p>The path we’ve taken to get here has been quite a curious one, and it’s worth recapping to give context on why it’s taken reality a little while to catch up with the dream. :)</p>
<p>The Dendrite project has its roots in 2016 as <a href="https://github.com/matrix-org/dendron">Dendron</a>: an attempt to write a next-generation homeserver in Golang rather than Python, in order to benefit from Go’s stronger typing, ease of profiling (no twisted stack-shredding via deferredInlineCallbacks), multithreading and faster GC performance.  The idea for Dendron was to do a <a href="https://martinfowler.com/bliki/StranglerFigApplication.html">strangler pattern</a> rewrite of Synapse - where we’d insert Dendron in front of Synapse as a load balancer, and incrementally replace Synapse’s API endpoints with ones implemented by Dendron.</p>
<p>However, as the project started to progress, it became clear that this was going to end up with many of Synapse’s architectural choices being baked into the project - particularly the DB schema and data flow architecture, such that the new endpoints could interoperate with the existing Python ones.  We got as far as putting Dendron live on matrix.org and moving some of the login/registration APIs over to it… but then work fizzled out due to Synapse demanding more urgent attention as traffic grew on Matrix.org, combined with concerns about whether Dendron was the right approach in general.</p>
<p>So, towards the end of 2016 (after the rush to launch <del>Vector</del> <del>Riot</del> Element that summer), we went back to the drawing board to devise Dendrite—“Dendron done right!”—as opposed to Dendron, which in retrospect was Dendrite done wrong. ;) The new vision was:</p>
<ul>
<li>Build a massively horizontally scalable architecture, such that large Matrix deployments like matrix.org and big government deployments could run smoothly without the constant scalability headaches we were seeing at the time with Synapse</li>
<li>Do so by splitting the server into well-defined microservice components, each of which could independently horizontally scale, each with its own DB (if desired)</li>
<li>Connect the components together with a set of append-only logs via <a href="https://kafka.apache.org/">Kafka</a> or similar, easily letting components shard and maintain their databases from the logs, allowing rolling upgrades, possibly schema upgrades, and all sorts of other niceties.  The logs effectively become a primary source of truth rather than putting all the onus on a massive monolithic ever-growing database</li>
</ul>
<p>Rather than Dendron’s top-down approach, instead Dendrite started bottom-up with the very hardest bit: <a href="https://github.com/matrix-org/gomatrixserverlib">gomatrixserverlib</a>, a standalone Go library implementing the state resolution algorithms and performing federation requests (such that it might also someday be used as a general purpose way to add Matrix federation support to an existing Go codebase).</p>
<p>Then we started building out the various components to implement the various services, starting with the roomserver (the service which models the history and state of one or more rooms in the server), then the syncserver (the service which implements the /sync API to let clients receive messages), etc. We even implemented a simplified in-memory version of Kafka named <a href="https://github.com/matrix-org/naffka">naffka</a>—useful for glueing together the microservice components when running them all within a single binary.</p>
<p>Things were looking pretty positive by the summer of 2017: we had the server sending/receiving messages, federating with Synapse, and looking tantalisingly close:</p>
<blockquote>
<p lang="en" dir="ltr">We just sent the first ever synapse-&gt;dendrite federated traffic, including full dendrite media API (thumbnailing, fed, etc)!!! :D :D :D <a href="https://t.co/sBcM2jMAr6">pic.twitter.com/sBcM2jMAr6</a></p>&mdash; Matrix (@matrixdotorg) <a href="https://twitter.com/matrixdotorg/status/872861579141947392?ref_src=twsrc%5Etfw">June 8, 2017</a>
</blockquote>
<p>However, we then hit three fairly major obstacles:</p>
<ul>
<li><a href="https://matrix.org/blog/2017/07/07/a-call-to-arms-supporting-matrix">Matrix lost its funding</a></li>
<li>In the ensuing uncertainty, the two lead developers (Mjark &amp; Kegan) went to work elsewhere</li>
<li>Meanwhile, Matrix uptake was starting to explode and Synapse was failing to scale to handle the traffic on matrix.org (and elsewhere)</li>
</ul>
<p>At first, having formed what would become New Vector (now Element) to keep the rest of the core team hired, we pushed to see if we could get Dendrite finished fast enough to replace Synapse, with Erik &amp; richvdh jumping over from Synapse to pick up the remaining work.  However, it became clear that we urgently needed a quicker solution to address all the overloaded Synapses out there, and so they swung back to focus on improving Synapse (taking inspiration from some of the design of Dendrite - e.g. offloading endpoints onto worker processes connected via replication streams, and using <a href="https://opentracing.io/">OpenTracing</a> to debug traffic as it flows over the various services).</p>
<p>At this point, Dendrite maintenance was in effect valiantly taken over by the community, with Brendan and later Anoa keeping the ball going in 2017, joined by APWhitehat in GSoC 2018 and cnly in GSoC 2019.  The fact that Dendrite is now here today is thanks in no small part to their work to keep the project alive in its “wilderness years” between Sept 2017 and Dec 2019.</p>
<p>Meanwhile, it became clear that we were overdue getting Matrix itself out of beta - and the last thing we wanted to do was to split and dilute the implementation work of Matrix 1.0 over both Synapse and Dendrite - so we consciously made the decision to focus all our effort on Synapse for solving the remaining bugs and challenges.</p>
<p>Then, in July 2019, <a href="https://matrix.org/blog/2019/06/11/introducing-matrix-1-0-and-the-matrix-org-foundation">Matrix and Synapse exited beta</a>, and we finally started to see light at the end of the tunnel.  In October we started dusting off Dendrite again - looking to use it as a relatively simple and flexible codebase for <a href="https://youtu.be/eA0KnTt4O7E?t=1423">experimenting with Peer-to-Peer Matrix</a>, not least because being Go it can compile to WebAssembly and run clientside, and because even though Dendrite was originally built with massive deployments in mind, it turns out the elastic scaling means it can also scale down pretty small too—as a part of the <a href="http://testflight.apple.com/join/Tgh2MEk6">iOS P2P demo</a>, we’ve even ran full Dendrite homeservers on iPhones embedded into Element iOS! :)</p>
<p>In Dec 2019, we finally got to the point where Element could fund full-time dedicated development on Dendrite once again, with Neil Alexander joining the project and focusing fulltime on getting Dendrite out of alpha and getting it working for P2P and embedded usage (adding libp2p as a federation transport, and adding SQLite support) - and in Jan 2020 we got Dendrite <a href="https://archive.fosdem.org/2020/schedule/event/dip_p2p_matrix/">successfully running clientside in a WASM service worker</a> (just in time for FOSDEM!). Then, in Feb 2020, Kegan returned to the project to work fulltime on Dendrite - and the race began in earnest to get Dendrite ready for beta!</p>
<p>Here’s a pretty picture courtesy of GitHub to visualise the progress:</p>
<p><img src="/blog/img/2020-10-08-dendrite-contributors.png" alt="020-10-08-dendrite-contributors.png" /></p>
<p>Throughout 2020 there’s been a huge amount of stabilisation work and polish:</p>
<ul>
<li>Refactoring much of Dendrite’s foundation to make the codebase more maintainable</li>
<li>Created all-new user server, key server, signing key server microservices</li>
<li>Moving some work from existing microservices (ultimately superseding the former currentstateserver, publicroomsapi and typingserver microservices altogether)</li>
<li>Developing new testing infrastructure:
<ul>
<li><a href="https://github.com/matrix-org/complement">Complement</a> - our brand new Golang Matrix integration test harness</li>
<li><a href="https://github.com/matrix-org/dendrite/blob/master/are-we-synapse-yet.py">Are We Synapse Yet</a> - an aggregator which parses sytest/complement output to compare how close Dendrite is to passing</li>
</ul>
</li>
<li>All the Matrix 1.0 work - particularly state res v2 &amp; room version support</li>
<li>Making it work with more P2P transports for <a href="https://matrix.org/blog/2020/06/02/introducing-p-2-p-matrix/">all the exciting P2P experiments</a></li>
<li>Supporting backfill and fetching missing events</li>
<li>Fixing up SQLite support to make it work as a first class citizen (with shared storage code where we can!)</li>
<li>Supporting both sending and rejecting invites (even over federation)</li>
<li>E2E encryption support (one-time keys, device lists, send-to-device support)</li>
<li>Improved federation sender logic (resend retries, backoffs, blacklisting, metrics, resetting backoffs when receiving transactions)</li>
<li>Handling both inbound and outbound redactions</li>
<li>User interactive authentication (and implemented on various ‘sudo’ endpoints e.g. deleting devices and changing passwords)</li>
<li>Respecting server ACLs</li>
<li>Rejecting / soft-failing events properly</li>
<li>Support for database schema upgrades</li>
</ul>
<p>... which brings us at last to the present day (Oct 2020), as we declare Dendrite sufficiently stable that we consider it ready for beta testing!</p>
<p>In practice, this means **Dendrite is now ready for experimentation by adventurous Matrix sysadmins. It is <em>NOT</em> ready for production usage yet, but we need folks to test it and help us iron out the remaining bugs!  **Please do not trust it with sensitive data yet, and we don’t recommend trying to run it at scale yet as we haven’t done any serious optimisation work yet.</p>
<p>That said, we do provide the following guarantees:</p>
<ul>
<li>We’re providing versioned releases from here on in, beginning with <a href="https://github.com/matrix-org/dendrite/releases/tag/v0.1.0">0.1.0</a></li>
<li>We don’t expect any major breaking changes to the config or architecture before 1.0</li>
<li>Ready for early adopters to try running Dendrite without experiencing ~daily breaking churn</li>
<li>The database schema is now stable and will upgrade itself going forwards - your database should now be here to stay! (assuming we don’t hit any nasty data loss bugs during beta)</li>
</ul>
<p>In terms of comparison with Synapse, the main things you should get excited about are:</p>
<ul>
<li>Dendrite aims to provide an <strong>efficient</strong>, <strong>reliable</strong> and <strong>scalable</strong> alternative to Synapse:
<ul>
<li>Efficient: A small memory footprint with better baseline performance than an out-of-the-box Synapse</li>
<li>Reliable: Implements the Matrix specification as written, using the <a href="https://github.com/matrix-org/sytest">same test suite</a> as Synapse as well as a <a href="https://github.com/matrix-org/complement">brand new Go test suite</a></li>
<li>Scalable: can run on multiple machines and eventually scale to massive homeserver deployments</li>
</ul>
</li>
<li>This means significantly less memory usage than Synapse (depends on joined rooms, often between 50MB - 400MB resident memory) - although we haven’t tuned this at all yet!</li>
<li>All-new database model, where every microservice instance has its own database tables, letting them scale arbitrarily wide</li>
<li>The ability to efficiently use all your available CPU cores without needing to split into separate processes, thanks to Go and our extensive use of goroutines.  No more Python global interpreter lock! :)</li>
<li>Future experimental MSCs are likely to land in Dendrite before Synapse (e.g <a href="https://github.com/matrix-org/matrix-doc/blob/matthew/msc2753/proposals/2753-peeking-via-sync-v2.md">MSC2753 Peeking via /sync</a> and <a href="https://github.com/matrix-org/matrix-doc/blob/matthew/msc2444/proposals/2444-peeking-over-federation-peek-api.md">MSC2444 Peeking over Federation</a> are already being prototyped (<a href="https://github.com/matrix-org/dendrite/pull/1370">#1370</a> and <a href="https://github.com/matrix-org/dendrite/pull/1391">#1391</a>) in Dendrite rather than Synapse!)</li>
</ul>
<p>The provisos you should know about however are:</p>
<ul>
<li>We’re not feature complete yet: sytest reports 56% CS API coverage and 77% Federation coverage. <strong>NB: these are always going to be underestimates of how much Dendrite actually performs due to how the tests are spread out, in actuality it’s likely more 70% CS, 95% Fed.</strong></li>
<li>No read receipts, membership lazy-loading, presence, push notifications, search, event context, key backups, cross-signing. See changelog for full limitations.</li>
<li>Not battle-tested in the wild by many people (there are probably only ~10 dendrites on the open network today!) - so there’s likely to be a broad spectrum of bugs at first.</li>
<li>Clients that require more exotic features, like lazy loading, may not behave properly yet</li>
<li>Please <strong>use Postgres rather than SQLite wherever possible</strong>—it’s faster and has fewer issues regarding concurrency (some requests on SQLite Dendrites may 500 with ‘database is locked’ - though we’ve worked hard to eliminate most of these)</li>
<li>Dendrite can run in either “monolith” or “polylith” mode. In monolith, all the microservices are linked into a single binary - and <strong>we recommend running in this configuration wherever possible</strong> for now. Monolith mode is <em>extremely</em> capable as it is and has fewer moving parts for things to go wrong and will be the right choice for the majority of beta deployments!</li>
<li>Whilst Dendrite is nearly 100% federation compatible, there may still be situations where it will split-brain and disagree with the current room state that Synapse has calculated. We expect these issues to resolve as we get more user feedback.</li>
</ul>
<p>Architecture-wise, this is what Dendrite looks like under the hood today:</p>
<p><img src="/blog/img/2020-10-08-dendrite-arch.svg" alt="2020-10-08-dendrite-arch.svg" /></p>
<p>To get up and running, please install Go and head on over to the Get Started guide at <a href="https://github.com/matrix-org/dendrite#get-started">https://github.com/matrix-org/dendrite#get-started</a> to join the fun :)</p>
<p>In terms of where we’re going next:</p>
<ul>
<li>Read receipts. It’s a major missing feature and impacts UX significantly.</li>
<li>100% Federation coverage (according to sytest). It’s crucial that Dendrite instances play nicely with other servers. This will be the best metric we have for asserting that we are just as capable as Synapse at the fed level.</li>
<li>Optimisation—<strong>Dendrite has not been optimised yet for speed or resource utilisation!</strong>
<ul>
<li>We plan to add benchmarks which will stress test different microservices in the presence of many different scaling factors (number of users, number of rooms, size of room, number of devices per user, number of sync requests, etc). This will hopefully allow us to identify early on bottlenecks and slow algorithms</li>
<li>Good old fashioned pprof with known slow scenarios to see what’s consuming CPU/memory and fixing issues ad-hoc (which we’ve already done a bit of pre-beta). This may involve adding additional in-memory caches, with a healthy respect for the complexities it may introduce (which Synapse has been bitten by)</li>
</ul>
</li>
<li>We plan to add first class feature flag support for experimental MSCs—experimentation is one thing which makes Dendrite notably different from Synapse, and supporting it more thoroughly going forwards will be important. This may mean adding additional hooks; potentially a dedicated microservice to cleanly separate experiments, we don’t know yet</li>
<li>P2P work will continue with vigour now we have a working, featureful, and relatively stable HS to embed and play with</li>
</ul>
<p>Longer term, it’s pretty hard to say right now when we expect to exit beta (it took Synapse 5 years to exit beta, after all ;) - but obviously we’ll need Dendrite to have parity with Synapse and have no known serious bugs.</p>
<p>Finally: you’re probably wondering what this means for Synapse.  Synapse is here to stay - with tens of thousands of deployments around the world serving tens of millions of users.  The majority of the core team is still focused on improving and optimising Synapse, and we’ll be keeping improving it for the foreseeable.</p>
<p>However, we’ll certainly be experimenting with new stuff on Dendrite first - whether that’s P2P, portable accounts, new-style communities, peeking etc.  We expect Synapse to be the stable long-term-supported solution, while Dendrite (particularly while in beta) will be the more unstable and experimental platform. In the longer term we’ll provide ways of migrating from Synapse to Dendrite however (probably via portable accounts), and perhaps in future new deployments may choose to use Dendrite - a bit like you might choose to use nginx rather than Apache for a new web server these days. But this will be a long transition—meanwhile we expect to see more and more next-generation homeservers like <a href="http://conduit.rs/">Conduit</a>, <a href="https://gitlab.com/mascarene/mascarene">Mascarene</a> or <a href="https://github.com/matrix-construct/construct">Construct</a> coming of age too.</p>
<p>So, there you have it. If you’re an intrepid sysadmin please spin up a Dendrite and start filing bugs! :)</p>
<p>— Matthew, Neil Alexander, Kegan and the whole Matrix team.</p>
<p>Here’s the official changelog:</p>
<h3 id="client-server-api-features">Client-Server API Features</h3>
<h4 id="account-registration-and-management">Account registration and management</h4>
<ul>
<li>Registration: By password only.</li>
<li>Login: By password only. No fallback.</li>
<li>Logout: Yes.</li>
<li>Change password: Yes.</li>
<li>Link email/msisdn to account: No.</li>
<li>Deactivate account: Yes.</li>
<li>Check if username is available: Yes.</li>
<li>Account data: Yes.</li>
<li>OpenID: No.</li>
</ul>
<h4 id="rooms">Rooms</h4>
<ul>
<li>Room creation: Yes, including presets.</li>
<li>Joining rooms: Yes, including by alias or <code>?server_name=</code>.</li>
<li>Event sending: Yes, including transaction IDs.</li>
<li>Aliases: Yes.</li>
<li>Published room directory: Yes.</li>
<li>Kicking users: Yes.</li>
<li>Banning users: Yes.</li>
<li>Inviting users: Yes, but not third-party invites.</li>
<li>Forgetting rooms: No.</li>
<li>Room versions: All (v1 - v6)</li>
<li>Tagging: Yes.</li>
</ul>
<h4 id="user-management">User management</h4>
<ul>
<li>User directory: Basic support.</li>
<li>Ignoring users: No.</li>
<li>Groups/Communities: No.</li>
</ul>
<h4 id="device-management">Device management</h4>
<ul>
<li>Creating devices: Yes.</li>
<li>Deleting devices: Yes.</li>
<li>Send-to-device messaging: Yes.</li>
</ul>
<h4 id="sync">Sync</h4>
<ul>
<li>Filters: Timeline limit only. Rest unimplemented.</li>
<li>Deprecated <code>/events</code> and <code>/initialSync</code>: No.</li>
</ul>
<h4 id="room-events">Room events</h4>
<ul>
<li>Typing: Yes.</li>
<li>Receipts: No.</li>
<li>Read Markers: No.</li>
<li>Presence: No.</li>
<li>Content repository (attachments): Yes.</li>
<li>History visibility: No, defaults to <code>joined</code>.</li>
<li>Push notifications: No.</li>
<li>Event context: No.</li>
<li>Reporting content: No.</li>
</ul>
<h4 id="end-to-end-encryption">End-to-End Encryption</h4>
<ul>
<li>Uploading device keys: Yes.</li>
<li>Downloading device keys: Yes.</li>
<li>Claiming one-time keys: Yes.</li>
<li>Querying key changes: Yes.</li>
<li>Cross-Signing: No.</li>
</ul>
<h4 id="misc">Misc</h4>
<ul>
<li>Server-side search: No.</li>
<li>Guest access: Partial.</li>
<li>Room previews: No, partial support for Peeking via MSC2753.</li>
<li>Third-Party networks: No.</li>
<li>Server notices: No.</li>
<li>Policy lists: No.</li>
</ul>
<h3 id="federation-features">Federation Features</h3>
<ul>
<li>Querying keys (incl. notary): Yes.</li>
<li>Server ACLs: Yes.</li>
<li>Sending transactions: Yes.</li>
<li>Joining rooms: Yes.</li>
<li>Inviting to rooms: Yes, but not third-party invites.</li>
<li>Leaving rooms: Yes.</li>
<li>Content repository: Yes.</li>
<li>Backfilling / get_missing_events: Yes.</li>
<li>Retrieving state of the room (<code>/state</code> and <code>/state_ids</code>): Yes.</li>
<li>Public rooms: Yes.</li>
<li>Querying profile data: Yes.</li>
<li>Device management: Yes.</li>
<li>Send-to-Device messaging: Yes.</li>
<li>Querying/Claiming E2E Keys: Yes.</li>
<li>Typing: Yes.</li>
<li>Presence: No.</li>
<li>Receipts: No.</li>
<li>OpenID: No.</li>
</ul>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="&#x2F;blog&#x2F;2020&#x2F;10&#x2F;02&#x2F;this-week-in-matrix-2020-10-02&#x2F;" title="This Week in Matrix 2020-10-02">This Week in Matrix 2020-10-02</a></h1>
            <span>
                02.10.2020 00:00
                —
                <a href="/category/this-week-in-matrix">
                    This Week in Matrix
                </a>
                —
                <a href="/author/andrew-morgan">
                    Andrew Morgan
                </a>
            </span>
            
        </header>
        <div>
            <h2 id="matrix-live">Matrix Live 🎙</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/J7aNMUg3pvA" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Don't forget that Matrix Live is also available in podcast form. Search for &quot;Matrix Live&quot; wherever you get your podcasts.</p>
<h2 id="dept-of-status-of-matrix-face-with-th">Dept of <em>Status of Matrix</em> 🌡️</h2>
<h3 id="gitter-enters-the-matrix">Gitter Enters the Matrix</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> reported:</p>
<blockquote>
<p>Gitter is joining the Matrix ecosystem!</p>
</blockquote>
<p>It's true! Element has acquired Gitter from GitLab and will be implementing
Gitter's current chat features in Matrix, before rebuilding Gitter as a Matrix
client! Before all that however, the first step is to build a proper, modern
bridge between the two networks, replacing the old one that's been around for
years.</p>
<p>The full spectrum of news is:</p>
<ul>
<li><a href="https://matrix.org/blog/2020/09/30/welcoming-gitter-to-matrix">The Matrix.org blog post</a></li>
<li><a href="https://element.io/blog/gitter-is-joining-element/">The Element blog post</a></li>
<li><a href="https://about.gitlab.com/blog/2020/09/30/gitter-moves-to-element">The Gitter blog post</a></li>
<li><a href="https://techcrunch.com/2020/09/30/element-acquires-gitter-to-get-more-developers-on-board-with-the-open-matrix-messaging-protocol/">Techcrunch article</a></li>
<li><a href="https://changelog.com/podcast/414">ChangeLog Podcast episode w/ Matthew Hodgson from Matrix and Sytse &quot;Sid&quot; Sijbrandij from GitLab</a></li>
</ul>
<p>And if you'd like to chat with your fellow Matrix and Gitter users, there's a
bridged room already set up at
<a href="https://matrix.to/#/#gitter:matrix.org">#gitter:matrix.org</a>!</p>
<p>Welcome to the community, Gitter! 🎉</p>
<h2 id="dept-of-spec-scroll">Dept of Spec 📜</h2>
<p><a href="https://matrix.to/#/@andrewm:amorgan.xyz">anoa</a> reported:</p>
<blockquote>
<h3 id="spec">Spec</h3>
</blockquote>
<blockquote>
<p>Here's your weekly spec update! The heart of Matrix is the specification - and this is modified by Matrix Spec Change (MSC) proposals. Learn more about how the process works at <a href="https://matrix.org/docs/spec/proposals.">https://matrix.org/docs/spec/proposals.</a></p>
<h2 id="msc-status">MSC Status</h2>
<p><strong>Merged MSCs:</strong></p>
<ul>
<li><em>No MSCs were merged this week.</em></li>
</ul>
<p><strong>MSCs in Final Comment Period:</strong></p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2788">MSC2788: Room version 6 as the default room version</a> (merge)</li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2414">MSC2414: Make reason and score parameters optional for reporting content</a> (merge)</li>
</ul>
<p><strong>New MSCs:</strong></p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2801">MSC2801: Make it explicit that event bodies are untrusted data</a></li>
</ul>
<h2 id="spec-core-team">Spec Core Team</h2>
<p>In terms of Spec Core Team MSC focus for this week, after dropping off <a href="https://github.com/matrix-org/matrix-doc/pull/2414">MSC2414</a> in the FCP bucket, we're heading back for another big swing at widgets. <a href="https://github.com/matrix-org/matrix-doc/pull/2774">MSC2774</a> (widget ID URL parameter), <a href="https://github.com/matrix-org/matrix-doc/pull/2765">MSC2765</a> (widget avatars) and <a href="https://github.com/matrix-org/matrix-doc/pull/2790">MSC2790</a> (modal widgets) are the focus for this week 🙂</p>
<p><img src="/blog/img/2020-10-02-BQKH9-stacked_area_chart.png" alt="2020-10-02-BQKH9-stacked_area_chart.png" /></p>
</blockquote>
<h3 id="matrix-uris">Matrix URIs</h3>
<p><a href="https://matrix.to/#/@kitsune:matrix.org">kitsune</a> told us:</p>
<blockquote>
<p>being totally shook up about the Gitter announcement for a good part of the week, I completed the work on <a href="https://github.com/matrix-org/matrix-doc/issues/2312">MSC2312</a> (it's about Matrix URIs, ICYMI) and it hopefully won't be long before it becomes the actual standard to share Matrix coordinates in popular web browsers. Ok, who am I kidding - before Matrix clients get on with adoption.</p>
</blockquote>
<p>This will allow people to post links to Matrix rooms/messages/users and when clicked will open right in your favourite Matrix client. Super convenient and great for adoption!</p>
<h2 id="dept-of-p2p-busts-in-silhouette">Dept of P2P 👥</h2>
<h3 id="ios-p2p-demo">iOS P2P Demo</h3>
<p>Dendrite is a next-generation homeserver written in Go. It is currently serving as the basis for peer-to-peer Matrix experiments</p>
<p><a href="https://matrix.to/#/@neilalexander:matrix.org">Neil Alexander</a> announced:</p>
<blockquote>
<p>Build 38 of the iOS P2P Demo, as built using Element iOS and Dendrite, has been submitted to TestFlight and will hopefully be available for testers shortly (pending Apple approval)! It features lots of updates in the Dendrite backend which should hopefully make it more reliable.</p>
<p>If you have an iPhone or iPad and enjoy things that sometimes work, <a href="https://testflight.apple.com/join/Tgh2MEk6">join the TestFlight here</a>!</p>
</blockquote>
<h2 id="dept-of-servers-europea">Dept of Servers 🏢</h2>
<h3 id="synapse">Synapse</h3>
<p><a href="https://matrix.to/#/@neilj:matrix.org">Neil</a> reported:</p>
<blockquote>
<p>This week we put out a new release candidate -<a href="https://github.com/matrix-org/synapse/releases/tag/v1.21.0rc2">1.21.0rc2</a></p>
<p>Highlights include </p>
<ul>
<li>
<p>Add experimental support for sharding event persister. (<a href="https://github.com/matrix-org/synapse/issues/8294">#8294</a>, <a href="https://github.com/matrix-org/synapse/issues/8387">#8387</a>, <a href="https://github.com/matrix-org/synapse/issues/8396">#8396</a>, <a href="https://github.com/matrix-org/synapse/issues/8419">#8419</a>)</p>
</li>
<li>
<p>Add experimental prometheus metric to track numbers of &quot;large&quot; rooms for state resolutiom. (<a href="https://github.com/matrix-org/synapse/issues/8425">#8425</a>)</p>
</li>
<li>
<p>Add prometheus metrics to track federation delays. (<a href="https://github.com/matrix-org/synapse/issues/8430">#8430</a>)</p>
</li>
<li>
<p>Fix messages not being sent over federation until an event is sent into the same room. (<a href="https://github.com/matrix-org/synapse/issues/8230">#8230</a>, <a href="https://github.com/matrix-org/synapse/issues/8247">#8247</a>, <a href="https://github.com/matrix-org/synapse/issues/8258">#8258</a>, <a href="https://github.com/matrix-org/synapse/issues/8272">#8272</a>, <a href="https://github.com/matrix-org/synapse/issues/8322">#8322</a>)</p>
</li>
<li>
<p>Fix a regression in v1.21.0rc1 which broke thumbnails of remote media. <a href="https://github.com/matrix-org/synapse/pull/8438">#8438</a></p>
</li>
</ul>
<p>Aside from that we are working on moving background processes away from the main process, actually getting the event persister sharding onto matrix.org and trying to improve Synapse stability generally.</p>
</blockquote>
<h3 id="dendrite-gomatrixserverlib">Dendrite / gomatrixserverlib</h3>
<p>Dendrite is a next-generation homeserver written in Go</p>
<p><a href="https://matrix.to/#/@neilalexander:matrix.org">Neil Alexander</a> said:</p>
<blockquote>
<p>Dendrite is nearing beta! Today we will be cutting a candidate 0.1.0rc1 version after a week of hunting and fixing bugs. We are on track to release version 0.1.0 next week, at which point we will be inviting people to try installing and using Dendrite!</p>
<p>Changes this week include:</p>
<ul>
<li>
<p>Initial sync is fixed after a bug caused us to fall back on incremental sync</p>
</li>
<li>
<p>The <code>Content-Type</code> HTTP header is now handled properly when MIME-formatted</p>
</li>
<li>
<p>Internal API calls over HTTP in polylith mode now use their own HTTP client with higher timeouts</p>
</li>
<li>
<p>Dendrite now tries harder to find missing auth events, using fetcher workers</p>
</li>
<li>
<p>Dendrite no longer falls back on <code>/state</code> unnecessarily, which was the cause of a major memory leak and high CPU usage</p>
</li>
<li>
<p>Federation HTTP calls now include the <code>User-Agent</code> header</p>
</li>
<li>
<p>The event <code>depth</code> field is now ignored in the federation API</p>
</li>
<li>
<p>We now report the password change capability properly (thanks <a href="https://github.com/bn4t">bn4t</a>!)</p>
</li>
<li>
<p>Registration flows now include the <code>completed</code> field after a failure (thanks <a href="https://github.com/Lesterpig">Lesterpig</a>!)</p>
</li>
<li>
<p>A bug in the previous event updater in the roomserver has been fixed</p>
</li>
<li>
<p>A bug where we didn't check our own old verify keys when verifying event signatures is fixed</p>
</li>
<li>
<p>A bug where we didn't handle event ID domains being different to the event origin in earlier room versions has been fixed</p>
</li>
<li>
<p>TLS fingerprints have been removed</p>
</li>
</ul>
<p>Spec compliance is unchanged:</p>
<ul>
<li>
<p>Client-Server APIs: 56%, same as last week</p>
</li>
<li>
<p>Server-Server APIs: 77%, same as last week</p>
</li>
</ul>
<p>Recently, we updated some of our documentation and created a whole new set of <a href="https://github.com/matrix-org/dendrite/issues?q=is%3Aissue+is%3Aopen+label%3A%22good+first+issue%22">easy first issues</a> and <a href="https://github.com/matrix-org/dendrite/issues?q=is%3Aissue+is%3Aopen+label%3Ahelp-wanted">medium to hard issues</a> for contributors.</p>
<p>If contributing to Dendrite sounds like something you would be interested in, please take a look at these issues and join us in <a href="https://matrix.to/#/#dendrite-dev:matrix.org">#dendrite-dev:matrix.org</a>! There's also <a href="https://matrix.to/#/#dendrite:matrix.org">#dendrite:matrix.org</a> for general Dendrite chat and updates and <a href="https://matrix.to/#/#dendrite-alerts:matrix.org">#dendrite-alerts:matrix.org</a> for release notifications and important alerts.</p>
</blockquote>
<h3 id="conduit">Conduit</h3>
<p>Conduit is a Matrix homeserver written in Rust <a href="https://conduit.rs">https://conduit.rs</a></p>
<p><a href="https://matrix.to/#/@timo:koesters.xyz">timo</a> reported:</p>
<blockquote>
<ul>
<li>
<p>Fix bug leading to many requests at the same time due to error in waiting code</p>
</li>
<li>
<p>Implement /query/profile over federation</p>
</li>
<li>
<p>Start work on /invite over federation</p>
</li>
</ul>
<p>Thanks to everyone who supports me on <a href="https://liberapay.com/timokoesters">Liberapay</a> or Bitcoin!</p>
</blockquote>
<h3 id="the-construct">The Construct</h3>
<p><a href="https://matrix.to/#/@jason:zemos.net">Jason</a> reported:</p>
<blockquote>
<p>This week in Matrix Construct supports aarch64 (ARMv8) architectures. The experience has been phenomenal, with performance exceeding all expectations. Last week I wrote about all new vector code inside Construct using SSE through AVX-512 hardware acceleration in servers; that same code is now accelerated by SVE (Scalable Vector Extensions) on ARM architectures when you compile with clang.</p>
<p>This result is important: ARM virtual machines are offered at a significantly lower price compared to x86 from the same vendor. The systems are cheaper, require less power, but generally perform worse. The trick is to optimize the software for the weaker hardware. The benefit allows, for example, Matrix server hosts running Construct to make th eir profit margin from the lower TCO, getting more out of every computing cycle.</p>
<p>Construct is available at <a href="https://github.com/matrix-construct/construct">https://github.com/matrix-construct/construct</a> and don't forget to idle and idle <a href="https://matrix.to/#/#construct:zemos.net">#construct:zemos.net</a>.</p>
</blockquote>
<h2 id="synapse-deployment-inbox-tray">Synapse Deployment 📥️</h2>
<h3 id="yunohost">YunoHost</h3>
<p><a href="https://matrix.to/#/@pierre:mamieserv.fr">Pierre</a> announced:</p>
<blockquote>
<p><a href="https://yunohost.org">YunoHost</a> is an operating system aiming for the simplest administration of a server, and therefore democratize self-hosting.</p>
<p><a href="https://github.com/YunoHost-Apps/synapse_ynh/tree/master">Synapse</a> integration had been updated to 1.19.3 (1.20.1 available in branch <code>testing</code>)</p>
<p><a href="https://github.com/YunoHost-Apps/element_ynh/tree/master">Element Web</a> integration had been updated to 1.7.7 (1.7.8 available in branch <code>testing</code>)</p>
</blockquote>
<h2 id="dept-of-bridges-bridge-at-night">Dept of Bridges 🌉</h2>
<h3 id="mautrix-signal">mautrix-signal</h3>
<p><a href="https://matrix.to/#/@tulir:maunium.net">Tulir</a> said:</p>
<blockquote>
<p>I made a Signal bridge using <a href="https://gitlab.com/thefinn93/signald">signald</a>.</p>
<p>Currently it supports bridging messages, reactions and signal read receipts. End-to-bridge encryption also exists (mautrix-python does all the work there). The bridge can be linked as a secondary device and possibly even registered as the main device, but I didn't actually test registering yet. Setup instructions are currently somewhat non-existent, but it's mostly the same as my other bridges plus signald as a separate daemon.</p>
<p>The repo is <a href="https://github.com/tulir/mautrix-signal">https://github.com/tulir/mautrix-signal</a> and the room is <a href="https://matrix.to/#/#signal:maunium.net">#signal:maunium.net</a></p>
</blockquote>
<p>He then popped up again a few days later to say:</p>
<blockquote>
<p>After the initial announcement earlier this week, I implemented a few of the missing features like media bridging, and even added setup instructions.</p>
</blockquote>
<p>The speed at which Tulir writes bridges scares me sometimes.</p>
<h3 id="mx-puppet-discord">mx-puppet-discord</h3>
<p><a href="https://github.com/matrix-discord/mx-puppet-discord">mx-puppet-discord</a> is a (double)puppeting and relay bridge for discord, based on mx-puppet-bridge</p>
<p><a href="https://matrix.to/#/@sorunome:sorunome.de">sorunome</a> said:</p>
<blockquote>
<p>mx-puppet-discord got updated to the newest discord.js version, meaning you have to update if you want to continue to operate it, due to discord having changed their gateway url!</p>
</blockquote>
<blockquote>
<p>mx-puppet-discord now also supports the intent stuff, so be sure to update by 7th oct</p>
</blockquote>
<p><strong>If you run mx-puppet-discord (like I do), make sure to update by October 7th or it will stop working!</strong></p>
<h3 id="bridges-do-hackertoberfest">Bridges do Hackertoberfest</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> reported:</p>
<blockquote>
<p>Hey folks, I wanted to give another shoutout to say that we are still accepting PRs as part of <a href="https://hacktoberfest.digitalocean.com/">hacktoberfest</a>. Contributing 4 PRs will get you a T-Shirt (sadly not a Matrix one). Obviously, please ensure your PRs are meaningful (no copyright adjustments, typo fixes).</p>
<p>You can work on any issue, but we've highlighted some issues that would be perfect for newcomers over at <a href="https://github.com/matrix-org/matrix-appservice-bridge/issues?q=is%3Aopen+is%3Aissue+label%3Ahacktoberfest">https://github.com/matrix-org/matrix-appservice-bridge/issues?q=is%3Aopen+is%3Aissue+label%3Ahacktoberfest</a> and <a href="https://github.com/matrix-org/matrix-appservice-slack/issues?q=is%3Aopen+is%3Aissue+label%3Ahacktoberfest">https://github.com/matrix-org/matrix-appservice-slack/issues?q=is%3Aopen+is%3Aissue+label%3Ahacktoberfest</a></p>
</blockquote>
<p><a href="https://matrix.to/#/@cadair:cadair.com">Cadair</a> reported:</p>
<blockquote>
<p>In the hope of expanding the number of people contributing to the matrix-appservice-slack repo I have spent a chunk of my morning improving the issue descriptions and labelling up issues. If you are interested in fixing a little annoyance with the slack bridge or just fancy writing some typescript see the <a href="https://github.com/matrix-org/matrix-appservice-slack/issues?q=is%3Aissue+is%3Aopen+label%3A%22good+first+issue%22">good first issue</a> label on the repo.</p>
</blockquote>
<h3 id="matrix-appservice-slack-1-6-0-rocks-the-block">matrix-appservice-slack 1.6.0 rocks the block</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> reported:</p>
<blockquote>
<p>The matrix.org team are delighted to bring you the latest in Slack bridging technology. Do not let the</p>
<p>minor version bump fool you, this release is packed with the good stuff. The headline feature is that
our phase 1 encryption feature has landed and is free for users to experiment with. Head over to the</p>
<p><a href="https://matrix-appservice-slack.readthedocs.io/en/stable/bridge-encryption/">docs</a> to see how to
set this up.</p>
<p>There have been other notable changes, such as:</p>
<ul>
<li>
<p>New configuration options to allow or deny some channels from being bridged.</p>
</li>
<li>
<p>Support removing <em>reactions</em> from Slack and Matrix messages.</p>
</li>
<li>
<p>Add onboarding message for new users when puppeting is enabled, to encourage them to puppet.</p>
</li>
<li>
<p>Improved feature documentation</p>
</li>
</ul>
<p>(and many many bugfixes)</p>
<p>You can read the release information over at <a href="https://github.com/matrix-org/matrix-appservice-slack/releases">https://github.com/matrix-org/matrix-appservice-slack/releases</a></p>
</blockquote>
<p>Looking forward to seeing all the new Hacktoberfest contributors! 🎃</p>
<h2 id="dept-of-clients-iphone">Dept of Clients 📱</h2>
<h3 id="fluffychat">fluffychat</h3>
<p><a href="https://matrix.to/#/@sorunome:sorunome.de">sorunome</a> offered:</p>
<blockquote>
<p>Fluffychat 0.19.1 has been released!</p>
<h4 id="features">Features</h4>
<ul>
<li>
<p>Implemented ignore list</p>
</li>
<li>
<p>Jump to events in timeline: When tapping on a reply and when tapping a matrix.to link</p>
</li>
<li>
<p>Display messages with up to 10 emotes or emoji bigger</p>
</li>
<li>
<p>New design for the chat list and message bubbles</p>
</li>
<li>
<p>Implement reactions</p>
</li>
<li>
<p>Implement password change</p>
</li>
<li>
<p>Implement deactivate user account</p>
</li>
</ul>
<h4 id="fixes">Fixes</h4>
<ul>
<li>
<p>Timeline randomly resorting while more history is being fetched</p>
</li>
<li>
<p>Automatically request history if the &quot;load more&quot; button is on the screen</p>
</li>
</ul>
</blockquote>
<h3 id="hydrogen">Hydrogen</h3>
<p><a href="https://matrix.to/#/@bwindels:matrix.org">Bruno</a> said:</p>
<blockquote>
<p>More browser compatibility work this week, making Hydrogen run IE11 on Windows 7, and on Safari on macOS and iOS (still with some caveats). Also fixed several bugs:</p>
<ul>
<li>
<p>fix for unable to open session after a synapse bug manifested itself</p>
</li>
<li>
<p>prevent the app locking up when you start the app with previously unsent messages</p>
</li>
<li>
<p>fix sync errors being reported as &quot;null&quot; in the banner</p>
</li>
<li>
<p>handle timeout during initial sync (important for large accounts) (although I have seen 1 report that this still isn't fixed, please report if you can't login with a large account)</p>
</li>
</ul>
</blockquote>
<h3 id="schildichat-for-android">SchildiChat for Android</h3>
<p><a href="https://matrix.to/#/@spiritcroc:matrix.org">SpiritCroc</a> said:</p>
<blockquote>
<p>SchildiChat's codebase has been updated to Element 1.0.8!</p>
<p>Furthermore, there have been a few design updates:</p>
<ul>
<li>
<p>Media items (pictures, videos, stickers) are no longer displayed in message bubbles</p>
</li>
<li>
<p>Bigger stickers</p>
</li>
<li>
<p>Avatars are now hidden in direct chats (when using dual-side message bubbles)</p>
</li>
</ul>
<p>Finally, Schildi doesn't crash anymore if somebody sends an empty message.</p>
</blockquote>
<p>SpiritCroc also mentioned some relevant links!</p>
<blockquote>
<ul>
<li>
<p>website: <a href="https://spiritcroc.de/schildichat-android">https://spiritcroc.de/schildichat-android</a></p>
</li>
<li>
<p>repo: <a href="https://github.com/SpiritCroc/SchildiChat-android">https://github.com/SpiritCroc/SchildiChat-android</a></p>
</li>
<li>
<p>room: <a href="https://matrix.to/#/#schildichat-android:matrix.org">#schildichat-android:matrix.org</a></p>
</li>
</ul>
</blockquote>
<h3 id="element-ios">Element-iOS</h3>
<p><a href="https://matrix.to/#/@Manu:matrix.org">Manu</a> announced:</p>
<blockquote>
<p>1.0.14 is in on the release path. It has:</p>
<ul>
<li>
<p>Room: Differentiate wordings for DMs</p>
</li>
<li>
<p>Room: New room details screen</p>
</li>
<li>
<p>Add Estonian support</p>
</li>
<li>
<p>Polishment in several areas and many bug fixes</p>
</li>
</ul>
<p>Full changelog:</p>
<p><a href="https://github.com/vector-im/element-ios/releases/tag/v1.0.14">https://github.com/vector-im/element-ios/releases/tag/v1.0.14</a>
<a href="https://github.com/vector-im/element-ios/releases/tag/v1.0.13">https://github.com/vector-im/element-ios/releases/tag/v1.0.13</a></p>
</blockquote>
<h3 id="element-web">Element Web</h3>
<p><a href="https://matrix.to/#/@neilj:matrix.org">Neil</a> announced:</p>
<blockquote>
<p>This week released <a href="https://github.com/vector-im/element-web/releases/tag/v1.7.8">v1.7.8</a></p>
<p>Highlights include</p>
<ul>
<li>
<p>Secure Backup has been moved out of the registration flow to a toast when you first encounter an E2EE room, which simplifies the new user experience</p>
</li>
<li>
<p>Added options to hide various UI features when hosting a custom Element</p>
</li>
</ul>
<p>Aside from that we continue to improve on widget support for resizable widgets, modal widgets and generally making widgets better.</p>
<p>We are also continuing to work on instrumenting the app, improving mobile support for matrix.to and making jitsi calling more reliable.</p>
</blockquote>
<h3 id="element-android">Element Android</h3>
<p><a href="https://matrix.to/#/@benoit.marty:matrix.org">benoit</a> told us:</p>
<blockquote>
<p>Element Android: Version 1.0.8 is now available on the stores, it fixes issues with verification and PIN code among other issues (see <a href="https://github.com/vector-im/element-android/releases/tag/v1.0.8">https://github.com/vector-im/element-android/releases/tag/v1.0.8</a> for more details). Now we are working on improving performance when sending messages to rooms, and also improving global UX, especially of the home (rooms list). Search messages (in clear rooms for the moment) is coming soon, and it will be also possible to filter the room members list.</p>
<p>We will also spend some time on the new Android SDK, https://github.com/matrix-org/matrix-android-sdk2, which is for the moment a quick extract of what we have in Element Android. We have to take care of it as a real product now: document it properly, set up CI, export Javadoc, develop a sample app, etc.</p>
</blockquote>
<h3 id="element-for-nextcloud">Element for Nextcloud</h3>
<p><a href="https://matrix.to/#/@gary:garykim.dev">Gary Kim</a> reported:</p>
<blockquote>
<p><a href="https://github.com/gary-kim/riotchat">Element for Nextcloud</a> v0.6.11 has been released this week. The new version comes with various bug fixes, dependency upgrades, and an upgrade to Element Web v1.7.8. The version is also compatible with Nextcloud 20 which is being released soon.</p>
</blockquote>
<h2 id="dept-of-sdks-and-frameworks">Dept of SDKs and Frameworks 🧰</h2>
<h3 id="ruma">Ruma</h3>
<p><a href="https://matrix.to/#/@iinuwa:matrix.org">iinuwa</a> told us:</p>
<blockquote>
<p>Over the past couple of weeks, we've received PRs for all of the remaining federation endpoints, and all but one have already been merged!</p>
<p>Now that the end is in sight, we're turning our focus elsewhere. We're working on cleaning up and fixing a few bugs in our event signing code and soon will create tracking issues for filling out the Identity Service API.</p>
</blockquote>
<h2 id="dept-of-services-rocket">Dept of Services 🚀</h2>
<h3 id="t2bot-io">t2bot.io</h3>
<p><a href="https://github.com/turt2live">TravisR</a> reported:</p>
<blockquote>
<p>t2bot.io has crossed 1M monthly active users</p>
<p>All of these users are Telegram/Discord users that have been brought into Matrix over the last 30 days. This doesn't appear to be a temporary spike either: over the last 8 weeks t2bot.io has been hovering at 900-950 thousand monthly active users, up from 600-700 thousand. Record-setting traffic levels have also been achieved, with matrix.org being able to keep up for the first time in a long while.</p>
<p>Overall it's a good sign to see so many communities making the jump to Matrix and sticking around ❤️</p>
</blockquote>
<p><img src="/blog/img/2020-10-02-uDiMG-image.png" alt="2020-10-02-uDiMG-image.png" /></p>
<h2 id="dept-of-bots-robot-face">Dept of Bots 🤖</h2>
<h3 id="zabbix-matrix">zabbix-matrix</h3>
<p><a href="https://matrix.to/#/@progserega:rsprim.ru">progserega</a> told us:</p>
<blockquote>
<p>I added zabbix-bot to my zabbix-matrix repo, which can get information about current problems from zabbix-server and send it to matrix user. <a href="https://github.com/progserega/matrix_zabbix">https://github.com/progserega/matrix_zabbix</a></p>
<p>In our company we use it for get current situation and <a href="https://github.com/progserega/im_sender_service">https://github.com/progserega/im_sender_service</a> for sending events from zabbix.</p>
</blockquote>
<p>I've found that having your systems reporting in a room while you chat around
it can be really productive. Props to supporting yet another monitoring platform!</p>
<h2 id="dept-of-interesting-projects">Dept of Interesting Projects 🛰️</h2>
<h3 id="jitsi-e2ee-calls-using-olm">Jitsi E2EE Calls using Olm</h3>
<p>While 1-1 calls benefit from end-to-end encryption due to WebRTC, Jitsi group calls have always only benefitted from transport encryption.</p>
<p>A while ago <a href="https://jitsi.org/blog/e2ee/">Jitsi announced</a> that they were adding E2EE to Jitsi. But did you know that it's using Matrix's Olm encryption under the hood? It's currently available as an experimental feature on <a href="https://meet.jit.si">https://meet.jit.si</a>!</p>
<h2 id="dept-of-ping-table-tennis-paddle-and-ball">Dept of Ping 🏓</h2>
<p>Here we reveal, rank, and applaud the homeservers with the lowest ping, as measured by <a href="https://github.com/maubot/echo">pingbot</a>, a <a href="https://github.com/maubot/maubot">maubot</a> that you can host on your own server. Join <a href="https://matrix.to/#/#ping:maunium.net">#ping:maunium.net</a> to experience the fun live, and to find out how to add YOUR server to the game.</p>
<table><thead><tr><th style="text-align: center">Rank</th><th style="text-align: center">Hostname</th><th style="text-align: center">Median MS</th></tr></thead><tbody>
<tr><td style="text-align: center">1</td><td style="text-align: center">fairydust.space</td><td style="text-align: center">368</td></tr>
<tr><td style="text-align: center">2</td><td style="text-align: center">blob.cat</td><td style="text-align: center">543</td></tr>
<tr><td style="text-align: center">3</td><td style="text-align: center">nuclearlimes.co.uk</td><td style="text-align: center">580</td></tr>
<tr><td style="text-align: center">4</td><td style="text-align: center">nuclearlemons.uk</td><td style="text-align: center">889</td></tr>
<tr><td style="text-align: center">5</td><td style="text-align: center">conduit.rs</td><td style="text-align: center">912.5</td></tr>
<tr><td style="text-align: center">6</td><td style="text-align: center">mailstation.de</td><td style="text-align: center">1075</td></tr>
<tr><td style="text-align: center">7</td><td style="text-align: center">matrix.org</td><td style="text-align: center">1092</td></tr>
<tr><td style="text-align: center">8</td><td style="text-align: center">test.zemos.net</td><td style="text-align: center">1123</td></tr>
<tr><td style="text-align: center">9</td><td style="text-align: center">shortestpath.dev</td><td style="text-align: center">1251.5</td></tr>
<tr><td style="text-align: center">10</td><td style="text-align: center">chatcloud.net</td><td style="text-align: center">1338.5</td></tr>
</tbody></table>
<p>We also now have a room where the ping bots are only hosted on non-Synapse
servers! See the scoreboard below.</p>
<table><thead><tr><th style="text-align: center">Rank</th><th style="text-align: center">Hostname</th><th style="text-align: center">Median MS</th></tr></thead><tbody>
<tr><td style="text-align: center">1</td><td style="text-align: center">conduit.rs</td><td style="text-align: center">104</td></tr>
<tr><td style="text-align: center">2</td><td style="text-align: center">settgast.org</td><td style="text-align: center">154</td></tr>
<tr><td style="text-align: center">3</td><td style="text-align: center">construct.grin.hu</td><td style="text-align: center">182</td></tr>
<tr><td style="text-align: center">4</td><td style="text-align: center">blob.cat</td><td style="text-align: center">209</td></tr>
<tr><td style="text-align: center">5</td><td style="text-align: center">grin.hu</td><td style="text-align: center">324.5</td></tr>
<tr><td style="text-align: center">6</td><td style="text-align: center">dendrite.neilalexander.dev</td><td style="text-align: center">367</td></tr>
<tr><td style="text-align: center">7</td><td style="text-align: center">test.zemos.net</td><td style="text-align: center">379</td></tr>
<tr><td style="text-align: center">8</td><td style="text-align: center">maunium.net</td><td style="text-align: center">448.5</td></tr>
<tr><td style="text-align: center">9</td><td style="text-align: center">conduit.nordgedanken.dev</td><td style="text-align: center">476</td></tr>
<tr><td style="text-align: center">10</td><td style="text-align: center">inferiorlattice.com</td><td style="text-align: center">592</td></tr>
</tbody></table>
<h2 id="final-thoughts-thought-balloon">Final Thoughts 💭</h2>
<h3 id="xkcd-2365">XKCD 2365</h3>
<p><a href="https://matrix.to/#/@afranke:matrix.org">Alexandre Franke</a> told us:</p>
<blockquote>
<p>XKCD made <a href="https://xkcd.com/2365/">another strip about messaging systems</a> and I’m outraged to see that Matrix has been left out of it.</p>
</blockquote>
<p>Not to worry though, we've fixed it up!</p>
<p><img src="/blog/img/2020-10-02-xkcd.png" alt="2020-10-02-xkcd.png" /></p>
<h3 id="twim-authorship">TWIM authorship</h3>
<p>I hope you enjoyed this week and last's TWIM editions! Benpa will return next
week for more of your regularly scheduled programming. Ciao!</p>
<h2 id="that-s-all-i-know-checkered-flag">That's all I know 🏁</h2>
<p>See you next week, and be sure to stop by <a href="https://matrix.to/#/#TWIM:matrix.org">#twim:matrix.org</a> with your updates!</p>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="&#x2F;blog&#x2F;2020&#x2F;09&#x2F;30&#x2F;welcoming-gitter-to-matrix&#x2F;" title="Welcoming Gitter to Matrix!">Welcoming Gitter to Matrix!</a></h1>
            <span>
                30.09.2020 16:28
                —
                <a href="/category/general">
                    General
                </a>
                —
                <a href="/author/matthew-hodgson">
                    Matthew Hodgson
                </a>
            </span>
            <br>
            <small>Last update: 30.09.2020 14:58</small>
        </header>
        <div>
            <p><img src="/blog/img/2020-09-30-gitter.png" alt="Gitter ♥️ Matrix" /></p>
<p>Hi all,</p>
<p>We are ridiculously excited to announce that <a href="https://gitter.im">Gitter</a> is joining the Matrix ecosystem and will become the first major existing chat platform to switch to natively speaking Matrix!</p>
<p>If you’re reading this from the Gitter community and have no idea what Matrix is: we’re an open source project that provides an open protocol for secure, decentralised communication - effectively the missing real-time communication layer of the open Web.  The open Matrix network has more than 20M users on it and is growing fast (adding another 1.7M or so with the arrival of Gitter!)</p>
<p>Gitter is easily one of the best developer community chat systems out there, used by the communities of some massive projects (<a href="https://gitter.im/nodejs/home">Node</a>, <a href="https://gitter.im/Microsoft/TypeScript">TypeScript</a>, <a href="https://gitter.im/angular/home">Angular</a>, <a href="https://gitter.im/scala/home">Scala</a> etc) and is a custodian of huge archives of knowledge via their chat logs. Gitter is unique in specifically focusing on developers: their tagline is literally “Where developers come to talk” (unlike Slack, which has barely any community features - or Discord, with its ban on unofficial clients, where developers are a bit of an afterthought relative to the gamers). With Gitter natively joining Matrix, we’re super excited to see the global developer community converging on the open Matrix network - and Gitter’s community rooms should see a huge new lease of life as they’re properly made natively available to the wider network as first class citizens :)</p>
<p>We’ve always had a bit of a crush on Gitter ever since we ended up opposite each other in the exhibition hall at TechCrunch Disrupt Europe 2014 - particularly when they demoed us not only their sexy webapp but also their official IRC server bridge at irc.gitter.im :D  Over the years we’ve been gently nudging them to consider fully embracing Matrix, but perhaps understandably they’ve been busy focusing on their own stuff. However, earlier this year, our friends at GitLab (who acquired Gitter in 2017) reached out to explore the opportunity of Gitter becoming a core part of Matrix rather than a non-core project at GitLab… and we’ve jumped on that opportunity to bring Gitter fully into Matrix.</p>
<p>In practice, the way this is happening is that Element (the company founded by the Matrix core team to fund Matrix development) is acquiring Gitter from GitLab, with a combined Gitter and Element dev team focusing on giving Gitter a new life in Matrix!  You can read about it from the Element angle over on <a href="https://element.io/blog/gitter-is-joining-element/">the Element blog</a>.</p>
<p>Practically speaking, we have a pretty interesting plan here, which we’d like to be very transparent about given it’s a little unusual:</p>
<p>At first, Gitter will keep running as it always has - needless to say, we will be doing everything we can to delight the Gitter community and keep the service in good shape.</p>
<p>Then we’re going to build out native Matrix connectivity - running a dedicated Matrix homeserver on gitter.im with a new bridge direct into the heart of Gitter; letting all Gitter rooms be available to Matrix directly as (say) #angular_angular:gitter.im, and bridging all the historical conversations into Matrix via <a href="https://github.com/matrix-org/matrix-doc/blob/matthew/msc2716/proposals/2716-importing-history-into-existing-rooms.md">MSC2716</a> or similar. We will of course do this entirely as open source, just as Gitter itself is open source thanks to GitLab releasing it under the MIT license in 2017. The plan is to comprehensively document our progress as the flagship worked example case study of “how do you make an existing chat system talk Matrix.”</p>
<p>This will of course replace the old and creaky <a href="https://github.com/matrix-org/matrix-appservice-gitter">matrix-appservice-gitter</a> bridge we’ve been running since 2016. Gitter users will also be able to talk to other users elsewhere in the open Matrix network - e.g. DMing them, and (possibly) joining arbitrary Matrix rooms. Effectively, <strong>Gitter will have become a Matrix client</strong>.</p>
<p>Now we come to the interesting bit. Gitter has some <em>really</em> nice features which are sorely lacking in Element today:</p>
<ul>
<li>Instant live room peeking (less than a second to load the webapp into a live-view of a massive room with 20K users!!)</li>
<li>Seamless onboarding thanks to using GitLab &amp; GitHub for accounts</li>
<li>Curated hierarchical room directory</li>
<li>Magical creation of rooms on demand for every GitLab and GitHub project ever</li>
<li>GitLab/GitHub activity as a first-class citizen in a room’s side-panel</li>
<li>Excellent search-engine-friendly static content and archives</li>
<li>KaTeX support for Maths communities</li>
<li>Threads!</li>
</ul>
<p>...and we promise to do everything in our power to preserve and honour these features at all costs and continue to give the Gitter community the experience they’ve come to know and love.</p>
<p><strong>However</strong>: in the medium/long term, it’s simply not going to be efficient for the combined Element/Gitter team to split our efforts maintaining two high-profile Matrix clients. Our plan is instead to merge Gitter’s features into Element (or next generations of Element) itself and then - if and only if Element has achieved parity with Gitter based on the above list - we expect to upgrade the deployment on gitter.im to a Gitter-customised version of Element. The inevitable side-effect is that we’ll be adding new features to Element rather than Gitter going forwards.</p>
<p>In practice, the main outcome in the end should be Element having benefited massively from levelling up with Gitter - and Gitter benefiting massively from all the goodies which Element and Matrix brings, including:</p>
<ul>
<li>E2E Encryption</li>
<li>Reactions</li>
<li>Constantly improving native iOS &amp; Android clients (which should be a welcome alternative to Gitter’s natives ones, which are <a href="https://gitlab.com/gitlab-org/gitter/webapp/-/issues/2281">already being deprecated</a>)</li>
<li>VoIP and conferencing</li>
<li>All the alternative clients, bots, bridges and servers in Matrix</li>
<li>The full open standard Matrix API</li>
<li>Widgets (embedding webapps into rooms!)</li>
<li>...and of course participation in the wider decentralised Matrix network.</li>
</ul>
<p>So, there you have it. It’s a new era for Gitter - and we look forward to reinvigorating Gitter’s communities over the coming months. We hope Gitter users will be blown away by the features arriving from Matrix… and we hope that Element users will be ecstatic with the performance and polish work that Gitter-parity will drive us towards. Imagine having guest access in Element that can launch and load a massive room in less than a second!</p>
<p>Finally, we would like to explicitly reassure the Gitter community again that we love and understand Gitter (it was one of the very first ever bridges we wrote for Matrix, for instance) - and we will be doing everything we can to not screw up our responsibility in looking after it. Please, please let us know if you have any concerns or if we ever fall short on this.</p>
<p>Any questions, come talk to us on <a href="https://matrix.to/#/#gitter:matrix.org">#gitter:matrix.org</a> - which is bridged with <a href="https://gitter.im/matrix-org/gitter">https://gitter.im/matrix-org/gitter</a>.  Exciting times ahead!</p>
<p>- Matthew, Amandine, and the whole Matrix, Element and Gitter teams.</p>
<div style="text-align: center">
    <img src="/blog/img/2020-09-30-gitter-photo.jpg" width="480" alt="Matthew & Amandine being dorky"/>
    <br/>
    <i><small>Matthew and Amandine model 2014-vintage Matrix & Gitter swag in celebration :D</small></i>
</div>
<h2 id="bonus-update-the-changelog-interview">Bonus update - The Changelog Interview!</h2>
<p>Sid Sijbrandij (CEO at GitLab) and Matthew had a chance to sit down with <a href="https://changelog.com">The Changelog</a> to talk about Gitter's Big Adventure - so tune in to hear the story first hand!  Warning: contains non-ironic use of the word &quot;synergy&quot; :D</p>
<br/>
<div style="text-align: center">
<a rel="noopener" href="https://cdn.changelog.com/uploads/podcast/414/the-changelog-414.mp3">
    <img src="https://matrix.org/blog/img/2020-09-30-gitter-changelog.png" alt="Changelog podcast 414"/>
</a>
<p><a href="https://changelog.com/podcast/414">The Changelog 414: Gitter's Big Adventure</a> - Listen on <a href="https://changelog.com/">Changelog.com</a></p>
</div>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="&#x2F;blog&#x2F;2020&#x2F;09&#x2F;25&#x2F;this-week-in-matrix-2020-09-25&#x2F;" title="This Week in Matrix 2020-09-25">This Week in Matrix 2020-09-25</a></h1>
            <span>
                26.09.2020 00:38
                —
                <a href="/category/this-week-in-matrix">
                    This Week in Matrix
                </a>
                —
                <a href="/author/andrew-morgan">
                    Andrew Morgan
                </a>
            </span>
            <br>
            <small>Last update: 25.09.2020 22:21</small>
        </header>
        <div>
            <p>Hello all, and welcome to this week's addition of This Week in Matrix!
<a href="https://matrix.org">Matrix</a> is an open network protocol for secure,
decentralized communication on the web.</p>
<p>My name is Andrew (aka <code>anoa</code>), and I'm a Synapse developer at Element.
Thanks to Ben for letting me take over the reins of TWIM for this week! I'll
actually be doing the same for next week as well, so please adjust your
clocks to Anoa Nonstandard Time accordingly.</p>
<p>With that out of the way, let's jump right in!</p>
<h2 id="matrix-live">Matrix Live 🎙</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Fk7YRiFIwZ4" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>It's demos week again. This time around we've got the following lineup:</p>
<ul>
<li>Michael shows off all the new widget goodies coming to Element Web!</li>
<li>Bruno shows off Hydrogen's new encrypted session backup support!</li>
<li>Ismail details the new room creation flow on Element iOS!</li>
<li>Jorik presents his work on revamping the UX of https://matrix.to that he completed for his second summer internship at Element!</li>
<li>Hubert fixes another class of failure-to-decrypt messages edge case with Device Dehydration!</li>
<li>Half-Shot closes off with the tale of Encrypted Bridges!</li>
</ul>
<p>Don't forget that Matrix Live is also available in podcast form, if you're into that sort of thing. Search for &quot;Matrix Live&quot; wherever you get your podcasts.</p>
<h2 id="dept-of-spec-scroll">Dept of Spec 📜</h2>
<p><a href="https://matrix.to/#/@andrewm:amorgan.xyz">anoa</a> (hey that's me!) told us:</p>
<blockquote>
<p>Here's your weekly spec update! The heart of Matrix is the specification - and this is modified by Matrix Spec Change (MSC) proposals. Learn more about how the process works at <a href="https://matrix.org/docs/spec/proposals">https://matrix.org/docs/spec/proposals</a>.</p>
<h2 id="msc-status">MSC Status</h2>
<p><strong>Merged MSCs:</strong></p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/1960">MSC1960: OpenID information exchange with widgets</a></li>
</ul>
</blockquote>
<blockquote>
<p><strong>MSCs in Final Comment Period:</strong></p>
<ul>
<li><em>No MSCs are in FCP.</em></li>
</ul>
</blockquote>
<blockquote>
<p><strong>New MSCs:</strong></p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2790">MSC2790: Modal widgets (acquiring user input from a widget)</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2788">MSC2788: Room version 6 as the default room version</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2787">MSC2787: Portable Identities</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2785">MSC2785: Event notification attributes and actions</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2783">[WIP] MSC2783: Homeserver Migration Data Format</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2782">MSC2782: Pushers with the full event content</a></li>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/2781">MSC2781: Deprecate the (reply) fallbacks in the Matrix specification</a></li>
</ul>
<h2 id="spec-core-team">Spec Core Team</h2>
<p>In terms of Spec Core Team MSC focus for this week, we've been rather busy with implementation, so we'll be continuing on with the same focus as last week. As a reminder, that's <a href="https://github.com/matrix-org/matrix-doc/issues/2414">MSC2414</a> (making reason and score optional on reports).</p>
</blockquote>
<blockquote>
<p><img src="/blog/img/2020-09-25-WozRC-image.png" alt="" /></p>
</blockquote>
<h2 id="dept-of-servers-europea">Dept of Servers 🏢</h2>
<h3 id="dendrite-gomatrixserverlib">Dendrite / gomatrixserverlib</h3>
<p>Dendrite is a next-generation homeserver written in Go.</p>
<p><a href="https://matrix.to/#/@neilalexander:matrix.org">Neil Alexander</a> announced:</p>
<blockquote>
<p>This week has mostly been spent trying to improve stability and to fix bugs ahead of the beta release, which is so far still planned to go ahead in the next two weeks.</p>
<p>Changes this week include:</p>
<ul>
<li>
<p>Room version 6 is now the default for newly created rooms</p>
</li>
<li>
<p>Soft-fail of events that aren't allowed by the current room state is now implemented</p>
</li>
<li>
<p>Support for configuring <code>old_verify_keys</code> has been added to the Dendrite config</p>
</li>
<li>
<p>Correct formatting for signing key IDs is now enforced in the configuration</p>
</li>
<li>
<p>Initial support for peeking over federation (<a href="https://github.com/matrix-org/matrix-doc/pull/2444">MSC2444</a>) is in progress and it &quot;even works!&quot; (thanks Matthew!)</p>
</li>
<li>
<p>Federated joins will now continue being processed even if the client gives up on the join due to a HTTP timeout</p>
</li>
<li>
<p>Backoff code has been refactored a bit more, and now correctly affects device list syncing</p>
</li>
<li>
<p><code>/make_join</code> now errors correctly if a federated user tries to join a room which all members have left</p>
</li>
<li>
<p>A bug where a single user could start multiple simultaneous federated joins to the same room has been fixed</p>
</li>
<li>
<p>Some initial (but unfinished) support for the <code>/key/v2/query</code> notary endpoint has been added</p>
</li>
<li>
<p>Signature verification has been updated to not fail if the event <code>origin</code> field is missing (although it still requires a signature from the domain of the <code>sender</code> field)</p>
</li>
<li>
<p>A number of places where we use SQL transactions have been updated with safe wrappers (thanks <a href="https://github.com/samcday">samcday</a>!)</p>
</li>
<li>
<p>A couple of error codes on invite endpoints for room version 6 JSON violations have been fixed</p>
</li>
</ul>
<p>Spec compliance has improved slightly for federation:</p>
<ul>
<li>
<p>Client-Server APIs: 56%, same as last week</p>
</li>
<li>
<p>Server-Server APIs: 77%, up from 74% last week</p>
</li>
</ul>
<p>As always, if contributing to Dendrite sounds like something you would be interested in, please feel free to join us in <a href="https://matrix.to/#/#dendrite-dev:matrix.org">#dendrite-dev:matrix.org</a> ! There's also <a href="https://matrix.to/#/#dendrite:matrix.org">#dendrite:matrix.org</a></p>
</blockquote>
<h3 id="synapse">Synapse</h3>
<p><a href="https://matrix.to/#/@neilj:matrix.org">Neil</a> offered:</p>
<blockquote>
<p>This week we released <a href="https://matrix.org/blog/2020/09/22/synapse-1-20-0-released">1.20.0</a> (and <a href="https://github.com/matrix-org/synapse/releases/tag/v1.20.1">1.20.1</a>) highlights include shadow banning support and including unread message counts in the sync response. This will help client developers and is a precursor to improving notification support.</p>
<p>We’ve also been looking at adding monitoring to get a better sense of which rooms are most expensive from a state resolution perspective, we also want a better way to track federation lag.</p>
<p>Up next we’ll move all background tasks away from the main process and try it out on matrix.org, we are hoping for a 10-15% saving in CPU. Event persistence sharding, specifically the new stream token format is on hold slightly while we work on a nasty race condition on start up of the event persister. We hope to get back to the main sharding project next week.</p>
</blockquote>
<h3 id="conduit">Conduit</h3>
<p>Conduit is a Matrix homeserver written in Rust <a href="https://conduit.rs">https://conduit.rs</a></p>
<p><a href="https://matrix.to/#/@timo:koesters.xyz">timo</a> announced:</p>
<blockquote>
<ul>
<li>Respect SRV record when sending requests over federation</li>
<li>Don't send new requests to servers if we are already waiting</li>
<li>Implement get_missing_events</li>
<li>Bug fixes and code cleanup</li>
</ul>
<p>We also started work on a system that retries failed or blocked requests after some time.</p>
</blockquote>
<blockquote>
<p>Thanks to everyone who supports me on &quot;Liberapay&quot; (https://liberapay.com/timokoesters) or Bitcoin!</p>
</blockquote>
<h3 id="the-construct">The Construct</h3>
<p><a href="https://matrix.to/#/@jason:zemos.net">Jason</a> reported:</p>
<blockquote>
<p>This week in Matrix concludes a summer of Construct where several transformative rounds of optimization took place. I'd like to talk about these achievements and why they are important for
future directions.</p>
<p>Over the summer, Construct introduced new vector extensions to the project. As server software, our primary target is the datacenter which (for now) is dominated by x86 hardware. The latest features of x86 chips include AVX-2, AVX-512, and on-die GPU. These advancements are important because they help mitigate current limitations of hardware, such as the cubic relationship between a processor's frequency and its power consumption. These limitations mean that CPU cores aren't completing more cycles-per-second every iteration of their development -- they're not getting much faster.</p>
<p>The problem with threads is that they can introduce a lot of complications to a project. Construct is able to forego multi-threading as a network server because it is primarily IO-bound. The benefits to a single-thread design in both performance and simplicity cannot be overstated. This is why Construct stands to benefit the most from features which allow more work to be accomplished at every individual computing cycle.</p>
<p>Construct undertook several endeavors over the summer which directly leverage platforms featuring SSE, AVX, AVX-512, etc. As an added bonus, our approach is designed to effortlessly port to ARM's Scalable Vector Extensions (SVE) as it becomes available (inside datacenters too!). Our focus has been JSON, Unicode, and finally Base64. Detailed explanations for each of these will need to be discussed in their own posts, but in summary:</p>
<ul>
<li>
<p>Matrix specifies a canonical form of JSON which is not necessarily the same as the JSON the server receives. Therefor it is imperative that Construct is liberal with what JSON it accepts and correct with its transformation into canonical JSON. Over the summer, a portion of Construct's canonical transform received some optimization to go beyond the default method of character-by-character read-modify-write. As seen in [1], a streaming hardware-accelerated transform now processes at least 16 characters at a time (with more possible) without forward branching except for the parts where transformation needs to occur. One of these transformations is UTF-16 to UTF-8 surrogate conversion, which leads into the second endeavor.</p>
</li>
<li>
<p>Construct introduced a completely branch-free Unicode toolset in [2]. Among the functions offered is a custom transform of UTF-16 surrogate pairs to UTF-8 sequences. Using the new vector registers, Construct can transform two UTF-16 surrogates in parallel to output two UTF-8 sequences, or two UTF-16 surrogates in a pair to output one UTF-8 sequence. Unfortunately, these specific functions were written at fixed vector widths, so more work needs to be done to really take advantage of the widest hardware. Each surrogate is 6 bytes, and a surrogate pair is 12 bytes; therefor we cannot make use of the last 4 bytes of a 16 byte vector. However, with a little more work this approach can be extended to a 64 byte vector, capable of decoding 5 surrogate pairs and 10 individual surrogates in parallel!</p>
</li>
<li>
<p>Professor Daniel Lemire recently published a paper about fast Base64 from hardware acceleration in [3]. This approach is extremely elegant on the 64-byte-wide AVX-512 system. Prior to Construct's implementation of this in [4], the Boost library base64 encoding and decoding took roughly 20 and 25 cycles per character respectively. Our implementation on the same system, an old system with only SSE2 (not even AVX-512!) yields 5 and 6 cycles per character!</p>
</li>
</ul>
<p>All of this helps lay a foundation for Construct to introduce Federated Media Rooms sometime in the future. Currently, Construct stores media in a separate database. Recently there's been work on a separate branch at [5] which stores actual file block inside events using Base64. It is for this reason sub-cycle and branchless JSON parsing and Base64 encoding is essential for maximum performance. The result is worthwhile, as the latency for querying the media database is slower than parsing and decoding the event content already in-hand.</p>
<p>That's all for today. Construct is available at <a href="https://github.com/matrix-construct/construct">https://github.com/matrix-construct/construct</a> and don't forget to idle and perform <a href="https://matrix.to/#/#construct:zemos.net">#construct:zemos.net</a> / <a href="https://matrix.to/#/#construct:maunium.net">#construct:maunium.net</a></p>
<p>Thanks!</p>
<ol>
<li>
<p><a href="https://github.com/matrix-construct/construct/blob/563f833ab325f27ff9e71af61af427fb02812f90/ircd/json.cc#L3483">https://github.com/matrix-construct/construct/blob/563f833ab325f27ff9e71af61af427fb02812f90/ircd/json.cc#L3483</a></p>
</li>
<li>
<p><a href="https://github.com/matrix-construct/construct/blob/563f833ab325f27ff9e71af61af427fb02812f90/ircd/utf.cc">https://github.com/matrix-construct/construct/blob/563f833ab325f27ff9e71af61af427fb02812f90/ircd/utf.cc</a></p>
</li>
<li>
<p><a href="https://arxiv.org/abs/1910.05109">https://arxiv.org/abs/1910.05109</a></p>
</li>
<li>
<p><a href="https://github.com/matrix-construct/construct/blob/563f833ab325f27ff9e71af61af427fb02812f90/ircd/b64.cc">https://github.com/matrix-construct/construct/blob/563f833ab325f27ff9e71af61af427fb02812f90/ircd/b64.cc</a></p>
</li>
<li>
<p><a href="https://github.com/jevolk/charybdis/tree/federated_media_rooms">https://github.com/jevolk/charybdis/tree/federated_media_rooms</a></p>
</li>
</ol>
</blockquote>
<p>It's really exciting to see Homeserver development ramping up from all
angles, and nice that the protocol warts are slowly getting ironed out in the
process.</p>
<h2 id="synapse-deployment-inbox-tray">Synapse Deployment 📥️</h2>
<h3 id="kubernetes">Kubernetes</h3>
<p><a href="https://matrix.to/#/@ace:kittenface.studio">Ananace</a> told us:</p>
<blockquote>
<p>Before I forget (more) about it, I pushed the 1.20.0 tag for my <a href="https://github.com/ananace/matrix-synapse">K8s-optimized container image</a> as well as my <a href="https://gitlab.com/ananace/charts">Helm chart</a>.</p>
</blockquote>
<h3 id="yunohost">YunoHost</h3>
<p><a href="https://matrix.to/#/@pierre:mamieserv.fr">Pierre</a> reported:</p>
<blockquote>
<p><a href="https://yunohost.org/">YunoHost</a> is an operating system aiming for the simplest administration of a server, and therefore democratize self-hosting.</p>
<p><a href="https://github.com/YunoHost-Apps/synapse_ynh/tree/master">Synapse</a> integration had been updated to 1.19.3 (1.20.0 available in branch <code>testing</code>)</p>
<p><a href="https://github.com/YunoHost-Apps/element_ynh/tree/master">Element Web</a> integration had been updated to 1.7.5 (1.7.7 available in branch <code>testing</code>)</p>
</blockquote>
<h3 id="dacruz21-matrix-chart">dacruz21/matrix-chart</h3>
<p><a href="https://matrix.to/#/@david:typokign.com">Typo Kign</a> announced:</p>
<blockquote>
<p>Thanks to <a href="https://www.github.com/Arkaniad">Arkaniad</a>, v2.7.0 of my Matrix Helm chart for Kubernetes is released with support for exporting Prometheus metrics. It pairs well with the <a href="https://grafana.com/grafana/dashboards/10046">Synapse Grafana dashboard</a>.</p>
</blockquote>
<h3 id="more-kubernetes">More Kubernetes</h3>
<p><a href="https://matrix.to/#/@ace:kittenface.studio">Ananace</a> said:</p>
<blockquote>
<p>And just pushed the 1.20.1 tag too for my <a href="https://github.com/ananace/matrix-synapse">K8s-optimized container image</a> as well as my <a href="https://gitlab.com/ananace/charts">Helm chart</a>.</p>
</blockquote>
<h3 id="third-party-powerpc-and-arm64-support-for-synapse">Third-Party PowerPC and ARM64 support for Synapse</h3>
<p><a href="https://matrix.to/#/@andreas:matrix.aventer.biz">andreas</a> announced:</p>
<blockquote>
<p>The synapse docker image from AVENTER (https://www.aventer.biz), does support PowerPC (ppc64le) and ARM64 architecture now. But at the moment only under the docker tag &quot;ppc&quot;. <a href="https://hub.docker.com/r/avhost/docker-matrix/tags?page=1&amp;name=ppc">https://hub.docker.com/r/avhost/docker-matrix/tags?page=1&amp;name=ppc</a> We will be happy to get feedback.</p>
</blockquote>
<p>As a Synapse developer, it's great to see the community making personal and
enterprise Matrix deployments more accessible!</p>
<h2 id="dept-of-clients-iphone">Dept of Clients 📱</h2>
<h3 id="fluffychat">FluffyChat</h3>
<p><a href="https://matrix.to/#/@sorunome:sorunome.de">sorunome</a> told us:</p>
<blockquote>
<p>Fluffychat 0.19.1 has been released!</p>
<h4 id="features">Features</h4>
<ul>
<li>
<p>Implemented ignore list</p>
</li>
<li>
<p>Jump to events in timeline: When tapping on a reply and when tapping a matrix.to link</p>
</li>
<li>
<p>Display messages with up to 10 emotes or emoji bigger</p>
</li>
<li>
<p>New design for the chat list and message bubbles</p>
</li>
<li>
<p>Implement reactions</p>
</li>
<li>
<p>Implement password change</p>
</li>
<li>
<p>Implement deactivate user account</p>
</li>
</ul>
<h4 id="fixes">Fixes</h4>
<ul>
<li>Timeline randomly resorting while more history is being fetched</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Automatically request history if the &quot;load more&quot; button is on the screen</li>
</ul>
</blockquote>
<p>Sorunome briefly mentioned afterwards that there is no 0.19.0 due to some accidental messed up tagging, and that it was easiest to just call the new version 0.19.1.</p>
<h3 id="element-web">Element Web</h3>
<p><a href="https://matrix.to/#/@neilj:matrix.org">Neil</a> offered:</p>
<blockquote>
<p>This week we put out a new release candidate <a href="https://staging.element.io">1.7.8-rc.1</a> highlights include:-</p>
<ul>
<li>
<p>Secure Backup has been moved out of the registration flow to a toast when you first encounter an E2EE room, which simplifies the new user experience</p>
</li>
<li>
<p>Added options to hide various UI features when hosting a custom Element
...along with various smaller fixes.</p>
</li>
</ul>
<p>Aside from that the work to improve the widget experience continues with modal widget next on the agenda.</p>
<p>Next week we will continue to improve widgets and add some more instrumentation into the app.</p>
</blockquote>
<h3 id="hydrogen">Hydrogen</h3>
<p><a href="https://matrix.to/#/@bwindels:matrix.org">Bruno</a> said:</p>
<blockquote>
<p>Released 0.1.0 (and 0.1.1) this week with read-only session backup enabled 🎉 Also doing more work to make Hydrogen work on IE11 on Windows 7 (it does already for Windows 10), Safari and other browsers where you get <code>TransactionInactiveError</code> during login, hope to release that soon.</p>
</blockquote>
<p>I need to give Hydrogren a shot myself, the quick speeds and low RAM usage
are really attractive.</p>
<h3 id="element-ios">Element-iOS</h3>
<p><a href="https://matrix.to/#/@Manu:matrix.org">Manu</a> offered:</p>
<blockquote>
<p>This week, room settings have been updated with a new intermediate screen. The codebase saw the introduction of an AppCoordinator (in swift) which will help us to have a better control on navigation within the app AND to use swift from end to end.</p>
</blockquote>
<h2 id="dept-of-sdks-and-frameworks">Dept of SDKs and Frameworks 🧰</h2>
<h3 id="polyjuice-client-mage">Polyjuice Client 🧙</h3>
<p><a href="https://matrix.to/#/@hubert:uhoreg.ca">uhoreg</a> told us:</p>
<blockquote>
<p>Polyjuice Client v0.3.0 has been released.  This release includes many breaking changes.  (&quot;Breaking&quot; in the sense of API changes, rather than the sync process suddenly failing to work, which was already featured in a previous release.)  This release also includes many changes, such as the client managing more bookkeeping, detecting if it got logged out, and supporting more Matrix features.  See the <a href="https://gitlab.com/uhoreg/polyjuice_client/-/releases/v0.3.0">release notes</a> for more information.</p>
</blockquote>
<h3 id="igor">Igor</h3>
<p><a href="https://matrix.to/#/@hubert:uhoreg.ca">uhoreg</a> reported:</p>
<blockquote>
<p><a href="https://hex.pm/packages/igor/">Igor</a> is a bot framework for Elixir.  Igor v0.2.0 has been released.  The main change is updating it to use Polyjuice Client 0.3.0.</p>
</blockquote>
<h2 id="dept-of-bots-robot-face">Dept of Bots 🤖</h2>
<h3 id="matrix-architect">Matrix-Architect</h3>
<p><a href="https://matrix.to/#/@erdnaxeli:cervoi.se">erdnaxeli</a> announced:</p>
<blockquote>
<p>Hi!</p>
<p>I present you a new project I've been working on for some time. It's a bot that allows you to use the admin API through matrix, by typing commands to the bot. The inspiration comes from the OperServ-like bots that allow IRC operators to administrate an IRC server.</p>
<p>The bot exposes some of the available admin APIs and aims to provide some more high level commands by combining different APIs. There is currently one &quot;high level command&quot;, <code>!room garbage-collect</code>, which allow you to purge from your HS all rooms without local users.</p>
<p>The project is written in crystal and is my first project in this language. It should be stable in normal conditions, but don't hesitate to fill issues. A Docker image is provided for more convenience.</p>
<p>I hope you will find this project useful 🙂</p>
<p><a href="https://github.com/erdnaxeli/matrix-architect">https://github.com/erdnaxeli/matrix-architect</a></p>
</blockquote>
<p>People administering their Synapse deployment through Matrix itself! How deep
does the rabbit hole go?</p>
<h3 id="songwhip-bot">Songwhip bot</h3>
<p><a href="https://matrix.to/#/@tulir:maunium.net">Tulir</a> reported:</p>
<blockquote>
<p>benpa wanted a bot that replies with a songwhip.com link whenever someone sends a music link (youtube, spotify, apple music, etc), so I wrote a small maubot plugin to do that: <a href="https://github.com/maubot/songwhip">https://github.com/maubot/songwhip</a></p>
<p>It's available at @songwhip:maunium.net</p>
</blockquote>
<p>I'm also desperately in need of this for the 10 <code>open.spotify.com</code> links that get thrown at me every week. Thanks Tulir!</p>
<h3 id="cyberbot">Cyberbot</h3>
<p><a href="https://matrix.to/#/@jj:sft.lol">jj</a> reported:</p>
<blockquote>
<p>There's a new bot! <a href="https://github.com/cybergruppe/cyberbot">Cyberbot</a>.</p>
<p>It supports E2EE and can be easily extended with Python plugins. Can be used e.g. for GitLab notifications, automated user invites, room creation, and of course can be programmed to react to any message posted in a room.</p>
</blockquote>
<h2 id="dept-of-interesting-projects">Dept of Interesting Projects 🛰️</h2>
<h3 id="matrix-gotify">matrix-gotify</h3>
<p><a href="https://matrix.to/#/@sorunome:sorunome.de">sorunome</a> said:</p>
<blockquote>
<p>Soru made a new thing, <a href="https://gitlab.com/Sorunome/matrix-gotify">matrix-gotify</a>. It is a <a href="https://gotify.net/">gotify</a> plugin to receive matrix notifications. This means, you can now receive matrix push notifications on your android phone self-hosted without the need of google services! That is why putting the full event in the push notification is actually not a privacy leak in this case.</p>
<p>This plugin could also be used to receive push notifications on any other kind of device that gotify supports.</p>
<p>Please note that this is independent of any matrix client - you don't even need to run one to be able to use this!</p>
</blockquote>
<p>I asked whether an <a href="https://bubu1.eu/openpush/">OpenPush</a>-like solution be
built on top of this , and Sorunome responded that someone had already
started working on just that! https://github.com/gotify/android/pull/115</p>
<p>This would allow other matrix clients on your phone to get their push
notifications through your gotify client, instead of needing to run a process
each. Great for battery life without proprietary Google blobs!</p>
<h3 id="homeservers-on-the-go">Homeservers on-the-go</h3>
<p><a href="https://matrix.to/#/@js:nil.im">js</a> got Synapse running in a car on a German highway:</p>
<blockquote>
<p><img src="/blog/img/2020-09-25-njVLa-matrix_car.jpeg" alt="" /></p>
</blockquote>
<blockquote>
<p>the setup is a cigarette lighter to 2x 230V converter, one being used to power the RockPro64, the other being used to power my notebook. My notebook is connected to the hotspot from my phone, while also being connected to a USB ethernet, the other end of which is plugged into the RockPro64. </p>
<p>The notebook then acts as a gateway, as well as SSHing to a tiny VPS with -R, to get a public port, and forwarding that traffic to the RockPro64.</p>
</blockquote>
<p>Maybe one day we'll all have an embedded Synapse homeserver in our cars. P2P E2EE
car comms anyone?</p>
<h3 id="matrix-voip-tester">Matrix VoIP Tester</h3>
<p><a href="https://matrix.to/#/@reivilibre:librepush.net">reivilibre</a> announced:</p>
<blockquote>
<p><a href="https://github.com/matrix-org/voip-tester">https://github.com/matrix-org/voip-tester</a></p>
<p>I have been through the perils of setting up a TURN server and having VoIP continue to fail, whilst spending hours scratching my head and staring at Wireshark without getting anywhere. When I was given free reign over project choice last year during my internship, I chose to start a tool that tests your homeserver's VoIP configuration, hoping it would be useful to both me and the community at large.</p>
<p>It saw some progress but I never managed to iron out some of the 'last few things' or put a pretty front on it — until about 2 weeks ago, when I got some more time to do it.</p>
<p>There are known issues — such as the scores being very arbitrary, wrong and misleading; it crashes Chromium every time (on my machine) and it completely misbehaves in Brave Browser (on my machine). It may also not be the prettiest (but hopefully it is at least somewhat inoffensive). I hope to work on these annoying issues soon.</p>
<p>I have deployed a test instance at <a href="https://test.voip.librepush.net">https://test.voip.librepush.net</a> — it can be tried in a WebRTC-supporting browser (probably Firefox if you want half a chance). Please don't take it to heart if you get a Fail or Poor score — it's probably not your fault. :)</p>
</blockquote>
<p>Oliver was interning with us at Element this Summer. Fixing up and releasing
this VoIP tester was part of it, but he's still working on it in his spare
time even though his internship has finished :)</p>
<p>Through this I found out that I forgot to turn on my turnserver on my
homeserver again. Thanks Oliver!</p>
<h2 id="dept-of-guides">Dept of Guides 🧭</h2>
<h3 id="german-language-guide-for-getting-start-with-matrix">German-Language Guide for Getting Start with Matrix</h3>
<p><a href="https://matrix.to/#/@samuel-p:matrix.sp-codes.de">Samuel</a> told us:</p>
<blockquote>
<p>I started an article series about Matrix on my german blog. The goal is to make it easier for new users to get started with Matrix. <a href="https://blog.sp-codes.de/werde-teil-der-matrix-matrix-teil-1/">https://blog.sp-codes.de/werde-teil-der-matrix-matrix-teil-1/</a></p>
</blockquote>
<p>Guides like these are the essential entrypoints to a project for a lot of users. The more, in different languages, the merrier!</p>
<h2 id="dept-of-ping-table-tennis-paddle-and-ball">Dept of Ping 🏓</h2>
<p>Here we reveal, rank, and applaud the homeservers with the lowest ping, as measured by <a href="https://github.com/maubot/echo">pingbot</a>, a <a href="https://github.com/maubot/maubot">maubot</a> that you can host on your own server. Join <a href="https://matrix.to/#/#ping:maunium.net">#ping:maunium.net</a> to experience the fun live, and to find out how to add YOUR server to the game.</p>
<table><thead><tr><th style="text-align: center">Rank</th><th style="text-align: center">Hostname</th><th style="text-align: center">Median MS</th></tr></thead><tbody>
<tr><td style="text-align: center">1</td><td style="text-align: center">thomcat.rocks</td><td style="text-align: center">896</td></tr>
<tr><td style="text-align: center">2</td><td style="text-align: center">matrix.vgorcum.com</td><td style="text-align: center">965</td></tr>
<tr><td style="text-align: center">3</td><td style="text-align: center">conduit.rs</td><td style="text-align: center">1226.5</td></tr>
<tr><td style="text-align: center">4</td><td style="text-align: center">neko.dev</td><td style="text-align: center">1232</td></tr>
<tr><td style="text-align: center">5</td><td style="text-align: center">kif.rocks</td><td style="text-align: center">1396</td></tr>
<tr><td style="text-align: center">6</td><td style="text-align: center">chatserver.ca</td><td style="text-align: center">1533.5</td></tr>
<tr><td style="text-align: center">7</td><td style="text-align: center">jauriarts.org</td><td style="text-align: center">1949.5</td></tr>
<tr><td style="text-align: center">8</td><td style="text-align: center">settgast.org</td><td style="text-align: center">2328</td></tr>
<tr><td style="text-align: center">9</td><td style="text-align: center">vkane.cz</td><td style="text-align: center">2419</td></tr>
<tr><td style="text-align: center">10</td><td style="text-align: center">conduit.nordgedanken.dev</td><td style="text-align: center">2519</td></tr>
</tbody></table>
<h3 id="ping-graphs-by-timotm">Ping Graphs by Timo™️</h3>
<p><a href="https://matrix.to/#/@timo:koesters.xyz">timo</a> told us:</p>
<blockquote>
<p>Here we look at how fast ping bots respond.</p>
<p>I changed the formatting of the plot a bit to make it more readable. Note that it is now using a log scale which allows us to see more data at the same time.</p>
<p><img src="/blog/img/2020-09-25-Osmfw-boxplot.svg" alt="(A graph showing conduit beating everyone)" /></p>
</blockquote>
<h3 id="non-synapse-ping-room">Non-Synapse Ping Room</h3>
<p><a href="https://matrix.to/#/@tulir:maunium.net">Tulir</a> reported:</p>
<blockquote>
<p>Now that we have multiple somewhat federating Matrix homeserver implementations, I decided to make a ping room where all the echo bots are hosted on second-gen homeservers: <a href="https://matrix.to/#/#ping-no-synapse:maunium.net">#ping-no-synapse:maunium.net</a>. Synapse users are still allowed to join and <code>!ping</code>, but all the pongs will come from non-Synapse servers.</p>
<p>Based on observations in that room so far, the new server implementations don't like eachother very much.</p>
</blockquote>
<table><thead><tr><th style="text-align: center">Rank</th><th style="text-align: center">Hostname</th><th style="text-align: center">Median MS</th></tr></thead><tbody>
<tr><td style="text-align: center">1</td><td style="text-align: center">conduit.rs</td><td style="text-align: center">110</td></tr>
<tr><td style="text-align: center">2</td><td style="text-align: center">pc.koesters.xyz:59003</td><td style="text-align: center">162</td></tr>
<tr><td style="text-align: center">3</td><td style="text-align: center">cd.mau.dev</td><td style="text-align: center">162.5</td></tr>
<tr><td style="text-align: center">4</td><td style="text-align: center">maunium.net</td><td style="text-align: center">181</td></tr>
<tr><td style="text-align: center">5</td><td style="text-align: center">c.mau.dev</td><td style="text-align: center">238</td></tr>
<tr><td style="text-align: center">6</td><td style="text-align: center">dendrite.neilalexander.dev</td><td style="text-align: center">370</td></tr>
<tr><td style="text-align: center">7</td><td style="text-align: center">conduit.nordgedanken.dev</td><td style="text-align: center">427</td></tr>
<tr><td style="text-align: center">8</td><td style="text-align: center">inferiorlattice.com</td><td style="text-align: center">592</td></tr>
<tr><td style="text-align: center">9</td><td style="text-align: center">matrix.org</td><td style="text-align: center">1294</td></tr>
<tr><td style="text-align: center">10</td><td style="text-align: center">grin.hu</td><td style="text-align: center">3560.5</td></tr>
</tbody></table>
<h2 id="final-thoughts-thought-balloon">Final Thoughts 💭</h2>
<ul>
<li><a href="https://matrix.to/#/@magnus:ctrl-c.liu.se">Magnus Svensson</a> was <a href="https://matrix.to/#/!xYvNcQPhnkrdUmYczI:matrix.org/$Fu_LD4g2AfYGWjcRPTISLIpJEGZ_Pq-MwymfBMddoRo?via=matrix.org&amp;via=privacytools.io&amp;via=feneas.org">left speechless</a> by the amazing projects that we got to see this week.</li>
</ul>
<h2 id="that-s-all-i-know-checkered-flag">That's all I know 🏁</h2>
<p>See you next week, and be sure to stop by <a href="https://matrix.to/#/#TWIM:matrix.org">#twim:matrix.org</a> with your updates!</p>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="&#x2F;blog&#x2F;2020&#x2F;09&#x2F;22&#x2F;synapse-1-20-0-released&#x2F;" title="Synapse 1.20.0 released">Synapse 1.20.0 released</a></h1>
            <span>
                22.09.2020 19:30
                —
                <a href="/category/releases">
                    Releases
                </a>
                —
                <a href="/author/neil-johnson">
                    Neil Johnson
                </a>
            </span>
            
        </header>
        <div>
            <p>Synapse 1.20.0 is here!</p>
<p>Highlights of 1.20.0 include:-</p>
<ul>
<li>Shadow ban support.</li>
<li>Unread message counts in the sync response to help our client developers, this is a precursor to improving notification support.</li>
<li>No less than 28 async/await PRs, so we can finally share all the hard work.</li>
</ul>
<p>Also take note that in a future release, we will be dropping support for accessing Synapse's Admin API using the <code>/_matrix/client/* prefixes</code>. More details follow in the changelog.</p>
<p>Get the new releases from any of the usual sources mentioned at https://github.com/matrix-org/synapse/blob/master/INSTALL.md. 1.20.0 is on github <a href="https://github.com/matrix-org/synapse/releases/tag/v1.20.0">here</a>, and 1.20.0rc4 is <a href="https://github.com/matrix-org/synapse/releases/tag/v1.20.0rc4">here</a>.</p>
<p>The changelog for 1.20.0 is as follows:</p>
<h1 id="synapse-1-20-0-2020-09-22">Synapse 1.20.0 (2020-09-22)</h1>
<p>No significant changes since v1.20.0rc5.</p>
<h2 id="removal-warning">Removal warning</h2>
<p>Historically, the <a href="https://github.com/matrix-org/synapse/tree/master/docs">Synapse Admin API</a> has been accessible under the <code>/_matrix/client/api/v1/admin</code>, <code>/_matrix/client/unstable/admin</code>, <code>/_matrix/client/r0/admin</code> and <code>/_synapse/admin</code> prefixes. In a future release, we will be dropping support for accessing Synapse's Admin API using the <code>/_matrix/client/*</code> prefixes. This makes it easier for homeserver admins to lock down external access to the Admin API endpoints.</p>
<h1 id="synapse-1-20-0rc5-2020-09-18">Synapse 1.20.0rc5 (2020-09-18)</h1>
<p>In addition to the below, Synapse 1.20.0rc5 also includes the bug fix that was included in 1.19.3.</p>
<h2 id="features">Features</h2>
<ul>
<li>Add flags to the <code>/versions</code> endpoint for whether new rooms default to using E2EE. (<a href="https://github.com/matrix-org/synapse/issues/8343">#8343</a>)</li>
</ul>
<h2 id="bugfixes">Bugfixes</h2>
<ul>
<li>Fix rate limiting of federation <code>/send</code> requests. (<a href="https://github.com/matrix-org/synapse/issues/8342">#8342</a>)</li>
<li>Fix a longstanding bug where back pagination over federation could get stuck if it failed to handle a received event. (<a href="https://github.com/matrix-org/synapse/issues/8349">#8349</a>)</li>
</ul>
<h2 id="internal-changes">Internal Changes</h2>
<ul>
<li>Blacklist <a href="https://github.com/matrix-org/matrix-doc/pull/2753">MSC2753</a> SyTests until it is implemented. (<a href="https://github.com/matrix-org/synapse/issues/8285">#8285</a>)</li>
</ul>
<h1 id="synapse-1-20-0rc4-2020-09-16">Synapse 1.20.0rc4 (2020-09-16)</h1>
<p>Synapse 1.20.0rc4 is identical to 1.20.0rc3, with the addition of the security fix that was included in 1.19.2.</p>
<h1 id="synapse-1-20-0rc3-2020-09-11">Synapse 1.20.0rc3 (2020-09-11)</h1>
<h2 id="bugfixes-1">Bugfixes</h2>
<ul>
<li>Fix a bug introduced in v1.20.0rc1 where the wrong exception was raised when invalid JSON data is encountered. (<a href="https://github.com/matrix-org/synapse/issues/8291">#8291</a>)</li>
</ul>
<h1 id="synapse-1-20-0rc2-2020-09-09">Synapse 1.20.0rc2 (2020-09-09)</h1>
<h2 id="bugfixes-2">Bugfixes</h2>
<ul>
<li>Fix a bug introduced in v1.20.0rc1 causing some features related to notifications to misbehave following the implementation of unread counts. (<a href="https://github.com/matrix-org/synapse/issues/8280">#8280</a>)</li>
</ul>
<h1 id="synapse-1-20-0rc1-2020-09-08">Synapse 1.20.0rc1 (2020-09-08)</h1>
<h2 id="removal-warning-1">Removal warning</h2>
<p>Some older clients used a <a href="https://matrix.org/docs/spec/client_server/r0.6.1#post-matrix-client-r0-register-email-requesttoken">disallowed character</a> (<code>:</code>) in the <code>client_secret</code> parameter of various endpoints. The incorrect behaviour was allowed for backwards compatibility, but is now being removed from Synapse as most users have updated their client. Further context can be found at <a href="https://github.com/matrix-org/synapse/issues/6766">#6766</a>.</p>
<h2 id="features-1">Features</h2>
<ul>
<li>Add an endpoint to query your shared rooms with another user as an implementation of <a href="https://github.com/matrix-org/matrix-doc/pull/2666">MSC2666</a>. (<a href="https://github.com/matrix-org/synapse/issues/7785">#7785</a>)</li>
<li>Iteratively encode JSON to avoid blocking the reactor. (<a href="https://github.com/matrix-org/synapse/issues/8013">#8013</a>, <a href="https://github.com/matrix-org/synapse/issues/8116">#8116</a>)</li>
<li>Add support for shadow-banning users (ignoring any message send requests). (<a href="https://github.com/matrix-org/synapse/issues/8034">#8034</a>, <a href="https://github.com/matrix-org/synapse/issues/8092">#8092</a>, <a href="https://github.com/matrix-org/synapse/issues/8095">#8095</a>, <a href="https://github.com/matrix-org/synapse/issues/8142">#8142</a>, <a href="https://github.com/matrix-org/synapse/issues/8152">#8152</a>, <a href="https://github.com/matrix-org/synapse/issues/8157">#8157</a>, <a href="https://github.com/matrix-org/synapse/issues/8158">#8158</a>, <a href="https://github.com/matrix-org/synapse/issues/8176">#8176</a>)</li>
<li>Use the default template file when its equivalent is not found in a custom template directory. (<a href="https://github.com/matrix-org/synapse/issues/8037">#8037</a>, <a href="https://github.com/matrix-org/synapse/issues/8107">#8107</a>, <a href="https://github.com/matrix-org/synapse/issues/8252">#8252</a>)</li>
<li>Add unread messages count to sync responses, as specified in <a href="https://github.com/matrix-org/matrix-doc/pull/2654">MSC2654</a>. (<a href="https://github.com/matrix-org/synapse/issues/8059">#8059</a>, <a href="https://github.com/matrix-org/synapse/issues/8254">#8254</a>, <a href="https://github.com/matrix-org/synapse/issues/8270">#8270</a>, <a href="https://github.com/matrix-org/synapse/issues/8274">#8274</a>)</li>
<li>Optimise <code>/federation/v1/user/devices/</code> API by only returning devices with encryption keys. (<a href="https://github.com/matrix-org/synapse/issues/8198">#8198</a>)</li>
</ul>
<h2 id="bugfixes-3">Bugfixes</h2>
<ul>
<li>Fix a memory leak by limiting the length of time that messages will be queued for a remote server that has been unreachable. (<a href="https://github.com/matrix-org/synapse/issues/7864">#7864</a>)</li>
<li>Fix <code>Re-starting finished log context PUT-nnnn</code> warning when event persistence failed. (<a href="https://github.com/matrix-org/synapse/issues/8081">#8081</a>)</li>
<li>Synapse now correctly enforces the valid characters in the <code>client_secret</code> parameter used in various endpoints. (<a href="https://github.com/matrix-org/synapse/issues/8101">#8101</a>)</li>
<li>Fix a bug introduced in v1.7.2 impacting message retention policies that would allow federated homeservers to dictate a retention period that's lower than the configured minimum allowed duration in the configuration file. (<a href="https://github.com/matrix-org/synapse/issues/8104">#8104</a>)</li>
<li>Fix a long-standing bug where invalid JSON would be accepted by Synapse. (<a href="https://github.com/matrix-org/synapse/issues/8106">#8106</a>)</li>
<li>Fix a bug introduced in Synapse v1.12.0 which could cause <code>/sync</code> requests to fail with a 404 if you had a very old outstanding room invite. (<a href="https://github.com/matrix-org/synapse/issues/8110">#8110</a>)</li>
<li>Return a proper error code when the rooms of an invalid group are requested. (<a href="https://github.com/matrix-org/synapse/issues/8129">#8129</a>)</li>
<li>Fix a bug which could cause a leaked postgres connection if synapse was set to daemonize. (<a href="https://github.com/matrix-org/synapse/issues/8131">#8131</a>)</li>
<li>Clarify the error code if a user tries to register with a numeric ID. This bug was introduced in v1.15.0. (<a href="https://github.com/matrix-org/synapse/issues/8135">#8135</a>)</li>
<li>Fix a bug where appservices with ratelimiting disabled would still be ratelimited when joining rooms. This bug was introduced in v1.19.0. (<a href="https://github.com/matrix-org/synapse/issues/8139">#8139</a>)</li>
<li>Fix logging in via OpenID Connect with a provider that uses integer user IDs. (<a href="https://github.com/matrix-org/synapse/issues/8190">#8190</a>)</li>
<li>Fix a longstanding bug where user directory updates could break when unexpected profile data was included in events. (<a href="https://github.com/matrix-org/synapse/issues/8223">#8223</a>)</li>
<li>Fix a longstanding bug where stats updates could break when unexpected profile data was included in events. (<a href="https://github.com/matrix-org/synapse/issues/8226">#8226</a>)</li>
<li>Fix slow start times for large servers by removing a table scan of the <code>users</code> table from startup code. (<a href="https://github.com/matrix-org/synapse/issues/8271">#8271</a>)</li>
</ul>
<h2 id="updates-to-the-docker-image">Updates to the Docker image</h2>
<ul>
<li>Fix builds of the Docker image on non-x86 platforms. (<a href="https://github.com/matrix-org/synapse/issues/8144">#8144</a>)</li>
<li>Added curl for healthcheck support and readme updates for the change. Contributed by @maquis196. (<a href="https://github.com/matrix-org/synapse/issues/8147">#8147</a>)</li>
</ul>
<h2 id="improved-documentation">Improved Documentation</h2>
<ul>
<li>Link to matrix-synapse-rest-password-provider in the password provider documentation. (<a href="https://github.com/matrix-org/synapse/issues/8111">#8111</a>)</li>
<li>Updated documentation to note that Synapse does not follow <code>HTTP 308</code> redirects due to an upstream library not supporting them. Contributed by Ryan Cole. (<a href="https://github.com/matrix-org/synapse/issues/8120">#8120</a>)</li>
<li>Explain better what GDPR-erased means when deactivating a user. (<a href="https://github.com/matrix-org/synapse/issues/8189">#8189</a>)</li>
</ul>
<h2 id="internal-changes-1">Internal Changes</h2>
<ul>
<li>Add filter <code>name</code> to the <code>/users</code> admin API, which filters by user ID or displayname. Contributed by Awesome Technologies Innovationslabor GmbH. (<a href="https://github.com/matrix-org/synapse/issues/7377">#7377</a>, <a href="https://github.com/matrix-org/synapse/issues/8163">#8163</a>)</li>
<li>Reduce run times of some unit tests by advancing the reactor a fewer number of times. (<a href="https://github.com/matrix-org/synapse/issues/7757">#7757</a>)</li>
<li>Don't fail <code>/submit_token</code> requests on incorrect session ID if <code>request_token_inhibit_3pid_errors</code> is turned on. (<a href="https://github.com/matrix-org/synapse/issues/7991">#7991</a>)</li>
<li>Convert various parts of the codebase to async/await. (<a href="https://github.com/matrix-org/synapse/issues/8071">#8071</a>, <a href="https://github.com/matrix-org/synapse/issues/8072">#8072</a>, <a href="https://github.com/matrix-org/synapse/issues/8074">#8074</a>, <a href="https://github.com/matrix-org/synapse/issues/8075">#8075</a>, <a href="https://github.com/matrix-org/synapse/issues/8076">#8076</a>, <a href="https://github.com/matrix-org/synapse/issues/8087">#8087</a>, <a href="https://github.com/matrix-org/synapse/issues/8100">#8100</a>, <a href="https://github.com/matrix-org/synapse/issues/8119">#8119</a>, <a href="https://github.com/matrix-org/synapse/issues/8121">#8121</a>, <a href="https://github.com/matrix-org/synapse/issues/8133">#8133</a>, <a href="https://github.com/matrix-org/synapse/issues/8156">#8156</a>, <a href="https://github.com/matrix-org/synapse/issues/8162">#8162</a>, <a href="https://github.com/matrix-org/synapse/issues/8166">#8166</a>, <a href="https://github.com/matrix-org/synapse/issues/8168">#8168</a>, <a href="https://github.com/matrix-org/synapse/issues/8173">#8173</a>, <a href="https://github.com/matrix-org/synapse/issues/8191">#8191</a>, <a href="https://github.com/matrix-org/synapse/issues/8192">#8192</a>, <a href="https://github.com/matrix-org/synapse/issues/8193">#8193</a>, <a href="https://github.com/matrix-org/synapse/issues/8194">#8194</a>, <a href="https://github.com/matrix-org/synapse/issues/8195">#8195</a>, <a href="https://github.com/matrix-org/synapse/issues/8197">#8197</a>, <a href="https://github.com/matrix-org/synapse/issues/8199">#8199</a>, <a href="https://github.com/matrix-org/synapse/issues/8200">#8200</a>, <a href="https://github.com/matrix-org/synapse/issues/8201">#8201</a>, <a href="https://github.com/matrix-org/synapse/issues/8202">#8202</a>, <a href="https://github.com/matrix-org/synapse/issues/8207">#8207</a>, <a href="https://github.com/matrix-org/synapse/issues/8213">#8213</a>, <a href="https://github.com/matrix-org/synapse/issues/8214">#8214</a>)</li>
<li>Remove some unused database functions. (<a href="https://github.com/matrix-org/synapse/issues/8085">#8085</a>)</li>
<li>Add type hints to various parts of the codebase. (<a href="https://github.com/matrix-org/synapse/issues/8090">#8090</a>, <a href="https://github.com/matrix-org/synapse/issues/8127">#8127</a>, <a href="https://github.com/matrix-org/synapse/issues/8187">#8187</a>, <a href="https://github.com/matrix-org/synapse/issues/8241">#8241</a>, <a href="https://github.com/matrix-org/synapse/issues/8140">#8140</a>, <a href="https://github.com/matrix-org/synapse/issues/8183">#8183</a>, <a href="https://github.com/matrix-org/synapse/issues/8232">#8232</a>, <a href="https://github.com/matrix-org/synapse/issues/8235">#8235</a>, <a href="https://github.com/matrix-org/synapse/issues/8237">#8237</a>, <a href="https://github.com/matrix-org/synapse/issues/8244">#8244</a>)</li>
<li>Return the previous stream token if a non-member event is a duplicate. (<a href="https://github.com/matrix-org/synapse/issues/8093">#8093</a>, <a href="https://github.com/matrix-org/synapse/issues/8112">#8112</a>)</li>
<li>Separate <code>get_current_token</code> into two since there are two different use cases for it. (<a href="https://github.com/matrix-org/synapse/issues/8113">#8113</a>)</li>
<li>Remove <code>ChainedIdGenerator</code>. (<a href="https://github.com/matrix-org/synapse/issues/8123">#8123</a>)</li>
<li>Reduce the amount of whitespace in JSON stored and sent in responses. (<a href="https://github.com/matrix-org/synapse/issues/8124">#8124</a>)</li>
<li>Update the test federation client to handle streaming responses. (<a href="https://github.com/matrix-org/synapse/issues/8130">#8130</a>)</li>
<li>Micro-optimisations to <code>get_auth_chain_ids</code>. (<a href="https://github.com/matrix-org/synapse/issues/8132">#8132</a>)</li>
<li>Refactor <code>StreamIdGenerator</code> and <code>MultiWriterIdGenerator</code> to have the same interface. (<a href="https://github.com/matrix-org/synapse/issues/8161">#8161</a>)</li>
<li>Add functions to <code>MultiWriterIdGen</code> used by events stream. (<a href="https://github.com/matrix-org/synapse/issues/8164">#8164</a>, <a href="https://github.com/matrix-org/synapse/issues/8179">#8179</a>)</li>
<li>Fix tests that were broken due to the merge of 1.19.1. (<a href="https://github.com/matrix-org/synapse/issues/8167">#8167</a>)</li>
<li>Make <code>SlavedIdTracker.advance</code> have the same interface as <code>MultiWriterIDGenerator</code>. (<a href="https://github.com/matrix-org/synapse/issues/8171">#8171</a>)</li>
<li>Remove unused <code>is_guest</code> parameter from, and add safeguard to, <code>MessageHandler.get_room_data</code>. (<a href="https://github.com/matrix-org/synapse/issues/8174">#8174</a>, <a href="https://github.com/matrix-org/synapse/issues/8181">#8181</a>)</li>
<li>Standardize the mypy configuration. (<a href="https://github.com/matrix-org/synapse/issues/8175">#8175</a>)</li>
<li>Refactor some of <code>LoginRestServlet</code>'s helper methods, and move them to <code>AuthHandler</code> for easier reuse. (<a href="https://github.com/matrix-org/synapse/issues/8182">#8182</a>)</li>
<li>Fix <code>wait_for_stream_position</code> to allow multiple waiters on same stream ID. (<a href="https://github.com/matrix-org/synapse/issues/8196">#8196</a>)</li>
<li>Make <code>MultiWriterIDGenerator</code> work for streams that use negative values. (<a href="https://github.com/matrix-org/synapse/issues/8203">#8203</a>)</li>
<li>Refactor queries for device keys and cross-signatures. (<a href="https://github.com/matrix-org/synapse/issues/8204">#8204</a>, <a href="https://github.com/matrix-org/synapse/issues/8205">#8205</a>, <a href="https://github.com/matrix-org/synapse/issues/8222">#8222</a>, <a href="https://github.com/matrix-org/synapse/issues/8224">#8224</a>, <a href="https://github.com/matrix-org/synapse/issues/8225">#8225</a>, <a href="https://github.com/matrix-org/synapse/issues/8231">#8231</a>, <a href="https://github.com/matrix-org/synapse/issues/8233">#8233</a>, <a href="https://github.com/matrix-org/synapse/issues/8234">#8234</a>)</li>
<li>Fix type hints for functions decorated with <code>@cached</code>. (<a href="https://github.com/matrix-org/synapse/issues/8240">#8240</a>)</li>
<li>Remove obsolete <code>order</code> field from federation send queues. (<a href="https://github.com/matrix-org/synapse/issues/8245">#8245</a>)</li>
<li>Stop sub-classing from object. (<a href="https://github.com/matrix-org/synapse/issues/8249">#8249</a>)</li>
<li>Add more logging to debug slow startup. (<a href="https://github.com/matrix-org/synapse/issues/8264">#8264</a>)</li>
<li>Do not attempt to upgrade database schema on worker processes. (<a href="https://github.com/matrix-org/synapse/issues/8266">#8266</a>, <a href="https://github.com/matrix-org/synapse/issues/8276">#8276</a>)</li>
</ul>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="&#x2F;blog&#x2F;2020&#x2F;09&#x2F;18&#x2F;gsoc-report-moving-matrix-ircd-to-async-await-and-futures-0-3&#x2F;" title="GSOC report: Moving matrix-ircd to async&#x2F;await and futures 0.3">GSOC report: Moving matrix-ircd to async&#x2F;await and futures 0.3</a></h1>
            <span>
                18.09.2020 13:05
                —
                <a href="/category/gsoc">
                    GSOC
                </a>
                —
                <a href="/author/brooks-karlik">
                    Brooks Karlik
                </a>
            </span>
            
        </header>
        <div>
            <p>This is part of a series of reports on the <a href="https://summerofcode.withgoogle.com/organizations/6060943798173696"><em>six</em> projects</a> assigned to Matrix for Google Summer of Code 2020.</p>
<p><a href="https://summerofcode.withgoogle.com/organizations/6060943798173696/#5911643604647936">View project: Moving <code>matrix-ircd</code> to async/await and <code>futures</code> 0.3</a></p>
<hr />
<p>The goal of this project was to port <code>matrix-ircd</code> from the outdated combinators style of <code>futures</code> 0.1 to the new-and-improved style of <code>futures</code> 0.3. As initially proposed, this greatly improves code readability and removes the convoluted compiler errors that were pervasive in <code>futures</code> 0.1</p>
<h2 id="matrix-ircd">matrix-ircd</h2>
<p>The matrix-ircd project functions as a bridge between two chat platforms: Internet relay chat (irc) and Matrix. matrix-ircd lets you use any standard IRC Client to communicate with Matrix chatrooms and direct messages.</p>
<h2 id="mentors">Mentors</h2>
<p>This project is mentored by Philipp Mandler (<a href="https://github.com/phlmn">@phlmn</a>) and Jonas Platte (<a href="https://github.com/jplatte">@jplatte</a>). I would like to thank them for the helpful advice and code reviews they have given me over the course of GSoC 2020.</p>
<h2 id="project-results">Project Results</h2>
<p>Since much of the code was written in late 2016, there were many portions of the code that were unidiomatic and produced compiler errors. The first step I made was to remove all compiler errors from <code>cargo</code> and <code>clippy</code> in <a href="https://github.com/matrix-org/matrix-ircd/pull/64">#64</a>.</p>
<p>Additional tests were then written in various parts of the codebase to ensure that the upgrade would produce the same results. These changes were made in <a href="https://github.com/matrix-org/matrix-ircd/pull/65">#64</a> and <a href="https://github.com/matrix-org/matrix-ircd/pull/66">#66</a>.</p>
<p>Since the project master branch currently used a custom http implementation, I moved it to use <a href="https://crates.io/crates/hyper">hyper</a>, a fast and correct http implementation that already supported async/await. Additionally, I moved the module that most utilized http, <code>matrix</code>, to async-await and the new <code>hyper</code> code. Not only did these changes shrink the code by ~700 lines, they also removed a lot of unnecessary complexity. These changes were made in <a href="https://github.com/matrix-org/matrix-ircd/pull/67">#67</a>.</p>
<p>The last large module remaining, <code>irc</code>, was then ported to <code>irc</code>, along with its dependencies in <code>stream_fold.rs</code> and its upstream user in the <code>bridge</code> module. The most exciting part of these changes was the removal of the <code>futures</code> 0.1 dependency. All code was now running in <code>futures</code> 0.3! These changes also moved away from <a href="https://github.com/erikjohnston/tasked-futures">tasked-futures</a> which further improved code readability. This PR was in <a href="https://github.com/matrix-org/matrix-ircd/pull/71">#71</a>.</p>
<p>Since the bulk of the changes were now complete, I moved onto bug fixes. As <a href="github.com/jplatte">@jplatte</a> mentioned in #71, the current single threaded approach to the application was not ideal. In <a href="https://github.com/matrix-org/matrix-ircd/pull/72">#72</a> I updated all code to be multithreaded-compatible.</p>
<p>Lastly, In <a href="https://github.com/matrix-org/matrix-ircd/pull/77">#77</a> I included more tests to functions with heavy changes, added additional logging, removed unnecessary complexity that was introduced to keep code as &quot;1:1&quot; as possible, and added TLS support to <code>hyper</code> so that https would work. This patch also fixed a rather difficult bug regarding the irc TCP streams and the buffer they were reading into.</p>
<h2 id="remaining-work">Remaining Work</h2>
<p>Based on my personal testing there is <em>no additional work</em> to be done in the realm of updating to async/await. All tests pass and the IRC server and matrix bridge function as expected. @jplatte kindly announced in the <a href="https://matrix.org/blog/category/this-week-in-matrix#matrix-ircd---call-for-testing">This Week In Matrix</a> blog that we will be conducting public testing of the <code>async_await</code> branch on github. Barring any issues the async/await code should be merged into the master branch in the next few weeks.</p>
<h3 id="pull-request-list">Pull request list</h3>
<ul>
<li>https://github.com/matrix-org/matrix-ircd/pull/64</li>
<li>https://github.com/matrix-org/matrix-ircd/pull/65</li>
<li>https://github.com/matrix-org/matrix-ircd/pull/66</li>
<li>https://github.com/matrix-org/matrix-ircd/pull/67</li>
<li>https://github.com/matrix-org/matrix-ircd/pull/71</li>
<li>https://github.com/matrix-org/matrix-ircd/pull/72</li>
<li>https://github.com/matrix-org/matrix-ircd/pull/77</li>
</ul>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="&#x2F;blog&#x2F;2020&#x2F;09&#x2F;18&#x2F;this-week-in-matrix-2020-09-18&#x2F;" title="This Week in Matrix 2020-09-18">This Week in Matrix 2020-09-18</a></h1>
            <span>
                18.09.2020 00:00
                —
                <a href="/category/this-week-in-matrix">
                    This Week in Matrix
                </a>
                —
                <a href="/author/ben-parsons">
                    Ben Parsons
                </a>
            </span>
            
        </header>
        <div>
            <h2 id="matrix-live">Matrix Live 🎙</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/9oIUEZidP5w" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2 id="dept-of-status-of-matrix-face-with-th">Dept of <em>Status of Matrix</em> 🌡️</h2>
<h3 id="element-review-by-techradar">Element review by TechRadar</h3>
<p>TechRadar have published a fairly thorough <a href="https://www.techradar.com/uk/reviews/element-secure-messenger-review">Element secure messenger review</a>. This covers the Web, Android and iOS clients, and appears to use the matrix.org server for signup.</p>
<p>The review is very positive, awarding 4.5/5, and concludes:</p>
<blockquote>
<p>The Element messenger platform scores highly for its approach to security and its commitment to decentralization, and it's definitely going to be of interest to businesses wanting control over their own chats – as well as plenty of individual users as well.</p>
</blockquote>
<h2 id="dept-of-spec-scroll">Dept of Spec 📜</h2>
<h3 id="spec">Spec</h3>
<p><a href="https://matrix.to/#/@andrewm:amorgan.xyz">anoa</a> told us:</p>
<blockquote>
<p>Here's your weekly spec update! The heart of Matrix is the specification - and this is modified by Matrix Spec Change (MSC) proposals. Learn more about how the process works at <a href="https://matrix.org/docs/spec/proposals">https://matrix.org/docs/spec/proposals</a>.</p>
<h4 id="msc-status">MSC Status</h4>
<p><strong>Merged MSCs:</strong></p>
<ul>
<li><em>No MSCs were merged this week.</em></li>
</ul>
<p><strong>MSCs in Final Comment Period:</strong></p>
<ul>
<li><a href="https://github.com/matrix-org/matrix-doc/pull/1960">MSC1960: OpenID information exchange with widgets</a> (merge)</li>
</ul>
<p><strong>New MSCs:</strong></p>
<ul>
<li>
<p><a href="https://github.com/matrix-org/matrix-doc/pull/2778">MSC2778: Providing authentication method for appservice users</a></p>
</li>
<li>
<p><a href="https://github.com/matrix-org/matrix-doc/pull/2775">MSC2775: Lazy loading over federation</a></p>
</li>
<li>
<p><a href="https://github.com/matrix-org/matrix-doc/pull/2774">MSC2774: Expose the widget ID to the widget</a></p>
</li>
<li>
<p><a href="https://github.com/matrix-org/matrix-doc/pull/2773">[WIP] MSC2773: Room kinds</a></p>
</li>
</ul>
<h4 id="spec-core-team">Spec Core Team</h4>
<p>In terms of Spec Core Team MSC focus for this week, <a href="https://github.com/matrix-org/matrix-doc/issues/1960">MSC1960</a> has made it into FCP, so this week our focus is <a href="https://github.com/matrix-org/matrix-doc/issues/2414">MSC2414</a>.</p>
</blockquote>
<p><img src="/blog/img/2020-09-18-8BoQF-stacked_area_chart.png" alt="2020-09-18-8BoQF-stacked_area_chart.png" /></p>
<h2 id="dept-of-servers-europea">Dept of Servers 🏢</h2>
<h3 id="synapse">Synapse</h3>
<p><a href="https://matrix.to/#/@neilj:matrix.org">Neil</a> announced:</p>
<blockquote>
<p>This week we put out two point releases to fix critical bugs. At the very least ensure that you have upgraded to <a href="https://github.com/matrix-org/synapse/releases/tag/v1.19.2">1.19.2</a> which is a security release but you may as well go the whole hog and upgrade to the hot off the press <a href="https://github.com/matrix-org/synapse/releases/tag/v1.19.3">1.19.3</a>. We will release 1.20.0 early next week.</p>
<p>Aside from that we continue to work on performance analysis and the sharding of the event persister continues - it’s proving to be a really tough job but we are getting there. We’ve also been making progress on the room knocking implementation</p>
<p>This week we say goodbye to Oliver (reivilibre) as a leaving present he fixed a long standing bug that prevented servers catching up after a federating outage and as we speak is furiously trying to finish a service to test TURN configuration. Thanks Oliver!</p>
</blockquote>
<h3 id="dendrite-gomatrixserverlib">Dendrite / gomatrixserverlib</h3>
<p>Dendrite is a next-generation homeserver written in Go</p>
<p><a href="https://matrix.to/#/@neilalexander:matrix.org">Neil Alexander</a> said:</p>
<blockquote>
<p>Not much has happened this week, as the Dendrite team have been taking some time off. However, we still have a couple of changes to report:</p>
<ul>
<li>
<p>Support for rejected events has been merged</p>
</li>
<li>
<p>Work on soft-fail has begun (although not complete yet)</p>
</li>
<li>
<p>A new mechanism for avoiding SQLite parameter limits was contributed (thanks HenrikSolver!)</p>
</li>
</ul>
<p>Spec compliance is on the up:</p>
<ul>
<li>
<p>Client-Server APIs: 56%, same as last week</p>
</li>
<li>
<p>Server-Server APIs: 74%, up from 71% last week</p>
</li>
</ul>
</blockquote>
<h3 id="conduit">Conduit</h3>
<p>Conduit is a Matrix homeserver written in Rust <a href="https://conduit.rs">https://conduit.rs</a></p>
<p><a href="https://matrix.to/#/@timo:koesters.xyz">timo</a> announced:</p>
<blockquote>
<p>Welcome back! This week we made some groundbreaking progress - this is not a joke, we found a bug in Synapse while breaking multiple Matrix rooms, causing the Matrix team a lot of unnecessary stress. Let me explain:
The good news is that Conduit is starting to federate now. This means that you should be able to join all public rooms of the Matrix network and exchange messages. Note that Conduit does not do all the checks it should be doing yet making it stop sending messages from time to time as well as that advanced features like loading the history, syncing temporary data like read receipts or accepting invites are not implemented yet.</p>
<p>The bad news is that, while Synapse is happy to accept Conduit's messages when it is already part of the room, joining into one of the rooms Conduit servers are part of didn't work because of an event validation bug. The Matrix team did an excellent job at fixing this bug and releasing a Synapse patch the same day, but the damage has been done making a few rooms inaccessible to old Synapse servers.
Thanks to everyone who supports me on &quot;Liberapay&quot; (https://liberapay.com/timokoesters) or Bitcoin!</p>
</blockquote>
<h2 id="synapse-deployment-inbox-tray">Synapse Deployment 📥️</h2>
<h3 id="synapse-on-netbsd">Synapse on NetBSD</h3>
<p><a href="https://matrix.to/#/@js:nil.im">js</a> reported:</p>
<blockquote>
<p>I ported Synapse + its dependencies to <a href="https://www.netbsd.org/">NetBSD</a> and it is now in <a href="https://www.pkgsrc.org/">pkgsrc</a> as <code>chat/matrix-synapse</code>. This means that Synapse is now easily installable on any operating system that supports pkgsrc (which is many, e.g. NetBSD, Linux, macOS, Solaris, AIX, Haiku, …). And while at it, I also ported mautrix-hangouts + dependencies (in pkgsrc as <code>chat/mautrix-hangouts</code>).</p>
</blockquote>
<h3 id="yunohost">YunoHost</h3>
<p><a href="https://matrix.to/#/@pierre:mamieserv.fr">Pierre</a> told us:</p>
<blockquote>
<p><a href="https://yunohost.org">YunoHost</a> is an operating system aiming for the simplest administration of a server, and therefore democratize self-hosting.</p>
<p><a href="https://github.com/YunoHost-Apps/synapse_ynh/tree/master">Synapse</a> integration had been updated to 1.19.1 (1.19.2 available in branch <code>testing</code>)</p>
<p><a href="https://github.com/YunoHost-Apps/element_ynh/tree/master">Element Web</a> integration had been updated to 1.7.5 (1.7.7 available in branch <code>testing</code>)</p>
</blockquote>
<h3 id="kubernetes">Kubernetes</h3>
<p><a href="https://matrix.to/#/@ace:kittenface.studio">Ananace</a> offered:</p>
<blockquote>
<p>Both image tags and a new chart version are hereby pushed for 1.19.2 for my <a href="https://github.com/ananace/matrix-synapse">Synapse image</a> and <a href="https://gitlab.com/ananace/charts">Helm chart</a></p>
</blockquote>
<p>then later</p>
<blockquote>
<p>Just pushed the updates for the K8s-optimized Synapse image and chart for 1.19.3</p>
</blockquote>
<h2 id="dept-of-bridges-bridge-at-night">Dept of Bridges 🌉</h2>
<h3 id="matrix-appservice-bridge-hits-2-0-0r-1">matrix-appservice-bridge hits 2.0.0ʳᶜ¹</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> said:</p>
<blockquote>
<p>Hey bridge developer enthusiasts! Myself and ChristianP (bridge crew of matrix.org) have been working hard on freshening up the matrix-appservice-bridge library. It's no secret that it was using &quot;classic&quot; Javascript rather than ES6 syntax, was poorly documented in places and there were no types at all to make use of.</p>
<p>But that's all changed now, the <a href="https://github.com/matrix-org/matrix-appservice-bridge/releases/tag/2.0.0-rc1">2.0.0-rc1</a> release brings fresh types, new convenience methods, a total swichover from Bluebird Promises to native Promises and much much more. If you are looking to quickly get set up writing bridges, it's never been easier.</p>
<p>Check out the <a href="https://github.com/matrix-org/matrix-appservice-bridge/tree/develop/examples/slack-starter">slack-starter</a> project to get your first taste of bridge excellence and see what you think.</p>
<p>As this is an RC, feedback is valuable and logging bugs helps us all. Please do so if you encounter any issues 😄</p>
</blockquote>
<h3 id="bridge-encryption-support">Bridge Encryption Support</h3>
<p><a href="https://matrix.to/#/@Half-Shot:half-shot.uk">Half-Shot</a> reported:</p>
<blockquote>
<p>Hi encryption fans. This week the bridge team has been churning away at adding support for encrypted rooms in the <code>matrix-appservice-bridge</code> library, to enable support in <code>matrix-appservice-irc</code>, <code>matrix-appservice-slack</code>, and anyone else using the library. This is probably the most exciting feature the library has seen in a long time! </p>
<p>The feature will be a simple config toggle, so existing bridges will have to do very little work to support it.</p>
<p>The first phase plans to use <a href="https://github.com/matrix-org/pantalaimon">Pantalaimon</a> with bridge users syncing like real users, but eventually the hope is that this will be all built into the library. Come check out <a href="https://github.com/matrix-org/matrix-appservice-bridge/issues/230">this issue</a> to keep track of progress.</p>
</blockquote>
<h2 id="dept-of-clients-iphone">Dept of Clients 📱</h2>
<h3 id="element-web">Element Web</h3>
<p><a href="https://matrix.to/#/@neilj:matrix.org">Neil</a> announced:</p>
<blockquote>
<ul>
<li>
<p>Released 1.7.6 and 1.7.7 highlights include</p>
<ul>
<li>
<p>Redesigned right panel where top right actions are now revealed via the i icon</p>
</li>
<li>
<p>Widgets can now be opened in the right panel</p>
</li>
<li>
<p>Widgets won't be visible in the Apps Drawer (top of timeline) by default (except Jitsi) - you need to pin them from the right panel</p>
</li>
<li>
<p>Widgets can now be resized</p>
</li>
</ul>
</li>
</ul>
</blockquote>
<ul>
<li>A new version of matrix.to is now live you can check it out <a href="https://matrix.to/">here</a>, <a href="https://github.com/matrix-org/matrix.to/issues">bug reports welcome</a>
&gt;</li>
</ul>
<blockquote>
<ul>
<li>
<p>A new feature to defer e2ee set up until the user actually wishes to use an e2ee channel.</p>
</li>
<li>
<p>A series of config flags to remove various features from the UI thereby simplifying the experience.</p>
</li>
</ul>
</blockquote>
<h3 id="mirage">Mirage</h3>
<p><a href="https://matrix.to/#/@miruka:privacytools.io">miruka</a> said:</p>
<blockquote>
<p>0.6.3 and 0.6.4 were released this week, and I'm now working on desktop notifications support and push rules control.</p>
<h4 id="added">Added</h4>
<ul>
<li>
<p>Add a <strong>system tray icon</strong>.</p>
<p>A left click will bring up the Mirage window, 
middle will quit the application and right will show a menu with these </p>
<p>options.</p>
</li>
<li>
<p>Add a <code>closeMimizesToTray</code> setting to the config file, defaults to <code>false</code>.</p>
<p>Controls whether closing the Mirage window will leave it running in the 
system tray, or fully quit the application.</p>
</li>
<li>
<p>Add a discrete <strong>read marker indicator</strong> to messages, shows how many people </p>
<p>have this event as their last seen one in the room.<br />
A way to see who read the message and when will be added in the future.</p>
</li>
<li>
<p>Themes: add <code>chat.message.localEcho</code> and <code>chat.message.readCounter</code> color properties</p>
</li>
<li>
<p>Add a <code>zoom</code> setting, defaults to <code>1.0</code></p>
</li>
<li>
<p>Add a <code>lexicalRoomSorting</code> setting, to sort rooms by their name instead of</p>
<p>recent activity.<br />
A restart is needed to apply changes to this setting.</p>
</li>
</ul>
<h4 id="changed">Changed</h4>
<ul>
<li>
<p>Restrict Mirage to a single instance per config folder, trying to launch a</p>
<p>new window will instead focus the existing one.<br />
The <code>MIRAGE_CONFIG_DIR</code> and <code>MIRAGE_DATA_DIR</code> environment variables can be</p>
<p>set to run different &quot;profiles&quot; in parallel.</p>
</li>
<li>
<p>Reduce the visible lag when opening a chat page, switching rooms should be </p>
<p>a lot smoother</p>
</li>
<li>
<p>When using the <code>focusPreviousMessage</code> and <code>focusNextMessage</code> keybinds, if no</p>
<p>message is focused and the timeline has been scrolled up, 
focus the message in the center of the view instead of returning to the </p>
<p>bottom of the timeline and focusing the last one.</p>
</li>
<li>
<p>Don't re-center the room list on clicks by default.</p>
<p>This prevents the list from jumping around every time a room is selected.<br />
The previous behavior can be restored with the new <code>centerRoomListOnClick</code></p>
<p>setting.</p>
</li>
<li>
<p>Show a better terminal error message than &quot;Component is not ready&quot; when the </p>
<p>window creation fails, giving details on what went wrong in the code</p>
</li>
<li>
<p>If an account's access token is invalid (e.g. our session was signed out </p>
<p>externally), say so with a popup and cleanly remove it from the UI, 
instead of spamming the user with errors.</p>
</li>
<li>
<p>Rename message context menu option &quot;Debug this event&quot; to just &quot;Debug&quot;</p>
</li>
<li>
<p>Unify up/down and (shift+)Tab navigation for the account Sessions page</p>
</li>
<li>
<p>Changes to the UI scale/zoom via keybinds are now persisted across restarts</p>
</li>
<li>
<p>Themes: <code>uiScale</code> is now bound to <code>window.settings.zoom</code>.</p>
<p>This change is necessary to keep the zoom keybinds working.</p>
</li>
</ul>
<h4 id="fixed">Fixed</h4>
<ul>
<li>A bunch of stuff, see the full changelog for <a href="https://github.com/mirukana/mirage/releases/tag/v0.6.3">0.6.3</a> and <a href="https://github.com/mirukana/mirage/releases/tag/v0.6.4">0.6.4</a></li>
</ul>
</blockquote>
<h3 id="element-android-1-0-7">Element Android 1.0.7</h3>
<p><a href="https://matrix.to/#/@benoit.marty:matrix.org">benoit</a> offered:</p>
<blockquote>
<p>Element Android 1.0.7 has been released (still stuck in Google pipes writing those lines), and will be quickly followed by 1.0.8 to fix a problem with cross signing verification.</p>
<p>We are working to implement search of messages in a room and we keep on fighting bugs and improving performance of the application.</p>
<p>We are also iterating on the home screen, to improve user experience, and try to satisfy users with a few rooms as well as users with several hundreds of rooms.</p>
</blockquote>
<h3 id="element-ios">Element-iOS</h3>
<p><a href="https://matrix.to/#/@Manu:matrix.org">Manu</a> said:</p>
<blockquote>
<p>This week, we released <a href="https://github.com/vector-im/element-ios/releases/tag/v1.0.12">1.0.12</a> with several bug fixes including the one for background crashes due to PushKit</p>
</blockquote>
<h3 id="hydrogen">Hydrogen</h3>
<p><a href="https://matrix.to/#/@bwindels:matrix.org">Bruno</a> told us:</p>
<blockquote>
<p>Released 0.037 on Monday with some polish for E2EE:</p>
<ul>
<li>
<p>remove outdated devices when querying</p>
</li>
<li>
<p>update room summary with decrypted events, also when retrying decryption</p>
</li>
<li>
<p>various crash protections</p>
</li>
<li>
<p>keep megolm session with earliest index when receiving a room key we already know about</p>
</li>
<li>
<p>add new icon</p>
</li>
<li>
<p>fix issue where olm would be loaded twice when login failed</p>
</li>
<li>
<p>show decryption errors in timeline</p>
</li>
<li>
<p>show encryption enabled tile in timeline</p>
</li>
</ul>
<p>The rest of the week was implementing session backup, which I hoped would be ready to release today but it needs some more polish unfortunately. In the meantime, here's a GIF teaser:</p>
</blockquote>
<p><img src="/blog/img/2020-09-18-uMR7F-session-backup.gif" alt="2020-09-18-uMR7F-session-backup.gif" /></p>
<h2 id="fluffychat">FluffyChat</h2>
<p>Thank you to <a href="https://matrix.to/#/@krille:janian.de">Krille</a>, who told us:</p>
<blockquote>
<p>FluffyChat version 0.18.0 is out now in F-Droid, Testflight and soon the PlayStore:</p>
<h3 id="features">Features</h3>
<ul>
<li>Added translations: Armenian, Turkish, Chinese (Simplified), Estonian</li>
<li>Url-ify matrix identifiers</li>
<li>Use server-side generated thumbnails in cleartext rooms</li>
<li>Add option to send images in their original resolution</li>
<li>Add additional confirmation for sending files &amp; share intents</li>
<li>Add option to opt-in to report issues / crashes to sentry</li>
<li>Write keys to online key backup, fully implementing online key backup</li>
</ul>
<h3 id="changes">Changes</h3>
<ul>
<li>Tapping links, pills, etc. now does stuff</li>
<li>Better handling of sending messages in bad network</li>
<li>Better recovery of &quot;keys not cached&quot;</li>
<li>E2EE is enabled again</li>
</ul>
<h3 id="fixes">Fixes:</h3>
<ul>
<li>Various html rendering and url-ifying fixes</li>
<li>Added support for blurhashes</li>
<li>Image viewer now eventually displays the original image, not only the thumbnail</li>
</ul>
</blockquote>
<h2 id="dept-of-sdks-and-frameworks">Dept of SDKs and Frameworks 🧰</h2>
<h3 id="hemppa">Hemppa</h3>
<p>Hemppa the bot is a multi-purpose Matrix bot for writing new functionality easily with Python. </p>
<p><a href="https://matrix.to/#/@cos:hacklab.fi">Cos</a> said:</p>
<blockquote>
<p>Hemppa gained a small but big feature for making fediverse better: per-room Mastodon tooting support. This means that you can set up a Mastodon account in your room and anyone with moderator rights can toot to that account. This way you and your roommates can super easily send toots to the world directly from Matrix. Mastodon (unlike the big alternative) supports RSS feeds out of the box so it's very easy to subscribe to users and hashtags with stock RSS bot.  Toot #hemppathebot if you like it! Another new contribution worth mentioning is welcome which can send welcome messages to users registering on the server or joining a room. <a href="https://github.com/vranki/hemppa">https://github.com/vranki/hemppa</a></p>
</blockquote>
<h3 id="ruby">Ruby</h3>
<p><a href="https://matrix.to/#/@ace:kittenface.studio">Ananace</a> said:</p>
<blockquote>
<p>Another week, another <a href="https://github.com/ananace/ruby-matrix-sdk">Ruby SDK</a> release. This time adding a little fix to avoid duplicate state events being passed twice to the application if identical ones arrive in both state and timeline, also adds a global state event handler and moves room event handling to not depend on room instances themselves.</p>
</blockquote>
<p>Asked how much the SDK is used in production, Ananace said: </p>
<blockquote>
<p>a little, we've hooked Matrix into our server orchestration / configuration management system TheForeman - which is a Rails application. Also got a colleague who's doing a bot to linkify internal ticket IDs.</p>
</blockquote>
<h3 id="ruma">Ruma</h3>
<p><a href="https://matrix.to/#/@iinuwa:matrix.org">iinuwa</a> told us:</p>
<blockquote>
<p>Thanks to @q-b and @jtescher we have implemented more of the federation endpoints (bringing us up to about 85% completion) and every (one) endpoint of the Push Gateway API!</p>
<p>We fixed a bug where federation endpoints expected access tokens instead of server signatures for authentication. In the future, we may add an API that requires signatures on requests.</p>
<p>Finally, we've also continued progress on the non-exhaustive type updates for backwards compatibility; we expect to finish this within the coming weeks.</p>
<h4 id="new-contributors">New Contributors</h4>
<ul>
<li>
<p><a href="https://github.com/jtescher">@jtescher</a>, not new but forgot to mention earlier!</p>
</li>
<li>
<p><a href="https://github.com/williewillus">@williewillus</a></p>
</li>
</ul>
</blockquote>
<h2 id="dept-of-bots-robot-face">Dept of Bots 🤖</h2>
<h3 id="matrix-reminder-bot">Matrix Reminder Bot</h3>
<p><a href="https://matrix.to/#/@andrewm:amorgan.xyz">anoa</a> announced:</p>
<blockquote>
<p>v0.2.0 of <a href="https://github.com/anoadragon453/matrix-reminder-bot">matrix-reminder-bot</a> has been released! This releases includes lots of bugfixes, updates and polishing. Find the list below:</p>
<h4 id="features-1">Features</h4>
<ul>
<li>
<p>Better support for command prefixes other than the default <code>!</code>.</p>
</li>
<li>
<p>Just writing <code>!silence</code> now silences the currently active alarm.</p>
</li>
<li>
<p>The bot will now print the correct syntax of a command if the user fails to follow it.</p>
</li>
<li>
<p>The bot will reply to events if it cannot decrypt them, as well as offer helpful tips that both the user and bot operator can try to fix things.</p>
</li>
</ul>
<h4 id="bugfixes">Bugfixes</h4>
<ul>
<li>
<p>Timezones. They should finally work correctly! ...no 100% guarantees though.</p>
</li>
<li>
<p>Alarms were a bit broken. They're fixed now.</p>
</li>
<li>
<p>Fix commands with formatting and newlines not being picked up by the bot.</p>
</li>
<li>
<p>Fix non-latin characters preventing reminders from being deleted.</p>
</li>
</ul>
<h4 id="internal-changes">Internal changes</h4>
<ul>
<li>
<p>Add a dev-optimised Dockerfile for quicker iteration during development.</p>
</li>
<li>
<p>Better wording revolving alarms. They're just reminders that alarm repeatedly when they go off.</p>
</li>
<li>
<p>Log why the bot is unable to start.</p>
</li>
<li>
<p>Don't print &quot;Unknown help topic&quot; in case the user is trying to ask another bot for help.</p>
</li>
<li>
<p>The config dict is now a singleton.</p>
</li>
<li>
<p>Type hints everywhere!</p>
</li>
</ul>
<p>Additionally, the minimum Python version is now 3.6. matrix-reminder-bot is made with <a href="https://github.com/anoadragon453/nio-template">nio-template</a>.</p>
</blockquote>
<h2 id="dept-of-ping-table-tennis-paddle-and-ball">Dept of Ping 🏓</h2>
<p>Here we reveal, rank, and applaud the homeservers with the lowest ping, as measured by <a href="https://github.com/maubot/echo">pingbot</a>, a <a href="https://github.com/maubot/maubot">maubot</a> that you can host on your own server. Join <a href="https://matrix.to/#/#ping:maunium.net">#ping:maunium.net</a> to experience the fun live, and to find out how to add YOUR server to the game.</p>
<table><thead><tr><th style="text-align: center">Rank</th><th style="text-align: center">Hostname</th><th style="text-align: center">Median MS</th></tr></thead><tbody>
<tr><td style="text-align: center">1</td><td style="text-align: center">fairydust.space</td><td style="text-align: center">412</td></tr>
<tr><td style="text-align: center">2</td><td style="text-align: center">matrix-dev.kapsi.fi</td><td style="text-align: center">1308</td></tr>
<tr><td style="text-align: center">3</td><td style="text-align: center">utzutzutz.net</td><td style="text-align: center">1519</td></tr>
<tr><td style="text-align: center">4</td><td style="text-align: center">blob.cat</td><td style="text-align: center">1521</td></tr>
<tr><td style="text-align: center">5</td><td style="text-align: center">r23s.eu</td><td style="text-align: center">1915.5</td></tr>
<tr><td style="text-align: center">6</td><td style="text-align: center">conduit.rs</td><td style="text-align: center">2149</td></tr>
<tr><td style="text-align: center">7</td><td style="text-align: center">maescool.be</td><td style="text-align: center">2759</td></tr>
<tr><td style="text-align: center">8</td><td style="text-align: center">halogen.city</td><td style="text-align: center">2774.5</td></tr>
<tr><td style="text-align: center">9</td><td style="text-align: center">uraziel.de</td><td style="text-align: center">3253</td></tr>
<tr><td style="text-align: center">10</td><td style="text-align: center">kapsi.fi</td><td style="text-align: center">3713</td></tr>
</tbody></table>
<h3 id="dept-of-ping-extra">Dept of Ping Extra:</h3>
<p><a href="https://matrix.to/#/@timo:koesters.xyz">timo</a> announced:</p>
<blockquote>
<p>Normally the ping shows how long other servers take to receive the sending-server's message. Some servers receive it quickly, some take hours. All this flows into the statistic of the sending server. I wrote a small program that's the other way around. Instead of measuring the sending-server's ping, it associates each measurement with an echo-bot (instead of the sending server), so this plot shows which maubots are the fastest to respond (it's probably not accurate at all, because most of the pings were started on conduit servers this week, but it's interesting nevertheless):</p>
</blockquote>
<p><img src="/blog/img/2020-09-18-PRR99-image.png" alt="2020-09-18-PRR99-image.png" /></p>
<h2 id="that-s-all-i-know-checkered-flag">That's all I know 🏁</h2>
<p>See you next week, and be sure to stop by <a href="https://matrix.to/#/#TWIM:matrix.org">#twim:matrix.org</a> with your updates!</p>

        </div>
    </article>
    
    <article class="post">
        <header>
            <h1><a href="&#x2F;blog&#x2F;2020&#x2F;09&#x2F;16&#x2F;gsoc-report-ruma-procedural-macro-refactoring-and-more&#x2F;" title="GSOC report: 	Ruma procedural macro refactoring and more">GSOC report: 	Ruma procedural macro refactoring and more</a></h1>
            <span>
                16.09.2020 16:35
                —
                <a href="/category/gsoc">
                    GSOC
                </a>
                —
                <a href="/author/devin-ragotzy">
                    Devin Ragotzy
                </a>
            </span>
            
        </header>
        <div>
            <p>This is part of a series of reports on the <a href="https://summerofcode.withgoogle.com/organizations/6060943798173696"><em>six</em> projects</a> assigned to Matrix for Google Summer of Code 2020.</p>
<p><a href="https://summerofcode.withgoogle.com/organizations/6060943798173696/#4756651216732160">View project: 	Ruma procedural macro refactoring and more</a></p>
<hr />
<p>Wow the summer has flown by, it feels like just yesterday I was learning how to rebase and what exactly it is Ruma does. I exaggerate slightly, but it is a big library with lots of public API surface. I have learned more in the last few months than in two years of school. I have been able to observe and participate in a project with a community growing around it, been a part of discussions about design and best practices, given and received numerous code reviews as well as learned the process of addressing the feedback, and working from a specification. In short, this has been an amazing opportunity to gain experience in all the things that are hard to obtain in a classroom.</p>
<p>My project goal was to improve the existing macros in ruma-events-macros and ruma-api-macros. It became clear early on that this would include some major API changes and that improving the macros as they were was pointless without also moving to a new public API. While improving the durability and readability of the macro code I also rewrote entire sections to accommodate the new design.</p>
<p>A quick overview of the Matrix protocol for reference: a client sends content that is interpreted by the server as events. The server distributes those events out to other clients and other servers (the server case is known as federation). Ruma groups these events by kind Message, State, Ephemeral, ToDevice and Basic which are represented as generic structs (<code>StateEvent&lt;C&gt;</code>). Each event kind needs to be able to hold many different content types, for state events there is room creation, room name, and membership events to name a
few. Using the macros, enums are generated to represent all state event possibilities, so a variant for membership, room name, etc. These types exist to support the core API request and response types for each endpoint that is defined by the Matrix specification.</p>
<h2 id="gsoc-starts-and-i-start-with-ruma-events">GSoC Starts and I start with ruma-events</h2>
<ul>
<li><a href="https://github.com/ruma/ruma-events/pull/85">remove old ruma-events macros</a></li>
<li><a href="https://github.com/ruma/ruma-events/pull/86">start work for event content derive, move to generic Event structs</a></li>
<li><a href="https://github.com/ruma/ruma-events/pull/101">collect all content types into enum</a></li>
<li><a href="https://github.com/ruma/ruma-events/pull/107">add more types, making sure the macro works</a></li>
<li><a href="https://github.com/ruma/ruma-events/pull/108">work on Event custom macro derive</a></li>
<li><a href="https://github.com/ruma/ruma-events/pull/111">remove raw modules and FromRaw trait</a></li>
<li><a href="https://github.com/ruma/ruma-events/pull/119">add each events enum</a></li>
<li><a href="https://github.com/ruma/ruma-events/pull/122">add trybuild tests for ruma-events</a></li>
</ul>
<h2 id="more-work-on-ruma-events-now-a-part-of-the-new-mono-repo">More work on ruma-events, now a part of the new mono-repo</h2>
<ul>
<li><a href="https://github.com/ruma/ruma/pull/52">deserialization optimization for Any*Event, and benchmarking to verify</a></li>
<li><a href="https://github.com/ruma/ruma/pull/68">reverting the removal of enum_enum macro, learning a lot of git along the way</a></li>
<li><a href="https://github.com/ruma/ruma/pull/69">it took me awhile but I got the hang of it, only one review issue!</a></li>
<li><a href="https://github.com/ruma/ruma/pull/97">add accessor methods to the enums, making them much nicer to use</a></li>
</ul>
<h2 id="work-on-ruma-client-api">Work on ruma-client-api</h2>
<ul>
<li><a href="https://github.com/ruma/ruma/pull/104">refactoring the Api::to_tokens code helped me get my head around this crate</a></li>
<li><a href="https://github.com/ruma/ruma/pull/105">notice my commit messages are starting to looking better</a></li>
<li><a href="https://github.com/ruma/ruma/pull/108">not everything works out...</a></li>
<li><a href="https://github.com/ruma/ruma/pull/109">but you get it eventually</a></li>
<li><a href="https://github.com/ruma/ruma/pull/111">deep dive into rust features, I learned a lot about them</a></li>
</ul>
<h2 id="back-to-ruma-events">Back to ruma-events</h2>
<ul>
<li><a href="https://github.com/ruma/ruma/pull/130">a ruma events and client-api rename</a></li>
<li><a href="https://github.com/ruma/ruma/pull/138">add code to generate redact method in event_enum!</a></li>
<li><a href="https://github.com/ruma/ruma/pull/139">adding to existing code without breaking everything is hard</a></li>
<li><a href="https://github.com/ruma/ruma/pull/155">converting to and from the rusty way</a></li>
<li><a href="https://github.com/ruma/ruma/pull/179">I love writing proc_macros, this was a fun one! Adding lifetimes in the req/resp macro</a></li>
</ul>
<h2 id="continuing-maintenance">Continuing maintenance</h2>
<ul>
<li><a href="https://github.com/ruma/ruma/pull/190">quality of life stuff, the day to day work of a maintainer</a></li>
<li><a href="https://github.com/ruma/ruma/pull/201">allow the internal macros to be used outside of the ruma crate more easily</a></li>
<li><a href="https://github.com/ruma/ruma/pull/213">adding small needed features to the macros</a></li>
<li><a href="https://github.com/ruma/ruma/pull/234">good ol' fashioned closing issues!</a></li>
</ul>
<p>One of my personal goals was to become more familiar with git. With the help of my mentor I now feel more confident using this tool that is so essential to developers. I became fairly adept at merging, rebasing, and navigating all the headaches that come with that. I learned plenty of new commands. A few highlights: <code>cherry-pick</code> and specific uses of <code>reset</code> to avoid copy-pasting fixes and adding more commits. I used the <code>reset</code> command to craft good commits, splitting work into appropriate chunks. I am glad that I had the opportunity to hone my git skills. I feel like I have accomplished my goal and then some!</p>
<p>I am proud of the work that I have done: Being part of moving ruma-events much closer to the <code>0.22</code> release and creating macros to generate types specific to the Matrix specification. Working with the community that has grown around Ruma has been rewarding and I plan on sticking around.</p>

        </div>
    </article>
    
    <nav class="pagination">
    <div class="prev">
        
        <a href="&#x2F;blog&#x2F;page&#x2F;21&#x2F;">‹ Previous</a>
        
    </div>
    <span class="page-number">22 / 64</span>
    <div class="prev">
        
        <a href="&#x2F;blog&#x2F;page&#x2F;23&#x2F;">Next ›</a>
        
    </div>
</nav>

</div>
    </main>

    <footer class="site-footer">
    <div class="internal-links">
        
        <a href="&#x2F;faq">FAQs</a>
        
        <a href="&#x2F;security-disclosure-policy">Security Disclosure Policy</a>
        
        <a href="&#x2F;security-hall-of-fame">Security Hall of Fame</a>
        
        <a href="&#x2F;legal&#x2F;code-of-conduct">Code of Conduct for Matrix.org</a>
        
        <a href="&#x2F;legal">Legal</a>
        
        <a href="&#x2F;contact">Contact</a>
        
        <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org&#x2F;matrix.org&#x2F;">Site Source</a>
        
    </div>
    <div class="external-links">
        <div>
            
            <a href="&#x2F;code"><img src="/assets/github.svg" alt="GitHub"></a>
            
            <a href="https:&#x2F;&#x2F;gitlab.matrix.org&#x2F;"><img src="/assets/gitlab.svg" alt="GitLab"></a>
            
            <a href="https:&#x2F;&#x2F;mastodon.matrix.org&#x2F;@matrix"><img src="/assets/mastodon.svg" alt="Mastodon"></a>
            
            <a href="https:&#x2F;&#x2F;twitter.com&#x2F;matrixdotorg"><img src="/assets/twitter.svg" alt="Twitter"></a>
            
            <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCVFkW-chclhuyYRbmmfwt6w"><img src="/assets/youtube.svg" alt="YouTube"></a>
            
        </div>
    </div>
    <p>© 2022 The Matrix.org Foundation C.I.C.</p>
</footer>

</body>

</html>
