<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="twitter:widgets:csp" content="on" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="twitter:site" content="@matrixdotorg" />
    <meta name="twitter:creator" content="@matrixdotorg" />

    <title>Matrix.org - Rooms &amp; Events</title>
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="icon" type="image/png" href="/assets/favicon.png" />
    <link rel="stylesheet" href="/style.css" />

    </head>

<body>
    
    <header class="site-header">
    <a href="/" class="brand">
        <img src="/images/matrix-logo-white.svg" alt="Matrix logo">
    </a>
    <input id="site-header-dropdown-checkbox" type="checkbox" class="dropdown-checkbox" aria-hidden="true">
    <label for="site-header-dropdown-checkbox" class="dropdown-button">&#xe602;</label>
    <label for="site-header-dropdown-checkbox" class="page-overlay"></label>
    <nav>
        
        
        <a href="&#x2F;about&#x2F;" class="
            ">
            About
        </a>
        
        
        
        <a href="&#x2F;blog&#x2F;" class="
            ">
            Blog
        </a>
        
        
        
        
        
        <div class="section-wrap">
            <input id="docs-submenu-checkbox" type="checkbox" class="submenu-checkbox" aria-hidden="true" checked>
            <label for="docs-submenu-checkbox" class="submenu-title">Documentation <div class="arrow"></div></label>

            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    
                    
                    <a href="&#x2F;docs&#x2F;chat_basics&#x2F;">Chat basics</a>
                    
                    
                    <a href="&#x2F;docs&#x2F;communities&#x2F;">Communities</a>
                    
                    
                    <a href="&#x2F;docs&#x2F;technical&#x2F;">Technical docs</a>
                    
                    
                    <a href="&#x2F;docs&#x2F;legacy&#x2F;">Legacy documentation</a>
                    
                </div>
            </div>
        </div>
        
        
        
        
        
        <div class="section-wrap">
            <input id="ecosystem-submenu-checkbox" type="checkbox" class="submenu-checkbox" aria-hidden="true" >
            <label for="ecosystem-submenu-checkbox" class="submenu-title">Ecosystem <div class="arrow"></div></label>

            <div class="section-submenu-wrap">
                <div class="section-submenu">
                    
                    <a href="&#x2F;ecosystem&#x2F;clients&#x2F;">Clients</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;servers&#x2F;">Servers</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;bots&#x2F;">Bots</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;bridges&#x2F;">Bridges</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;sdks&#x2F;">SDKs</a>
                    
                    <a href="&#x2F;ecosystem&#x2F;hosting&#x2F;">Hosting</a>
                    
                    
                </div>
            </div>
        </div>
        
        
        
        <a href="&#x2F;podcasts&#x2F;" class="
            ">
            Podcasts
        </a>
        
        
        
        <a href="https:&#x2F;&#x2F;shop.matrix.org" class="
            ">
            Shop
        </a>
        
        
        
        <a href="&#x2F;try-matrix&#x2F;" class="primary
            ">
            Try Matrix
        </a>
        
        
    </nav>
</header>


    <main>
        




    


<div class="docs-body">
    <div class="docs-menu">
        
            
        
        <div>
            <input id="Technical docs-submenu-checkbox" type="checkbox" class="submenu-checkbox" aria-hidden="true" >
            <label for="Technical docs-submenu-checkbox" class="submenu-title">Technical docs<div class="arrow"></div></label>
            <ul class="section-submenu-wrap">
                <a href="&#x2F;docs&#x2F;technical&#x2F;"><li>Overview</li></a>
                
                <li>
                    <a href="&#x2F;docs&#x2F;technical&#x2F;#elements-of-matrix">Elements of Matrix</a>
                    
                    <ul>
                    
                        <a href="&#x2F;docs&#x2F;technical&#x2F;#homeserver"><li>Homeserver</li></a>
                    
                        <a href="&#x2F;docs&#x2F;technical&#x2F;#client"><li>Client</li></a>
                    
                        <a href="&#x2F;docs&#x2F;technical&#x2F;#appservice-bridges-and-some-bots"><li>AppService (bridges and some bots)</li></a>
                    
                    </ul>
                    
                </li>
                
                <li>
                    <a href="&#x2F;docs&#x2F;technical&#x2F;#the-specification">The Specification</a>
                    
                </li>
                
            </ul>
        </div>
        
        
        
            
        
        <div>
            <input id="1-submenu-checkbox" type="checkbox" class="submenu-checkbox" aria-hidden="true" checked>
            <label for="1-submenu-checkbox" class="submenu-title">Rooms &amp; Events<div class="arrow"></div></label>
            <ul class="section-submenu-wrap">
                <a href="&#x2F;docs&#x2F;technical&#x2F;rooms_and_events&#x2F;"><li>Overview</li></a>
                
                <li>
                    <a href="&#x2F;docs&#x2F;technical&#x2F;rooms_and_events&#x2F;#local-copies">Local copies</a>
                    
                </li>
                
                <li>
                    <a href="&#x2F;docs&#x2F;technical&#x2F;rooms_and_events&#x2F;#administration-privileges">Administration &amp; privileges</a>
                    
                    <ul>
                    
                        <a href="&#x2F;docs&#x2F;technical&#x2F;rooms_and_events&#x2F;#at-room-creation"><li>At room creation</li></a>
                    
                        <a href="&#x2F;docs&#x2F;technical&#x2F;rooms_and_events&#x2F;#at-room-join"><li>At room join</li></a>
                    
                        <a href="&#x2F;docs&#x2F;technical&#x2F;rooms_and_events&#x2F;#altering-a-local-copy-of-the-room"><li>Altering a local copy of the room</li></a>
                    
                        <a href="&#x2F;docs&#x2F;technical&#x2F;rooms_and_events&#x2F;#impersonating-others"><li>Impersonating others</li></a>
                    
                    </ul>
                    
                </li>
                
            </ul>
        </div>
        
    </div>
    <div class="docs-content">
        <article class="content">
            <header>
                <h1>Rooms &amp; Events</h1>
                
                <span class="last-updated">
                    Last updated: <time datetime="2023-02-23"> 2023-02-23</time>
                </span>
            </header>

            <p>Users on a server can send <em>events</em> into <em>rooms</em>. An event is a particular json
object, describing what a user is trying to do (join a room, send a message,
update a specific value…). An event will look like the following</p>
<pre data-lang="json" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-json "><code class="language-json" data-lang="json"><span>{
</span><span>  </span><span style="color:#d69d85;">&quot;content&quot;</span><span>: {
</span><span>    </span><span style="color:#d69d85;">&quot;body&quot;</span><span>: </span><span style="color:#d69d85;">&quot;This is an example text message&quot;</span><span>,
</span><span>    </span><span style="color:#d69d85;">&quot;format&quot;</span><span>: </span><span style="color:#d69d85;">&quot;org.matrix.custom.html&quot;</span><span>,
</span><span>    </span><span style="color:#d69d85;">&quot;formatted_body&quot;</span><span>: </span><span style="color:#d69d85;">&quot;&lt;b&gt;This is an example text message&lt;/b&gt;&quot;</span><span>,
</span><span>    </span><span style="color:#d69d85;">&quot;msgtype&quot;</span><span>: </span><span style="color:#d69d85;">&quot;m.text&quot;
</span><span>  },
</span><span>  </span><span style="color:#d69d85;">&quot;event_id&quot;</span><span>: </span><span style="color:#d69d85;">&quot;$143273582443PhrSn:example.org&quot;</span><span>,
</span><span>  </span><span style="color:#d69d85;">&quot;origin_server_ts&quot;</span><span>: </span><span style="color:#b5cea8;">1432735824653</span><span>,
</span><span>  </span><span style="color:#d69d85;">&quot;room_id&quot;</span><span>: </span><span style="color:#d69d85;">&quot;!jEsUZKDJdhlrceRyVU:example.org&quot;</span><span>,
</span><span>  </span><span style="color:#d69d85;">&quot;sender&quot;</span><span>: </span><span style="color:#d69d85;">&quot;@example:example.org&quot;</span><span>,
</span><span>  </span><span style="color:#d69d85;">&quot;type&quot;</span><span>: </span><span style="color:#d69d85;">&quot;m.room.message&quot;</span><span>,
</span><span>  </span><span style="color:#d69d85;">&quot;unsigned&quot;</span><span>: {
</span><span>    </span><span style="color:#d69d85;">&quot;age&quot;</span><span>: </span><span style="color:#b5cea8;">1234
</span><span>  }
</span><span>}
</span></code></pre>
<p>In the case of instant messaging, clients display rooms very similarly to Slack,
Discord or IRC channels. Most of the events in such rooms are messages. Rooms
have a unique technical identifier, and zero or more human-readable aliases.
Aliases are made of a room name, and a server part, and are sometimes referred
to as &quot;addresses&quot;. A typical room alias would be:</p>
<pre style="background-color:#1e1e1e;color:#dcdcdc;"><code><span>#goodfriends:example.com
</span></code></pre>
<p>From a technical perspective, a room is a series of json objects. The schema
below represents a room with dumbed down events. It is up to the clients to
read, parse, and display the events properly.</p>
<figure>
    <img src=".&#x2F;events.svg" alt="The room #goodfriends:example.com with simplified events" />
    <figcaption>The room #goodfriends:example.com with simplified events</figcaption>
</figure>
<h2 id="local-copies">Local copies</h2>
<p>Homeservers are federated: the Matrix specification defines a <a href="https://spec.matrix.org/latest/server-server-api/">Sever-Server API</a>
(also known as Federation API) to describe interactions between servers.
Whenever a user is in a room, their homeserver needs to have a local copy of
that room.</p>
<p>For example, if <code>@alice:example.com</code> is the first user from <code>example.com</code> to try
to join <code>#goodfriends:matrix.org</code>, then her homeserver is going to reach out to
<code>matrix.org</code> to get a copy of the room. <code>example.com</code> and <code>matrix.org</code> then stay
in touch to synchronise their copy of the room.</p>
<figure>
    <img src=".&#x2F;room_federated.svg" alt="Three homeservers keeping their local copy of the room in sync" />
    <figcaption>Three homeservers keeping their local copy of the room in sync</figcaption>
</figure>
<h2 id="administration-privileges">Administration &amp; privileges</h2>
<p>Whenever the homeserver receives new events, it's in charge of parsing them,
perform checks on the event, and take action accordingly (e.g. sending messages
from users on the homeserver to other participating homeservers, or distributing
messages from other participating homeservers to users). The expected behaviour
of homeservers is described fully in the <a href="https://spec.matrix.org">Matrix Specification</a>.</p>
<p>It could seem dangerous to think that everyone has their own local copy of the
room. Doesn't that mean anyone can become administrator of the room and do nasty
things? Fortunately, no. The privileges of people in the room are defined by
Power Levels.</p>
<p>Power levels define a hierarchy in the room. All of the actions in a room
require a minimum power level. Posting a message in a room requires having the
power level 0, redacting someone else's message usually requires having power
level 50, changing the room address usually requires having power level 100.</p>
<p>For more details on power levels, please check the relevant section of the
community management documentation.</p>
<div class="page_card">
    <a href="&#x2F;docs&#x2F;communities&#x2F;moderation&#x2F;#power-levels" alt="Link to Power Levels">
        <div class="wrapper">
            <div class="card_content">
                <h4>Power Levels</h4>
                <p>Discover how power levels are used in practice.</p>
            </div>
            <div class="arrow"></div>
        </div>
    </a>
</div>
<h3 id="at-room-creation">At room creation</h3>
<p>A power level is an integer usually between 0 and 100 bound to an account in a
room. According to the spec recommendations, when someone creates a room, their
account gets power level 100 in that room. So if Alice creates the room
<code>#goodfriends</code> on example.com, her account <code>@alice:example.com</code> will get the
power level 100 in all the local copies of <code>#goodfriends:example.com</code>, whether
the copy is on example.com, matrix.org or ergaster.org.</p>
<figure>
    <img src=".&#x2F;room_creation.svg" alt="Alice creates the room and automatically gets Power Level 100" />
    <figcaption>Alice creates the room and automatically gets Power Level 100</figcaption>
</figure>
<h3 id="at-room-join">At room join</h3>
<p>When someone else joins the room, whether they are on the same homeserver as the
creator or another homeserver, by default they are assigned the power level 0.
If Bob on ergaster.org joins <code>#goodfriends:example.com</code>, his server is going to
ask Alice's example.com a local copy of the room, and stay in sync with it.</p>
<figure>
    <img src=".&#x2F;room_join.svg" alt="Bob joins the room and automatically gets Power Level 0" />
    <figcaption>Bob joins the room and automatically gets Power Level 0</figcaption>
</figure>
<p>If Carol joins from her homeserver matrix.org, she will also get the power level
0.</p>
<figure>
    <img src=".&#x2F;room_federated.svg" alt="Carol joins the room and automatically gets Power Level 0 as well.
    The power levels are the same on every local copy of the room." />
    <figcaption>Carol joins the room and automatically gets Power Level 0 as well.
    The power levels are the same on every local copy of the room.</figcaption>
</figure>
<h3 id="altering-a-local-copy-of-the-room">Altering a local copy of the room</h3>
<p>Let's now consider Walter. Walter is the homeserver administrator of
example.com, the homeserver Alice used to create the <code>#goodfriends:example.com</code>
room.</p>
<p>When he joins the room, Walter gets the power level 0 by default, as everyone
else.</p>
<figure>
    <img src=".&#x2F;walter_joins.svg" alt="Walter joins the room and gets Power Level 0: he is a regular user" />
    <figcaption>Walter joins the room and gets Power Level 0: he is a regular user</figcaption>
</figure>
<p>If Walter fiddled with its homeserver database to alter its local copy of the
room, his change would not propagate: nobody has granted him power level 0: when
the other homeservers would want to update their local copy of the room, they
would reject the change making Walter administrator of the room.</p>
<h3 id="impersonating-others">Impersonating others</h3>
<p>Some homeserver implementations like Synapse have a non-standard <a href="https://matrix-org.github.io/synapse/latest/usage/administration/admin_api/index.html">Admin API</a>
and more particularly an <a href="https://matrix-org.github.io/synapse/latest/admin_api/rooms.html#make-room-admin-api">API to make someone the room admin</a>.
This doesn't mean homeserver administrators can't take over rooms as they
please.</p>
<p>When Walter calls the Make Room Admin API, Synapse is going to control Alice's
account to grant Walter the same Power Level as her. Alice is Power Level 100,
she is allowed to promote Walter to the same Power Level. This is valid
according to the Matrix Spec, so when the other homeservers will update their
local copy of the room they will accept the change.</p>
<figure>
    <img src=".&#x2F;walter_escalate_ok.svg" alt="Alice&#x27;s account is used by Synapse to give Walter the same power level" />
    <figcaption>Alice&#x27;s account is used by Synapse to give Walter the same power level</figcaption>
</figure>
<p>What if Walter was the homeserver administrator of ergaster.org instead? Every
user of ergaster.org in this room have the Power Level 0. If Walter called this
API, his homeserver would only be able to control a user with Power Level 0, and
would not be able to promote him.</p>
<figure>
    <img src=".&#x2F;walter_escalate_ko.svg" alt="Walter cannot control any account to escalate his power level" />
    <figcaption>Walter cannot control any account to escalate his power level</figcaption>
</figure>

        </article>
    </div>
</div>

    </main>

    <footer class="site-footer">
    <div class="internal-links">
        
        <a href="&#x2F;faq">FAQs</a>
        
        <a href="&#x2F;security-disclosure-policy">Security Disclosure Policy</a>
        
        <a href="&#x2F;security-hall-of-fame">Security Hall of Fame</a>
        
        <a href="&#x2F;legal&#x2F;code-of-conduct">Code of Conduct for Matrix.org</a>
        
        <a href="&#x2F;legal">Legal</a>
        
        <a href="&#x2F;contact">Contact</a>
        
        <a href="https:&#x2F;&#x2F;github.com&#x2F;matrix-org&#x2F;matrix.org&#x2F;">Site Source</a>
        
    </div>
    <div class="external-links">
        <div>
            
            <a href="&#x2F;code"><img src="/assets/github.svg" alt="GitHub"></a>
            
            <a href="https:&#x2F;&#x2F;gitlab.matrix.org&#x2F;"><img src="/assets/gitlab.svg" alt="GitLab"></a>
            
            <a href="https:&#x2F;&#x2F;mastodon.matrix.org&#x2F;@matrix"><img src="/assets/mastodon.svg" alt="Mastodon"></a>
            
            <a href="https:&#x2F;&#x2F;twitter.com&#x2F;matrixdotorg"><img src="/assets/twitter.svg" alt="Twitter"></a>
            
            <a href="https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCVFkW-chclhuyYRbmmfwt6w"><img src="/assets/youtube.svg" alt="YouTube"></a>
            
        </div>
    </div>
    <p>© 2022 The Matrix.org Foundation C.I.C.</p>
</footer>

</body>

</html>
